import{r as e,j as s,C as r,b as t,c as n,a as i,B as a,ai as o,aj as l,ag as c,an as d,I as u,ao as m,A as h,_ as p,D as x,q as g,s as w,t as f,ap as j,G as _}from"./index-Cn25rjDc.js";import{s as v}from"./supabase-rhP1-bIs.js";const y=["QuestionFormat","original_sentence","WordOrSentence","CorrectAnswer","IncorrectAnswer1","IncorrectAnswer2","IncorrectAnswer3","Explanation"];function N(e){return e.replace(/<[^>]*>/g,"")}function b(e){const s=[];let r="",t=!1;for(let n=0;n<e.length;n++){const i=e[n];'"'===i?t&&'"'===e[n+1]?(r+='"',n++):t=!t:","!==i||t?r+=i:(s.push(r),r="")}return s.push(r),s.map(e=>e.trim())}function C(e,s,r){const t=[],n=[],i=[];let a=(e||"").replace(/^\uFEFF/,"");a=function(e){return e.replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'")}(a),a=function(e){const s=e.split(/\r?\n/).find(e=>e.trim().length>0)||"",r=(s.match(/,/g)||[]).length;return(s.match(/;/g)||[]).length>0&&0===r?e.replace(/;/g,","):e}(a);const o=a.split(/\r?\n/).map(e=>e.trim()).filter(e=>e.length>0);if(0===o.length)return{ok:!1,skill_type:s,skill_test_id:r,insert:[],warnings:[],errors:[{row:0,message:`Missing headers. Expected: ${y.join(",")}`,raw:{}}],summary:{rows_received:0,rows_valid:0,rows_with_warnings:0,rows_with_errors:0}};const l=e=>e.replace(/[^a-z0-9]/gi,"").toLowerCase(),c={QuestionFormat:["format","type","qformat"],audio_url:["audio","audiourl","audiofile","file","filename","audiofilename","mp3"],original_sentence:["transcript","transcription","original","sentence","audiotranscript"],WordOrSentence:["instruction","prompt","question","questiontext","stem"],CorrectAnswer:["answer","correct","key"],IncorrectAnswer1:["incorrect1","wrong1","distractor1","option2","choiceb","b"],IncorrectAnswer2:["incorrect2","wrong2","distractor2","option3","choicec","c"],IncorrectAnswer3:["incorrect3","wrong3","distractor3","option4","choiced","d"],Explanation:["rationale","why","notes","feedback"]},d=b(o[0]).map(e=>e.replace(/^"|"$/g,"").trim()),u={};d.forEach((e,s)=>{u[l(e)]=s});const m=e=>{var s;const r=[l(e),...(null==(s=c[e])?void 0:s.map(l))||[]];for(const t of r)if(void 0!==u[t])return u[t]},h=[];if(y.forEach(e=>{void 0===m(e)&&h.push(e)}),h.length>0)return{ok:!1,skill_type:s,skill_test_id:r,insert:[],warnings:[],errors:[{row:0,message:`Missing required headers: ${h.join("; ")}. Expected: ${y.join(",")}`,raw:Object.fromEntries(d.map((e,s)=>[s.toString(),e]))}],summary:{rows_received:0,rows_valid:0,rows_with_warnings:0,rows_with_errors:0}};const p=o.slice(1);p.forEach((e,a)=>{const o=a+1,l=b(e),c=e=>{const s=m(e);return function(e,s=300){if(e.length<=s)return e;const r=e.slice(0,s),t=Math.max(r.lastIndexOf("."),r.lastIndexOf(","),r.lastIndexOf(";"),r.lastIndexOf(":"));return(t>60?r.slice(0,t):r).trim()}(function(e){return e.replace(/[\r\n]+/g," ").replace(/\s+/g," ").trim()}(N((void 0!==s?l[s]:"")||"")))},d=e=>{const s=m(e);return N((void 0!==s?l[s]:"")||"").replace(/\r?\n/g,"\n").trim()};let u=c("QuestionFormat");const h=c("audio_url"),p=d("original_sentence"),x=d("WordOrSentence"),g=c("CorrectAnswer"),w=c("IncorrectAnswer1"),f=c("IncorrectAnswer2"),j=c("IncorrectAnswer3"),_=c("Explanation"),v={QuestionFormat:u,audio_url:h,original_sentence:p,WordOrSentence:x,CorrectAnswer:g,IncorrectAnswer1:w,IncorrectAnswer2:f,IncorrectAnswer3:j,Explanation:_};if(!u||!x||!g)return void n.push({row:o,message:"Missing critical fields",raw:v});if("Listening_Dictation"!==u&&"Listening_MultipleChoice"!==u){const e=function(e){const s=e.replace(/[^a-z]/gi,"").toLowerCase();return["listeningdictation","dictation","listening_shortanswer"].includes(s)?"Listening_Dictation":["listeningmultiplechoice","listeningmcq","comprehension"].includes(s)?"Listening_MultipleChoice":null}(u);if(!e)return void n.push({row:o,message:`Unrecognized QuestionFormat: ${u}`,raw:v});u=e,t.push({row:o,message:`Corrected QuestionFormat to ${e}`})}const y=x,C=g,k=[w,f,j].filter(Boolean);let I;if(h){const e=h.split("/").pop()||h;I=`${r}/${e}`}i.push({skill_type:s,skill_test_id:r,question_format:u,content:y,correct_answer:C,incorrect_answers:k,explanation:_||void 0,original_sentence:p||null,audio_url:I})});return{ok:i.length>0,skill_type:s,skill_test_id:r,insert:i,warnings:t,errors:n,summary:{rows_received:p.length,rows_valid:i.length,rows_with_warnings:new Set(t.map(e=>e.row)).size,rows_with_errors:n.length}}}function k({skillTestId:d,onImported:u}){const[m,h]=e.useState(null),[p,x]=e.useState([]),[g,w]=e.useState(null),[f,j]=e.useState(!1),_=e.useRef(null);return s.jsxs(r,{children:[s.jsx(t,{children:s.jsx(n,{className:"text-base",children:"Upload Listening CSV"})}),s.jsxs(i,{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{ref:_,type:"file",accept:".csv",className:"hidden",onChange:e=>{var s;const r=null==(s=e.target.files)?void 0:s[0];r&&(async s=>{var r;try{h(null),x([]),w(null);const e=C(await s.text(),"Listening for Details",d);if(w(e),0===e.insert.length){const s=(null==(r=e.errors[0])?void 0:r.message)||"No valid rows found in CSV";return void h(s)}e.errors.length>0&&c.warning(`${e.errors.length} row(s) have errors and will be skipped`),e.warnings.length>0&&c.message(`${e.warnings.length} warning(s) during normalization`),x(e.insert)}catch(e){h(e.message||"Failed to parse CSV")}})(r)}}),s.jsx(a,{onClick:()=>{var e;return null==(e=_.current)?void 0:e.click()},children:"Choose CSV"}),s.jsx(a,{variant:"secondary",onClick:()=>{const e=['Listening_Dictation,"listening_dict_1.mp3","We should submit the report by Friday.","Listen and type exactly what you hear.","We should submit the report by Friday.","We should submit the report by Friday","we should submit the report by friday","","The speaker said: "We should submit the report by Friday.""','Listening_MultipleChoice,"comprehension_q5.mp3","The meeting was postponed due to weather.","Why was the meeting postponed?","Because of weather","Because the presenter was late","Because of a scheduling conflict","Because the venue was closed","The audio mentions the meeting was postponed due to weather."'].join("\n"),s=new Blob(["QuestionFormat,audio_url,original_sentence,WordOrSentence,CorrectAnswer,IncorrectAnswer1,IncorrectAnswer2,IncorrectAnswer3,Explanation\n"+e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download="listening-for-details-template.csv",t.click(),URL.revokeObjectURL(r)},children:"Download Template"})]}),m&&s.jsx(o,{variant:"destructive",children:s.jsx(l,{children:m})}),p.length>0&&s.jsxs("div",{className:"space-y-2",children:[g&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Parsed: ",p.length," valid row(s)",g.warnings.length>0&&` â€¢ ${g.warnings.length} warning(s)`,g.errors.length>0&&` â€¢ ${g.errors.length} error row(s) skipped`]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(a,{onClick:async()=>{if(g&&0!==g.insert.length){j(!0);try{const{error:e}=await v.from("skill_practice_questions").insert(g.insert);if(e)throw e;c.success(`Imported ${g.insert.length} questions`),x([]),w(null),null==u||u()}catch(e){console.error(e),c.error(e.message||"Import failed")}finally{j(!1)}}},disabled:f,children:f?"Importing...":"Import"}),s.jsx(a,{variant:"secondary",onClick:()=>{x([]),w(null)},children:"Cancel"})]}),s.jsxs("div",{className:"max-h-60 overflow-auto rounded border p-2 text-xs",children:[p.slice(0,10).map((e,r)=>s.jsxs("div",{className:"py-1 border-b last:border-b-0",children:[s.jsx("div",{className:"font-medium",children:e.question_format}),s.jsxs("div",{className:"text-muted-foreground",children:[s.jsx("span",{className:"font-medium",children:"Audio:"})," ",e.audio_url||"â€”"]}),e.original_sentence&&s.jsxs("div",{className:"text-muted-foreground whitespace-pre-wrap break-words",children:[s.jsx("span",{className:"font-medium",children:"Transcript:"})," ",e.original_sentence]}),s.jsx("div",{className:"text-muted-foreground",children:e.content})]},r)),p.length>10&&s.jsxs("div",{className:"text-muted-foreground",children:["...and ",p.length-10," more"]})]})]})]})]})}function I(e){const s=[...e];for(let r=s.length-1;r>0;r--){const e=Math.floor(Math.random()*(r+1));[s[r],s[e]]=[s[e],s[r]]}return s}function S(e){if(!e)return"";let s=e.trim();return s=s.replace(/^[-â€¢]\s*/,""),s=s.replace(/\*\*(.*?)\*\*/g,"$1"),s=s.replace(/\*(.*?)\*/g,"$1"),s=s.replace(/_(.*?)_/g,"$1"),s=s.replace(/`(.*?)`/g,"$1"),s}const q=t=>{const{skillTestId:n,selectedQuestionId:o,limit:l=6}=t,c=t.questions,[m,h]=e.useState([]),[p,x]=e.useState(0),[g,w]=e.useState(null),[f,j]=e.useState(""),[_,y]=e.useState(0),[N,b]=e.useState(!1);e.useEffect(()=>{(async()=>{if(c&&c.length)return h(c),x(0),w(null),j(""),y(0),void b(!1);if(!n)return;const{data:e,error:s}=await v.from("skill_practice_questions").select("id,content,question_format,correct_answer,incorrect_answers,explanation,original_sentence,audio_url").eq("skill_test_id",n);if(!s){const s=I(e??[]).slice(0,l);h(s),x(0),w(null),j(""),y(0),b(!1)}})()},[c,n,l]),e.useEffect(()=>{if(!o||!m.length)return;const e=m.findIndex(e=>e.id===o);e>=0&&(x(e),w(null),j(""),b(!1))},[o,m]);const C=m[p],k=e.useMemo(()=>C?I([C.correct_answer,...C.incorrect_answers||[]]):[],[C]),q=m.length?p/m.length*100:0;return n||c&&c.length?s.jsxs("div",{className:"space-y-4",children:[s.jsx(d,{value:q}),N?s.jsx(r,{children:s.jsxs(i,{className:"p-6 text-center space-y-3",children:[s.jsx("div",{className:"text-lg font-semibold",children:"Preview complete"}),s.jsxs("div",{className:"text-muted-foreground",children:["Score: ",_," / ",m.length]}),s.jsx(a,{onClick:()=>{x(0),y(0),w(null),j(""),b(!1)},children:"Restart preview"})]})}):C?s.jsx(r,{className:"border-light-border",children:s.jsxs(i,{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"text-xs text-muted-foreground",children:["Question ",p+1," of ",m.length]}),C.audio_url&&s.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm font-medium mb-2",children:"Audio"}),s.jsxs("audio",{controls:!0,className:"w-full",children:[s.jsx("source",{src:C.audio_url.startsWith("http")?C.audio_url:`https://your-bucket.your-domain.com/${C.audio_url}`}),"Your browser does not support the audio element."]})]}),C.original_sentence&&s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 rounded-lg p-3 text-sm",children:[s.jsx("div",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Transcript (admin view)"}),s.jsx("div",{className:"text-blue-700 dark:text-blue-300",children:C.original_sentence})]}),"Listening_Dictation"===C.question_format?s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-medium mb-4",children:C.content}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(u,{value:f,onChange:e=>j(e.target.value),placeholder:"Type what you hear...",disabled:!!g}),!g&&s.jsx(a,{onClick:()=>{g||(w(f),C&&f.toLowerCase().trim()===C.correct_answer.toLowerCase().trim()&&y(e=>e+1))},disabled:!f.trim(),children:"Submit"})]})]}):s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-medium mb-4",children:C.content}),s.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:k.map(e=>{const r=g&&e===C.correct_answer,t=g===e&&e!==C.correct_answer;return s.jsx(a,{variant:r?"success":t?"destructive":"outline",className:"justify-start h-auto py-3",onClick:()=>(e=>{g||(w(e),C&&e===C.correct_answer&&y(e=>e+1))})(e),children:e},e)})})]}),g&&s.jsxs("div",{className:"pt-2 space-y-3",children:[s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("div",{className:"text-sm font-medium",children:"Result"}),s.jsx("div",{className:"text-sm",children:"Listening_Dictation"===C.question_format?s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:["Your answer: ",s.jsx("span",{className:"font-mono",children:g})]}),s.jsxs("div",{children:["Correct answer: ",s.jsx("span",{className:"font-mono",children:C.correct_answer})]}),s.jsx("div",{className:"font-medium "+(g.toLowerCase().trim()===C.correct_answer.toLowerCase().trim()?"text-green-600":"text-red-600"),children:g.toLowerCase().trim()===C.correct_answer.toLowerCase().trim()?"âœ“ Correct":"âœ— Incorrect"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:["Correct answer: ",s.jsx("span",{className:"font-medium",children:C.correct_answer})]}),s.jsx("div",{className:"font-medium "+(g===C.correct_answer?"text-green-600":"text-red-600"),children:g===C.correct_answer?"âœ“ Correct":"âœ— Incorrect"})]})})]}),C.explanation&&s.jsxs("div",{className:"rounded-md border p-3",children:[s.jsx("div",{className:"text-sm font-medium",children:"Explanation"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:S(C.explanation)})]}),s.jsx(a,{onClick:()=>{p+1>=m.length?b(!0):(x(e=>e+1),w(null),j(""))},children:"Continue"})]})]})}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"No questions yet. Use the CSV import above."})]}):null},$=()=>{const{id:o}=m(),[l,c]=e.useState(null),[d,y]=e.useState([]),[N,b]=e.useState(null),[C,I]=e.useState(null),S=e.useRef(null),[$,A]=e.useState({content:"",question_format:"",correct_answer:"",incorrect1:"",incorrect2:"",incorrect3:"",explanation:"",original_sentence:"",audio_url:""}),[L,F]=e.useState([]),[E,O]=e.useState(!1),[T,M]=e.useState(null),z=async()=>{if(!o)return;const{data:e}=await v.from("skill_tests").select("id,title").eq("id",o).maybeSingle();c(e??null);const{data:s}=await v.from("skill_practice_questions").select("id,content,question_format,correct_answer,incorrect_answers,explanation,original_sentence,audio_url").eq("skill_test_id",o).order("created_at",{ascending:!1});y(s??[]),F([])};e.useEffect(()=>{z()},[o]);return s.jsx(h,{title:l?`Manage: ${l.title}`:"Manage Listening Test",showBackButton:!0,children:s.jsxs("section",{className:"space-y-6",children:[o&&s.jsx(k,{skillTestId:o,onImported:z}),s.jsx(p,{}),s.jsx("div",{ref:S,children:s.jsxs(r,{children:[s.jsx(t,{children:s.jsx(n,{className:"text-base",children:"Student Preview"})}),s.jsx(i,{children:s.jsx(q,{questions:d,selectedQuestionId:C||void 0})})]})}),s.jsx(p,{}),s.jsxs(r,{children:[s.jsx(t,{children:s.jsx(n,{className:"text-base",children:"Manage Audio Files"})}),s.jsxs(i,{className:"space-y-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(u,{type:"file",accept:"audio/mpeg,audio/mp3,audio/wav,audio/webm",onChange:e=>{var s;return M((null==(s=e.target.files)?void 0:s[0])||null)}}),s.jsx(a,{onClick:async()=>{var e;if(T&&o){O(!0);try{const s=(null==(e=T.name.split(".").pop())?void 0:e.toLowerCase())||"mp3",r=T.name.replace(/\.[^/.]+$/,"").normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase(),t=`${Date.now()}-${r}.${s}`,n=`admin/listening/${o}/${t}`;console.log("ðŸ“¤ Uploading listening audio to R2:",{originalName:T.name,fileName:t,size:T.size,type:T.type});const i=new FormData;i.append("file",T),i.append("path",n),i.append("contentType",T.type||"audio/mpeg"),i.append("cacheControl","public, max-age=31536000");const{data:{session:a}}=await v.auth.getSession(),l="https://cuumxmfzhwljylbdlflj.supabase.co/functions/v1/r2-upload",c=await fetch(l,{method:"POST",headers:{Authorization:(null==a?void 0:a.access_token)?`Bearer ${a.access_token}`:""},body:i});if(!c.ok){const e=await c.text();throw console.error("âŒ R2 upload error:",c.status,e),new Error(`Upload failed ${c.status}: ${e}`)}const d=await c.json();if(!d||!d.success)throw new Error((null==d?void 0:d.error)||"Upload failed");console.log("âœ… Listening audio uploaded successfully:",d.url),F([...L,{name:t,url:d.url}]),await z()}catch(s){console.error("âŒ Upload error:",s),alert(`Upload failed: ${s.message}`)}finally{O(!1),M(null)}}},disabled:!T||E,children:E?"Uploading...":"Upload Audio"})]}),s.jsxs("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:[L.map(e=>s.jsxs("div",{className:"border rounded-md p-2 text-sm",children:[s.jsx("div",{className:"font-medium break-words",children:e.name}),s.jsx("audio",{controls:!0,className:"w-full mt-1",children:s.jsx("source",{src:e.url})}),s.jsx("div",{className:"flex gap-2 mt-2",children:s.jsx(a,{size:"sm",variant:"destructive",onClick:()=>(async e=>{if(o)try{console.log("ðŸ—‘ï¸ Deleting listening audio from R2:",{fileName:e});const s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN1dW14bWZ6aHdsanlsYmRsZmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1MTkxMjEsImV4cCI6MjA2OTA5NTEyMX0.8jqO_ciOttSxSLZnKY0i5oJmEn79ROF53TjUMYhNemI",r="https://cuumxmfzhwljylbdlflj.supabase.co/functions/v1/r2-delete",t=`admin/listening/${o}/${e}`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",apikey:s,Authorization:`Bearer ${s}`},body:JSON.stringify({path:t})});if(!n.ok){const e=await n.text();throw console.error("âŒ R2 delete error:",n.status,e),new Error(`Delete failed ${n.status}: ${e}`)}console.log("âœ… Listening audio deleted successfully"),F(L.filter(s=>s.name!==e)),await z()}catch(s){console.error("âŒ Delete error:",s),alert(`Delete failed: ${s.message}`)}})(e.name),children:"Delete"})})]},e.name)),0===L.length&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"No audio yet. Upload MP3s before importing CSV."})]})]})]}),s.jsx(p,{}),s.jsxs(r,{children:[s.jsx(t,{children:s.jsx(n,{className:"text-base",children:"Question Library"})}),s.jsx(i,{className:"space-y-3",children:0===d.length?s.jsx("p",{className:"text-sm text-muted-foreground",children:"No questions yet. Upload a CSV to add questions."}):d.map(e=>s.jsx("div",{className:"p-3 border rounded-md space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"text-xs text-muted-foreground",children:e.question_format}),e.original_sentence&&s.jsxs("div",{className:"text-sm text-muted-foreground whitespace-pre-wrap break-words",children:[s.jsx("span",{className:"font-medium",children:"Transcript:"})," ",e.original_sentence]}),e.audio_url&&s.jsx("audio",{controls:!0,className:"w-full my-2",children:s.jsx("source",{src:e.audio_url.startsWith("http")?e.audio_url:`https://your-bucket.your-domain.com/${e.audio_url}`})}),s.jsx("div",{className:"whitespace-pre-wrap break-words",children:e.content})]}),s.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.jsx(a,{size:"sm",variant:"secondary",onClick:()=>{var s;I(e.id),null==(s=S.current)||s.scrollIntoView({behavior:"smooth"})},children:"Preview"}),s.jsx(a,{size:"sm",onClick:()=>(e=>{var s,r,t;b(e),A({content:e.content||"",question_format:e.question_format||"",correct_answer:e.correct_answer||"",incorrect1:(null==(s=e.incorrect_answers)?void 0:s[0])||"",incorrect2:(null==(r=e.incorrect_answers)?void 0:r[1])||"",incorrect3:(null==(t=e.incorrect_answers)?void 0:t[2])||"",explanation:e.explanation||"",original_sentence:e.original_sentence||"",audio_url:e.audio_url||""})})(e),children:"Edit"}),s.jsx(a,{size:"sm",variant:"destructive",onClick:()=>(async e=>{confirm("Delete this question?")&&(await v.from("skill_practice_questions").delete().eq("id",e),await z())})(e.id),children:"Delete"})]})]})},e.id))})]}),s.jsx(x,{open:!!N,onOpenChange:e=>{e||b(null)},children:s.jsxs(g,{className:"sm:max-w-lg",children:[s.jsx(w,{children:s.jsx(f,{children:"Edit Question"})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx(j,{htmlFor:"question_format",children:"Format"}),s.jsx(u,{id:"question_format",value:$.question_format,onChange:e=>A({...$,question_format:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"original_sentence",children:"Transcript (optional)"}),s.jsx(_,{id:"original_sentence",value:$.original_sentence,onChange:e=>A({...$,original_sentence:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"content",children:"Instruction / Question"}),s.jsx(_,{id:"content",value:$.content,onChange:e=>A({...$,content:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"audio_url",children:"Audio file (path in bucket)"}),s.jsx(u,{id:"audio_url",value:$.audio_url,onChange:e=>A({...$,audio_url:e.target.value}),placeholder:`${o}/file.mp3`})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"correct_answer",children:"Correct Answer"}),s.jsx(u,{id:"correct_answer",value:$.correct_answer,onChange:e=>A({...$,correct_answer:e.target.value})})]}),s.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx(j,{children:"Incorrect 1"}),s.jsx(u,{value:$.incorrect1,onChange:e=>A({...$,incorrect1:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{children:"Incorrect 2"}),s.jsx(u,{value:$.incorrect2,onChange:e=>A({...$,incorrect2:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{children:"Incorrect 3"}),s.jsx(u,{value:$.incorrect3,onChange:e=>A({...$,incorrect3:e.target.value})})]})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"explanation",children:"Explanation"}),s.jsx(_,{id:"explanation",value:$.explanation,onChange:e=>A({...$,explanation:e.target.value})})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(a,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),s.jsx(a,{onClick:async()=>{if(!N)return;const e=[$.incorrect1,$.incorrect2,$.incorrect3].filter(Boolean),{error:s}=await v.from("skill_practice_questions").update({content:$.content,question_format:$.question_format,correct_answer:$.correct_answer,incorrect_answers:e,explanation:$.explanation,original_sentence:$.original_sentence||null,audio_url:$.audio_url}).eq("id",N.id);s||(b(null),await z())},children:"Save"})]})]})})]})})};export{$ as default};
