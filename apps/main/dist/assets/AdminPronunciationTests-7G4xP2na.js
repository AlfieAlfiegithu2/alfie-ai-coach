import{r as e,u as t,j as s}from"./vendor-react-rLLBBC7n.js";import{A as a}from"./AdminLayout-DwaN-V0p.js";import{d as i,C as r,b as n,c as o,a as d,I as c,B as l,s as m}from"./index-BDl0jLJK.js";import{S as u}from"./separator-C0bogF69.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-ui-BGi_EvHx.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";const p=()=>{const[p,j]=e.useState([]),[h,v]=e.useState(""),[x,g]=e.useState(!1),f=t(),{toast:b}=i(),y=async()=>{const{data:e,error:t}=await m.from("pronunciation_tests").select("id,title,created_at").order("created_at",{ascending:!1});if(t)return console.error(t),void b({title:"Failed to load tests",description:t.message,variant:"destructive"});j(e??[])};e.useEffect(()=>{document.title="Pronunciation Tests | Admin",y()},[]);return s.jsx(a,{title:"Pronunciation: Repeat After Me",showBackButton:!0,children:s.jsxs("section",{className:"space-y-4",children:[s.jsxs(r,{children:[s.jsx(n,{children:s.jsx(o,{className:"text-base",children:"+ Create Pronunciation Test"})}),s.jsxs(d,{className:"flex gap-2 items-center",children:[s.jsx(c,{placeholder:"Test title (e.g., Set 1)",value:h,onChange:e=>v(e.target.value)}),s.jsx(l,{onClick:async()=>{var e;if(!h.trim())return;g(!0);const{data:t}=await m.auth.getUser(),s=null==(e=null==t?void 0:t.user)?void 0:e.id,{data:a,error:i}=await m.from("pronunciation_tests").insert({title:h.trim(),created_by:s,is_published:!0}).select("id").maybeSingle();g(!1),i?b({title:"Failed to create test",description:i.message,variant:"destructive"}):(v(""),await y(),(null==a?void 0:a.id)&&f(`/admin/skills/pronunciation-repeat-after-me/${a.id}`))},disabled:x,children:x?"Adding...":"Add"})]})]}),s.jsx(u,{}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[p.map(e=>s.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[s.jsx(n,{className:"pb-2",children:s.jsx(o,{className:"text-sm",children:e.title})}),s.jsx(d,{children:s.jsx(l,{size:"sm",variant:"secondary",onClick:()=>f(`/admin/skills/pronunciation-repeat-after-me/${e.id}`),children:"Manage Test"})})]},e.id)),0===p.length&&s.jsx("p",{className:"text-sm text-muted-foreground",children:"No tests yet. Create your first one above."})]})]})})};export{p as default};
