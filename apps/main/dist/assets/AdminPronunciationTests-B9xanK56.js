import{r as e,u as s,h as t,j as a,A as i,C as r,b as n,c as d,a as l,I as o,B as c,_ as m}from"./index-DO59ztb3.js";import{s as u}from"./supabase-rhP1-bIs.js";const h=()=>{const[h,x]=e.useState([]),[p,g]=e.useState(""),[j,f]=e.useState(!1),v=s(),{toast:b}=t(),N=async()=>{const{data:e,error:s}=await u.from("pronunciation_tests").select("id,title,created_at").order("created_at",{ascending:!1});if(s)return console.error(s),void b({title:"Failed to load tests",description:s.message,variant:"destructive"});x(e??[])};e.useEffect(()=>{document.title="Pronunciation Tests | Admin",N()},[]);return a.jsx(i,{title:"Pronunciation: Repeat After Me",showBackButton:!0,children:a.jsxs("section",{className:"space-y-4",children:[a.jsxs(r,{children:[a.jsx(n,{children:a.jsx(d,{className:"text-base",children:"+ Create Pronunciation Test"})}),a.jsxs(l,{className:"flex gap-2 items-center",children:[a.jsx(o,{placeholder:"Test title (e.g., Set 1)",value:p,onChange:e=>g(e.target.value)}),a.jsx(c,{onClick:async()=>{var e;if(!p.trim())return;f(!0);const{data:s}=await u.auth.getUser(),t=null==(e=null==s?void 0:s.user)?void 0:e.id,{data:a,error:i}=await u.from("pronunciation_tests").insert({title:p.trim(),created_by:t,is_published:!0}).select("id").maybeSingle();f(!1),i?b({title:"Failed to create test",description:i.message,variant:"destructive"}):(g(""),await N(),(null==a?void 0:a.id)&&v(`/admin/skills/pronunciation-repeat-after-me/${a.id}`))},disabled:j,children:j?"Adding...":"Add"})]})]}),a.jsx(m,{}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[h.map(e=>a.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(n,{className:"pb-2",children:a.jsx(d,{className:"text-sm",children:e.title})}),a.jsx(l,{children:a.jsx(c,{size:"sm",variant:"secondary",onClick:()=>v(`/admin/skills/pronunciation-repeat-after-me/${e.id}`),children:"Manage Test"})})]},e.id)),0===h.length&&a.jsx("p",{className:"text-sm text-muted-foreground",children:"No tests yet. Create your first one above."})]})]})})};export{h as default};
