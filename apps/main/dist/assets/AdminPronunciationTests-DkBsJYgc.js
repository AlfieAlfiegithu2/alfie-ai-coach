import{r as e,u as s,g as t,j as a,C as i,b as r,c as n,a as o,I as d,B as l}from"./index-Dn1FbCoL.js";import{A as c}from"./AdminLayout-D0SmDFg3.js";import{S as m}from"./separator-D4FeQnFx.js";import{s as u}from"./supabase-DUkWVuqu.js";const p=()=>{const[p,x]=e.useState([]),[h,j]=e.useState(""),[g,f]=e.useState(!1),v=s(),{toast:b}=t(),y=async()=>{const{data:e,error:s}=await u.from("pronunciation_tests").select("id,title,created_at").order("created_at",{ascending:!1});if(s)return console.error(s),void b({title:"Failed to load tests",description:s.message,variant:"destructive"});x(e??[])};e.useEffect(()=>{document.title="Pronunciation Tests | Admin",y()},[]);return a.jsx(c,{title:"Pronunciation: Repeat After Me",showBackButton:!0,children:a.jsxs("section",{className:"space-y-4",children:[a.jsxs(i,{children:[a.jsx(r,{children:a.jsx(n,{className:"text-base",children:"+ Create Pronunciation Test"})}),a.jsxs(o,{className:"flex gap-2 items-center",children:[a.jsx(d,{placeholder:"Test title (e.g., Set 1)",value:h,onChange:e=>j(e.target.value)}),a.jsx(l,{onClick:async()=>{var e;if(!h.trim())return;f(!0);const{data:s}=await u.auth.getUser(),t=null==(e=null==s?void 0:s.user)?void 0:e.id,{data:a,error:i}=await u.from("pronunciation_tests").insert({title:h.trim(),created_by:t,is_published:!0}).select("id").maybeSingle();f(!1),i?b({title:"Failed to create test",description:i.message,variant:"destructive"}):(j(""),await y(),(null==a?void 0:a.id)&&v(`/admin/skills/pronunciation-repeat-after-me/${a.id}`))},disabled:g,children:g?"Adding...":"Add"})]})]}),a.jsx(m,{}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[p.map(e=>a.jsxs(i,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(r,{className:"pb-2",children:a.jsx(n,{className:"text-sm",children:e.title})}),a.jsx(o,{children:a.jsx(l,{size:"sm",variant:"secondary",onClick:()=>v(`/admin/skills/pronunciation-repeat-after-me/${e.id}`),children:"Manage Test"})})]},e.id)),0===p.length&&a.jsx("p",{className:"text-sm text-muted-foreground",children:"No tests yet. Create your first one above."})]})]})})};export{p as default};
