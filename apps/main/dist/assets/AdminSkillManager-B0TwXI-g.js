import{G as e,u as s,h as t,r as a,j as i,B as l,C as r,b as n,d as o,a as c,T as d}from"./index-cMzFjQ8t.js";import{A as u}from"./AdminLayout-BeDwyTOk.js";import{S as m}from"./separator-N5tDzH9f.js";import{g as x}from"./skills-NqzSOyzV.js";import{s as p}from"./supabase-DWL4C3fA.js";const h=p,j=()=>{const{slug:p}=e(),j=s(),{toast:v}=t(),f=a.useMemo(()=>p?x(p):void 0,[p]),[k,g]=a.useState(""),[y,N]=a.useState(!1),[w,b]=a.useState([]),[C,_]=a.useState(null),[S,q]=a.useState("");a.useEffect(()=>{f&&(document.title=`Manage: ${f.label} | Admin`,B())},[null==f?void 0:f.label]);const B=async()=>{if(!f)return;const{data:e,error:s}=await h.from("skill_practice_questions").select("id, content, skill_type, created_at").eq("skill_type",f.label).order("created_at",{ascending:!1});if(s)return console.error(s),void v({title:"Failed to load questions",variant:"destructive"});b(e||[])},Q=async()=>{if(!C||!S.trim())return;const{error:e}=await h.from("skill_practice_questions").update({content:S.trim()}).eq("id",C);if(e)return console.error(e),void v({title:"Update failed",description:e.message,variant:"destructive"});_(null),q(""),v({title:"Question updated"}),await B()};return f?i.jsx(u,{title:`Manage: ${f.label}`,showBackButton:!0,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs(r,{children:[i.jsx(n,{children:i.jsx(o,{className:"text-base",children:"Add New Question"})}),i.jsxs(c,{className:"space-y-3",children:[i.jsx(d,{value:k,onChange:e=>g(e.target.value),placeholder:"Question Content",rows:4}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{onClick:async()=>{if(!f||!k.trim())return;N(!0);const{error:e}=await h.from("skill_practice_questions").insert({skill_type:f.label,content:k.trim()});if(N(!1),e)return console.error(e),void v({title:"Unable to save question",description:e.message,variant:"destructive"});g(""),v({title:"Question added"}),await B()},disabled:y,children:y?"Saving...":"Save"}),i.jsx(l,{variant:"secondary",onClick:()=>g(""),children:"Clear"})]})]})]}),i.jsx(m,{}),i.jsxs("section",{className:"space-y-3",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Question Library"}),0===w.length?i.jsx("p",{className:"text-muted-foreground text-sm",children:"No questions yet. Add your first one above."}):i.jsx("div",{className:"space-y-3",children:w.map(e=>i.jsx(r,{children:i.jsx(c,{className:"pt-4",children:C===e.id?i.jsxs("div",{className:"space-y-3",children:[i.jsx(d,{value:S,onChange:e=>q(e.target.value),rows:4}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(l,{size:"sm",onClick:Q,children:"Save"}),i.jsx(l,{size:"sm",variant:"secondary",onClick:()=>_(null),children:"Cancel"})]})]}):i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsx("p",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:e.content}),i.jsxs("div",{className:"shrink-0 flex gap-2",children:[i.jsx(l,{size:"sm",variant:"outline",onClick:()=>(e=>{_(e.id),q(e.content)})(e),children:"Edit"}),i.jsx(l,{size:"sm",variant:"destructive",onClick:()=>(async e=>{const{error:s}=await h.from("skill_practice_questions").delete().eq("id",e);if(s)return console.error(s),void v({title:"Delete failed",description:s.message,variant:"destructive"});v({title:"Question deleted"}),await B()})(e.id),children:"Delete"})]})]})})},e.id))})]})]})}):i.jsx(u,{title:"Skill not found",showBackButton:!0,children:i.jsx(l,{onClick:()=>j("/admin/skills"),children:"Back to Skills"})})};export{j as default};
