import{c as e,u as s,r as t,j as i}from"./vendor-react-rLLBBC7n.js";import{A as a}from"./AdminLayout-DGXoIbe0.js";import{d as r,B as n,C as l,b as o,c,a as d,T as m,s as u}from"./index-KxDfHqNJ.js";import{S as p}from"./separator-DByOkGf1.js";import{g as j}from"./skills-NqzSOyzV.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-ui-BGi_EvHx.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";const v=u,x=()=>{const{slug:u}=e(),x=s(),{toast:h}=r(),f=t.useMemo(()=>u?j(u):void 0,[u]),[k,g]=t.useState(""),[y,b]=t.useState(!1),[N,w]=t.useState([]),[C,_]=t.useState(null),[S,q]=t.useState("");t.useEffect(()=>{f&&(document.title=`Manage: ${f.label} | Admin`,B())},[null==f?void 0:f.label]);const B=async()=>{if(!f)return;const{data:e,error:s}=await v.from("skill_practice_questions").select("id, content, skill_type, created_at").eq("skill_type",f.label).order("created_at",{ascending:!1});if(s)return console.error(s),void h({title:"Failed to load questions",variant:"destructive"});w(e||[])},Q=async()=>{if(!C||!S.trim())return;const{error:e}=await v.from("skill_practice_questions").update({content:S.trim()}).eq("id",C);if(e)return console.error(e),void h({title:"Update failed",description:e.message,variant:"destructive"});_(null),q(""),h({title:"Question updated"}),await B()};return f?i.jsx(a,{title:`Manage: ${f.label}`,showBackButton:!0,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs(l,{children:[i.jsx(o,{children:i.jsx(c,{className:"text-base",children:"Add New Question"})}),i.jsxs(d,{className:"space-y-3",children:[i.jsx(m,{value:k,onChange:e=>g(e.target.value),placeholder:"Question Content",rows:4}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(n,{onClick:async()=>{if(!f||!k.trim())return;b(!0);const{error:e}=await v.from("skill_practice_questions").insert({skill_type:f.label,content:k.trim()});if(b(!1),e)return console.error(e),void h({title:"Unable to save question",description:e.message,variant:"destructive"});g(""),h({title:"Question added"}),await B()},disabled:y,children:y?"Saving...":"Save"}),i.jsx(n,{variant:"secondary",onClick:()=>g(""),children:"Clear"})]})]})]}),i.jsx(p,{}),i.jsxs("section",{className:"space-y-3",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Question Library"}),0===N.length?i.jsx("p",{className:"text-muted-foreground text-sm",children:"No questions yet. Add your first one above."}):i.jsx("div",{className:"space-y-3",children:N.map(e=>i.jsx(l,{children:i.jsx(d,{className:"pt-4",children:C===e.id?i.jsxs("div",{className:"space-y-3",children:[i.jsx(m,{value:S,onChange:e=>q(e.target.value),rows:4}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(n,{size:"sm",onClick:Q,children:"Save"}),i.jsx(n,{size:"sm",variant:"secondary",onClick:()=>_(null),children:"Cancel"})]})]}):i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsx("p",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:e.content}),i.jsxs("div",{className:"shrink-0 flex gap-2",children:[i.jsx(n,{size:"sm",variant:"outline",onClick:()=>(e=>{_(e.id),q(e.content)})(e),children:"Edit"}),i.jsx(n,{size:"sm",variant:"destructive",onClick:()=>(async e=>{const{error:s}=await v.from("skill_practice_questions").delete().eq("id",e);if(s)return console.error(s),void h({title:"Delete failed",description:s.message,variant:"destructive"});h({title:"Question deleted"}),await B()})(e.id),children:"Delete"})]})]})})},e.id))})]})]})}):i.jsx(a,{title:"Skill not found",showBackButton:!0,children:i.jsx(n,{onClick:()=>x("/admin/skills"),children:"Back to Skills"})})};export{x as default};
