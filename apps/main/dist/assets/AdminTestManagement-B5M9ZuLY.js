import{u as e,ak as s,v as t,f as a,r,J as n,j as i,D as l,t as c,B as o,P as d,l as m,m as x,n as h,aj as p,a8 as u,I as g,S as j,o as f,p as N,q as y,s as v,k as T,C as b,b as w,c as C,al as k,x as E,a as P,$ as A,d as L}from"./index-BmiLTbvw.js";import{A as S}from"./AdminLayout-KodGO2y3.js";import{s as $}from"./supabase-Bqkrifq5.js";import{U as F}from"./users-CYMKMu2V.js";const M=()=>{const M=e(),{testType:U}=s(),{admin:_,loading:G}=t(),{createContent:B,listContent:I}=a(),[O,q]=r.useState([]),[D,J]=r.useState(!1),[V,Y]=r.useState(""),[z,H]=r.useState("");r.useEffect(()=>{G||_||M("/admin/login")},[_,G,M]),r.useEffect(()=>{K()},[U]);const K=async()=>{try{console.log("Loading tests for type:",U);const{data:e,error:s}=await $.from("tests").select("*").eq("test_type",U).order("created_at",{ascending:!1});if(s)throw console.error("Error loading tests:",s),s;console.log("Found tests:",(null==e?void 0:e.length)||0),q(e||[])}catch(e){console.error("Error loading tests:",e),n.error("Failed to load tests")}};if(G)return i.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),i.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading Test Management..."})]})});if(!_)return null;const Q=(()=>{switch(U){case"ielts":return{title:"IELTS Mock Tests",description:"IELTS Academic and General Training Tests",color:"from-blue-500 to-purple-600"};case"pte":return{title:"PTE Mock Tests",description:"PTE Academic Test Preparation",color:"from-green-500 to-blue-600"};case"toefl":return{title:"TOEFL Mock Tests",description:"TOEFL iBT Test Preparation",color:"from-orange-500 to-red-600"};case"general":return{title:"General English Tests",description:"English Proficiency Development",color:"from-purple-500 to-pink-600"};default:return{title:"Mock Tests",description:"Test Preparation",color:"from-blue-500 to-purple-600"}}})();return i.jsx(S,{title:Q.title,showBackButton:!0,backPath:`/admin/${U}`,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:`text-3xl font-bold tracking-tight bg-gradient-to-r ${Q.color} bg-clip-text text-transparent`,children:Q.title}),i.jsx("p",{className:"text-muted-foreground mt-1",children:Q.description})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs(l,{open:D,onOpenChange:J,children:[i.jsx(c,{asChild:!0,children:i.jsxs(o,{className:"bg-primary hover:bg-primary/90",children:[i.jsx(d,{className:"w-4 h-4 mr-2"}),"Add New Test"]})}),i.jsxs(m,{children:[i.jsxs(x,{children:[i.jsxs(h,{children:["Create New ",null==U?void 0:U.toUpperCase()," Test"]}),i.jsx(p,{children:"Enter a name for the new test. You can manage its content after creation."})]}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(u,{htmlFor:"testName",children:"Test Name"}),i.jsx(g,{id:"testName",value:V,onChange:e=>Y(e.target.value),placeholder:`e.g., ${null==U?void 0:U.toUpperCase()} Practice Test 1`})]}),"writing"===U&&i.jsxs("div",{className:"space-y-2",children:[i.jsx(u,{htmlFor:"trainingType",children:"Training Type"}),i.jsxs(j,{value:z,onValueChange:e=>H(e),children:[i.jsx(f,{children:i.jsx(N,{placeholder:"Select training type"})}),i.jsxs(y,{children:[i.jsx(v,{value:"Academic",children:"Academic Training"}),i.jsx(v,{value:"General",children:"General Training"})]})]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose the IELTS training type for this writing test"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(o,{onClick:async()=>{if(V.trim())if("writing"!==U||z){J(!0);try{console.log("Creating test:",{newTestName:V,testType:U,trainingType:z});const e={test_name:V,test_type:U,module:"ielts"===U?"reading":U};"writing"===U&&z&&(e.training_type=z);const s=await B("tests",e);console.log("Test created:",s),n.success("Test created successfully"),J(!1),Y(""),H(""),K()}catch(e){console.error("Error creating test:",e),n.error(`Failed to create test: ${e.message||"Unknown error"}`)}finally{J(!1)}}else n.error("Please select Academic or General training type for writing tests");else n.error("Please enter a test name")},className:"flex-1",children:"Create Test"}),i.jsx(o,{variant:"outline",onClick:()=>J(!1),className:"flex-1",children:"Cancel"})]})]})]})]}),i.jsxs(T,{variant:"secondary",className:"text-sm",children:[null==U?void 0:U.toUpperCase()," Module"]})]})]}),i.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[O.map(e=>{var s,t;return i.jsxs(b,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer border-border/40 bg-card/50 backdrop-blur-sm",onClick:()=>M(`/admin/${U}/test/${e.id}`),children:[i.jsxs(w,{className:"pb-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(C,{className:"text-lg font-semibold text-foreground",children:e.test_name}),i.jsx(k,{className:"w-4 h-4 text-primary"})]}),i.jsx(E,{className:"text-sm text-muted-foreground",children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(F,{className:"w-3 h-3"}),i.jsxs("span",{children:[null==(s=e.module)?void 0:s.charAt(0).toUpperCase(),null==(t=e.module)?void 0:t.slice(1)," Module"]})]})})]}),i.jsxs(P,{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(A,{className:"w-3 h-3"}),i.jsx("span",{children:"2h 45m"})]}),i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx(L,{className:"w-3 h-3"}),i.jsx("span",{children:"4 sections"})]})]}),i.jsx(o,{className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",onClick:s=>{s.stopPropagation(),M(`/admin/${U}/test/${e.id}`)},children:"Manage Test Content"})]})]},e.id)}),0===O.length&&i.jsxs("div",{className:"col-span-full text-center py-12",children:[i.jsx(L,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tests created yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first test to get started"}),i.jsxs(o,{onClick:()=>J(!0),children:[i.jsx(d,{className:"w-4 h-4 mr-2"}),"Create First Test"]})]})]})]})})};export{M as default};
