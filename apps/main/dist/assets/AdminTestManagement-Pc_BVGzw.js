import{u as e,c as s,r as t,j as r}from"./vendor-react-JN_hy__U.js";import{n as a,u as n,s as i,J as l,D as o,m as c,B as d,f as m,g as x,h,W as p,L as u,I as g,S as j,i as f,j as N,k as v,l as y,e as T,C as b,b as w,c as C,o as k,a as E}from"./index-DXpPY1B7.js";import{A as P}from"./AdminLayout-D3lPYw5Y.js";import{av as A,al as L,aZ as S,aA as F,ao as M}from"./vendor-ui-DG51EGkO.js";import"./vendor-react-dom-Cb-iy8Oc.js";import"./vendor-animation-ClPlB6zo.js";import"./vendor-i18n-DlHrixAm.js";import"./vendor-utils-D5HPTFR9.js";import"./vendor-supabase-D7XYLCUu.js";import"./vendor-charts-BpOKEG9Z.js";import"./vendor-date-DT7Rq6D9.js";const $=()=>{const $=e(),{testType:_}=s(),{admin:G,loading:U}=a(),{createContent:B,listContent:I}=n(),[O,D]=t.useState([]),[q,J]=t.useState(!1),[V,W]=t.useState(""),[Y,Z]=t.useState("");t.useEffect(()=>{U||G||$("/admin/login")},[G,U,$]),t.useEffect(()=>{z()},[_]);const z=async()=>{try{console.log("Loading tests for type:",_);const{data:e,error:s}=await i.from("tests").select("*").eq("test_type",_).order("created_at",{ascending:!1});if(s)throw console.error("Error loading tests:",s),s;console.log("Found tests:",(null==e?void 0:e.length)||0),D(e||[])}catch(e){console.error("Error loading tests:",e),l.error("Failed to load tests")}};if(U)return r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading Test Management..."})]})});if(!G)return null;const H=(()=>{switch(_){case"ielts":return{title:"IELTS Mock Tests",description:"IELTS Academic and General Training Tests",color:"from-blue-500 to-purple-600"};case"pte":return{title:"PTE Mock Tests",description:"PTE Academic Test Preparation",color:"from-green-500 to-blue-600"};case"toefl":return{title:"TOEFL Mock Tests",description:"TOEFL iBT Test Preparation",color:"from-orange-500 to-red-600"};case"general":return{title:"General English Tests",description:"English Proficiency Development",color:"from-purple-500 to-pink-600"};default:return{title:"Mock Tests",description:"Test Preparation",color:"from-blue-500 to-purple-600"}}})();return r.jsx(P,{title:H.title,showBackButton:!0,backPath:`/admin/${_}`,children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:`text-3xl font-bold tracking-tight bg-gradient-to-r ${H.color} bg-clip-text text-transparent`,children:H.title}),r.jsx("p",{className:"text-muted-foreground mt-1",children:H.description})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(o,{open:q,onOpenChange:J,children:[r.jsx(c,{asChild:!0,children:r.jsxs(d,{className:"bg-primary hover:bg-primary/90",children:[r.jsx(A,{className:"w-4 h-4 mr-2"}),"Add New Test"]})}),r.jsxs(m,{children:[r.jsxs(x,{children:[r.jsxs(h,{children:["Create New ",null==_?void 0:_.toUpperCase()," Test"]}),r.jsx(p,{children:"Enter a name for the new test. You can manage its content after creation."})]}),r.jsxs("div",{className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(u,{htmlFor:"testName",children:"Test Name"}),r.jsx(g,{id:"testName",value:V,onChange:e=>W(e.target.value),placeholder:`e.g., ${null==_?void 0:_.toUpperCase()} Practice Test 1`})]}),"writing"===_&&r.jsxs("div",{className:"space-y-2",children:[r.jsx(u,{htmlFor:"trainingType",children:"Training Type"}),r.jsxs(j,{value:Y,onValueChange:e=>Z(e),children:[r.jsx(f,{children:r.jsx(N,{placeholder:"Select training type"})}),r.jsxs(v,{children:[r.jsx(y,{value:"Academic",children:"Academic Training"}),r.jsx(y,{value:"General",children:"General Training"})]})]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose the IELTS training type for this writing test"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(d,{onClick:async()=>{if(V.trim())if("writing"!==_||Y){J(!0);try{console.log("Creating test:",{newTestName:V,testType:_,trainingType:Y});const e={test_name:V,test_type:_,module:"ielts"===_?"reading":_};"writing"===_&&Y&&(e.training_type=Y);const s=await B("tests",e);console.log("Test created:",s),l.success("Test created successfully"),J(!1),W(""),Z(""),z()}catch(e){console.error("Error creating test:",e),l.error(`Failed to create test: ${e.message||"Unknown error"}`)}finally{J(!1)}}else l.error("Please select Academic or General training type for writing tests");else l.error("Please enter a test name")},className:"flex-1",children:"Create Test"}),r.jsx(d,{variant:"outline",onClick:()=>J(!1),className:"flex-1",children:"Cancel"})]})]})]})]}),r.jsxs(T,{variant:"secondary",className:"text-sm",children:[null==_?void 0:_.toUpperCase()," Module"]})]})]}),r.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[O.map(e=>{var s,t;return r.jsxs(b,{className:"hover:shadow-lg transition-all duration-200 cursor-pointer border-border/40 bg-card/50 backdrop-blur-sm",onClick:()=>$(`/admin/${_}/test/${e.id}`),children:[r.jsxs(w,{className:"pb-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(C,{className:"text-lg font-semibold text-foreground",children:e.test_name}),r.jsx(L,{className:"w-4 h-4 text-primary"})]}),r.jsx(k,{className:"text-sm text-muted-foreground",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(S,{className:"w-3 h-3"}),r.jsxs("span",{children:[null==(s=e.module)?void 0:s.charAt(0).toUpperCase(),null==(t=e.module)?void 0:t.slice(1)," Module"]})]})})]}),r.jsxs(E,{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(F,{className:"w-3 h-3"}),r.jsx("span",{children:"2h 45m"})]}),r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(M,{className:"w-3 h-3"}),r.jsx("span",{children:"4 sections"})]})]}),r.jsx(d,{className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",onClick:s=>{s.stopPropagation(),$(`/admin/${_}/test/${e.id}`)},children:"Manage Test Content"})]})]},e.id)}),0===O.length&&r.jsxs("div",{className:"col-span-full text-center py-12",children:[r.jsx(M,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tests created yet"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first test to get started"}),r.jsxs(d,{onClick:()=>J(!0),children:[r.jsx(A,{className:"w-4 h-4 mr-2"}),"Create First Test"]})]})]})]})})};export{$ as default};
