import{r as e,f as t,J as s,j as a,C as i,b as n,c as o,a as r,av as l,B as c}from"./index-DnM5_-1I.js";import{A as p,a as d}from"./alert-CH2FBaKh.js";import{F as m}from"./file-text-CC7LpGqK.js";import{C as u}from"./circle-alert-CVzbYzmC.js";import{C as h}from"./circle-help-BqK1ZqGN.js";import{D as g}from"./download-B5RGlbtZ.js";import{U as f}from"./upload-CLhuwlT7.js";const b=[{value:"Matching Headings",label:"Matching Headings",description:"Read paragraphs and choose best topic from a list of headings",tips:"Understand main vs supporting ideas; read the list of headings first; answers are often numbers"},{value:"Matching Paragraph Information",label:"Matching Paragraph Information",description:"Choose statements that fit specific paragraph content",tips:"Use keywords and paraphrasing; answers are not necessarily consecutive"},{value:"Matching Features",label:"Matching Features",description:"Match facts, ideas, or opinions (e.g., researcher to discovery)",tips:"Focus on specifics, synonyms, and keywords"},{value:"Matching Sentence Endings",label:"Matching Sentence Endings",description:"Match incomplete sentences to appropriate ending alternatives",tips:"Practice grammar like subject-verb agreement and tenses"},{value:"True/False/Not Given",label:"True/False/Not Given",description:"Verify statements against passage content",tips:"True if matches passage, False if contradicts, Not Given if not mentioned"},{value:"Yes/No/Not Given",label:"Yes/No/Not Given",description:"Evaluate views, claims, or opinions in the passage",tips:"Yes if matches author's view, No if contradicts, Not Given if not mentioned"},{value:"Multiple Choice",label:"Multiple Choice",description:"Choose the correct answer from multiple options",tips:"Understand main ideas and specific information; use skimming and elimination"},{value:"List of Options",label:"List of Options",description:"Select multiple answers from a list (e.g., 'Which THREE?')",tips:"Similar to multiple choice but requires selecting several correct options"},{value:"Choose a Title",label:"Choose a Title",description:"Select the most appropriate title for the passage",tips:"Understand main ideas vs supporting details and overall purpose"},{value:"Short-answer Questions",label:"Short-answer Questions",description:"Answer questions with specific information from the passage",tips:"Questions usually follow the order of information in the passage"},{value:"Sentence Completion",label:"Sentence Completion",description:"Complete sentences using words from the passage",tips:"Use paraphrasing and look for synonyms"},{value:"Summary Completion",label:"Summary Completion",description:"Complete a summary of part of the passage",tips:"Identify parts of speech and grammatical requirements"},{value:"Table Completion",label:"Table Completion",description:"Fill in missing information in a table format",tips:"Follow the logical flow of information in the table structure"},{value:"Flow Chart Completion",label:"Flow Chart Completion",description:"Fill in missing steps or information in a flow chart",tips:"Understand the sequence and logical progression"},{value:"Diagram Label Completion",label:"Diagram Label Completion",description:"Fill in labels or parts of diagrams",tips:"Use synonyms and paraphrases; focus on technical or descriptive vocabulary"}],v=[{value:"Multiple Choice",label:"Multiple Choice",description:"Choose the correct answer from options while listening",tips:"Listen for specific information and main ideas"},{value:"Matching",label:"Matching",description:"Match items from two lists",tips:"Listen for relationships between different pieces of information"},{value:"Plan/Map/Diagram Labelling",label:"Plan/Map/Diagram Labelling",description:"Label parts of a visual representation",tips:"Follow directions and spatial relationships described in audio"},{value:"Form Completion",label:"Form Completion",description:"Fill in missing information on a form",tips:"Listen for specific details like names, numbers, dates"},{value:"Note Completion",label:"Note Completion",description:"Complete notes with missing information",tips:"Focus on key points and main ideas"},{value:"Table Completion",label:"Table Completion",description:"Fill in missing information in table format",tips:"Follow the structure and categories in the table"},{value:"Flow-chart Completion",label:"Flow-chart Completion",description:"Complete steps in a process or sequence",tips:"Listen for sequence markers and logical progression"},{value:"Summary Completion",label:"Summary Completion",description:"Complete a summary of the listening passage",tips:"Focus on main ideas and overall content"},{value:"Sentence Completion",label:"Sentence Completion",description:"Complete sentences with information from audio",tips:"Pay attention to grammar and word limits"},{value:"Short-answer Questions",label:"Short-answer Questions",description:"Answer questions with brief responses",tips:"Listen for specific factual information"}],w=[{value:"Task 1 - Graph Description",label:"Task 1 - Graph Description",description:"Describe data presented in graphs, charts, or tables",tips:"Focus on trends, comparisons, and key features"},{value:"Task 1 - Map Description",label:"Task 1 - Map Description",description:"Describe changes shown in maps over time",tips:"Describe locations, changes, and spatial relationships"},{value:"Task 1 - Process Description",label:"Task 1 - Process Description",description:"Describe how something works or is made",tips:"Use sequence words and passive voice appropriately"},{value:"Task 2 - Essay",label:"Task 2 - Essay",description:"Write an essay responding to a question or statement",tips:"Present clear arguments with examples and logical structure"}],x=[{value:"Part 1 - Introduction and Interview",label:"Part 1 - Introduction and Interview",description:"Answer questions about yourself and familiar topics",tips:"Give personal responses with some detail and examples"},{value:"Part 2 - Long Turn (Cue Card)",label:"Part 2 - Long Turn (Cue Card)",description:"Speak for 1-2 minutes on a given topic using cue card",tips:"Use the preparation time to plan and cover all points on the card"},{value:"Part 3 - Discussion",label:"Part 3 - Discussion",description:"Discuss abstract topics related to Part 2 theme",tips:"Give detailed answers with explanations, examples, and analysis"}],C={"True False Not Given":"True/False/Not Given","True False Not Given or Yes No Not Given":"True/False/Not Given",true_false_not_given:"True/False/Not Given","TF/NG":"True/False/Not Given","T/F/NG":"True/False/Not Given","Yes No Not Given":"Yes/No/Not Given",yes_no_not_given:"Yes/No/Not Given","Y/N/NG":"Yes/No/Not Given","Multiple choice (reading)":"Multiple Choice","multiple choice (reading)":"Multiple Choice",multiple_choice:"Multiple Choice","Short answer":"Short-answer Questions","short answer":"Short-answer Questions",short_answer_questions:"Short-answer Questions","Completion Diagrams":"Diagram Label Completion","Diagram completion":"Diagram Label Completion",diagram_label_completion:"Diagram Label Completion","Flow chart":"Flow Chart Completion",Flowchart:"Flow Chart Completion",flow_chart_completion:"Flow Chart Completion","Table completion (reading)":"Table Completion",table_completion:"Table Completion","Summary completion (reading)":"Summary Completion",summary_completion:"Summary Completion","Sentence completion (reading)":"Sentence Completion",sentence_completion:"Sentence Completion","Matching headings":"Matching Headings","matching headings":"Matching Headings",matching_headings:"Matching Headings","Matching features":"Matching Features","matching features":"Matching Features",matching_features:"Matching Features",matching_paragraph_information:"Matching Paragraph Information",matching_sentence_endings:"Matching Sentence Endings",list_of_options:"List of Options",choose_a_title:"Choose a Title","multiple choice (listening)":"Multiple Choice","Multiple choice (listening)":"Multiple Choice","Plan labelling":"Plan/Map/Diagram Labelling","Map labelling":"Plan/Map/Diagram Labelling","Diagram labelling":"Plan/Map/Diagram Labelling","Form completion":"Form Completion","Note completion":"Note Completion","Table completion (listening)":"Table Completion","Summary completion (listening)":"Summary Completion","Sentence completion (listening)":"Sentence Completion","Short answer (listening)":"Short-answer Questions","Task 1 Graph":"Task 1 - Graph Description","Task 1 Map":"Task 1 - Map Description","Task 1 Process":"Task 1 - Process Description","Task 2 Essay":"Task 2 - Essay",Essay:"Task 2 - Essay","Part 1":"Part 1 - Introduction and Interview","Part 2":"Part 2 - Long Turn (Cue Card)","Part 3":"Part 3 - Discussion","Cue Card":"Part 2 - Long Turn (Cue Card)"};function y(e){switch(e){case"reading":return b;case"listening":return v;case"writing":return w;case"speaking":return x;default:return[]}}function N(e){return[...b,...v,...w,...x].map(e=>e.value).includes(e)?e:C[e]||e}function j(e,t){return y(t).map(e=>e.value).includes(e)}const T=({onImport:b,onQuestionsPreview:v,type:w,module:x="ielts",cambridgeBook:C,testNumber:T,sectionNumber:S,partNumber:M,hideDownloadSample:k=!1,testId:F,testType:_})=>{const[D,L]=e.useState(!1),[P,E]=e.useState(null),[G,q]=e.useState([]),[I,U]=e.useState(!1),A=e.useRef(null),R=["Question Number","Section","Type","Question Text","Choices","Correct Answer","Explanation"],{uploading:V,uploadCSV:O}=function(){const[a,i]=e.useState(!1),{createContent:n}=t();return{uploading:a,uploadCSV:async(e,t,a,o,r)=>{var l;i(!0);try{console.log("useCSVUpload: Starting upload with data:",{testId:t,testType:a,partNumber:o,module:r,questionCount:e.length});const i=await n("csv_upload",{csvData:e,testId:t,testType:a,partNumber:o,module:r});if(i.success)return s.success(`Successfully uploaded ${e.length} questions for Part ${o}`),{success:!0,data:i.data};throw console.error("Upload result error:",i),new Error(i.error||"Upload failed")}catch(P){console.error("CSV upload error:",P);let t="Unknown error occurred";if((null==P?void 0:P.message)&&(t=P.message),null==(l=null==P?void 0:P.response)?void 0:l.data){const s=P.response.data;s.error&&(t=s.error,s.details&&(t+=` Details: ${s.details}`))}s.error(`Upload failed: ${t}`);const a=new Error(t);throw a.response=P.response,a}finally{i(!1)}}}}(),$=y(w),B=e=>{const t=[];let s="",a=!1;for(let i=0;i<e.length;i++){const n=e[i],o=e[i+1];'"'!==n||a?'"'===n&&a&&'"'===o?(s+='"',i++):'"'===n&&a?a=!1:","!==n||a?s+=n:(t.push(s.trim()),s=""):a=!0}return t.push(s.trim()),t};return a.jsxs(i,{className:"rounded-2xl border-light-border shadow-soft",style:{background:"var(--gradient-card)"},children:[a.jsx(n,{children:a.jsxs(o,{className:"flex items-center gap-2 text-foreground",children:[a.jsx(m,{className:"w-5 h-5"}),"Bulk CSV Import - ",w.charAt(0).toUpperCase()+w.slice(1)," Question Types"]})}),a.jsxs(r,{className:"space-y-4",children:[a.jsx("div",{className:"text-sm text-warm-gray",children:"Import multiple questions at once using a CSV file with comprehensive IELTS Reading question type support. Download the sample file to see the exact format and examples for all question types."}),a.jsxs("div",{className:"text-xs text-warm-gray bg-blue-50 p-3 rounded-xl border border-blue-200",children:[a.jsx("strong",{children:"Instructions:"})," Your CSV must match this exact format and support all IELTS Reading types listed below. Use semicolons (;) to separate choices or matches. Download the sample for reference and examples. Enclose text with commas in quotes if needed.",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Required Format:"})," ",R.join(", "),a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Supported Question Types:"}),a.jsx(l,{children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-1 mt-2",children:$.map(e=>a.jsx("div",{className:"text-xs",children:e.label},e.value))})}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Choice Formats:"}),a.jsx("br",{}),'• Multiple Choice: "A) Option1;B) Option2;C) Option3"',a.jsx("br",{}),'• Matching: "Item1=MatchA;Item2=MatchB" or "Option1;Option2;Option3"',a.jsx("br",{}),"• True/False/Not Given: Leave choices blank (auto-generated)",a.jsx("br",{}),"• Fill/Completion: Leave choices blank for open text answers"]}),P&&a.jsxs(p,{className:"border-red-200 bg-red-50",children:[a.jsx(u,{className:"h-4 w-4 text-red-600"}),a.jsx(d,{className:"text-red-800",children:P})]}),a.jsx("div",{className:"bg-muted/30 border border-dashed rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:a.jsx(h,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-sm mb-2",children:"Need CSV Format Reference?"}),a.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["Download a sample CSV with the correct format and column headers for ",w," questions."]}),a.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{const e=[R.join(","),...(()=>{const e={reading:['1,Reading,True/False/Not Given,"People had expected Andy Murray to become the world\'s top tennis player for at least five years before 2016.","TRUE;FALSE;NOT GIVEN","FALSE","The passage states Murray was regarded as an outsider before 2016."','2,Reading,Sentence Completion,"Mike and Bob Bryan made changes to the types of ______ used on their racket frames.","","paint","The passage mentions they experimented with different kinds of paint."','3,Reading,Multiple Choice,"What is the main benefit of racket modifications according to the passage?","A) Increased speed;B) Better control;C) Reduced weight;D) Enhanced power","B","The passage emphasizes control as a key benefit."'],listening:['1,Listening,Multiple Choice,"What is the main topic of the conversation?","A) Travel plans;B) Hotel booking;C) Restaurant reservation;D) Meeting schedule","B","The speakers discuss hotel arrangements."','2,Listening,Form Completion,"The caller\'s name is ______","","Sarah Johnson","As stated by the caller at the beginning."','3,Listening,Table Completion,"Complete the table: Day | Activity | Time","Monday;Meeting;9:00 AM","Monday=Meeting;9:00 AM","Based on the schedule discussion."'],writing:['1,Writing,Task 1 - Graph Description,"Describe the trends shown in the graph","","The graph shows a steady increase...","Model answer describing key trends."','2,Writing,Task 2 - Essay,"Discuss both views and give your opinion","","While some argue that...","Model essay with balanced arguments."'],speaking:['1,Speaking,Part 1 - Introduction and Interview,"What do you do for work or study?","","I work as a software developer...","Sample response with details."','2,Speaking,Part 2 - Long Turn (Cue Card),"Describe a memorable journey","","I\'d like to talk about a trip...","Sample 2-minute response."']};return e[w]||e.reading})()].join("\n"),t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`${w}_questions_sample.csv`,a.click(),window.URL.revokeObjectURL(s)},className:"text-xs",children:[a.jsx(g,{className:"w-3 h-3 mr-1"}),"Download Sample CSV"]})]})]})}),I?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[a.jsxs("h4",{className:"font-medium text-green-800 mb-2",children:["Preview: ",G.length," questions parsed successfully"]}),a.jsx("div",{className:"text-sm text-green-700",children:"Review the questions below and confirm to import them into your test."})]}),a.jsx("div",{className:"max-h-64 overflow-y-auto border border-light-border rounded-xl p-4 bg-white",children:G.map((e,t)=>a.jsx("div",{className:"border-b border-light-border pb-3 mb-3 last:border-b-0 last:mb-0",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsxs("span",{className:"font-medium text-sm text-foreground min-w-8",children:[e.question_number,"."]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e.question_type}),a.jsxs("span",{className:"text-xs text-warm-gray",children:["Answer: ",e.correct_answer]})]}),a.jsx("p",{className:"text-sm text-foreground",children:e.question_text}),e.options&&e.options.length>0&&a.jsxs("div",{className:"text-xs text-warm-gray mt-1",children:["Options: ",e.options.join(" | ")]}),e.choices&&a.jsxs("div",{className:"text-xs text-warm-gray mt-1",children:["Matches: ",Object.entries(e.choices).map(([e,t])=>`${e}=${t}`).join(" | ")]})]})]})},t))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(c,{onClick:async()=>{var e,t;if(!F||!_)return console.log("Confirming import of questions:",G),b(G),U(!1),void q([]);try{L(!0),E(null),console.log("Confirm Import clicked - uploading questions to database..."),await O(G,F,_,M||1,x),console.log("Database upload completed successfully"),b(G),U(!1),q([]),console.log("Import workflow completed - preview closed")}catch(s){console.error("Upload failed:",s);let a="Failed to upload questions. Please try again.";(null==s?void 0:s.message)?a=s.message:"string"==typeof s&&(a=s),(null==(t=null==(e=null==s?void 0:s.response)?void 0:e.data)?void 0:t.error)&&(a=`Upload Failed: ${s.response.data.error}`,s.response.data.details&&(a+=` Details: ${s.response.data.details}`)),E(a)}finally{L(!1)}},disabled:D||V,className:"rounded-xl flex-1 bg-primary hover:bg-primary/90 text-white font-medium",children:D||V?"Uploading...":"Confirm Import"}),a.jsx(c,{variant:"outline",onClick:()=>{U(!1),q([])},className:"rounded-xl flex-1 border-light-border",children:"Cancel"})]})]}):a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("input",{ref:A,type:"file",accept:".csv",onChange:async e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){L(!0),E(null),U(!1);try{const e=(e=>{var t,s,a,i,n,o;const r=e.split("\n").filter(e=>e.trim());if(r.length<2)throw new Error("CSV file must contain at least a header row and one data row");const l=B(r[0]).map(e=>e.trim()),c=R.filter(e=>!l.includes(e));if(c.length>0)throw new Error(`Missing required columns: ${c.join(", ")}. Expected exact format: ${R.join(", ")}`);const p=[];for(let d=1;d<r.length;d++){const e=B(r[d]);if(e.length<l.length)continue;const c=d;null==(t=e[1])||t.trim();const m=(null==(s=e[2])?void 0:s.trim())||"",u=(null==(a=e[3])?void 0:a.trim())||"",h=(null==(i=e[4])?void 0:i.trim())||"",g=(null==(n=e[5])?void 0:n.trim())||"",f=(null==(o=e[6])?void 0:o.trim())||"",b=N(m);if(!j(b,w)){const e=$.map(e=>e.value);throw new Error(`Invalid question type "${m}" in row ${d+1}. Mapped to "${b}". Supported types: ${e.join(", ")}`)}const v=b;let x=[],y=null;if(h)if("Multiple Choice"===v)x=h.split(";").map(e=>e.trim()).filter(e=>e);else if("True/False/Not Given"===v)x=["TRUE","FALSE","NOT GIVEN"];else if("Yes/No/Not Given"===v)x=["YES","NO","NOT GIVEN"];else if(v.includes("Matching")){const e=h.split(";").map(e=>e.trim()).filter(e=>e);e.some(e=>e.includes("="))?(y={},e.forEach(e=>{const[t,s]=e.split("=").map(e=>e.trim());t&&s&&(y[t]=s)})):x=e}else x=h.split(";").map(e=>e.trim()).filter(e=>e);p.push({question_number:c,question_type:v,question_text:u,options:x.length>0?x:void 0,choices:y||void 0,correct_answer:g,explanation:f,cambridge_book:C,section_number:S,part_number:M||1})}return p})(await s.text());if(0===e.length)throw new Error("No valid questions found in CSV file");q(e),U(!0)}catch(a){E(a.message||"Failed to parse CSV file")}finally{L(!1),A.current&&(A.current.value="")}}},className:"hidden"}),a.jsxs(c,{onClick:()=>{var e;return null==(e=A.current)?void 0:e.click()},disabled:D,className:"bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-xl font-medium w-full",children:[a.jsx(f,{className:"w-4 h-4 mr-2"}),D?"Parsing CSV...":"Upload CSV File"]})]})]})]})};export{T as C};
