import{y as e,u as t,a4 as s,A as a,g as l,r as i,j as r,B as n,a5 as o,a6 as c,T as d,k as m,a7 as h,I as x,a0 as p}from"./index-BX4LCKf1.js";import{s as u}from"./supabase-Bqkrifq5.js";import{U as g}from"./users-CBMdpv2Z.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=e("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),f=async(e,t,s)=>{try{const{data:{user:a}}=await u.auth.getUser();if(!a)return;await u.from("user_analytics").insert({user_id:a.id,action_type:e,details:{question_id:t||null,...s}})}catch(a){console.log("Analytics logging failed:",a)}},y=()=>{const e=t(),{t:y}=s(),{user:w}=a(),{toast:v}=l(),[j,N]=i.useState(""),[k,_]=i.useState([]),[S,C]=i.useState(""),[I,F]=i.useState("all"),[T,A]=i.useState(!0);i.useEffect(()=>{f("page_visit",void 0,{page:"community",timestamp:(new Date).toISOString()})},[]),i.useEffect(()=>{z()},[]);const z=async()=>{try{const{data:e,error:t}=await u.from("community_posts").select("*").order("created_at",{ascending:!1});if(t)throw t;_(e||[])}catch(e){console.error("Error loading posts:",e),_([{id:1,username:"Sarah Chen",content:"Just achieved Band 7 in Reading! The key was practicing with Cambridge 19 daily. Any tips for improving Writing Task 2?",likes_count:12,comments_count:5,created_at:new Date(Date.now()-72e5).toISOString(),category:"reading"},{id:2,username:"Mike Johnson",content:"Looking for a study group for IELTS preparation. I'm aiming for Band 7.5 by March. Anyone interested?",likes_count:8,comments_count:12,created_at:new Date(Date.now()-144e5).toISOString(),category:"general"}])}finally{A(!1)}},D=k.filter(e=>!(S&&!e.content.toLowerCase().includes(S.toLowerCase()))&&("all"===I||e.category===I)),E=e=>{const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/36e5);return a<1?"Just now":a<24?`${a} hours ago`:`${Math.floor(a/24)} days ago`};return r.jsxs("div",{className:"min-h-full lg:py-10 lg:px-6 pt-6 pr-4 pb-6 pl-4",children:[r.jsx("div",{className:"fixed top-0 w-full h-screen bg-cover bg-center -z-10",style:{backgroundImage:"url('/lovable-uploads/e2289d4e-02bd-49a2-be13-299500e8fa69.png')"}}),r.jsxs("header",{className:"flex sm:px-6 lg:px-12 lg:py-5 pt-4 pr-4 pb-4 pl-4 items-center justify-between border-b border-white/20",children:[r.jsx("h1",{className:"text-3xl font-semibold text-slate-800",style:{fontFamily:"Bricolage Grotesque, sans-serif"},children:y("community.studyCommunity")}),r.jsxs(n,{onClick:()=>e("/"),variant:"ghost",style:{fontFamily:"Inter, sans-serif"},className:"hover:bg-white/10 flex items-center gap-2 text-slate-950",children:[r.jsx(o,{className:"w-4 h-4"}),y("navigation.home")]})]}),r.jsx("main",{className:"relative sm:px-6 lg:px-12 pr-4 pb-8 pl-4",children:r.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pt-6",children:[r.jsx("div",{className:"text-center mb-8",children:r.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"text-slate-950 font-light",children:"Connect with fellow students, share tips, and get support on your English learning journey"})}),r.jsxs("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:[r.jsxs("h3",{className:"flex items-center gap-2 text-lg font-semibold mb-4 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:[r.jsx(c,{className:"w-5 h-5 text-slate-600"}),"Share with the Community"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(d,{value:j,onChange:e=>N(e.target.value),placeholder:"Ask a question, share a tip, or start a discussion...",className:"min-h-[100px] bg-white/10 border-white/20 text-slate-800 placeholder:text-slate-500"}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(m,{variant:"general"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("general"),children:"Question"}),r.jsx(m,{variant:"tip"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("tip"),children:"Study Tip"}),r.jsx(m,{variant:"success"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("success"),children:"Success Story"})]}),r.jsxs(n,{onClick:async()=>{var e;if(j.trim())if(w)try{const{error:t}=await u.from("community_posts").insert({user_id:w.id,username:(null==(e=w.email)?void 0:e.split("@")[0])||"User",title:j.substring(0,100),content:j,category:"all"===I?"general":I});if(t)throw t;N(""),v({title:"Post created successfully!"}),z(),f("community_post_created",void 0,{content_length:j.length,category:I})}catch(t){console.error("Error creating post:",t),v({title:"Failed to create post",variant:"destructive"})}else v({title:"Please sign in to post",variant:"destructive"})},disabled:!j.trim(),className:"bg-slate-800/80 backdrop-blur-sm text-white hover:bg-slate-700/80 border border-white/20",children:[r.jsx(h,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsx(x,{placeholder:"Search posts...",value:S,onChange:e=>C(e.target.value),className:"w-full bg-white/10 border-white/20 text-slate-800 placeholder:text-slate-500"})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(n,{variant:"all"===I?"default":"outline",onClick:()=>F("all"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"All"}),r.jsx(n,{variant:"general"===I?"default":"outline",onClick:()=>F("general"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Question"}),r.jsx(n,{variant:"tip"===I?"default":"outline",onClick:()=>F("tip"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Study Tip"}),r.jsx(n,{variant:"success"===I?"default":"outline",onClick:()=>F("success"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Success Story"})]})]}),r.jsx("div",{className:"space-y-4",children:T?r.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl text-center",children:r.jsx("p",{className:"text-slate-600",children:"Loading posts..."})}):0===D.length?r.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl text-center",children:r.jsx("p",{className:"text-slate-600",children:"No posts found. Be the first to start a discussion!"})}):D.map(e=>r.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-800/20 backdrop-blur-sm flex items-center justify-center border border-white/20",children:r.jsx(g,{className:"w-5 h-5 text-slate-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"font-semibold text-slate-950",children:e.username})}),r.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"text-sm text-slate-950",children:E(e.created_at)})]})]}),r.jsx(m,{variant:"outline",className:"text-xs bg-white/10 border-white/20 text-slate-700",children:e.category})]}),r.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"leading-relaxed text-slate-950",children:e.content}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(n,{variant:"ghost",size:"sm",className:"text-slate-600 hover:text-slate-800 hover:bg-white/10",onClick:()=>(async e=>{w?(f("community_post_liked",e.toString()),_(t=>t.map(t=>t.id===e?{...t,likes_count:(t.likes_count||0)+1}:t))):v({title:"Please sign in to like posts",variant:"destructive"})})(e.id),children:[r.jsx(b,{className:"w-4 h-4 mr-1"}),e.likes_count||0]}),r.jsxs(n,{variant:"ghost",size:"sm",className:"text-slate-600 hover:text-slate-800 hover:bg-white/10",children:[r.jsx(c,{className:"w-4 h-4 mr-1"}),e.comments_count||0," replies"]})]})]})},e.id))}),r.jsxs("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Coming Soon"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"text-center p-4",children:[r.jsx(g,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),r.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Study Groups"}),r.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Join or create study groups with students at your level"})]}),r.jsxs("div",{className:"text-center p-4",children:[r.jsx(c,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),r.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Live Q&A"}),r.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Weekly live sessions with English teachers and experts"})]}),r.jsxs("div",{className:"text-center p-4",children:[r.jsx(p,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),r.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Peer Reviews"}),r.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Get feedback on your writing from other students"})]})]})]})]})})]})};export{y as default};
