import{u as e,r as t,j as s}from"./vendor-react-JN_hy__U.js";import{s as a,E as l,d as r,B as i,T as n,e as o,I as c}from"./index-DXpPY1B7.js";import{u as d}from"./vendor-i18n-DlHrixAm.js";import{aG as m,as as h,x,aZ as p,bg as u,F as g}from"./vendor-ui-DG51EGkO.js";import"./vendor-react-dom-Cb-iy8Oc.js";import"./vendor-animation-ClPlB6zo.js";import"./vendor-utils-D5HPTFR9.js";import"./vendor-supabase-D7XYLCUu.js";import"./vendor-charts-BpOKEG9Z.js";import"./vendor-date-DT7Rq6D9.js";const b=async(e,t,s)=>{try{const{data:{user:l}}=await a.auth.getUser();if(!l)return;await a.from("user_analytics").insert({user_id:l.id,action_type:e,details:{question_id:t||null,...s}})}catch(l){console.log("Analytics logging failed:",l)}},f=()=>{const f=e(),{t:v}=d(),{user:w}=l(),{toast:y}=r(),[j,N]=t.useState(""),[k,_]=t.useState([]),[S,C]=t.useState(""),[I,F]=t.useState("all"),[E,T]=t.useState(!0);t.useEffect(()=>{b("page_visit",void 0,{page:"community",timestamp:(new Date).toISOString()})},[]),t.useEffect(()=>{z()},[]);const z=async()=>{try{const{data:e,error:t}=await a.from("community_posts").select("*").order("created_at",{ascending:!1});if(t)throw t;_(e||[])}catch(e){console.error("Error loading posts:",e),_([{id:1,username:"Sarah Chen",content:"Just achieved Band 7 in Reading! The key was practicing with Cambridge 19 daily. Any tips for improving Writing Task 2?",likes_count:12,comments_count:5,created_at:new Date(Date.now()-72e5).toISOString(),category:"reading"},{id:2,username:"Mike Johnson",content:"Looking for a study group for IELTS preparation. I'm aiming for Band 7.5 by March. Anyone interested?",likes_count:8,comments_count:12,created_at:new Date(Date.now()-144e5).toISOString(),category:"general"}])}finally{T(!1)}},D=k.filter(e=>!(S&&!e.content.toLowerCase().includes(S.toLowerCase()))&&("all"===I||e.category===I)),A=e=>{const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/36e5);return a<1?"Just now":a<24?`${a} hours ago`:`${Math.floor(a/24)} days ago`};return s.jsxs("div",{className:"min-h-full lg:py-10 lg:px-6 pt-6 pr-4 pb-6 pl-4",children:[s.jsx("div",{className:"fixed top-0 w-full h-screen bg-cover bg-center -z-10",style:{backgroundImage:"url('/lovable-uploads/e2289d4e-02bd-49a2-be13-299500e8fa69.png')"}}),s.jsxs("header",{className:"flex sm:px-6 lg:px-12 lg:py-5 pt-4 pr-4 pb-4 pl-4 items-center justify-between border-b border-white/20",children:[s.jsx("h1",{className:"text-3xl font-semibold text-slate-800",style:{fontFamily:"Bricolage Grotesque, sans-serif"},children:v("community.studyCommunity")}),s.jsxs(i,{onClick:()=>f("/"),variant:"ghost",style:{fontFamily:"Inter, sans-serif"},className:"hover:bg-white/10 flex items-center gap-2 text-slate-950",children:[s.jsx(m,{className:"w-4 h-4"}),v("navigation.home")]})]}),s.jsx("main",{className:"relative sm:px-6 lg:px-12 pr-4 pb-8 pl-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pt-6",children:[s.jsx("div",{className:"text-center mb-8",children:s.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"text-slate-950 font-light",children:"Connect with fellow students, share tips, and get support on your English learning journey"})}),s.jsxs("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:[s.jsxs("h3",{className:"flex items-center gap-2 text-lg font-semibold mb-4 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:[s.jsx(h,{className:"w-5 h-5 text-slate-600"}),"Share with the Community"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(n,{value:j,onChange:e=>N(e.target.value),placeholder:"Ask a question, share a tip, or start a discussion...",className:"min-h-[100px] bg-white/10 border-white/20 text-slate-800 placeholder:text-slate-500"}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(o,{variant:"general"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("general"),children:"Question"}),s.jsx(o,{variant:"tip"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("tip"),children:"Study Tip"}),s.jsx(o,{variant:"success"===I?"default":"outline",className:"cursor-pointer hover:bg-white/20 bg-white/10 border-white/20 text-slate-700",onClick:()=>F("success"),children:"Success Story"})]}),s.jsxs(i,{onClick:async()=>{var e;if(j.trim())if(w)try{const{error:t}=await a.from("community_posts").insert({user_id:w.id,username:(null==(e=w.email)?void 0:e.split("@")[0])||"User",title:j.substring(0,100),content:j,category:"all"===I?"general":I});if(t)throw t;N(""),y({title:"Post created successfully!"}),z(),b("community_post_created",void 0,{content_length:j.length,category:I})}catch(t){console.error("Error creating post:",t),y({title:"Failed to create post",variant:"destructive"})}else y({title:"Please sign in to post",variant:"destructive"})},disabled:!j.trim(),className:"bg-slate-800/80 backdrop-blur-sm text-white hover:bg-slate-700/80 border border-white/20",children:[s.jsx(x,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(c,{placeholder:"Search posts...",value:S,onChange:e=>C(e.target.value),className:"w-full bg-white/10 border-white/20 text-slate-800 placeholder:text-slate-500"})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(i,{variant:"all"===I?"default":"outline",onClick:()=>F("all"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"All"}),s.jsx(i,{variant:"general"===I?"default":"outline",onClick:()=>F("general"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Question"}),s.jsx(i,{variant:"tip"===I?"default":"outline",onClick:()=>F("tip"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Study Tip"}),s.jsx(i,{variant:"success"===I?"default":"outline",onClick:()=>F("success"),size:"sm",className:"bg-white/10 border-white/20 text-slate-700 hover:bg-white/20",children:"Success Story"})]})]}),s.jsx("div",{className:"space-y-4",children:E?s.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl text-center",children:s.jsx("p",{className:"text-slate-600",children:"Loading posts..."})}):0===D.length?s.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl text-center",children:s.jsx("p",{className:"text-slate-600",children:"No posts found. Be the first to start a discussion!"})}):D.map(e=>s.jsx("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-800/20 backdrop-blur-sm flex items-center justify-center border border-white/20",children:s.jsx(p,{className:"w-5 h-5 text-slate-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"font-semibold text-slate-950",children:e.username})}),s.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"text-sm text-slate-950",children:A(e.created_at)})]})]}),s.jsx(o,{variant:"outline",className:"text-xs bg-white/10 border-white/20 text-slate-700",children:e.category})]}),s.jsx("p",{style:{fontFamily:"Inter, sans-serif"},className:"leading-relaxed text-slate-950",children:e.content}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(i,{variant:"ghost",size:"sm",className:"text-slate-600 hover:text-slate-800 hover:bg-white/10",onClick:()=>(async e=>{w?(b("community_post_liked",e.toString()),_(t=>t.map(t=>t.id===e?{...t,likes_count:(t.likes_count||0)+1}:t))):y({title:"Please sign in to like posts",variant:"destructive"})})(e.id),children:[s.jsx(u,{className:"w-4 h-4 mr-1"}),e.likes_count||0]}),s.jsxs(i,{variant:"ghost",size:"sm",className:"text-slate-600 hover:text-slate-800 hover:bg-white/10",children:[s.jsx(h,{className:"w-4 h-4 mr-1"}),e.comments_count||0," replies"]})]})]})},e.id))}),s.jsxs("div",{className:"relative lg:p-6 bg-white/10 border-white/20 rounded-2xl pt-4 pr-4 pb-4 pl-4 backdrop-blur-xl",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Coming Soon"}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-4",children:[s.jsx(p,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),s.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Study Groups"}),s.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Join or create study groups with students at your level"})]}),s.jsxs("div",{className:"text-center p-4",children:[s.jsx(h,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),s.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Live Q&A"}),s.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Weekly live sessions with English teachers and experts"})]}),s.jsxs("div",{className:"text-center p-4",children:[s.jsx(g,{className:"w-8 h-8 text-slate-600 mx-auto mb-2"}),s.jsx("h4",{className:"font-semibold mb-1 text-slate-800",style:{fontFamily:"Inter, sans-serif"},children:"Peer Reviews"}),s.jsx("p",{className:"text-sm text-slate-600",style:{fontFamily:"Inter, sans-serif"},children:"Get feedback on your writing from other students"})]})]})]})]})})]})};export{f as default};
