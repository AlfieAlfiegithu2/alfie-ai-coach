import{r as e,j as t,aA as s,B as n,Y as a,Z as r,bG as o,V as l}from"./index-CFsndfmK.js";import{V as c}from"./volume-x-ClZGgKw_.js";const u=({src:u,className:i,style:d,accentColor:m="#3b82f6"})=>{const h=e.useRef(null),v=e.useRef(null),[f,x]=e.useState(!1),[p,E]=e.useState(0),[b,j]=e.useState(0),[w,L]=e.useState(!1),[g,y]=e.useState(!1),[N,k]=e.useState(!1);e.useState(1);const C=e=>{if(isNaN(e)||!isFinite(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},S=b>0?p/b*100:0;e.useEffect(()=>{const e=h.current;if(!e)return;const t=()=>{j(e.duration)},s=()=>{g||E(e.currentTime)},n=()=>{x(!1),E(0)},a=()=>x(!0),r=()=>x(!1);return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",s),e.addEventListener("ended",n),e.addEventListener("play",a),e.addEventListener("pause",r),e.readyState>=1&&j(e.duration),()=>{e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",s),e.removeEventListener("ended",n),e.removeEventListener("play",a),e.removeEventListener("pause",r)}},[g]),e.useEffect(()=>{E(0),x(!1),j(0)},[u]);const $=e.useCallback(()=>{const e=h.current;e&&(f?e.pause():e.play().catch(console.error))},[f]),M=e.useCallback(()=>{const e=h.current;e&&(e.currentTime=0,E(0),e.play().catch(console.error))},[]),T=e.useCallback(()=>{const e=h.current;e&&(e.muted=!w,L(!w))},[w]),X=e.useCallback(e=>{if(!v.current||b<=0)return 0;const t=v.current.getBoundingClientRect(),s=e-t.left;return Math.max(0,Math.min(1,s/t.width))*b},[b]),z=e.useCallback(e=>{const t=X(e.clientX);E(t),h.current&&(h.current.currentTime=t)},[X]),D=e.useCallback(e=>{e.preventDefault(),y(!0);const t="touches"in e?e.touches[0].clientX:e.clientX,s=X(t);E(s)},[X]);return e.useEffect(()=>{if(!g)return;const e=e=>{const t="touches"in e?e.touches[0].clientX:e.clientX,s=X(t);E(s)},t=()=>{y(!1),h.current&&(h.current.currentTime=p)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.addEventListener("touchmove",e),document.addEventListener("touchend",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",t)}},[g,p,X]),t.jsxs("div",{className:s("rounded-xl p-3 flex items-center gap-3 select-none",i),style:d,children:[t.jsx("audio",{ref:h,src:u,preload:"metadata"}),t.jsx(n,{variant:"ghost",size:"icon",className:s("h-9 w-9 rounded-lg transition-all duration-200 shrink-0","hover:scale-105 active:scale-95"),style:{color:m,backgroundColor:`${m}15`},onClick:$,children:f?t.jsx(a,{className:"h-4 w-4"}):t.jsx(r,{className:"h-4 w-4 ml-0.5"})}),t.jsx("span",{className:"text-xs font-mono tabular-nums w-10 text-right",style:{color:`${m}90`},children:C(p)}),t.jsx("div",{ref:v,className:s("flex-1 h-10 flex items-center cursor-pointer group relative",g&&"cursor-grabbing"),onMouseDown:D,onTouchStart:D,onClick:z,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:t.jsxs("div",{className:"w-full h-2 rounded-full relative overflow-visible",style:{backgroundColor:`${m}20`},children:[t.jsx("div",{className:"absolute left-0 top-0 h-full rounded-full transition-all ease-out",style:{width:`${S}%`,backgroundColor:m,transitionDuration:g?"0ms":"100ms"}}),t.jsx("div",{className:s("absolute top-1/2 -translate-y-1/2 -translate-x-1/2 rounded-full transition-all duration-150","shadow-sm",g?"w-4 h-4 scale-110":"w-3 h-3",N||g?"opacity-100 scale-100":"opacity-0 scale-75"),style:{left:`${S}%`,backgroundColor:m,boxShadow:g?`0 0 0 4px ${m}30`:`0 1px 3px ${m}40`}})]})}),t.jsx("span",{className:"text-xs font-mono tabular-nums w-10",style:{color:`${m}70`},children:C(b)}),t.jsx(n,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-lg transition-all duration-200 shrink-0 hover:scale-105",style:{color:`${m}80`},onClick:M,children:t.jsx(o,{className:"h-3.5 w-3.5"})}),t.jsx(n,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-lg transition-all duration-200 shrink-0 hover:scale-105",style:{color:`${m}80`},onClick:T,children:w?t.jsx(c,{className:"h-3.5 w-3.5"}):t.jsx(l,{className:"h-3.5 w-3.5"})})]})};export{u as C};
