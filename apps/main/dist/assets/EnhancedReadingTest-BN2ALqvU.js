import{c as e,u as s,r as t,j as n,B as r,ao as i,ai as a,c1 as o,C as l,a as c,b as d,d as m,l as u,ah as x,h,G as p,a5 as g,c2 as f,R as j,K as v,a2 as N,c0 as b,Z as w,_ as y,O as _,I as q}from"./index-CutW7JrA.js";import{s as $}from"./supabase-DWL4C3fA.js";import{P as k}from"./PenguinClapAnimation-Cv_6sjDq.js";import{T as C}from"./trophy-jpBv39ne.js";import{Z as T}from"./zoom-in-BzoxiKH_.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=e("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),P=({score:e,timeTaken:h,answers:p,questions:g,onRetake:f,testParts:j})=>{var v,N,b,w,y,_,q;const $=s(),[T,S]=t.useState(1),P=Math.round(e/40*100),O=x(e,"academic-reading"),R=P>=85?{level:"Excellent",color:"text-primary"}:P>=70?{level:"Good",color:"text-primary"}:P>=50?{level:"Average",color:"text-primary"}:{level:"Needs Improvement",color:"text-muted-foreground"},L=Object.values(j).flatMap(e=>e.questions),E=L.filter(e=>{var s;return(null==(s=p[e.id])?void 0:s.toLowerCase().trim())===e.correct_answer.toLowerCase().trim()}).length,A=L.filter(e=>{const s=p[e.id];return s&&s.toLowerCase().trim()!==e.correct_answer.toLowerCase().trim()}).length,I=L.filter(e=>!p[e.id]).length,z=L.reduce((e,s)=>(e[s.question_type]=(e[s.question_type]||0)+1,e),{});return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("div",{className:"bg-card border-b sticky top-0 z-10 shadow-sm",children:n.jsx("div",{className:"container mx-auto px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(r,{variant:"ghost",onClick:()=>$("/dashboard"),className:"hover:bg-muted text-foreground",children:[n.jsx(i,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),n.jsxs(r,{variant:"ghost",onClick:()=>$("/ielts-portal"),className:"hover:bg-muted text-foreground",children:[n.jsx(a,{className:"w-4 h-4 mr-2"}),"Back to Portal"]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-semibold text-foreground font-inter",children:"Reading Test Results"}),n.jsx("p",{className:"text-sm text-muted-foreground font-inter",children:"IELTS Academic Reading"})]})]}),n.jsxs(r,{onClick:f,variant:"outline",children:[n.jsx(o,{className:"w-4 h-4 mr-2"}),"Retake Test"]})]})})}),n.jsxs("div",{className:"container mx-auto px-6 py-8",children:[n.jsx(l,{className:"mb-8",children:n.jsx(c,{className:"pt-6",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx(k,{size:"sm",className:"flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-medium text-foreground font-inter",children:"Test Completed Successfully! ðŸŽ‰"}),n.jsx("p",{className:"text-muted-foreground font-inter",children:"Your IELTS Academic Reading test has been evaluated."})]})]})})}),n.jsxs(l,{className:"mb-8",children:[n.jsx(d,{className:"text-center bg-muted/30 py-6",children:n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx("div",{className:"p-3 rounded-full bg-primary",children:n.jsx(C,{className:"w-6 h-6 text-primary-foreground"})}),n.jsx(m,{className:"text-xl font-medium text-foreground font-inter",children:"Your IELTS Reading Band Score"})]})}),n.jsxs(c,{className:"text-center py-8",children:[n.jsx("div",{className:"text-7xl font-bold mb-6 text-foreground font-inter",children:O}),n.jsxs("div",{className:"flex items-center justify-center gap-8 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-semibold text-foreground font-inter",children:[e,"/",40]}),n.jsx("p",{className:"text-sm text-muted-foreground font-inter",children:"Questions Correct"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-semibold text-foreground font-inter",children:[P,"%"]}),n.jsx("p",{className:"text-sm text-muted-foreground font-inter",children:"Accuracy"})]})]}),n.jsxs("div",{className:"inline-flex items-center px-6 py-3 rounded-full bg-primary text-primary-foreground font-medium text-lg font-inter",children:[R.level," Performance"]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-4 font-inter",children:"Based on official IELTS assessment criteria"})]})]}),n.jsx(l,{className:"mb-6",children:n.jsx(c,{className:"py-6",children:n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"flex bg-muted/50 rounded-xl p-2 gap-2",children:Object.keys(j).map(e=>{var s;const t=parseInt(e),i=(null==(s=j[t])?void 0:s.questions)||[],a=i.filter(e=>{var s;return(null==(s=p[e.id])?void 0:s.toLowerCase().trim())===e.correct_answer.toLowerCase().trim()}).length;return n.jsxs(r,{variant:T===t?"default":"ghost",size:"sm",onClick:()=>S(t),className:"min-w-[120px] rounded-lg font-medium font-inter",children:["Part ",t,n.jsxs("span",{className:"ml-2 text-xs",children:[a,"/",i.length]})]},t)})})})})}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[n.jsxs(l,{children:[n.jsx(d,{className:"text-center pb-3",children:n.jsx(m,{className:"text-lg font-medium text-foreground font-inter",children:"Summary"})}),n.jsxs(c,{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-muted/30",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),n.jsx("span",{className:"font-medium text-foreground font-inter",children:"Correct"})]}),n.jsx("span",{className:"text-xl font-semibold text-foreground font-inter",children:E})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-muted/30",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),n.jsx("span",{className:"font-medium text-foreground font-inter",children:"Incorrect"})]}),n.jsx("span",{className:"text-xl font-semibold text-foreground font-inter",children:A})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-muted/30",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-3 h-3 rounded-full bg-muted-foreground"}),n.jsx("span",{className:"font-medium text-foreground font-inter",children:"Skipped"})]}),n.jsx("span",{className:"text-xl font-semibold text-foreground font-inter",children:I})]})]})]}),n.jsxs(l,{children:[n.jsx(d,{className:"text-center pb-3",children:n.jsx(m,{className:"text-lg font-medium text-foreground font-inter",children:"Question Types"})}),n.jsx(c,{className:"space-y-3",children:Object.entries(z).map(([e,s])=>n.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-muted/30",children:[n.jsx("span",{className:"text-sm capitalize font-medium text-foreground font-inter",children:e.replace("_"," ")}),n.jsx("span",{className:"text-xl font-semibold text-foreground font-inter",children:s})]},e))})]})]}),n.jsxs("div",{className:"flex gap-6 h-[calc(100vh-200px)]",children:[n.jsxs(l,{className:"flex flex-col w-[50%] h-full",children:[n.jsxs(d,{className:"flex-shrink-0 pb-3 px-4 py-3 bg-muted/30 border-b",children:[n.jsx(m,{className:"flex items-center gap-2 text-lg font-medium text-foreground font-inter",children:(null==(N=null==(v=j[T])?void 0:v.passage)?void 0:N.title)||`Reading Passage ${T}`}),n.jsxs(u,{variant:"outline",className:"w-fit text-xs",children:["Part ",T,"/",Object.keys(j).length]})]}),n.jsx(c,{className:"flex-1 overflow-y-auto min-h-0 p-6",children:n.jsx("div",{className:"prose prose-sm max-w-none",children:n.jsx("div",{className:"whitespace-pre-wrap leading-relaxed select-text text-foreground font-inter",id:`passage-content-${T}`,style:{fontSize:"16px",lineHeight:"1.8"},children:(null==(w=null==(b=j[T])?void 0:b.passage)?void 0:w.content)||"Loading passage..."})})})]}),n.jsxs(l,{className:"flex flex-col w-[50%] h-full",children:[n.jsxs(d,{className:"flex-shrink-0 pb-3 px-4 py-3 bg-muted/30 border-b",children:[n.jsxs(m,{className:"text-lg font-medium flex items-center gap-2 text-foreground font-inter",children:["Answer Review - Part ",T]}),n.jsxs(u,{variant:"outline",className:"w-fit text-xs",children:[((null==(y=j[T])?void 0:y.questions)||[]).filter(e=>{var s;return(null==(s=p[e.id])?void 0:s.toLowerCase().trim())===e.correct_answer.toLowerCase().trim()}).length,"/",((null==(_=j[T])?void 0:_.questions)||[]).length," correct"]})]}),n.jsx(c,{className:"flex-1 overflow-y-auto min-h-0 p-4 scroll-smooth",children:n.jsx("div",{className:"space-y-4 pb-4",children:((null==(q=j[T])?void 0:q.questions)||[]).map(e=>{const s=p[e.id]||"Not answered",t=s.toLowerCase().trim()===e.correct_answer.toLowerCase().trim();return p[e.id],n.jsx("div",{className:"p-4 rounded-lg border "+(t?"border-green-200 bg-green-50":"border-border bg-muted/30"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium "+(t?"bg-green-500 text-white":"bg-muted-foreground text-background"),children:e.question_number}),n.jsxs("div",{className:"flex-1 space-y-3",children:[n.jsx("p",{className:"text-sm leading-relaxed text-foreground font-medium font-inter",children:e.question_text}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-medium text-muted-foreground font-inter",children:"Your answer:"}),n.jsx("span",{className:"text-sm font-medium "+(t?"text-green-600":"text-red-600"),children:s})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-medium text-muted-foreground font-inter",children:"Correct answer:"}),n.jsx("span",{className:"text-sm font-medium text-foreground",children:e.correct_answer})]}),e.explanation&&n.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg border-l-4 border-primary/50",children:[n.jsx("p",{className:"text-xs font-medium mb-2 text-foreground font-inter",children:"ðŸ’¡ Explanation:"}),n.jsx("p",{className:"text-xs leading-relaxed text-muted-foreground font-inter",children:e.explanation})]})]})]})]})},e.id)})})})]})]})]})]})},O=()=>{const e=s(),{toast:i}=h(),{testId:o}=p(),[x,k]=t.useState(3600),[C,O]=t.useState(1),[R,L]=t.useState({}),[E,A]=t.useState({}),[I,z]=t.useState(!0),[F,W]=t.useState(!1),[M,D]=t.useState(!1),[G,B]=t.useState([]),[Y,Q]=t.useState(14);console.log("ðŸš€ EnhancedReadingTest component initialized, passageFontSize:",Y),t.useEffect(()=>{console.log("ðŸ“ Font size changed to:",Y)},[Y]),t.useEffect(()=>{H()},[o]),t.useEffect(()=>{if(x>0&&!F){const e=setTimeout(()=>k(x-1),1e3);return()=>clearTimeout(e)}0!==x||F||J()},[x,F]);const H=async()=>{try{if(!o||"random"===o)return i({title:"Invalid Test",description:"Please select a specific test from the portal.",variant:"destructive"}),void e(-1);const{data:s,error:t}=await $.from("tests").select("*").eq("id",o).single();if(t)throw t;if(!s)return i({title:"Test Not Found",description:"This test doesn't exist. Please check the test ID.",variant:"destructive"}),void e(-1);const{data:n,error:r}=await $.from("questions").select("*").eq("test_id",o).not("question_type","in",'("Task 1","Task 2","title")').order("part_number",{ascending:!0}).order("question_number_in_part",{ascending:!0});if(r)throw r;const{data:a,error:l}=await $.from("questions").select("*").eq("test_id",o).or("question_type.eq.title,question_number_in_part.eq.0").order("part_number",{ascending:!0});if(l)throw l;if(!n||0===n.length)return i({title:"No Questions Available",description:"This test doesn't have questions yet. Please contact your instructor.",variant:"destructive"}),void e(-1);const c={},d=[],m={},u={},x={};null==a||a.forEach(e=>{"title"!==e.question_type&&0!==e.question_number_in_part||(u[e.part_number]=e.question_text,console.log(`ðŸ“‹ Found title for Part ${e.part_number}: "${e.question_text}"`)),e.passage_text&&e.passage_text.trim()&&(x[e.part_number]=e.passage_text)}),n.forEach(e=>{e.passage_text&&e.passage_text.trim()&&(x[e.part_number]=e.passage_text),m[e.part_number]||(m[e.part_number]=[]),m[e.part_number].push(e)}),console.log("ðŸ—‚ï¸ Passage texts found:",Object.keys(x).map(e=>{var s;return`Part ${e}: ${(null==(s=x[parseInt(e)])?void 0:s.length)||0} chars`})),console.log("ðŸ“š Part titles:",u),console.log("Parts organized:",Object.keys(m).map(e=>`Part ${e}: ${m[parseInt(e)].length} questions`)),Object.entries(m).forEach(([e,s])=>{var t,n;const r=parseInt(e),i=s[0];console.log(`Processing Part ${r}:`,{questionCount:s.length,firstQuestionId:null==i?void 0:i.id,hasPassageText:!!(null==i?void 0:i.passage_text),passageTextLength:(null==(t=null==i?void 0:i.passage_text)?void 0:t.length)||0});let a=u[r]||`Reading Passage ${r}`;if(!u[r]&&(null==i?void 0:i.passage_text)){const e=null==(n=i.passage_text.split("\n")[0])?void 0:n.trim();e&&e.length<200&&!e.includes(".")&&(a=e)}let l=x[r];if(!l&&(l=null==i?void 0:i.passage_text,!l))for(const o of s)if(o.passage_text){l=o.passage_text,console.log(`ðŸ“– Found passage content in question ${o.id} for part ${r}`);break}l?console.log(`âœ… Using passage content for Part ${r} (${l.length} chars)`):(console.error(`âŒ No passage content found for Part ${r}`),l="Passage content not available - please contact administrator"),c[r]={passage:{id:`passage-${r}`,title:a,content:l,part_number:r,test_number:parseInt(o)},questions:s.map(e=>({id:e.id,question_number:e.question_number_in_part,question_text:e.question_text,question_type:e.question_type,options:e.choices?Array.isArray(e.choices)?e.choices.map(e=>String(e)):e.choices.split(";"):[],correct_answer:e.correct_answer,explanation:e.explanation||"",passage_id:`passage-${r}`,part_number:e.part_number}))},d.push(...c[r].questions)}),L(c),B(d),z(!1),console.log(`âœ… Loaded ${Object.keys(c).length} parts with ${d.length} total questions`)}catch(s){console.error("Error fetching test:",s),i({title:"Error",description:"Failed to load reading test",variant:"destructive"}),z(!1),e(-1)}},U=(e,s)=>{A(t=>({...t,[e]:s}))},V=()=>{let e=0;return G.forEach(s=>{var t;(null==(t=E[s.id])?void 0:t.toLowerCase().trim())===s.correct_answer.toLowerCase().trim()&&e++}),e},Z=e=>{R[e]&&O(e)},J=async()=>{var e;W(!0),i({title:"ðŸŽ‰ Test Completed!",description:"Processing your results...",duration:2e3}),G.map(e=>{const s=E[e.id]||"",t=s.toLowerCase().trim()===e.correct_answer.toLowerCase().trim();return{question:e,userAnswer:s,isCorrect:t,isSkipped:!E[e.id]}});const s=V(),t=G.length;try{const{data:{user:n}}=await $.auth.getUser();if(n&&(null==(e=R[1])?void 0:e.passage)){const{data:e,error:r}=await $.from("test_results").insert({user_id:n.id,test_type:"reading",section_number:1,total_questions:t,correct_answers:s,score_percentage:s/t*100,time_taken:3600-x,test_data:{answers:E,all_questions:G.map(e=>({id:e.id,question_number:e.question_number,question_type:e.question_type,question_text:e.question_text,correct_answer:e.correct_answer,explanation:e.explanation})),completed_parts:Object.keys(R).map(e=>parseInt(e))}}).select().single();if(r)throw r;for(const[s,t]of Object.entries(R)){const r=parseInt(s),i=t.questions,a=i.map(e=>{var s;return{id:e.id,question_text:e.question_text,question_type:e.question_type,user_answer:E[e.id]||"",correct_answer:e.correct_answer,is_correct:(null==(s=E[e.id])?void 0:s.toLowerCase().trim())===e.correct_answer.toLowerCase().trim(),explanation:e.explanation,options:e.options||[]}}),o={};i.forEach(e=>{var s;const t=e.question_type||"unknown";o[t]||(o[t]={correct:0,total:0}),o[t].total++,(null==(s=E[e.id])?void 0:s.toLowerCase().trim())===e.correct_answer.toLowerCase().trim()&&o[t].correct++});const l=a.filter(e=>e.is_correct).length/a.length;await $.from("reading_test_results").insert({user_id:n.id,test_result_id:e.id,passage_title:t.passage.title,passage_text:t.passage.content,questions_data:a,reading_time_seconds:Math.floor((3600-x)/Object.keys(R).length),comprehension_score:l,question_type_performance:o,detailed_feedback:`Passage ${r}: ${a.filter(e=>e.is_correct).length}/${a.length} correct (${Math.round(100*l)}%)`})}console.log("âœ… Reading test results saved successfully")}}catch(n){console.error("Error saving test result:",n)}setTimeout(()=>{D(!0)},2e3)},K=()=>Object.keys(E).length,X=e=>{var s,t;const n=(null==(s=e.question_text)?void 0:s.toLowerCase())||"",r=(null==(t=e.correct_answer)?void 0:t.toLowerCase())||"";return n.includes("statement")&&(r.includes("yes")||r.includes("no")||r.includes("not given"))?"yes_no_not_given":n.includes("statement")&&(r.includes("true")||r.includes("false")||r.includes("not given"))?"true_false_not_given":n.includes("complete the summary")||n.includes("complete the text")||n.includes("choose from the list")||n.includes("write the correct letter")?"completion":n.includes("match each statement")||n.includes("match each")||n.includes("correct theorist")||n.includes("correct letter, a, b, or c")?"matching_features":e.options&&e.options.length>0&&(n.includes("choose the correct")||n.includes("which of the following"))?"multiple_choice":e.question_type||"short_answer"};if(I)return n.jsx(g,{title:"Loading Reading Test",children:n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),n.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading Reading Test..."})]})})});const ee=R[C];if(M){const e=V();return G.length,n.jsx(P,{score:e,timeTaken:3600-x,answers:E,questions:G,onRetake:()=>window.location.reload(),testParts:R})}return ee?n.jsx(f,{children:n.jsx(g,{title:`Reading Test ${o} - Part ${C}`,children:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"container mx-auto px-3 py-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>e("/ielts-portal"),children:[n.jsx(a,{className:"w-3 h-3 mr-1"}),"Back"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(j,{className:"w-4 h-4 text-muted-foreground"}),n.jsx("span",{className:"font-mono text-sm",children:(e=>{const s=Math.floor(e/3600),t=Math.floor(e%3600/60),n=e%60;return`${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`})(x)})]}),n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Questions: ",K(),"/",G.length]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[Object.keys(R).map(e=>{const s=parseInt(e),t=(e=>R[e]?R[e].questions.filter(e=>E[e.id]).length:0)(s),i=R[s].questions.length;return n.jsxs(r,{variant:C===s?"default":"outline",size:"sm",onClick:()=>Z(s),className:"px-2 h-7 text-xs",children:["P",s," ",t,"/",i]},s)}),n.jsx(r,{onClick:J,disabled:F,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white px-3 h-7 text-xs",children:F?"Submitting...":"Submit"})]})]}),n.jsx(v,{value:K()/G.length*100,className:"h-1"})]})}),n.jsxs("div",{className:"flex gap-2 h-[calc(100vh-120px)] px-2",children:[n.jsxs(l,{className:"flex flex-col w-[45%] h-full",children:[n.jsx(d,{className:"flex-shrink-0 pb-2 px-3 py-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(m,{className:"flex items-center gap-1 text-sm font-medium",children:[n.jsx(N,{className:"w-4 h-4"}),ee.passage.title]}),n.jsxs(u,{variant:"outline",className:"w-fit text-xs h-5 mt-1",children:["Part ",C,"/",Object.keys(R).length]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(r,{variant:"ghost",size:"sm",onClick:()=>{console.log("Decreasing font size from:",Y),Q(e=>Math.max(e-2,10))},className:"h-6 w-6 p-0",disabled:Y<=10,children:n.jsx(S,{className:"w-3 h-3"})}),n.jsxs("span",{className:"text-xs text-muted-foreground px-1",children:[Y,"px"]}),n.jsx(r,{variant:"ghost",size:"sm",onClick:()=>{console.log("Increasing font size from:",Y),Q(e=>Math.min(e+2,20))},className:"h-6 w-6 p-0",disabled:Y>=20,children:n.jsx(T,{className:"w-3 h-3"})})]})]})}),n.jsx(c,{className:"flex-1 overflow-y-auto min-h-0 p-3",children:n.jsx("div",{className:"prose prose-sm max-w-none relative",children:n.jsx("div",{className:"whitespace-pre-wrap leading-relaxed select-text",style:{fontSize:`${Y}px`,lineHeight:"1.6"},children:ee.passage.content})})})]}),n.jsxs(l,{className:"flex flex-col w-[55%] h-full",children:[n.jsxs(d,{className:"flex-shrink-0 pb-2 px-3 py-2",children:[n.jsxs(m,{className:"text-sm font-medium",children:["Questions ",(()=>{if(!(null==ee?void 0:ee.questions)||0===ee.questions.length)return"";const e=ee.questions.map(e=>e.question_number).filter(e=>e>0).sort((e,s)=>e-s);return 0===e.length?"":1===e.length?e[0].toString():`${e[0]} - ${e[e.length-1]}`})()]}),n.jsxs(u,{variant:"secondary",className:"text-xs h-5",children:[ee.questions.filter(e=>E[e.id]).length,"/",ee.questions.length," answered"]})]}),n.jsx(c,{className:"flex-1 overflow-y-auto min-h-0 p-3 scroll-smooth",children:n.jsx("div",{className:"space-y-4 pb-4",children:(()=>{if(!(null==ee?void 0:ee.questions))return[];const e=[];let s=null;return console.log("ðŸ” Grouping questions for Part",C,"- Total questions:",ee.questions.length),ee.questions.forEach((t,n)=>{var r;const i=X(t),a=(null==(r=t.question_type)?void 0:r.toLowerCase())||"";if(console.log(`Question ${t.question_number}: Original="${a}" â†’ Detected="${i}"`),s&&s.type===i)s.questions.push(t),console.log(`âž• Added question ${t.question_number} to existing group "${i}"`);else{const n=ee.questions.filter(e=>X(e)===i).map(e=>e.question_number).sort((e,s)=>e-s),r=1===n.length?n[0].toString():`${n[0]}-${n[n.length-1]}`,a=((e,s)=>{const t=(null==e?void 0:e.toLowerCase())||"";return console.log(`ðŸŽ¯ Getting instruction for type: "${t}", range: "${s}"`),t.includes("true")||t.includes("false")||t.includes("not given")?t.includes("yes")||t.includes("no")?`Do the following statements agree with the views of the writer in the reading passage? In boxes ${s} on your answer sheet, write YES if the statement agrees with the views of the writer, NO if the statement contradicts the views of the writer, or NOT GIVEN if it is impossible to say what the writer thinks about this.`:`Do the following statements agree with the information given in the reading passage? In boxes ${s} on your answer sheet, write TRUE if the statement agrees with the information, FALSE if the statement contradicts the information, or NOT GIVEN if there is no information on this.`:t.includes("matching")&&t.includes("heading")?`The reading passage has several paragraphs. Choose the correct heading for each paragraph from the list of headings below. Write the correct number in boxes ${s} on your answer sheet.`:t.includes("matching")&&t.includes("paragraph")?`Which paragraph contains the following information? Write the correct letter in boxes ${s} on your answer sheet. NB You may use any letter more than once.`:t.includes("matching")&&(t.includes("feature")||t.includes("theorist"))?`Look at the following statements and match each statement with the correct option from the list below. Write the correct letter in boxes ${s} on your answer sheet.`:t.includes("matching")&&t.includes("sentence")?`Complete each sentence with the correct ending below. Write the correct letter in boxes ${s} on your answer sheet.`:t.includes("multiple")&&t.includes("choice")?`Choose the correct letter, A, B, C, or D. Write the correct letter in boxes ${s} on your answer sheet.`:t.includes("completion")||t.includes("summary")?`Complete the summary below using the list of words provided. Write the correct letter in boxes ${s} on your answer sheet.`:t.includes("flow")||t.includes("diagram")?`Complete the flow chart/diagram below. Choose NO MORE THAN TWO WORDS AND/OR A NUMBER from the passage for each answer. Write your answers in boxes ${s} on your answer sheet.`:t.includes("table")?`Complete the table below. Choose NO MORE THAN TWO WORDS AND/OR A NUMBER from the passage for each answer. Write your answers in boxes ${s} on your answer sheet.`:t.includes("short")&&t.includes("answer")?`Answer the questions below. Choose NO MORE THAN TWO WORDS AND/OR A NUMBER from the passage for each answer. Write your answers in boxes ${s} on your answer sheet.`:(console.log(`âš ï¸ No specific instruction found for type: "${t}"`),`Read the questions below and answer according to the passage. Write your answers in boxes ${s} on your answer sheet.`)})(i,r);console.log(`ðŸ“‹ New group for type "${i}": Range ${r}, Instruction: ${a?"YES":"NO"}`),s={type:i,questions:[t],instruction:a},e.push(s)}}),console.log("ðŸ“Š Final groups:",e.map(e=>`${e.type} (${e.questions.length} questions) - ${e.instruction?"HAS":"NO"} instruction`)),e})().map((e,s)=>n.jsxs("div",{className:"space-y-3",children:[e.instruction&&n.jsx("div",{className:"bg-muted/30 p-3 rounded-lg border-l-4 border-primary",children:n.jsx("p",{className:"text-sm font-medium text-foreground leading-relaxed",children:e.instruction})}),e.questions.map(e=>n.jsx("div",{className:"border-b pb-4 last:border-b-0",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(u,{variant:"outline",className:"mt-1 flex-shrink-0",children:e.question_number}),n.jsxs("div",{className:"flex-1 space-y-3",children:[n.jsx("div",{className:"space-y-2",children:n.jsx("p",{className:"font-medium leading-relaxed text-sm",children:e.question_text})}),(()=>{const s=X(e);return s.includes("yes_no_not_given")?n.jsxs(w,{value:E[e.id]||"",onValueChange:s=>U(e.id,s),children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"Yes",id:`${e.id}-yes`}),n.jsx(_,{htmlFor:`${e.id}-yes`,className:"cursor-pointer",children:"Yes"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"No",id:`${e.id}-no`}),n.jsx(_,{htmlFor:`${e.id}-no`,className:"cursor-pointer",children:"No"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"Not Given",id:`${e.id}-notgiven`}),n.jsx(_,{htmlFor:`${e.id}-notgiven`,className:"cursor-pointer",children:"Not Given"})]})]}):s.includes("true_false_not_given")?n.jsxs(w,{value:E[e.id]||"",onValueChange:s=>U(e.id,s),children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"True",id:`${e.id}-true`}),n.jsx(_,{htmlFor:`${e.id}-true`,className:"cursor-pointer",children:"True"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"False",id:`${e.id}-false`}),n.jsx(_,{htmlFor:`${e.id}-false`,className:"cursor-pointer",children:"False"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:"Not Given",id:`${e.id}-notgiven`}),n.jsx(_,{htmlFor:`${e.id}-notgiven`,className:"cursor-pointer",children:"Not Given"})]})]}):s.includes("multiple_choice")&&e.options&&e.options.length>0?n.jsx(w,{value:E[e.id]||"",onValueChange:s=>U(e.id,s),children:e.options.map((s,t)=>n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:s,id:`${e.id}-${t}`}),n.jsx(_,{htmlFor:`${e.id}-${t}`,className:"cursor-pointer",children:s})]},t))}):s.includes("matching")&&e.options&&e.options.length>0?n.jsx(w,{value:E[e.id]||"",onValueChange:s=>U(e.id,s),children:e.options.map((s,t)=>{var r;const i=(null==(r=s.match(/^([ivxlcdm]+|[a-z])\./i))?void 0:r[1])||s;return n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(y,{value:i,id:`${e.id}-${t}`}),n.jsx(_,{htmlFor:`${e.id}-${t}`,className:"cursor-pointer",children:s})]},t)})}):n.jsxs("div",{className:"space-y-2",children:[n.jsx(q,{value:E[e.id]||"",onChange:s=>U(e.id,s.target.value),placeholder:"Type your answer here...",className:"max-w-md"}),(s.includes("completion")||s.includes("short"))&&n.jsx("p",{className:"text-xs text-muted-foreground",children:"ðŸ’¡ Remember to check the word limit specified in the question"})]})})()]})]})},e.id))]},s))})}),n.jsx("div",{className:"flex-shrink-0 border-t p-4",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs(r,{variant:"outline",onClick:()=>Z(C-1),disabled:1===C,children:[n.jsx(a,{className:"w-4 h-4 mr-2"}),"Previous Part"]}),C===Object.keys(R).length?n.jsx(r,{onClick:J,className:"bg-primary hover:bg-primary/90",children:"Submit Test"}):n.jsxs(r,{onClick:()=>Z(C+1),disabled:!R[C+1],children:["Next Part",n.jsx(b,{className:"w-4 h-4 ml-2"})]})]})})]})]})]})})}):n.jsx(g,{title:"Reading Test - Part Not Available",children:n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("p",{className:"text-lg text-muted-foreground",children:["Part ",C," not available"]}),n.jsx(r,{onClick:()=>O(1),className:"mt-4",children:"Go to Part 1"})]})})})};export{O as default};
