import{u as e,a2 as s,am as r,a0 as a,r as t,j as l,a3 as o,bg as i,a4 as n,an as c,a8 as d,ca as m,C as x,a as g,K as h,l as p,e as u,ai as b,W as j,B as v,a1 as f,a6 as y}from"./index-CbHGm2wy.js";import{T as N,a as w,b as _}from"./tabs-CThqafbK.js";import{s as k}from"./supabase-DWL4C3fA.js";import{T as C}from"./trophy-obgLcyGh.js";import{Z as S}from"./zap-DCPgPgpz.js";const P={book:l.jsx(u,{className:"w-6 h-6"}),star:l.jsx(b,{className:"w-6 h-6"}),target:l.jsx(f,{className:"w-6 h-6"}),zap:l.jsx(S,{className:"w-6 h-6"}),trophy:l.jsx(C,{className:"w-6 h-6"}),graduation:l.jsx(y,{className:"w-6 h-6"})},$={beginner:{bg:"from-emerald-400 to-green-500",text:"text-emerald-600",badge:"bg-emerald-100 text-emerald-700"},intermediate:{bg:"from-blue-400 to-indigo-500",text:"text-blue-600",badge:"bg-blue-100 text-blue-700"},advanced:{bg:"from-purple-400 to-violet-500",text:"text-purple-600",badge:"bg-purple-100 text-purple-700"}},E={beginner:"Beginner",intermediate:"Intermediate",advanced:"Advanced"},B=()=>{const b=e(),{user:j}=s(),{i18n:v}=r(),f=a(),y="note"===f.theme.name,[S,P]=t.useState([]),[B,M]=t.useState({}),[L,q]=t.useState(!0),[z,A]=t.useState("all"),[I,T]=t.useState({completed:0,total:0,percentage:0});t.useEffect(()=>{F()},[j,v.language]);const F=async()=>{q(!0);try{const e=v.language||"en",{data:s,error:r}=await k.from("grammar_topics").select("\n          id,\n          slug,\n          level,\n          topic_order,\n          icon,\n          color,\n          is_published,\n          grammar_topic_translations!inner(title, description)\n        ").eq("is_published",!0).eq("grammar_topic_translations.language_code",e).order("level").order("topic_order");if(r){console.error("Error loading topics:",r);const{data:e}=await k.from("grammar_topics").select("\n            id,\n            slug,\n            level,\n            topic_order,\n            icon,\n            color,\n            is_published,\n            grammar_topic_translations(title, description)\n          ").eq("is_published",!0).order("level").order("topic_order");if(e){const s=e.map(e=>{var s,r,a,t;return{...e,title:(null==(r=null==(s=e.grammar_topic_translations)?void 0:s[0])?void 0:r.title)||e.slug.replace(/-/g," "),description:(null==(t=null==(a=e.grammar_topic_translations)?void 0:a[0])?void 0:t.description)||""}});P(s)}}else if(s){const e=s.map(e=>{var s,r,a,t;return{...e,title:(null==(r=null==(s=e.grammar_topic_translations)?void 0:s[0])?void 0:r.title)||e.slug.replace(/-/g," "),description:(null==(t=null==(a=e.grammar_topic_translations)?void 0:a[0])?void 0:t.description)||""}});P(e)}if(j){const{data:e,error:r}=await k.from("user_grammar_progress").select("*").eq("user_id",j.id);if(!r&&e){const r={};e.forEach(e=>{r[e.topic_id]=e}),M(r);const a=e.filter(e=>e.mastery_level>=80).length,t=(null==s?void 0:s.length)||0;T({completed:a,total:t,percentage:t>0?Math.round(a/t*100):0})}}}catch(e){console.error("Error loading grammar data:",e)}finally{q(!1)}},O="all"===z?S:S.filter(e=>e.level===z),Y={beginner:O.filter(e=>"beginner"===e.level),intermediate:O.filter(e=>"intermediate"===e.level),advanced:O.filter(e=>"advanced"===e.level)},H=e=>{b(`/grammar/${e.slug}`)};return L?l.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:f.theme.colors.background},children:l.jsx(o,{})}):l.jsxs("div",{className:"min-h-screen relative "+(y?"font-serif":""),style:{backgroundColor:f.theme.colors.background},children:[l.jsx(i,{title:"Grammar Learning Center",description:"Master English grammar with interactive lessons and exercises. Learn grammar rules, practice with multiple exercise types, and track your progress.",keywords:"English grammar, grammar lessons, grammar exercises, learn grammar, English learning",type:"website"}),!y&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50/50 via-blue-50/50 to-purple-50/50"}),l.jsx("div",{className:"relative z-10",children:l.jsx(n,{title:"Grammar",showBackButton:!0,children:l.jsxs("div",{className:"space-y-6 max-w-6xl mx-auto px-4 md:px-6 pb-12",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsxs("button",{onClick:()=>b("/hero"),className:"inline-flex items-center gap-2 px-2 py-1 h-8 text-sm font-medium transition-colors rounded-md hover:bg-gray-100",style:{color:f.textSecondary},children:[!y&&l.jsx(c,{className:"h-4 w-4"}),y&&l.jsx("span",{children:"Home"})]}),l.jsx("span",{style:{color:f.textSecondary},children:"/"}),l.jsx("span",{className:"text-sm font-medium",style:{color:f.textPrimary},children:"Grammar"})]}),l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-black tracking-tight mb-4",style:{color:f.textPrimary},children:"Grammar Learning Center"}),l.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto mb-4",children:"Master English grammar step by step with clear explanations, examples, and interactive exercises."}),l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[!y&&l.jsx(d,{className:"w-4 h-4 text-muted-foreground"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Learn in your language:"}),l.jsx(m,{})]})]}),j&&l.jsx(x,{className:"mb-8 overflow-hidden",style:{backgroundColor:f.theme.colors.cardBackground,borderColor:f.border},children:l.jsx(g,{className:"p-6",children:l.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[!y&&l.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-emerald-400 to-blue-500 flex items-center justify-center",children:l.jsx(C,{className:"w-8 h-8 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold",style:{color:f.textPrimary},children:"Your Progress"}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:[I.completed," of ",I.total," topics mastered"]})]})]}),l.jsxs("div",{className:"w-full md:w-64",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{style:{color:f.textSecondary},children:"Overall Mastery"}),l.jsxs("span",{className:"font-semibold",style:{color:f.textPrimary},children:[I.percentage,"%"]})]}),l.jsx(h,{value:I.percentage,className:"h-3"})]})]})})}),l.jsx(N,{value:z,onValueChange:e=>A(e),className:"mb-6",children:l.jsxs(w,{className:"grid w-full grid-cols-4 max-w-md mx-auto",style:y?{backgroundColor:"transparent",border:`1px solid ${f.border}`}:void 0,children:[l.jsx(_,{value:"all",style:y?{color:f.textPrimary}:void 0,children:"All"}),l.jsx(_,{value:"beginner",className:y?"":"text-emerald-600",style:y?{color:f.textSecondary}:void 0,children:"Beginner"}),l.jsx(_,{value:"intermediate",className:y?"":"text-blue-600",style:y?{color:f.textSecondary}:void 0,children:"Intermediate"}),l.jsx(_,{value:"advanced",className:y?"":"text-purple-600",style:y?{color:f.textSecondary}:void 0,children:"Advanced"})]})}),"all"===z?Object.entries(Y).map(([e,s])=>s.length>0&&l.jsxs("div",{className:"mb-10",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[!y&&l.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${$[e].bg}`}),l.jsx("h2",{className:"text-2xl font-bold",style:{color:f.textPrimary},children:E[e]}),l.jsxs(p,{variant:"secondary",className:y?"":$[e].badge,style:y?{backgroundColor:"transparent",border:`1px solid ${f.border}`,color:f.textSecondary}:void 0,children:[s.length," topics"]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.map(e=>l.jsx(G,{topic:e,progress:B[e.id],onClick:()=>H(e),themeStyles:f},e.id))})]},e)):l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:O.map(e=>l.jsx(G,{topic:e,progress:B[e.id],onClick:()=>H(e),themeStyles:f},e.id))}),0===S.length&&l.jsxs("div",{className:"text-center py-16",children:[!y&&l.jsx(u,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:f.textPrimary},children:"No Topics Available Yet"}),l.jsx("p",{className:"text-muted-foreground",children:"Grammar lessons are being prepared. Check back soon!"})]})]})})})]})},G=({topic:e,progress:s,onClick:r,themeStyles:a})=>{const t="note"===a.theme.name,o=s?s.mastery_level>=80?"mastered":s.theory_completed||s.exercises_completed>0?"in_progress":"not_started":"not_started",i=$[e.level],n=P[e.icon]||l.jsx(u,{className:"w-6 h-6"});return l.jsxs(x,{className:"cursor-pointer hover:shadow-lg transition-all duration-300 hover:scale-[1.02] overflow-hidden group",onClick:r,style:{backgroundColor:a.theme.colors.cardBackground,borderColor:a.border},children:[!t&&l.jsx("div",{className:`h-1.5 bg-gradient-to-r ${i.bg}`}),t&&l.jsx("div",{className:"h-1.5",style:{backgroundColor:a.theme.colors.border}}),l.jsxs(g,{className:"p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[!t&&l.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${i.bg} flex items-center justify-center text-white`,children:n}),"mastered"===o&&l.jsxs("div",{className:"flex items-center gap-1 "+(t?"":"text-amber-500"),style:t?{color:a.textSecondary}:void 0,children:[!t&&l.jsxs(l.Fragment,{children:[l.jsx(b,{className:"w-4 h-4 fill-current"}),l.jsx(b,{className:"w-4 h-4 fill-current"}),l.jsx(b,{className:"w-4 h-4 fill-current"})]}),t&&l.jsx("span",{className:"text-sm font-bold",children:"Mastered"})]}),"in_progress"===o&&l.jsx(p,{variant:"secondary",className:t?"":"bg-blue-100 text-blue-700 text-xs",style:t?{backgroundColor:"transparent",border:`1px solid ${a.border}`,color:a.textSecondary}:void 0,children:"In Progress"}),"not_started"===o&&!t&&l.jsx(j,{className:"w-5 h-5 text-muted-foreground group-hover:text-emerald-500 transition-colors"})]}),l.jsx("h3",{className:"font-semibold mb-1 line-clamp-1",style:{color:a.textPrimary},children:e.title}),l.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-3",children:e.description}),s&&(s.theory_completed||s.exercises_completed>0)&&l.jsxs("div",{className:"mt-auto",children:[l.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[l.jsx("span",{className:"text-muted-foreground",children:"Mastery"}),l.jsxs("span",{className:t?"":i.text,style:t?{color:a.textSecondary}:void 0,children:[s.mastery_level,"%"]})]}),l.jsx(h,{value:s.mastery_level,className:"h-1.5"})]}),"not_started"===o&&l.jsx(v,{size:"sm",className:`w-full mt-2 ${t?"":`bg-gradient-to-r ${i.bg}`} text-white hover:opacity-90`,style:t?{backgroundColor:a.theme.colors.buttonPrimary}:void 0,children:"Start Learning"})]})]})};export{B as default};
