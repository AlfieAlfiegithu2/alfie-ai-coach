import{u as e,r as s,j as r}from"./vendor-react-JN_hy__U.js";import{E as t,q as a,s as l,x as o,U as n,y as i,a8 as c,C as d,a as m,P as x,e as g,B as p}from"./index-DXpPY1B7.js";import{T as h,a as u,b}from"./tabs-CUO_kQ2m.js";import{u as j}from"./vendor-i18n-DlHrixAm.js";import{aG as v,G as f,be as y,ao as N,F as w,aL as _,K as k,bf as C,an as S}from"./vendor-ui-DG51EGkO.js";import"./vendor-react-dom-Cb-iy8Oc.js";import"./vendor-animation-ClPlB6zo.js";import"./vendor-utils-D5HPTFR9.js";import"./vendor-supabase-D7XYLCUu.js";import"./vendor-charts-BpOKEG9Z.js";import"./vendor-date-DT7Rq6D9.js";const P={book:r.jsx(N,{className:"w-6 h-6"}),star:r.jsx(w,{className:"w-6 h-6"}),target:r.jsx(k,{className:"w-6 h-6"}),zap:r.jsx(C,{className:"w-6 h-6"}),trophy:r.jsx(y,{className:"w-6 h-6"}),graduation:r.jsx(S,{className:"w-6 h-6"})},E={beginner:{bg:"from-emerald-400 to-green-500",text:"text-emerald-600",badge:"bg-emerald-100 text-emerald-700"},intermediate:{bg:"from-blue-400 to-indigo-500",text:"text-blue-600",badge:"bg-blue-100 text-blue-700"},advanced:{bg:"from-purple-400 to-violet-500",text:"text-purple-600",badge:"bg-purple-100 text-purple-700"}},$={beginner:"Beginner",intermediate:"Intermediate",advanced:"Advanced"},B=()=>{const p=e(),{user:w}=t(),{i18n:_}=j(),k=a(),C="note"===k.theme.name,[S,P]=s.useState([]),[B,L]=s.useState({}),[M,q]=s.useState(!0),[A,z]=s.useState("all"),[I,F]=s.useState({completed:0,total:0,percentage:0});s.useEffect(()=>{O()},[w,_.language]);const O=async()=>{q(!0);try{const e=_.language||"en",{data:s,error:r}=await l.from("grammar_topics").select("\n          id,\n          slug,\n          level,\n          topic_order,\n          icon,\n          color,\n          is_published,\n          grammar_topic_translations!inner(title, description)\n        ").eq("is_published",!0).eq("grammar_topic_translations.language_code",e).order("level").order("topic_order");if(r){console.error("Error loading topics:",r);const{data:e}=await l.from("grammar_topics").select("\n            id,\n            slug,\n            level,\n            topic_order,\n            icon,\n            color,\n            is_published,\n            grammar_topic_translations(title, description)\n          ").eq("is_published",!0).order("level").order("topic_order");if(e){const s=e.map(e=>{var s,r,t,a;return{...e,title:(null==(r=null==(s=e.grammar_topic_translations)?void 0:s[0])?void 0:r.title)||e.slug.replace(/-/g," "),description:(null==(a=null==(t=e.grammar_topic_translations)?void 0:t[0])?void 0:a.description)||""}});P(s)}}else if(s){const e=s.map(e=>{var s,r,t,a;return{...e,title:(null==(r=null==(s=e.grammar_topic_translations)?void 0:s[0])?void 0:r.title)||e.slug.replace(/-/g," "),description:(null==(a=null==(t=e.grammar_topic_translations)?void 0:t[0])?void 0:a.description)||""}});P(e)}if(w){const{data:e,error:r}=await l.from("user_grammar_progress").select("*").eq("user_id",w.id);if(!r&&e){const r={};e.forEach(e=>{r[e.topic_id]=e}),L(r);const t=e.filter(e=>e.mastery_level>=80).length,a=(null==s?void 0:s.length)||0;F({completed:t,total:a,percentage:a>0?Math.round(t/a*100):0})}}}catch(e){console.error("Error loading grammar data:",e)}finally{q(!1)}},T="all"===A?S:S.filter(e=>e.level===A),Y={beginner:T.filter(e=>"beginner"===e.level),intermediate:T.filter(e=>"intermediate"===e.level),advanced:T.filter(e=>"advanced"===e.level)},H=e=>{p(`/grammar/${e.slug}`)};return M?r.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:k.theme.colors.background},children:r.jsx(o,{})}):r.jsxs("div",{className:"min-h-screen relative "+(C?"font-serif":""),style:{backgroundColor:k.theme.colors.background},children:[r.jsx(n,{title:"Grammar Learning Center",description:"Master English grammar with interactive lessons and exercises. Learn grammar rules, practice with multiple exercise types, and track your progress.",keywords:"English grammar, grammar lessons, grammar exercises, learn grammar, English learning",type:"website"}),!C&&r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50/50 via-blue-50/50 to-purple-50/50"}),r.jsx("div",{className:"relative z-10",children:r.jsx(i,{title:"Grammar",showBackButton:!0,children:r.jsxs("div",{className:"space-y-6 max-w-6xl mx-auto px-4 md:px-6 pb-12",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsxs("button",{onClick:()=>p("/hero"),className:"inline-flex items-center gap-2 px-2 py-1 h-8 text-sm font-medium transition-colors rounded-md hover:bg-gray-100",style:{color:k.textSecondary},children:[!C&&r.jsx(v,{className:"h-4 w-4"}),C&&r.jsx("span",{children:"Home"})]}),r.jsx("span",{style:{color:k.textSecondary},children:"/"}),r.jsx("span",{className:"text-sm font-medium",style:{color:k.textPrimary},children:"Grammar"})]}),r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-4xl md:text-5xl font-black tracking-tight mb-4",style:{color:k.textPrimary},children:"Grammar Learning Center"}),r.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto mb-4",children:"Master English grammar step by step with clear explanations, examples, and interactive exercises."}),r.jsxs("div",{className:"flex items-center justify-center gap-2",children:[!C&&r.jsx(f,{className:"w-4 h-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm text-muted-foreground",children:"Learn in your language:"}),r.jsx(c,{})]})]}),w&&r.jsx(d,{className:"mb-8 overflow-hidden",style:{backgroundColor:k.theme.colors.cardBackground,borderColor:k.border},children:r.jsx(m,{className:"p-6",children:r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[!C&&r.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-emerald-400 to-blue-500 flex items-center justify-center",children:r.jsx(y,{className:"w-8 h-8 text-white"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold",style:{color:k.textPrimary},children:"Your Progress"}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[I.completed," of ",I.total," topics mastered"]})]})]}),r.jsxs("div",{className:"w-full md:w-64",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{style:{color:k.textSecondary},children:"Overall Mastery"}),r.jsxs("span",{className:"font-semibold",style:{color:k.textPrimary},children:[I.percentage,"%"]})]}),r.jsx(x,{value:I.percentage,className:"h-3"})]})]})})}),r.jsx(h,{value:A,onValueChange:e=>z(e),className:"mb-6",children:r.jsxs(u,{className:"grid w-full grid-cols-4 max-w-md mx-auto",style:C?{backgroundColor:"transparent",border:`1px solid ${k.border}`}:void 0,children:[r.jsx(b,{value:"all",style:C?{color:k.textPrimary}:void 0,children:"All"}),r.jsx(b,{value:"beginner",className:C?"":"text-emerald-600",style:C?{color:k.textSecondary}:void 0,children:"Beginner"}),r.jsx(b,{value:"intermediate",className:C?"":"text-blue-600",style:C?{color:k.textSecondary}:void 0,children:"Intermediate"}),r.jsx(b,{value:"advanced",className:C?"":"text-purple-600",style:C?{color:k.textSecondary}:void 0,children:"Advanced"})]})}),"all"===A?Object.entries(Y).map(([e,s])=>s.length>0&&r.jsxs("div",{className:"mb-10",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[!C&&r.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${E[e].bg}`}),r.jsx("h2",{className:"text-2xl font-bold",style:{color:k.textPrimary},children:$[e]}),r.jsxs(g,{variant:"secondary",className:C?"":E[e].badge,style:C?{backgroundColor:"transparent",border:`1px solid ${k.border}`,color:k.textSecondary}:void 0,children:[s.length," topics"]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:s.map(e=>r.jsx(G,{topic:e,progress:B[e.id],onClick:()=>H(e),themeStyles:k},e.id))})]},e)):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:T.map(e=>r.jsx(G,{topic:e,progress:B[e.id],onClick:()=>H(e),themeStyles:k},e.id))}),0===S.length&&r.jsxs("div",{className:"text-center py-16",children:[!C&&r.jsx(N,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),r.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:k.textPrimary},children:"No Topics Available Yet"}),r.jsx("p",{className:"text-muted-foreground",children:"Grammar lessons are being prepared. Check back soon!"})]})]})})})]})},G=({topic:e,progress:s,onClick:t,themeStyles:a})=>{const l="note"===a.theme.name,o=s?s.mastery_level>=80?"mastered":s.theory_completed||s.exercises_completed>0?"in_progress":"not_started":"not_started",n=E[e.level],i=P[e.icon]||r.jsx(N,{className:"w-6 h-6"});return r.jsxs(d,{className:"cursor-pointer hover:shadow-lg transition-all duration-300 hover:scale-[1.02] overflow-hidden group",onClick:t,style:{backgroundColor:a.theme.colors.cardBackground,borderColor:a.border},children:[!l&&r.jsx("div",{className:`h-1.5 bg-gradient-to-r ${n.bg}`}),l&&r.jsx("div",{className:"h-1.5",style:{backgroundColor:a.theme.colors.border}}),r.jsxs(m,{className:"p-4",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[!l&&r.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${n.bg} flex items-center justify-center text-white`,children:i}),"mastered"===o&&r.jsxs("div",{className:"flex items-center gap-1 "+(l?"":"text-amber-500"),style:l?{color:a.textSecondary}:void 0,children:[!l&&r.jsxs(r.Fragment,{children:[r.jsx(w,{className:"w-4 h-4 fill-current"}),r.jsx(w,{className:"w-4 h-4 fill-current"}),r.jsx(w,{className:"w-4 h-4 fill-current"})]}),l&&r.jsx("span",{className:"text-sm font-bold",children:"Mastered"})]}),"in_progress"===o&&r.jsx(g,{variant:"secondary",className:l?"":"bg-blue-100 text-blue-700 text-xs",style:l?{backgroundColor:"transparent",border:`1px solid ${a.border}`,color:a.textSecondary}:void 0,children:"In Progress"}),"not_started"===o&&!l&&r.jsx(_,{className:"w-5 h-5 text-muted-foreground group-hover:text-emerald-500 transition-colors"})]}),r.jsx("h3",{className:"font-semibold mb-1 line-clamp-1",style:{color:a.textPrimary},children:e.title}),r.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mb-3",children:e.description}),s&&(s.theory_completed||s.exercises_completed>0)&&r.jsxs("div",{className:"mt-auto",children:[r.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[r.jsx("span",{className:"text-muted-foreground",children:"Mastery"}),r.jsxs("span",{className:l?"":n.text,style:l?{color:a.textSecondary}:void 0,children:[s.mastery_level,"%"]})]}),r.jsx(x,{value:s.mastery_level,className:"h-1.5"})]}),"not_started"===o&&r.jsx(p,{size:"sm",className:`w-full mt-2 ${l?"":`bg-gradient-to-r ${n.bg}`} text-white hover:opacity-90`,style:l?{backgroundColor:a.theme.colors.buttonPrimary}:void 0,children:"Start Learning"})]})]})};export{B as default};
