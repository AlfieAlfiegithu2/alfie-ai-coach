import{r as e,j as r,u as o}from"./vendor-react-rLLBBC7n.js";import{q as a,s as t,E as s,d as n,x as l,C as i,a as d,B as c}from"./index-KxDfHqNJ.js";import{C as m}from"./checkbox-BqZ742qD.js";import{U as u,az as g,ao as b}from"./vendor-ui-BGi_EvHx.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";const h=e.memo(({word:o,onRemove:s,isEditMode:n=!1,isSelected:l=!1,onToggleSelect:i})=>{var d;const[c,u]=e.useState(!1),[g,b]=e.useState(0),h=e.useRef(null),f=a(),x=["US","UK","AUS","IND"],y=async()=>{if(c)return window.speechSynthesis.cancel(),h.current&&(h.current.pause(),h.current.currentTime=0),void u(!1);const e=x[g];b(e=>(e+1)%x.length),u(!0);try{console.log(`ðŸŽµ Playing ${e} accent for:`,o.word);const{data:r,error:a}=await t.functions.invoke("audio-cache",{body:{text:o.word,accent:e,question_id:`word-${o.word}-${e}-${Date.now()}`}});if(a)throw a;if((null==r?void 0:r.success)&&(null==r?void 0:r.audio_url)){console.log("âœ… ElevenLabs Success! Playing high-quality audio:",r.audio_url);const e=new Audio(r.audio_url);return h.current=e,e.addEventListener("error",e=>{console.error("Audio playback error:",e),p()}),e.addEventListener("ended",()=>{u(!1)}),await e.play(),void console.log("ðŸŽµ High-quality audio playing successfully")}}catch(r){console.log("ElevenLabs failed, using browser TTS fallback:",r.message)}p()},p=()=>{console.log("ðŸ”„ Using browser TTS fallback");const e=new SpeechSynthesisUtterance(o.word);e.rate=.8,e.volume=1;const r=window.speechSynthesis.getVoices();let a=r.find(e=>e.name.includes("Google")&&e.lang.startsWith("en"))||r.find(e=>e.lang.startsWith("en"));a&&(e.voice=a),e.onend=()=>u(!1),e.onerror=()=>u(!1),window.speechSynthesis.speak(e)};return r.jsxs("div",{className:"relative",children:[n&&r.jsx("div",{className:"absolute -top-2 -left-2 z-20",children:r.jsx(m,{checked:l,onCheckedChange:()=>null==i?void 0:i(o.id),className:"w-6 h-6 rounded-full shadow-sm transition-all",style:{backgroundColor:"glassmorphism"===f.theme.name||"dark"===f.theme.name?"rgba(255,255,255,0.9)":"minimalist"===f.theme.name?"#ffffff":"rgba(255,255,255,0.9)",borderColor:f.border,borderWidth:"2px"}})}),r.jsx("div",{className:"word-card word-card-hover-reveal "+(n?"cursor-pointer":"cursor-pointer hover:shadow-lg transition-shadow"),onClick:e=>{if(n)return e.preventDefault(),void(null==i||i(o.id));y()},style:{fontFamily:"Bricolage Grotesque, sans-serif",background:"glassmorphism"===f.theme.name||"dark"===f.theme.name?"rgba(255,255,255,0.1)":"minimalist"===f.theme.name?"#ffffff":f.theme.colors.cardBackground,borderColor:f.border,color:f.textPrimary,backdropFilter:"glassmorphism"===f.theme.name||"dark"===f.theme.name?"blur(16px)":"none",boxShadow:"note"===f.theme.name?null==(d=f.theme.styles.cardStyle)?void 0:d.boxShadow:"none"},children:r.jsxs("div",{className:"text-center relative h-full flex flex-col items-center justify-center",children:[r.jsxs("div",{className:"word-card-content word-card-word absolute inset-0 flex flex-col items-center justify-center transition-all duration-300 ease-in-out",children:[r.jsx("div",{className:"font-bold text-lg mb-1",style:{color:f.textPrimary},children:o.word}),o.context&&r.jsx("div",{className:"text-xs px-2 py-1 rounded-full inline-block",style:{opacity:.7,backgroundColor:"glassmorphism"===f.theme.name||"dark"===f.theme.name?"rgba(255,255,255,0.2)":"minimalist"===f.theme.name?"#f3f4f6":"rgba(255,255,255,0.6)",color:f.textSecondary},children:o.context})]}),r.jsx("div",{className:"word-card-content word-card-translation absolute inset-0 flex items-center justify-center transition-all duration-300 ease-in-out opacity-0 pointer-events-none",children:r.jsx("div",{className:"font-bold text-lg text-center",style:{color:f.textPrimary},children:o.translations&&o.translations.length>0?o.translations.join(", "):"No translation available"})})]})})]})}),f=()=>{const m=o(),{user:f,profile:x,refreshProfile:y,loading:p}=s(),{toast:v}=n(),k=a(),[w,j]=e.useState([]),[N,C]=e.useState(!0),[S,P]=e.useState(!1);e.useState(new Set),e.useEffect(()=>{const e=new Image;e.onload=()=>P(!0),e.src="/lovable-uploads/5d9b151b-eb54-41c3-a578-e70139faa878.png",f&&E()},[f]);const E=async()=>{try{C(!0),console.log("ðŸ“– Fetching word book from user_vocabulary table...");const{data:e,error:r}=await t.from("user_vocabulary").select("id, word, part_of_speech, translations, created_at").order("created_at",{ascending:!1});if(console.log("ðŸ“Š Word book response:",{data:e,error:r,count:null==e?void 0:e.length}),r)throw console.error("Database error:",r),new Error(`Database error: ${r.message}`);const o=(null==e?void 0:e.map(e=>({id:e.id,word:e.word,translations:e.translations||["No translation available"],context:"",savedAt:e.created_at,languageCode:"en"})))||[];console.log("âœ… Successfully loaded",o.length,"words"),j(o)}catch(e){console.error("âŒ Error fetching word book:",e),v({title:"Failed to Load Word Book",description:`Could not load your word book: ${e.message}`,variant:"destructive",duration:4e3}),j([])}finally{C(!1)}},T=async e=>{try{console.log("ðŸ—‘ï¸ Removing word:",e);const{error:r}=await t.from("user_vocabulary").delete().eq("id",e);if(r)throw console.error("Database error removing word:",r),new Error(`Database error: ${r.message}`);j(r=>r.filter(r=>r.id!==e)),v({title:"âœ… Word Removed",description:"The word has been removed from your Word Book.",duration:3e3}),console.log("âœ… Successfully removed word")}catch(r){console.error("âŒ Error removing word:",r),v({title:"Failed to Remove Word",description:r.message||"Could not remove word. Please try again.",variant:"destructive",duration:4e3})}};return p?r.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:k.backgroundImageColor},children:r.jsx(l,{})}):p||f?N||!S?r.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:k.backgroundImageColor},children:r.jsx(l,{})}):r.jsxs("div",{className:"min-h-screen relative",style:{backgroundColor:"dark"===k.theme.name?k.theme.colors.background:"transparent"},children:[r.jsx("div",{className:"absolute inset-0 bg-contain bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"note"===k.theme.name||"minimalist"===k.theme.name||"dark"===k.theme.name?"none":"url('/lovable-uploads/5d9b151b-eb54-41c3-a578-e70139faa878.png')",backgroundColor:k.backgroundImageColor}}),r.jsxs("div",{className:"relative z-10 min-h-full lg:py-10 lg:px-6 pt-6 pr-4 pb-6 pl-4",children:[r.jsxs("header",{className:"flex sm:px-6 lg:px-12 lg:py-5 pt-4 pr-4 pb-4 pl-4 items-center border-b relative",style:{borderColor:k.border+"60"},children:[r.jsx("div",{className:"absolute left-4 sm:left-6 lg:left-12",children:r.jsx(c,{variant:"ghost",size:"sm",onClick:()=>m("/dashboard"),className:"flex items-center p-2",style:{fontFamily:"Inter, sans-serif",color:k.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=k.buttonPrimary,onMouseLeave:e=>e.currentTarget.style.color=k.textSecondary,children:r.jsx(g,{className:"w-4 h-4"})})}),r.jsx("div",{className:"flex-1 flex justify-center items-center",children:r.jsx("h1",{className:"text-xl lg:text-2xl tracking-tight font-semibold text-center",style:{fontFamily:"Bricolage Grotesque, sans-serif",color:k.textPrimary},children:"My Word Book"})}),r.jsx("div",{className:"w-10 sm:w-12 lg:w-16"})]}),r.jsx("main",{className:"relative sm:px-6 lg:px-12 pr-4 pb-12 pl-4 pt-10 lg:pt-12",children:0===w.length?r.jsxs("div",{className:"text-center py-16",children:[r.jsx(b,{className:"w-20 h-20 mx-auto mb-6",style:{color:k.textSecondary+"80"}}),r.jsx("h3",{className:"text-2xl font-semibold mb-4",style:{fontFamily:"Bricolage Grotesque, sans-serif",color:k.textPrimary},children:"Your Word Book is empty"}),r.jsx("p",{className:"mb-8 max-w-md mx-auto",style:{fontFamily:"Inter, sans-serif",color:k.textSecondary},children:'Start building your vocabulary by selecting words during reading tests and clicking "Add to Word Book" in the translation popup.'}),r.jsx(c,{onClick:()=>m("/ielts-portal"),className:"px-6 py-3 rounded-xl backdrop-blur-sm border text-white",style:{backgroundColor:k.buttonPrimary,borderColor:k.border,fontFamily:"Inter, sans-serif"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=k.buttonPrimaryHover,onMouseLeave:e=>e.currentTarget.style.backgroundColor=k.buttonPrimary,children:"Start Learning"})]}):r.jsx(r.Fragment,{children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 word-card-grid",children:w.map(e=>r.jsx(h,{word:e,onRemove:T,isEditMode:!1,isSelected:!1,onToggleSelect:void 0},e.id))})})})]})]}):r.jsxs("div",{className:"min-h-screen relative",style:{backgroundColor:"dark"===k.theme.name?k.theme.colors.background:"transparent"},children:[r.jsx("div",{className:"absolute inset-0 bg-contain bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"note"===k.theme.name||"minimalist"===k.theme.name||"dark"===k.theme.name?"none":"url('/lovable-uploads/5d9b151b-eb54-41c3-a578-e70139faa878.png')",backgroundColor:k.backgroundImageColor}}),r.jsx("div",{className:"relative z-10 min-h-full flex items-center justify-center",children:r.jsx(i,{className:"p-8 text-center backdrop-blur-xl shadow-xl border rounded-xl",style:{backgroundColor:k.backgroundOverlay,borderColor:k.border},children:r.jsxs(d,{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx(u,{className:"w-16 h-16 mx-auto mb-4",style:{color:k.textSecondary}}),r.jsx("h2",{className:"text-xl font-semibold mb-2",style:{fontFamily:"Bricolage Grotesque, sans-serif",color:k.textPrimary},children:"Sign in Required"}),r.jsx("p",{className:"mb-6",style:{fontFamily:"Inter, sans-serif",color:k.textSecondary},children:"Please sign in to access your Word Book and save your progress."})]}),r.jsxs("div",{className:"flex gap-3 justify-center",children:[r.jsx(c,{onClick:()=>m("/auth"),className:"px-6 py-2 text-white",style:{backgroundColor:k.buttonPrimary,fontFamily:"Inter, sans-serif"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=k.buttonPrimaryHover,onMouseLeave:e=>e.currentTarget.style.backgroundColor=k.buttonPrimary,children:"Sign In"}),r.jsx(c,{onClick:()=>m("/dashboard"),variant:"outline",className:"px-6 py-2",style:{backgroundColor:"glassmorphism"===k.theme.name||"dark"===k.theme.name?"rgba(255,255,255,0.1)":"minimalist"===k.theme.name?"#ffffff":"rgba(255,255,255,0.5)",borderColor:k.border,color:k.textPrimary,fontFamily:"Inter, sans-serif"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=k.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="glassmorphism"===k.theme.name||"dark"===k.theme.name?"rgba(255,255,255,0.1)":"minimalist"===k.theme.name?"#ffffff":"rgba(255,255,255,0.5)",children:"Go to Dashboard"})]})]})})})]})};export{f as default};
