import{u as e,c as s,r as a,j as r}from"./vendor-react-rLLBBC7n.js";import{E as t,q as i,s as o,J as l,x as n,y as c,B as d,e as m,P as u,C as p,a as h,b as x,c as g,T as b}from"./index-KxDfHqNJ.js";import{C as y,a as j,b as v,O as f,M as w,c as N,R as E,S as k}from"./shimmering-text-B_6cduiE.js";import{aA as C,aK as A,aL as D,aO as S,bb as _,at as B,b4 as P,x as F,bc as I,X as T}from"./vendor-ui-BGi_EvHx.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";const L={read_aloud:{name:"Read Aloud",isSpeaking:!0,isWriting:!1,hasAudio:!1,hasImage:!1,hasPassage:!0,timeLimit:40,instructions:"Look at the text below. In 30-40 seconds, you must read this text aloud as naturally and clearly as possible."},repeat_sentence:{name:"Repeat Sentence",isSpeaking:!0,isWriting:!1,hasAudio:!0,hasImage:!1,hasPassage:!1,timeLimit:15,instructions:"You will hear a sentence. Please repeat the sentence exactly as you hear it."},describe_image:{name:"Describe Image",isSpeaking:!0,isWriting:!1,hasAudio:!1,hasImage:!0,hasPassage:!1,timeLimit:40,instructions:"Look at the image below. In 25 seconds, please speak into the microphone and describe in detail what the image is showing."},retell_lecture:{name:"Retell Lecture",isSpeaking:!0,isWriting:!1,hasAudio:!0,hasImage:!0,hasPassage:!1,timeLimit:40,instructions:"You will hear a lecture. After listening to the lecture, in 10 seconds, please speak into the microphone and retell what you have just heard."},answer_short_question:{name:"Answer Short Question",isSpeaking:!0,isWriting:!1,hasAudio:!0,hasImage:!1,hasPassage:!1,timeLimit:10,instructions:"You will hear a question. Please give a simple and short answer. Often just one or a few words is enough."},summarize_group_discussion:{name:"Summarize Group Discussion",isSpeaking:!0,isWriting:!1,hasAudio:!0,hasImage:!1,hasPassage:!1,timeLimit:70,instructions:"You will hear a group discussion. You will have 10 seconds to prepare, then summarize the main points of the discussion in 70 seconds."},respond_to_situation:{name:"Respond to a Situation",isSpeaking:!0,isWriting:!1,hasAudio:!1,hasImage:!1,hasPassage:!0,timeLimit:40,instructions:"You will see a scenario. In 20 seconds prepare time, think about what you would say in this situation. Then speak for up to 40 seconds."},summarize_written_text:{name:"Summarize Written Text",isSpeaking:!1,isWriting:!0,hasAudio:!1,hasImage:!1,hasPassage:!0,timeLimit:600,wordLimit:75,instructions:"Read the passage below. Write a one-sentence summary of the passage. Your summary should be between 5 and 75 words."},write_essay:{name:"Write Essay",isSpeaking:!1,isWriting:!0,hasAudio:!1,hasImage:!1,hasPassage:!1,timeLimit:1200,wordLimit:300,instructions:"You will have 20 minutes to plan, write and revise an essay about the topic below. Your response will be judged on how well you develop a position, organize your ideas, present supporting details, and control the elements of standard written English."}},W=()=>{var W,z,R;const $=e(),{type:Y}=s(),{user:q,profile:M}=t();i();const O=a.useRef(null),U=a.useRef(null),G=a.useRef([]),[H,K]=a.useState([]),[J,Q]=a.useState(0),[V,X]=a.useState(!0),[Z,ee]=a.useState(0),[se,ae]=a.useState(!1),[re,te]=a.useState(!1),[ie,oe]=a.useState(null),[le,ne]=a.useState(!1),[ce,de]=a.useState(!1),[me,ue]=a.useState(""),[pe,he]=a.useState(!1),[xe,ge]=a.useState(!1),[be,ye]=a.useState(null),[je,ve]=a.useState(!1),[fe,we]=a.useState(!1),[Ne,Ee]=a.useState([{id:"1",type:"bot",content:"Hello! I'm Catie, your PTE Speaking & Writing tutor. üéØ I'm here to help you improve your responses. Ask me about structure, vocabulary, pronunciation tips, or any PTE strategy!",timestamp:new Date}]),[ke,Ce]=a.useState(""),[Ae,De]=a.useState(!1),Se=Y?L[Y]:null,_e=H[J],Be=me.trim().split(/\s+/).filter(e=>e).length,Pe=async()=>{if(!ke.trim()||Ae)return;const e={id:Date.now().toString(),type:"user",content:ke,timestamp:new Date};Ee(s=>[...s,e]),Ce(""),De(!0);try{const e=`You are Catie, a friendly and expert PTE Academic tutor specializing in Speaking and Writing tasks. \nThe student is currently practicing: ${(null==Se?void 0:Se.name)||"PTE task"}\nTask instructions: ${(null==Se?void 0:Se.instructions)||""}\n${(null==_e?void 0:_e.prompt_text)?`Current prompt: ${_e.prompt_text}`:""}\n${(null==_e?void 0:_e.passage_text)?`Passage: ${_e.passage_text}`:""}\n\nHelp the student with:\n- Task-specific strategies\n- Vocabulary and grammar tips\n- Structure and organization\n- Pronunciation guidance (for speaking)\n- Time management advice\n\nBe encouraging, specific, and practical. Keep responses concise but helpful.`,{data:s,error:a}=await o.functions.invoke("gemini-chat",{body:{message:ke,context:"pte_tutor",systemPrompt:e}});if(a)throw a;const r={id:(Date.now()+1).toString(),type:"bot",content:(null==s?void 0:s.response)||"I'm here to help! Could you please rephrase your question?",timestamp:new Date};Ee(e=>[...e,r])}catch(s){console.error("Catie error:",s),l.error("Catie couldn't respond. Please try again.")}finally{De(!1)}};a.useEffect(()=>{Y&&Fe()},[Y]),a.useEffect(()=>{_e&&Se&&(ee(_e.time_limit||Se.timeLimit),ue(""),oe(null),ge(!1),ye(null),de(!1))},[J,_e]),a.useEffect(()=>{let e;return se&&Z>0&&(e=setInterval(()=>{ee(e=>e<=1?(ae(!1),re&&Ie(),0):e-1)},1e3)),()=>clearInterval(e)},[se,Z,re]);const Fe=async()=>{if(Y){X(!0);try{const{data:e,error:s}=await o.from("pte_items").select("*").eq("pte_section_type",Y).order("created_at",{ascending:!0});if(s)throw s;if(!e||0===e.length)return l.error("No items available for this type"),void $("/pte-portal");K(e)}catch(e){console.error("Error loading items:",e),l.error("Failed to load practice items")}finally{X(!1)}}},Ie=()=>{U.current&&re&&(U.current.stop(),te(!1),ae(!1))};return V?r.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:r.jsx(n,{})}):Se&&_e?r.jsxs(c,{title:Se.name,showBackButton:!0,children:[r.jsx("audio",{ref:O,onEnded:()=>{ne(!1),de(!0)},className:"hidden"}),r.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-24",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(m,{variant:"outline",className:"font-medium",style:{borderColor:"#A68B5B",color:"#5D4E37",backgroundColor:"rgba(254, 249, 231, 0.8)"},children:[J+1," / ",H.length]}),r.jsx(m,{style:{backgroundColor:"#E8D5A3",color:"#5D4E37"},children:_e.difficulty})]}),r.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg",style:{backgroundColor:"rgba(254, 249, 231, 0.9)",border:"1px solid #E8D5A3"},children:[r.jsx(C,{className:"w-4 h-4",style:{color:"#8B6914"}}),r.jsx("span",{className:"font-mono text-lg font-semibold",style:{color:Z<10?"#C97D60":"#5D4E37"},children:(Te=Z,`${Math.floor(Te/60)}:${(Te%60).toString().padStart(2,"0")}`)})]})]}),r.jsx(u,{value:J/H.length*100,className:"h-2",style:{backgroundColor:"#E8D5A3"}}),r.jsx(p,{className:"rounded-2xl border-2",style:{background:"linear-gradient(to bottom, #FFF8E7 0%, #FEF3D6 100%)",borderColor:"#E8D5A3",boxShadow:"0 2px 8px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.5)"},children:r.jsx(h,{className:"pt-4",children:r.jsxs("p",{className:"text-sm",style:{color:"#8B6914"},children:["üìã ",Se.instructions]})})}),r.jsxs(p,{className:"rounded-2xl shadow-lg border-2",style:{background:"linear-gradient(to bottom, #FEF9E7 0%, #FDF6E3 100%)",borderColor:"#E8D5A3",boxShadow:"0 4px 12px rgba(0,0,0,0.1), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[r.jsx(x,{children:r.jsx(g,{style:{color:"#5D4E37"},children:_e.title||Se.name})}),r.jsxs(h,{className:"space-y-6",children:[r.jsxs("div",{className:"text-lg p-4 rounded-lg",style:{backgroundColor:"rgba(166, 139, 91, 0.1)",border:"1px dashed #E8D5A3",color:"#5D4E37"},children:["‚úèÔ∏è ",_e.prompt_text]}),Se.hasPassage&&_e.passage_text&&r.jsx(p,{className:"border-2",style:{backgroundColor:"rgba(254, 249, 231, 0.8)",borderColor:"#E8D5A3",boxShadow:"inset 0 1px 3px rgba(0,0,0,0.05)"},children:r.jsxs(h,{className:"pt-4",children:[r.jsx("h3",{className:"font-semibold mb-3",style:{color:"#8B6914"},children:"üìñ Passage:"}),r.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",style:{color:"#5D4E37"},children:_e.passage_text})]})}),Se.hasImage&&_e.image_url&&r.jsx("div",{className:"flex justify-center",children:r.jsx("img",{src:_e.image_url,alt:"Practice image",className:"max-w-full max-h-96 rounded-lg border-2",style:{borderColor:"#E8D5A3",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})}),Se.hasAudio&&_e.audio_url&&r.jsx(p,{className:"border-2",style:{backgroundColor:"rgba(232, 213, 163, 0.3)",borderColor:"#E8D5A3"},children:r.jsx(h,{className:"pt-4",children:r.jsxs("div",{className:"flex items-center justify-center gap-4",children:[r.jsx(d,{variant:"outline",size:"lg",onClick:le?()=>{O.current&&(O.current.pause(),ne(!1))}:()=>{O.current&&(null==_e?void 0:_e.audio_url)&&(O.current.src=_e.audio_url,O.current.play(),ne(!0))},disabled:ce&&"repeat_sentence"===Y,className:"rounded-full",style:{borderColor:"#A68B5B",color:"#5D4E37"},children:le?r.jsx(A,{className:"w-6 h-6"}):r.jsx(D,{className:"w-6 h-6"})}),r.jsxs("div",{className:"text-sm",style:{color:"#8B6914"},children:["üéß ",ce?"Audio played":"Click to listen","repeat_sentence"===Y&&ce&&" (one time only)"]})]})})}),Se.isSpeaking&&!xe&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-center gap-4",children:[!re&&!ie&&r.jsxs(d,{size:"lg",onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e);U.current=s,G.current=[],s.ondataavailable=e=>{e.data.size>0&&G.current.push(e.data)},s.onstop=()=>{const s=new Blob(G.current,{type:"audio/webm"});oe(s),e.getTracks().forEach(e=>e.stop())},s.start(),te(!0),ae(!0)}catch(e){console.error("Error starting recording:",e),l.error("Failed to access microphone")}},disabled:Se.hasAudio&&!ce,style:{backgroundColor:"#A68B5B",color:"white"},className:"hover:opacity-90",children:[r.jsx(S,{className:"w-5 h-5 mr-2"}),"üéôÔ∏è Start Recording"]}),re&&r.jsxs(d,{size:"lg",onClick:Ie,style:{backgroundColor:"#C97D60",color:"white"},className:"hover:opacity-90",children:[r.jsx(_,{className:"w-5 h-5 mr-2"}),"Stop Recording"]}),ie&&!re&&r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(m,{style:{backgroundColor:"rgba(232, 213, 163, 0.5)",color:"#5D4E37",border:"1px solid #E8D5A3"},children:[r.jsx(B,{className:"w-4 h-4 mr-1",style:{color:"#8B6914"}}),"Recording saved"]}),r.jsx(d,{variant:"outline",onClick:()=>oe(null),style:{borderColor:"#E8D5A3",color:"#5D4E37"},children:"Re-record"})]})]}),re&&r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-4 h-4 rounded-full animate-pulse mx-auto",style:{backgroundColor:"#C97D60"}}),r.jsx("p",{className:"text-sm mt-2",style:{color:"#8B6914"},children:"Recording..."})]})]}),Se.isWriting&&!xe&&r.jsxs("div",{className:"space-y-4",children:[!se&&!me&&r.jsx("div",{className:"text-center",children:r.jsx(d,{onClick:()=>{ae(!0)},size:"lg",style:{backgroundColor:"#A68B5B",color:"white"},className:"hover:opacity-90",children:"‚úçÔ∏è Start Writing"})}),(se||me)&&r.jsxs(r.Fragment,{children:[r.jsx(b,{value:me,onChange:e=>ue(e.target.value),placeholder:"Type your response here...",rows:10,className:"font-mono border-2",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",borderColor:"#E8D5A3",color:"#5D4E37"}}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{style:{color:Be>(Se.wordLimit||300)?"#C97D60":"#8B6914"},children:["üìù Words: ",Be," ",Se.wordLimit&&`/ ${Se.wordLimit}`]}),Se.wordLimit&&Be<5&&r.jsxs("span",{style:{color:"#C97D60"},children:[r.jsx(P,{className:"w-4 h-4 inline mr-1"}),"Minimum 5 words required"]})]})]})]}),!xe&&r.jsx("div",{className:"flex justify-end",children:r.jsxs(d,{onClick:async()=>{if(q&&_e){he(!0);try{let e=me,s=null,a="";if((null==Se?void 0:Se.isSpeaking)&&ie){const e=`pte-responses/${q.id}/${Y}/${Date.now()}.webm`,{data:r,error:t}=await o.storage.from("audio").upload(e,ie,{upsert:!0});if(t)throw t;const{data:{publicUrl:i}}=o.storage.from("audio").getPublicUrl(e);s=i;const n=await ie.arrayBuffer(),c=btoa(String.fromCharCode(...new Uint8Array(n)));l.loading("AI is evaluating your response...");const{data:d,error:m}=await o.functions.invoke("pte-speaking-evaluator",{body:{taskType:Y,transcribedText:a||"[Audio response - transcription pending]",audioBase64:c,originalText:_e.passage_text||_e.prompt_text,imageDescription:_e.image_url?"Image provided":void 0,lectureContent:_e.audio_url?"Lecture audio provided":void 0,situationContext:_e.passage_text,correctAnswer:_e.sample_answer}});l.dismiss(),m?(console.error("AI evaluation error:",m),ye({sampleAnswer:_e.sample_answer})):(null==d?void 0:d.success)&&ye({aiEvaluation:d.evaluation,taskName:d.taskName,scoringCriteria:d.scoringCriteria,sampleAnswer:_e.sample_answer})}if((null==Se?void 0:Se.isWriting)&&me){l.loading("AI is evaluating your response...");const{data:e,error:s}=await o.functions.invoke("pte-writing-evaluator",{body:{taskType:Y,writtenResponse:me,originalPassage:_e.passage_text,essayPrompt:_e.prompt_text,spokenTextContent:_e.audio_url?"Audio content provided":void 0}});l.dismiss(),s?(console.error("AI evaluation error:",s),ye({sampleAnswer:_e.sample_answer})):(null==e?void 0:e.success)&&ye({aiEvaluation:e.evaluation,taskName:e.taskName,scoringCriteria:e.scoringCriteria,wordLimits:e.wordLimits,sampleAnswer:_e.sample_answer})}const{error:r}=await o.from("pte_user_progress").insert({user_id:q.id,pte_skill:"speaking_writing",pte_section_type:Y,item_id:_e.id,completed:!0,response_text:e||null,response_audio_url:s,time_taken:(_e.time_limit||(null==Se?void 0:Se.timeLimit)||60)-Z});if(r)throw r;ge(!0),l.success("Response submitted!")}catch(e){console.error("Error submitting response:",e),l.error("Failed to submit response")}finally{he(!1)}}},disabled:pe||Se.isSpeaking&&!ie||Se.isWriting&&Be<5,style:{backgroundColor:"#A68B5B",color:"white"},className:"hover:opacity-90",children:[r.jsx(F,{className:"w-4 h-4 mr-2"}),pe?"Submitting...":"Submit Response"]})}),xe&&r.jsxs("div",{className:"space-y-4",children:[(null==be?void 0:be.aiEvaluation)&&r.jsxs(p,{className:"border-2",style:{borderColor:"#E8D5A3"},children:[r.jsx(x,{style:{background:"linear-gradient(to right, #FEF9E7, #FFF8E7)"},children:r.jsxs(g,{className:"flex items-center justify-between",style:{color:"#5D4E37"},children:[r.jsxs("span",{className:"flex items-center gap-2",children:["‚ú® AI Evaluation - ",be.taskName]}),r.jsxs(m,{className:"text-lg",style:{backgroundColor:"#A68B5B",color:"white"},children:[be.aiEvaluation.totalScore,"/",be.aiEvaluation.totalMax,r.jsxs("span",{className:"ml-2 text-xs",children:["(",be.aiEvaluation.percentage,"%)"]})]})]})}),r.jsxs(h,{className:"pt-4 space-y-4",style:{backgroundColor:"#FEF9E7"},children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(be.aiEvaluation.scores||{}).map(([e,s])=>{var a;return r.jsxs("div",{className:"p-3 rounded-lg border",style:{backgroundColor:"rgba(255, 255, 255, 0.6)",borderColor:"#E8D5A3"},children:[r.jsx("div",{className:"text-xs capitalize",style:{color:"#8B6914"},children:e.replace(/_/g," ")}),r.jsxs("div",{className:"text-lg font-bold",style:{color:"#A68B5B"},children:[s,"/",(null==(a=be.scoringCriteria)?void 0:a[e])||5]})]},e)})}),r.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg",style:{backgroundColor:"rgba(232, 213, 163, 0.4)",border:"1px solid #E8D5A3"},children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs",style:{color:"#8B6914"},children:"Estimated PTE Score"}),r.jsx("div",{className:"text-2xl font-bold",style:{color:"#5D4E37"},children:be.aiEvaluation.pteScore})]}),r.jsx("div",{className:"text-sm",style:{color:"#8B6914"},children:"(Scale: 10-90)"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium",style:{color:"#8B6914"},children:"üìù Overall Feedback"}),r.jsx("p",{className:"text-sm",style:{color:"#5D4E37"},children:be.aiEvaluation.overallFeedback})]}),(null==(W=be.aiEvaluation.strengths)?void 0:W.length)>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("h4",{className:"font-medium flex items-center gap-2",style:{color:"#8B6914"},children:[r.jsx(B,{className:"w-4 h-4",style:{color:"#A68B5B"}})," ‚úÖ Strengths"]}),r.jsx("ul",{className:"list-disc list-inside text-sm space-y-1",style:{color:"#5D4E37"},children:be.aiEvaluation.strengths.map((e,s)=>r.jsx("li",{children:e},s))})]}),(null==(z=be.aiEvaluation.improvements)?void 0:z.length)>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("h4",{className:"font-medium flex items-center gap-2",style:{color:"#C97D60"},children:[r.jsx(P,{className:"w-4 h-4"})," üìà Areas for Improvement"]}),r.jsx("ul",{className:"list-disc list-inside text-sm space-y-1",style:{color:"#5D4E37"},children:be.aiEvaluation.improvements.map((e,s)=>r.jsx("li",{children:e},s))})]}),be.aiEvaluation.feedback&&r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium",style:{color:"#8B6914"},children:"üìã Detailed Feedback"}),r.jsx("div",{className:"space-y-2 text-sm",children:Object.entries(be.aiEvaluation.feedback).map(([e,s])=>r.jsxs("div",{className:"p-2 rounded border",style:{backgroundColor:"rgba(255, 255, 255, 0.5)",borderColor:"#E8D5A3"},children:[r.jsxs("span",{className:"font-medium capitalize",style:{color:"#8B6914"},children:[e.replace(/_/g," "),":"]})," ",r.jsx("span",{style:{color:"#5D4E37"},children:s})]},e))})]}),(null==(R=be.aiEvaluation.grammarErrors)?void 0:R.length)>0&&r.jsxs("div",{className:"p-3 rounded-lg",style:{backgroundColor:"rgba(201, 125, 96, 0.15)",border:"1px solid #C97D60"},children:[r.jsx("h4",{className:"font-medium text-sm",style:{color:"#C97D60"},children:"‚ö†Ô∏è Grammar Issues:"}),r.jsx("ul",{className:"list-disc list-inside text-xs",style:{color:"#5D4E37"},children:be.aiEvaluation.grammarErrors.map((e,s)=>r.jsx("li",{children:e},s))})]})]})]}),(null==be?void 0:be.sampleAnswer)&&r.jsxs(p,{className:"border-2",style:{backgroundColor:"rgba(232, 213, 163, 0.3)",borderColor:"#E8D5A3"},children:[r.jsx(x,{children:r.jsxs(g,{className:"flex items-center gap-2 text-base",style:{color:"#8B6914"},children:[r.jsx(B,{className:"w-5 h-5",style:{color:"#A68B5B"}}),"üí° Sample Answer"]})}),r.jsx(h,{children:r.jsx("p",{className:"whitespace-pre-wrap text-sm",style:{color:"#5D4E37"},children:be.sampleAnswer})})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx(d,{onClick:()=>{J<H.length-1?Q(e=>e+1):(l.success("You have completed all items!"),$("/pte-portal"))},style:{backgroundColor:"#A68B5B",color:"white"},className:"hover:opacity-90",children:J<H.length-1?r.jsxs(r.Fragment,{children:[r.jsx(I,{className:"w-4 h-4 mr-2"}),"Next Item"]}):"üéâ Complete"})})]})]})]})]}),r.jsxs("div",{className:"fixed bottom-6 right-3 sm:bottom-6 sm:right-6 z-50",children:[je&&r.jsxs(p,{className:"rounded-3xl w-[280px] h-[400px] sm:w-96 sm:h-[500px] shadow-2xl flex flex-col transform-gpu origin-bottom-right transition-all duration-260 ease-in-out border-2 "+(fe?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-75 translate-y-8"),style:{background:"linear-gradient(to bottom, #FEF9E7 0%, #FDF6E3 100%)",borderColor:"#E8D5A3",boxShadow:"0 8px 32px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[r.jsxs(x,{className:"pb-1 sm:pb-2 rounded-t-3xl relative",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border-2",style:{borderColor:"#E8D5A3"},children:r.jsx("img",{src:"/1000031289.png",alt:"Catie",className:"w-full h-full object-cover"})}),r.jsxs("div",{children:[r.jsx(g,{className:"text-base",style:{color:"#5D4E37"},children:"Ask Catie"}),r.jsx("p",{className:"text-xs",style:{color:"#8B6914"},children:"Your PTE tutor"})]})]}),r.jsx("div",{className:"absolute top-1.5 right-1.5 sm:top-2 sm:right-2",children:r.jsx(d,{variant:"ghost",size:"icon",onClick:()=>{we(!1),setTimeout(()=>ve(!1),260)},className:"h-7 w-7 sm:h-8 sm:w-8 p-0 hover:bg-amber-100",style:{color:"#5D4E37"},children:r.jsx(T,{className:"w-4 h-4"})})})]}),r.jsxs(h,{className:"flex-1 flex flex-col px-2.5 py-2 sm:p-4 overflow-hidden",children:[r.jsx(y,{className:"flex-1 min-h-0",children:r.jsx(j,{className:"flex-1 min-h-0",children:0!==Ne.length||Ae?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"rounded-lg p-2 mb-3 text-xs",style:{backgroundColor:"rgba(232, 213, 163, 0.4)",borderColor:"#E8D5A3",borderWidth:"1px",borderStyle:"solid",color:"#8B6914"},children:["üìù ",(null==Se?void 0:Se.name)||"PTE Practice"]}),Ne.map(e=>r.jsxs(w,{from:"user"===e.type?"user":"assistant",children:["bot"===e.type&&r.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0 border",style:{borderColor:"#E8D5A3"},children:r.jsx("img",{src:"/1000031289.png",alt:"Catie",className:"w-full h-full object-cover"})}),r.jsx(N,{children:r.jsx("div",{className:"px-3 py-2 rounded-xl text-sm",style:{backgroundColor:"user"===e.type?"rgba(166, 139, 91, 0.15)":"rgba(255, 255, 255, 0.6)",borderColor:"#E8D5A3",borderWidth:"1px",borderStyle:"solid",color:"#5D4E37"},children:r.jsx(E,{dangerouslySetInnerHTML:{__html:e.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^‚Ä¢ (.*)$/gm,"<li>$1</li>").replace(/\n/g,"<br>")}})})}),"user"===e.type&&(null==M?void 0:M.avatar_url)&&r.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0 border",style:{borderColor:"#E8D5A3"},children:r.jsx("img",{src:M.avatar_url,alt:"You",className:"w-full h-full object-cover"})})]},e.id)),Ae&&r.jsxs(w,{from:"assistant",children:[r.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden flex-shrink-0 border",style:{borderColor:"#E8D5A3"},children:r.jsx("img",{src:"/1000031289.png",alt:"Catie",className:"w-full h-full object-cover"})}),r.jsx(N,{children:r.jsx("div",{className:"px-3 py-2 rounded-xl text-sm",style:{backgroundColor:"rgba(255, 255, 255, 0.6)",borderColor:"#E8D5A3",borderWidth:"1px",borderStyle:"solid"},children:r.jsx(k,{text:"Thinking..."})})})]})]}):r.jsx(v,{icon:r.jsx(f,{className:"size-9 sm:size-12",style:{color:"#8B6914"}}),title:"Ask Catie anything",description:"Get help with your PTE practice"})})}),r.jsx("div",{className:"flex-shrink-0 mt-2.5 sm:mt-4",children:r.jsxs("div",{className:"flex gap-1.5 sm:gap-2",children:[r.jsx("input",{type:"text",value:ke,onChange:e=>Ce(e.target.value),onKeyPress:e=>"Enter"===e.key&&!Ae&&ke.trim()&&Pe(),placeholder:"Ask Catie for PTE help...",className:"flex-1 px-2.5 py-1.5 sm:px-3 sm:py-2 rounded-lg text-sm focus:outline-none focus:ring-2",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",borderColor:"#E8D5A3",borderWidth:"1px",borderStyle:"solid",color:"#5D4E37"},disabled:Ae}),r.jsx(d,{onClick:Pe,disabled:Ae||!ke.trim(),size:"icon",className:"h-9 w-9",style:{backgroundColor:"#A68B5B",color:"white"},children:Ae?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):r.jsx(F,{className:"w-4 h-4"})})]})})]})]}),!je&&r.jsx("div",{className:"cursor-pointer transition-all duration-200 hover:scale-110",style:{borderRadius:"50%",overflow:"hidden",width:"64px",height:"64px",boxShadow:"0 8px 20px rgba(166, 139, 91, 0.4)",border:"3px solid #E8D5A3"},onClick:()=>{ve(!0),requestAnimationFrame(()=>we(!0))},children:r.jsx("img",{src:"/1000031289.png",alt:"Ask Catie",className:"w-full h-full object-cover"})})]}),r.jsx(d,{variant:"outline",size:"sm",onClick:()=>$("/pte-portal"),className:"fixed bottom-6 left-6 z-50 rounded-xl",style:{backgroundColor:"#FEF9E7",borderColor:"#E8D5A3",color:"#5D4E37"},children:"Exit"})]}):r.jsx(c,{title:"PTE Practice",showBackButton:!0,children:r.jsxs("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-muted-foreground",children:"No items available"}),r.jsx(d,{onClick:()=>$("/pte-portal"),className:"mt-4",children:"Back to PTE Portal"})]})});var Te};export{W as default};
