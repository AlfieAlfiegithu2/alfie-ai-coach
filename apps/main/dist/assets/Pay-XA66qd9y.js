import{c as e,c4 as t,bE as r,r as n,u as s,j as o,ai as a,x as i,R as l,ap as c,am as d,c5 as u,N as m,as as p}from"./index-C36stBbp.js";import{s as f}from"./supabase-DWL4C3fA.js";import{Z as h}from"./zap-CxL8Rjj5.js";import{L as x}from"./lock-qgpj8BDW.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=e("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var y,g="https://js.stripe.com/v3",v=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,j="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",E=function(e){var t=document.createElement("script");t.src="".concat(g).concat("");var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(t),t},w=null,N=null,k=null,C=function(e){return null!==w?w:(w=new Promise(function(t,r){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&e&&console.warn(j),window.Stripe)t(window.Stripe);else try{var n=function(){for(var e=document.querySelectorAll('script[src^="'.concat(g,'"]')),t=0;t<e.length;t++){var r=e[t];if(v.test(r.src))return r}return null}();if(n&&e)console.warn(j);else if(n){if(n&&null!==k&&null!==N){var s;n.removeEventListener("load",k),n.removeEventListener("error",N),null===(s=n.parentNode)||void 0===s||s.removeChild(n),n=E()}}else n=E();k=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,r),N=function(e){return function(){e(new Error("Failed to load Stripe.js"))}}(r),n.addEventListener("load",k),n.addEventListener("error",N)}catch(o){return void r(o)}else t(null)})).catch(function(e){return w=null,Promise.reject(e)})},S=!1,D=function(){return y||(y=C(null).catch(function(e){return y=null,Promise.reject(e)}))};Promise.resolve().then(function(){return D()}).catch(function(e){S||console.warn(e)});function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach(function(t){F(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==r)return;var n,s,o=[],a=!0,i=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(l){i=!0,s=l}finally{try{a||null==r.return||r.return()}finally{if(i)throw s}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L=function(e,t,n){var s=!!n,o=r.useRef(n);r.useEffect(function(){o.current=n},[n]),r.useEffect(function(){if(!s||!e)return function(){};var r=function(){o.current&&o.current.apply(o,arguments)};return e.on(t,r),function(){e.off(t,r)}},[s,t,e,o])},R=function(e){var t=r.useRef(e);return r.useEffect(function(){t.current=e},[e]),t.current},_=function(e){return null!==e&&"object"===P(e)},$="[object Object]",I=function e(t,r){if(!_(t)||!_(r))return t===r;var n=Array.isArray(t);if(n!==Array.isArray(r))return!1;var s=Object.prototype.toString.call(t)===$;if(s!==(Object.prototype.toString.call(r)===$))return!1;if(!s&&!n)return t===r;var o=Object.keys(t),a=Object.keys(r);if(o.length!==a.length)return!1;for(var i={},l=0;l<o.length;l+=1)i[o[l]]=!0;for(var c=0;c<a.length;c+=1)i[a[c]]=!0;var d=Object.keys(i);if(d.length!==o.length)return!1;var u=t,m=r;return d.every(function(t){return e(u[t],m[t])})},T=function(e,t,r){return _(e)?Object.keys(e).reduce(function(n,s){var o=!_(t)||!I(e[s],t[s]);return r.includes(s)?(o&&console.warn("Unsupported prop change: options.".concat(s," is not a mutable property.")),n):o?A(A({},n||{}),{},F({},s,e[s])):n},null):null},U="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",q=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U;if(null===e||_(t=e)&&"function"==typeof t.elements&&"function"==typeof t.createToken&&"function"==typeof t.createPaymentMethod&&"function"==typeof t.confirmCardPayment)return e;throw new Error(r)},W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U;if(function(e){return _(e)&&"function"==typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(e){return q(e,t)})};var r=q(e,t);return null===r?{tag:"empty"}:{tag:"sync",stripe:r}},z=r.createContext(null);z.displayName="ElementsContext";var K=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},Y=function(e){var t=e.stripe,n=e.options,s=e.children,o=r.useMemo(function(){return W(t)},[t]),a=M(r.useState(function(){return{stripe:"sync"===o.tag?o.stripe:null,elements:"sync"===o.tag?o.stripe.elements(n):null}}),2),i=a[0],l=a[1];r.useEffect(function(){var e=!0,t=function(e){l(function(t){return t.stripe?t:{stripe:e,elements:e.elements(n)}})};return"async"!==o.tag||i.stripe?"sync"!==o.tag||i.stripe||t(o.stripe):o.stripePromise.then(function(r){r&&e&&t(r)}),function(){e=!1}},[o,i,n]);var c=R(t);r.useEffect(function(){null!==c&&c!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[c,t]);var d=R(n);return r.useEffect(function(){if(i.elements){var e=T(n,d,["clientSecret","fonts"]);e&&i.elements.update(e)}},[n,d,i.elements]),r.useEffect(function(){var e;(e=i.stripe)&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"2.8.1"}),e.registerAppInfo({name:"react-stripe-js",version:"2.8.1",url:"https://stripe.com/docs/stripe-js/react"}))},[i.stripe]),r.createElement(z.Provider,{value:i},s)};Y.propTypes={stripe:t.any,options:t.object};var H=function(){var e,t;return(e="calls useElements()",t=r.useContext(z),K(t,e)).elements};t.func.isRequired;var G=r.createContext(null);G.displayName="CustomCheckoutSdkContext";r.createContext(null).displayName="CustomCheckoutContext",t.any,t.shape({clientSecret:t.string.isRequired,elementsOptions:t.object}).isRequired;var V=function(e){var t=r.useContext(G),n=r.useContext(z);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e}(t,e):K(n,e)},Z=function(e,n){var s,o="".concat((s=e).charAt(0).toUpperCase()+s.slice(1),"Element"),a=n?function(e){V("mounts <".concat(o,">"));var t=e.id,n=e.className;return r.createElement("div",{id:t,className:n})}:function(t){var n,s=t.id,a=t.className,i=t.options,l=void 0===i?{}:i,c=t.onBlur,d=t.onFocus,u=t.onReady,m=t.onChange,p=t.onEscape,f=t.onClick,h=t.onLoadError,x=t.onLoaderStart,b=t.onNetworksChange,y=t.onConfirm,g=t.onCancel,v=t.onShippingAddressChange,j=t.onShippingRateChange,E=V("mounts <".concat(o,">")),w="elements"in E?E.elements:null,N="customCheckoutSdk"in E?E.customCheckoutSdk:null,k=M(r.useState(null),2),C=k[0],S=k[1],D=r.useRef(null),B=r.useRef(null);L(C,"blur",c),L(C,"focus",d),L(C,"escape",p),L(C,"click",f),L(C,"loaderror",h),L(C,"loaderstart",x),L(C,"networkschange",b),L(C,"confirm",y),L(C,"cancel",g),L(C,"shippingaddresschange",v),L(C,"shippingratechange",j),L(C,"change",m),u&&(n="expressCheckout"===e?u:function(){u(C)}),L(C,"ready",n),r.useLayoutEffect(function(){if(null===D.current&&null!==B.current&&(w||N)){var t=null;N?t=N.createElement(e,l):w&&(t=w.create(e,l)),D.current=t,S(t),t&&t.mount(B.current)}},[w,N,l]);var A=R(l);return r.useEffect(function(){if(D.current){var e=T(l,A,["paymentRequest"]);e&&"update"in D.current&&D.current.update(e)}},[l,A]),r.useLayoutEffect(function(){return function(){if(D.current&&"function"==typeof D.current.destroy)try{D.current.destroy(),D.current=null}catch(e){}}},[]),r.createElement("div",{id:s,className:a,ref:B})};return a.propTypes={id:t.string,className:t.string,onChange:t.func,onBlur:t.func,onFocus:t.func,onReady:t.func,onEscape:t.func,onClick:t.func,onLoadError:t.func,onLoaderStart:t.func,onNetworksChange:t.func,onConfirm:t.func,onCancel:t.func,onShippingAddressChange:t.func,onShippingRateChange:t.func,options:t.object},a.displayName=o,a.__elementType=e,a},J="undefined"==typeof window;r.createContext(null).displayName="EmbeddedCheckoutProviderContext";Z("auBankAccount",J),Z("card",J),Z("cardNumber",J),Z("cardExpiry",J),Z("cardCvc",J),Z("fpxBank",J),Z("iban",J),Z("idealBank",J),Z("p24Bank",J),Z("epsBank",J);var Q=Z("payment",J);Z("expressCheckout",J),Z("currencySelector",J),Z("paymentRequestButton",J),Z("linkAuthentication",J),Z("address",J),Z("shippingAddress",J),Z("paymentMethodMessaging",J),Z("affirmMessage",J),Z("afterpayClearpayMessage",J);const X={pro:4*20,ultra:4*75},ee={pro:{monthly:49,threeMonth:39,sixMonth:29},ultra:{monthly:199,threeMonth:149,sixMonth:119}},te={pro:{week:0,monthly:Math.round(100*(1-ee.pro.monthly/X.pro)),threeMonth:Math.round(100*(1-ee.pro.threeMonth/X.pro)),sixMonth:Math.round(100*(1-ee.pro.sixMonth/X.pro))},ultra:{week:0,monthly:Math.round(100*(1-ee.ultra.monthly/X.ultra)),threeMonth:Math.round(100*(1-ee.ultra.threeMonth/X.ultra)),sixMonth:Math.round(100*(1-ee.ultra.sixMonth/X.ultra))}},re={pro:ee.pro.monthly,ultra:ee.ultra.monthly},ne={premium:{name:"Pro",description:"Unlimited AI Practice & Feedback",features:["Unlimited AI Practice Tests","Examiner-Level Detailed Feedback","Advanced Pronunciation Coaching","Personalized Study Roadmap"],icon:m,color:"from-[#d97757] to-[#e8956f]",shadowColor:"shadow-[#d97757]/20",basePrice:re.pro},pro:{name:"Pro",description:"Unlimited AI Practice & Feedback",features:["Unlimited AI Practice Tests","Examiner-Level Detailed Feedback","Advanced Pronunciation Coaching","Personalized Study Roadmap"],icon:m,color:"from-[#d97757] to-[#e8956f]",shadowColor:"shadow-[#d97757]/20",basePrice:re.pro},ultra:{name:"Ultra",description:"Ultimate Mentorship Package",features:["Everything in Pro Plan","1-on-1 Personal Meeting with Developers","All Premium Templates & E-books","Direct Access to New Beta Features"],icon:p,color:"from-amber-500 to-yellow-400",shadowColor:"shadow-amber-500/20",basePrice:re.ultra}},se=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S=!0;var n=Date.now();return D().then(function(e){return function(e,t,r){if(null===e)return null;var n=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"3.4.1",startTime:t})}(n,r),n}(e,t,n)})}(u.stripe.publishableKey),oe=({plan:e,totalAmount:t,currency:r,region:s,onSuccess:a,onError:i})=>{const l=V("calls useStripe()").stripe,d=H(),[u,m]=n.useState(!1),[p,f]=n.useState(null);return o.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!l||!d)return;m(!0),f(null);const{error:t,paymentIntent:r}=await l.confirmPayment({elements:d,confirmParams:{return_url:`${window.location.origin}/dashboard?payment=success`},redirect:"if_required"});t?(f(t.message||"Payment failed"),i(t.message||"Payment failed"),m(!1)):r&&"succeeded"===r.status?a():m(!1)},className:"space-y-6",children:[o.jsx(Q,{options:{layout:"tabs",business:{name:"English AIdol"},paymentMethodOrder:"korea"===s?["card","kakao_pay","naver_pay"]:"china"===s?["alipay","wechat_pay"]:["card","apple_pay","google_pay"]}}),p&&o.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg flex items-center gap-2",children:[o.jsx(h,{className:"w-4 h-4"})," ",p]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("button",{type:"submit",disabled:!l||u,className:`w-full bg-gradient-to-r ${e.color} text-white font-semibold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-70 flex items-center justify-center gap-2 transform active:scale-[0.98] duration-200`,children:[u?o.jsx(c,{className:"w-5 h-5 animate-spin"}):o.jsx(x,{className:"w-4 h-4"}),"Pay Securely ",{usd:"$",krw:"₩",cny:"¥"}[r],t.toLocaleString()]}),o.jsxs("p",{className:"text-center text-xs text-[#8B6914] font-sans",children:["By clicking pay, you read and agree to our"," ",o.jsx("a",{href:"/terms-of-service",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Terms"}),","," ",o.jsx("a",{href:"/privacy-policy",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," ","and"," ",o.jsx("a",{href:"/refund-policy",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Refund Policy"}),"."]}),o.jsx("p",{className:"text-center text-xs text-[#A68B5B] font-sans mt-2",children:"Subscription automatically renews. Cancel anytime in Settings."})]})]})},ae=()=>{const e=function(){const{search:e}=d();return n.useMemo(()=>new URLSearchParams(e),[e])}(),t=e.get("plan")||"premium";e.get("cancelled");const[r,u]=n.useState(!1),[m,p]=n.useState(null),[y,g]=n.useState(null),v=s(),[j,E]=n.useState("ultra"===t?"ultra":"pro"),[w,N]=n.useState(1),[k,C]=n.useState(!0),[S,D]=n.useState("embedded"),[B,A]=n.useState(""),[P,F]=n.useState("international"),M="korea"===P?"krw":"china"===P?"cny":"usd",O=ne[j],L="pro"===j?"premium":"ultra",R=(e,t)=>{const r=te[t];return"week"===e?r.week:6===e?r.sixMonth:3===e?r.threeMonth:1===e?r.monthly:0},_=(e,t)=>{const r=ee[t];return"week"===e?X[t]:6===e?r.sixMonth:3===e?r.threeMonth:r.monthly},$={usd:"$",krw:"₩",cny:"¥"},I={usd:1,krw:1350,cny:7.2},T=R(w,j),U=X[j],q=_(w,j),W="week"===w,z=W?.25:w,K=Math.round(U*z),H=W?Math.round(.25*U):q*w,G=K-H,V=Math.round(K*I[M]),Z=Math.round(G*I[M]),J=Math.round(H*I[M]),Q=Math.round(q*I[M]);n.useEffect(()=>{C(!0)},[w]),n.useEffect(()=>{"embedded"===S&&re()},[S,j,w,M]);const re=async()=>{u(!0),p(null),g(null);try{const{data:{session:e}}=await f.auth.getSession();if(!e)return void setTimeout(()=>v("/auth"),500);const{data:t,error:r}=await f.functions.invoke("create-embedded-payment",{body:{planId:L,months:w,currency:M}});if(r||!(null==t?void 0:t.clientSecret))throw new Error((null==r?void 0:r.message)||"Init failed");g(t.clientSecret)}catch(e){console.error(e),p("Failed to load payment form")}finally{u(!1)}};return o.jsx("div",{className:"min-h-screen w-full font-serif bg-[#FEF9E7] flex items-center justify-center p-4 py-8",children:o.jsxs("div",{className:"w-full max-w-6xl grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:[o.jsx("div",{className:"lg:col-span-5 flex flex-col gap-6 order-2 lg:order-1",children:o.jsxs("div",{className:"bg-[#FEF9E7] rounded-3xl p-8 shadow-sm border border-[#E8D5A3] relative overflow-hidden group hover:shadow-md transition-all duration-500",children:[o.jsxs("button",{onClick:()=>v(-1),className:"inline-flex items-center gap-2 text-sm text-[#8B6914] hover:text-[#5D4E37] mb-6 transition-colors font-medium",children:[o.jsx(a,{className:"w-4 h-4"})," Back to Plans"]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-semibold text-[#5D4E37] mb-3 font-sans",children:"Select Plan"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("button",{onClick:()=>E("pro"),className:"p-4 rounded-xl border-2 transition-all text-left "+("pro"===j?"border-[#d97757] bg-gradient-to-br from-[#d97757]/10 to-[#e8956f]/10":"border-[#E8D5A3] hover:border-[#d97757]/50"),children:[o.jsx("div",{className:"mb-1",children:o.jsx("span",{className:"font-bold "+("pro"===j?"text-[#d97757]":"text-[#5D4E37]"),children:"Pro"})}),o.jsxs("span",{className:"text-sm text-[#8B6914]",children:[o.jsx("span",{className:"text-xs",children:"from "}),"$",ee.pro.sixMonth,"/mo"]})]}),o.jsxs("button",{onClick:()=>E("ultra"),className:"p-4 rounded-xl border-2 transition-all text-left "+("ultra"===j?"border-amber-500 bg-gradient-to-br from-amber-500/10 to-yellow-400/10":"border-[#E8D5A3] hover:border-amber-500/50"),children:[o.jsx("div",{className:"mb-1",children:o.jsx("span",{className:"font-bold "+("ultra"===j?"text-amber-600":"text-[#5D4E37]"),children:"Ultra"})}),o.jsxs("span",{className:"text-sm text-[#8B6914]",children:[o.jsx("span",{className:"text-xs",children:"from "}),"$",ee.ultra.sixMonth,"/mo"]})]})]})]}),o.jsx("div",{className:"flex items-center gap-4 mb-6",children:o.jsx("div",{children:o.jsxs("h1",{className:"text-3xl font-bold text-[#5D4E37] tracking-tight",children:[O.name," Plan"]})})}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsxs("span",{className:"text-5xl font-bold text-[#5D4E37] font-sans",children:[$[M],Q.toLocaleString()]}),o.jsx("span",{className:"text-[#8B6914] font-medium font-sans",children:"/mo"})]}),T>0&&o.jsxs("p",{className:"text-sm text-[#A68B5B] mt-1 font-sans",children:[o.jsxs("span",{className:"line-through",children:[$[M],Math.round(X[j]*I[M]).toLocaleString(),"/mo"]}),o.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:[T,"% off"]})]}),o.jsx("p",{className:"text-base text-[#8B6914] mt-3 leading-relaxed",children:O.description})]}),o.jsx("div",{className:"space-y-4",children:O.features.map((e,t)=>o.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-[#FDF6E3] transition-colors border border-transparent hover:border-[#E8D5A3]/30",children:[o.jsx("div",{className:"p-1 rounded-full bg-[#E8D5A3] mt-0.5 shrink-0",children:o.jsx(i,{className:"w-3 h-3 text-[#5D4E37]"})}),o.jsx("span",{className:"text-sm font-medium text-[#5D4E37] leading-tight",children:e})]},t))})]})}),o.jsxs("div",{className:"lg:col-span-7 bg-[#FEF9E7] rounded-3xl shadow-xl shadow-[#E8D5A3]/20 border border-[#E8D5A3] overflow-hidden flex flex-col order-1 lg:order-2",children:[o.jsx("div",{className:"p-8 border-b border-[#E8D5A3] bg-[#FDF6E3]/50",children:o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-[#5D4E37] flex items-center gap-2 font-serif",children:"Complete Payment"}),o.jsx("p",{className:"text-sm text-[#8B6914] mt-1 font-sans",children:"Choose your billing cycle"})]})})}),o.jsxs("div",{className:"p-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsxs("label",{className:"block text-sm font-semibold text-[#5D4E37] mb-3 flex items-center gap-2 font-sans",children:[o.jsx(l,{className:"w-4 h-4 text-[#A68B5B]"})," Billing Cycle"]}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[o.jsxs("button",{onClick:()=>N("week"),className:"relative p-4 rounded-xl border transition-all text-left group font-sans "+("week"===w?"border-[#A68B5B] bg-[#FDF6E3] ring-1 ring-[#A68B5B]/30":"border-[#E8D5A3] hover:border-[#A68B5B] hover:bg-[#FDF6E3]/50"),children:[o.jsx("div",{className:"font-bold text-lg mb-1 "+("week"===w?"text-[#5D4E37]":"text-[#8B6914]"),children:"1 Week"}),o.jsxs("div",{className:"mt-2 text-sm font-bold text-[#5D4E37]",children:[$[M],Math.round(X[j]*I[M]).toLocaleString(),o.jsx("span",{className:"text-xs font-normal text-[#8B6914]",children:"/mo"})]})]}),[1,3,6].map(e=>{const t=R(e,j),r=_(e,j),n=Math.round(r*I[M]);return o.jsxs("button",{onClick:()=>N(e),className:"relative p-4 rounded-xl border transition-all text-left group font-sans "+(w===e?"border-[#A68B5B] bg-[#FDF6E3] ring-1 ring-[#A68B5B]/30":"border-[#E8D5A3] hover:border-[#A68B5B] hover:bg-[#FDF6E3]/50"),children:[o.jsxs("div",{className:"absolute -top-2.5 right-3 bg-[#A68B5B] text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-sm tracking-wide",children:["SAVE ",t,"%"]}),o.jsx("div",{className:"font-bold text-lg mb-1 "+(w===e?"text-[#5D4E37]":"text-[#8B6914]"),children:1===e?"Monthly":`${e} Months`}),o.jsxs("div",{className:"mt-2 text-sm font-bold text-[#5D4E37]",children:[$[M],n.toLocaleString(),o.jsx("span",{className:"text-xs font-normal text-[#8B6914]",children:"/mo"})]})]},e)})]})]}),o.jsx("div",{className:"bg-[#FDF6E3] rounded-2xl p-5 border border-[#E8D5A3] mb-8 font-sans",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsxs("span",{className:"text-[#8B6914]",children:["Subtotal (",W?"1 week":`${w} month${w>1?"s":""}`,")"]}),o.jsxs("span",{className:"font-medium text-[#5D4E37]",children:[$[M],V.toLocaleString()]})]}),Z>0&&o.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[o.jsxs("span",{children:["Discount (",T,"% off)"]}),o.jsxs("span",{className:"font-bold",children:["-",$[M],Z.toLocaleString()]})]}),o.jsxs("div",{className:"border-t border-[#E8D5A3] pt-3 flex justify-between items-center",children:[o.jsx("span",{className:"font-bold text-lg text-[#5D4E37]",children:"Total Due"}),o.jsxs("div",{className:"text-right",children:[o.jsxs("span",{className:"font-bold text-2xl text-[#5D4E37]",children:[$[M],J.toLocaleString()]}),o.jsx("p",{className:"text-[10px] text-[#8B6914] font-medium uppercase tracking-wider",children:M.toUpperCase()})]})]})]})}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("label",{className:"block text-sm font-semibold text-[#5D4E37] mb-3 font-sans flex items-center gap-2",children:[o.jsx(b,{className:"w-4 h-4 text-[#A68B5B]"})," Discount Code (Optional)"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:B,onChange:e=>A(e.target.value.toUpperCase()),placeholder:"Enter coupon code",className:"flex-1 px-4 py-3 rounded-xl border border-[#E8D5A3] bg-[#FEF9E7] text-[#5D4E37] placeholder-[#A68B5B]/60 focus:outline-none focus:ring-2 focus:ring-[#A68B5B]/30 focus:border-[#A68B5B] font-sans text-sm"}),o.jsx("button",{type:"button",className:"px-5 py-3 rounded-xl border border-[#E8D5A3] bg-[#FDF6E3] text-[#5D4E37] font-medium text-sm hover:bg-[#E8D5A3]/30 transition-colors font-sans",children:"Apply"})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-semibold text-[#5D4E37] mb-3 font-sans",children:"Region"}),o.jsxs("div",{className:"flex p-1 bg-[#FDF6E3] rounded-xl mb-4 border border-[#E8D5A3]",children:[o.jsx("button",{onClick:()=>F("international"),className:"flex-1 py-2.5 text-sm font-medium rounded-lg transition-all font-sans "+("international"===P?"bg-[#FEF9E7] text-[#5D4E37] shadow-sm border border-[#E8D5A3]":"text-[#8B6914] hover:text-[#5D4E37]"),children:"International"}),o.jsx("button",{onClick:()=>F("china"),className:"flex-1 py-2.5 text-sm font-medium rounded-lg transition-all font-sans "+("china"===P?"bg-[#FEF9E7] text-[#5D4E37] shadow-sm border border-[#E8D5A3]":"text-[#8B6914] hover:text-[#5D4E37]"),children:"China"}),o.jsx("button",{onClick:()=>F("korea"),className:"flex-1 py-2.5 text-sm font-medium rounded-lg transition-all font-sans "+("korea"===P?"bg-[#FEF9E7] text-[#5D4E37] shadow-sm border border-[#E8D5A3]":"text-[#8B6914] hover:text-[#5D4E37]"),children:"Korea"})]}),"korea"===P&&o.jsx("p",{className:"text-xs text-[#8B6914] font-sans mb-4",children:"Kakao Pay, Naver Pay, Korean Cards available"}),"china"===P&&o.jsx("p",{className:"text-xs text-[#8B6914] font-sans mb-4",children:"Alipay, WeChat Pay available"}),o.jsx("label",{className:"block text-sm font-semibold text-[#5D4E37] mb-3 font-sans mt-4",children:"Checkout"}),o.jsxs("div",{className:"flex p-1 bg-[#FDF6E3] rounded-xl mb-4 border border-[#E8D5A3]",children:[o.jsx("button",{onClick:()=>D("embedded"),className:"flex-1 py-2.5 text-sm font-medium rounded-lg transition-all font-sans "+("embedded"===S?"bg-[#FEF9E7] text-[#5D4E37] shadow-sm border border-[#E8D5A3]":"text-[#8B6914] hover:text-[#5D4E37]"),children:"Pay Here"}),o.jsx("button",{onClick:()=>D("redirect"),className:"flex-1 py-2.5 text-sm font-medium rounded-lg transition-all font-sans "+("redirect"===S?"bg-[#FEF9E7] text-[#5D4E37] shadow-sm border border-[#E8D5A3]":"text-[#8B6914] hover:text-[#5D4E37]"),children:"Stripe Checkout"})]})]}),m&&o.jsxs("div",{className:"mb-6 bg-red-50 border border-red-100 text-red-600 p-4 rounded-xl text-sm flex gap-3 items-start animate-in fade-in slide-in-from-top-2",children:[o.jsx(h,{className:"w-5 h-5 shrink-0 mt-0.5"}),o.jsx("span",{children:m})]}),"embedded"===S&&o.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-300",children:r&&!y?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-[#8B6914] gap-3",children:[o.jsx(c,{className:"w-8 h-8 animate-spin text-[#A68B5B]"}),o.jsx("span",{className:"text-sm font-medium",children:"Initializing secure checkout..."})]}):y?o.jsx(Y,{stripe:se,options:{clientSecret:y,appearance:{theme:"flat",variables:{colorPrimary:"#A68B5B",colorBackground:"#FEF9E7",colorText:"#5D4E37",colorDanger:"#ef4444",borderRadius:"12px",fontFamily:"ui-sans-serif, system-ui, sans-serif"},rules:{".Label":{marginBottom:"8px"},".Tab--selected":{borderColor:"#A68B5B",boxShadow:"0 0 0 1px #A68B5B"}}}},children:o.jsx(oe,{plan:O,totalAmount:J,currency:M,region:P,onSuccess:()=>v("/dashboard?payment=success"),onError:p})},`${y}-${P}-${M}`):null}),"redirect"===S&&o.jsxs("div",{className:"text-center py-6 animate-in fade-in zoom-in-95 duration-300",children:[o.jsx("p",{className:"text-[#8B6914] text-sm mb-6 max-w-sm mx-auto font-sans",children:"korea"===P?"Pay with Kakao Pay, Naver Pay, or Korean Cards via Stripe.":"china"===P?"Pay with Alipay, WeChat Pay via Stripe.":"Pay with Card, Apple Pay, Google Pay, or Crypto via Stripe."}),o.jsxs("button",{onClick:async()=>{u(!0);try{const{data:{session:e}}=await f.auth.getSession();if(!e)return void v("/auth");const{data:t,error:r}=await f.functions.invoke("create-payment-intent",{body:{planId:L,months:w,currency:M,successUrl:`${window.location.origin}/dashboard?payment=success&plan=${L}`,cancelUrl:`${window.location.origin}/pay?plan=${L}&cancelled=true`}});if(r||!(null==t?void 0:t.url))throw new Error("Checkout failed");window.location.href=t.url}catch(e){p(e.message),u(!1)}},disabled:r,className:"w-full bg-[#A68B5B] text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-[#A68B5B]/30 hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 font-sans",children:[r?o.jsx(c,{className:"w-5 h-5 animate-spin"}):o.jsx(x,{className:"w-5 h-5"}),"Pay ",$[M],J.toLocaleString()]}),o.jsxs("p",{className:"text-center text-xs text-[#8B6914] font-sans mt-4",children:["By clicking, you read and agree to our"," ",o.jsx("a",{href:"/terms-of-service",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Terms"}),","," ",o.jsx("a",{href:"/privacy-policy",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," ","and"," ",o.jsx("a",{href:"/refund-policy",className:"underline hover:text-[#5D4E37] transition-colors",target:"_blank",rel:"noopener noreferrer",children:"Refund Policy"}),"."]}),o.jsx("p",{className:"text-center text-xs text-[#A68B5B] font-sans mt-2",children:"Subscription automatically renews. Cancel anytime in Settings."})]})]})]})]})})};export{ae as default};
