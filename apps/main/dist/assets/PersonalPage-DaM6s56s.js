import{z as e,j as s,C as a,b as r,c as t,G as n,a as l,S as c,o as i,p as d,L as o,q as x,s as m,A as u,r as h,N as j,F as g,U as p,k as f,B as N,K as v,O as b,Q as y,R as w,x as S,W as k,d as _,Y as T,H as L,e as C,M as D}from"./index-Dn1FbCoL.js";import{T as P,a as A,b as E,c as B}from"./tabs-C-70zI4u.js";import{s as W}from"./supabase-DUkWVuqu.js";import{H as I}from"./Header-C0KtwRaw.js";import{T as q}from"./trophy-Dk_VBv2F.js";import"./dropdown-menu-ygJc1laj.js";const z=({selectedLanguage:u,onLanguageChange:h})=>{const j=e(),g=j.find(e=>e.code===u);return s.jsxs(a,{className:"glass-effect border-border/30",children:[s.jsxs(r,{className:"pb-3",children:[s.jsxs(t,{className:"text-lg flex items-center gap-2",children:[s.jsx(n,{className:"w-5 h-5 text-primary"}),"Select Your Native Language"]}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Choose your mother language for better vocabulary and translation support"})]}),s.jsxs(l,{children:[s.jsxs(c,{value:u,onValueChange:h,children:[s.jsx(i,{className:"w-full bg-surface-1/50 border-border/30",children:s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:null==g?void 0:g.flag}),s.jsx("span",{children:null==g?void 0:g.name}),s.jsx(o,{className:"w-4 h-4 ml-auto text-text-secondary"})]})})}),s.jsx(x,{children:j.map(e=>s.jsx(m,{value:e.code,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:e.flag}),s.jsx("span",{children:e.name})]})},e.code))})]}),"en"!==u&&s.jsxs("div",{className:"mt-3 p-3 bg-primary/10 rounded-lg",children:[s.jsx("p",{className:"text-sm text-primary font-medium",children:"âœ¨ Translation support enabled"}),s.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Get vocabulary help and translations in ",null==g?void 0:g.name]})]})]})]})},R=()=>{const{user:e,profile:n,loading:c}=u(),[i,d]=h.useState([]),[o,x]=h.useState({totalTests:0,averageScore:0,streakDays:0,targetBand:7,currentLevel:"Intermediate",testsThisWeek:0}),[m,R]=h.useState(!0),[G,H]=h.useState("en");if(!c&&!e)return s.jsx(j,{to:"/auth",replace:!0});h.useEffect(()=>{e&&(O(),M())},[e]);const M=async()=>{try{const{data:s}=await W.from("user_preferences").select("native_language").eq("user_id",null==e?void 0:e.id).single();(null==s?void 0:s.native_language)&&H(g(s.native_language))}catch(s){console.error("Error loading native language:",s)}},O=async()=>{try{const{data:s,error:a}=await W.from("test_results").select("*").eq("user_id",null==e?void 0:e.id).order("completed_at",{ascending:!1}).limit(10);if(a)console.error("Error fetching test results:",a);else{d(s||[]);const e=(null==s?void 0:s.length)||0,a=e>0?s.reduce((e,s)=>e+(s.score_percentage||0),0)/e:0,r=new Date;r.setDate(r.getDate()-7);const t=(null==s?void 0:s.filter(e=>new Date(e.completed_at)>r).length)||0;x(s=>({...s,totalTests:e,averageScore:Math.round(a),testsThisWeek:t}))}}catch(s){console.error("Error loading dashboard data:",s)}finally{R(!1)}},F=[{id:"reading",title:"Reading",icon:_,color:"text-blue-600",bgColor:"bg-blue-50",description:"Comprehension & analysis",progress:75,recentScore:7.5},{id:"listening",title:"Listening",icon:L,color:"text-green-600",bgColor:"bg-green-50",description:"Audio comprehension",progress:68,recentScore:6.5},{id:"writing",title:"Writing",icon:C,color:"text-purple-600",bgColor:"bg-purple-50",description:"Essay & task response",progress:60,recentScore:6},{id:"speaking",title:"Speaking",icon:D,color:"text-orange-600",bgColor:"bg-orange-50",description:"Fluency & pronunciation",progress:72,recentScore:7}];return c||m?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(I,{}),s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading your dashboard..."})]})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(I,{}),s.jsx("div",{className:"border-b border-border/40 bg-background/95 backdrop-blur",children:s.jsx("div",{className:"container mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-electric-blue to-neon-green rounded-full flex items-center justify-center",children:s.jsx(p,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-foreground",children:["Welcome back, ",(null==n?void 0:n.full_name)||"Student","!"]}),s.jsx("p",{className:"text-muted-foreground",children:"Track your progress and continue your IELTS journey"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(f,{variant:"secondary",className:"text-sm",children:o.currentLevel}),s.jsxs(N,{variant:"outline",size:"sm",children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]})})}),s.jsxs("div",{className:"container mx-auto px-6 py-8",children:[s.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Total Tests"}),s.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(l,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.totalTests}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",o.testsThisWeek," this week"]})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Average Score"}),s.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(l,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[o.averageScore,"%"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Band ",(e=>{const s=Math.round(e/100*40);return T(s,"academic-reading")})(o.averageScore)," equivalent"]})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Target Band"}),s.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(l,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.targetBand}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Current goal"})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Study Streak"}),s.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(l,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.streakDays}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Days in a row"})]})]})]}),s.jsxs(P,{defaultValue:"overview",className:"space-y-6",children:[s.jsxs(A,{className:"grid w-full grid-cols-3",children:[s.jsx(E,{value:"overview",children:"Overview"}),s.jsx(E,{value:"progress",children:"Progress"}),s.jsx(E,{value:"study-plan",children:"Study Plan"})]}),s.jsxs(B,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Skill Areas"}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:F.map(e=>{const n=e.icon;return s.jsxs(a,{className:"hover:shadow-md transition-shadow",children:[s.jsxs(r,{className:"pb-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg ${e.bgColor} flex items-center justify-center`,children:s.jsx(n,{className:`w-5 h-5 ${e.color}`})}),s.jsxs(f,{variant:"outline",className:"text-xs",children:["Band ",e.recentScore]})]}),s.jsx(t,{className:"text-base",children:e.title}),s.jsx(S,{className:"text-sm",children:e.description})]}),s.jsx(l,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{children:[e.progress,"%"]})]}),s.jsx(k,{value:e.progress,className:"h-2"})]})})]},e.id)})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Test Results"}),s.jsx(a,{children:s.jsx(l,{className:"p-0",children:i.length>0?s.jsx("div",{className:"divide-y",children:i.slice(0,5).map(e=>s.jsxs("div",{className:"p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(_,{className:"w-4 h-4 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.test_type}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.cambridge_book," - Section ",e.section_number]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-medium",children:[e.score_percentage,"%"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(e.completed_at).toLocaleDateString()})]})]},e.id))}):s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[s.jsx(_,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No test results yet"}),s.jsx("p",{className:"text-sm",children:"Start practicing to see your progress here"})]})})})]})]}),s.jsx(B,{value:"progress",className:"space-y-6",children:s.jsxs(a,{children:[s.jsxs(r,{children:[s.jsx(t,{children:"Progress Analytics"}),s.jsx(S,{children:"Detailed breakdown of your performance over time"})]}),s.jsx(l,{children:s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(b,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Progress analytics coming soon"}),s.jsx("p",{className:"text-sm",children:"Track your improvement across all skills"})]})})]})}),s.jsxs(B,{value:"study-plan",className:"space-y-6",children:[s.jsx(z,{selectedLanguage:G,onLanguageChange:async s=>{try{const{error:a}=await W.from("user_preferences").upsert({user_id:null==e?void 0:e.id,native_language:s,updated_at:(new Date).toISOString()});if(a)throw a;H(s)}catch(a){console.error("Error updating language:",a)}}}),s.jsxs(a,{children:[s.jsxs(r,{children:[s.jsx(t,{children:"AI-Powered Study Plan"}),s.jsx(S,{children:"Personalized recommendations based on your performance"})]}),s.jsx(l,{children:s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(y,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"AI study plan coming soon"}),s.jsx("p",{className:"text-sm",children:"Get personalized recommendations for your target band"})]})})]})]})]})]})]})};export{R as default};
