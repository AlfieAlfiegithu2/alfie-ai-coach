import{a8 as e,j as s,C as a,b as r,d as t,a9 as l,a as n,S as c,p as i,q as d,aa as o,s as x,t as m,a3 as h,r as u,ab as j,ac as g,ad as p,l as f,B as N,ae as v,af as b,a2 as y,ag as w,y as S,K as k,e as _,ah as T,H as C,f as D,M as L}from"./index-BHP5ddKT.js";import{T as P,a as E,b as A,c as B}from"./tabs-Dqv5dvms.js";import{s as I}from"./supabase-DWL4C3fA.js";import{H as W}from"./Header-BkrMN_aM.js";import{T as q}from"./trophy-C5skKW0b.js";import"./dropdown-menu-DcymMKnB.js";import"./shield-u7M8ME3P.js";const z=({selectedLanguage:h,onLanguageChange:u})=>{const j=e(),g=j.find(e=>e.code===h);return s.jsxs(a,{className:"glass-effect border-border/30",children:[s.jsxs(r,{className:"pb-3",children:[s.jsxs(t,{className:"text-lg flex items-center gap-2",children:[s.jsx(l,{className:"w-5 h-5 text-primary"}),"Select Your Native Language"]}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Choose your mother language for better vocabulary and translation support"})]}),s.jsxs(n,{children:[s.jsxs(c,{value:h,onValueChange:u,children:[s.jsx(i,{className:"w-full bg-surface-1/50 border-border/30",children:s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:null==g?void 0:g.flag}),s.jsx("span",{children:null==g?void 0:g.name}),s.jsx(o,{className:"w-4 h-4 ml-auto text-text-secondary"})]})})}),s.jsx(x,{children:j.map(e=>s.jsx(m,{value:e.code,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:e.flag}),s.jsx("span",{children:e.name})]})},e.code))})]}),"en"!==h&&s.jsxs("div",{className:"mt-3 p-3 bg-primary/10 rounded-lg",children:[s.jsx("p",{className:"text-sm text-primary font-medium",children:"âœ¨ Translation support enabled"}),s.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Get vocabulary help and translations in ",null==g?void 0:g.name]})]})]})]})},H=()=>{const{user:e,profile:l,loading:c}=h(),[i,d]=u.useState([]),[o,x]=u.useState({totalTests:0,averageScore:0,streakDays:0,targetBand:7,currentLevel:"Intermediate",testsThisWeek:0}),[m,H]=u.useState(!0),[M,R]=u.useState("en");if(!c&&!e)return s.jsx(j,{to:"/auth",replace:!0});u.useEffect(()=>{e&&(O(),G())},[e]);const G=async()=>{try{const{data:s}=await I.from("user_preferences").select("native_language").eq("user_id",null==e?void 0:e.id).single();(null==s?void 0:s.native_language)&&R(g(s.native_language))}catch(s){console.error("Error loading native language:",s)}},O=async()=>{try{const{data:s,error:a}=await I.from("test_results").select("*").eq("user_id",null==e?void 0:e.id).order("completed_at",{ascending:!1}).limit(10);if(a)console.error("Error fetching test results:",a);else{d(s||[]);const e=(null==s?void 0:s.length)||0,a=e>0?s.reduce((e,s)=>e+(s.score_percentage||0),0)/e:0,r=new Date;r.setDate(r.getDate()-7);const t=(null==s?void 0:s.filter(e=>new Date(e.completed_at)>r).length)||0;x(s=>({...s,totalTests:e,averageScore:Math.round(a),testsThisWeek:t}))}}catch(s){console.error("Error loading dashboard data:",s)}finally{H(!1)}},V=[{id:"reading",title:"Reading",icon:_,color:"text-blue-600",bgColor:"bg-blue-50",description:"Comprehension & analysis",progress:75,recentScore:7.5},{id:"listening",title:"Listening",icon:C,color:"text-green-600",bgColor:"bg-green-50",description:"Audio comprehension",progress:68,recentScore:6.5},{id:"writing",title:"Writing",icon:D,color:"text-purple-600",bgColor:"bg-purple-50",description:"Essay & task response",progress:60,recentScore:6},{id:"speaking",title:"Speaking",icon:L,color:"text-orange-600",bgColor:"bg-orange-50",description:"Fluency & pronunciation",progress:72,recentScore:7}];return c||m?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(W,{}),s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading your dashboard..."})]})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(W,{}),s.jsx("div",{className:"border-b border-border/40 bg-background/95 backdrop-blur",children:s.jsx("div",{className:"container mx-auto px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-electric-blue to-neon-green rounded-full flex items-center justify-center",children:s.jsx(p,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-foreground",children:["Welcome back, ",(null==l?void 0:l.full_name)||"Student","!"]}),s.jsx("p",{className:"text-muted-foreground",children:"Track your progress and continue your IELTS journey"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(f,{variant:"secondary",className:"text-sm",children:o.currentLevel}),s.jsxs(N,{variant:"outline",size:"sm",children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]})})}),s.jsxs("div",{className:"container mx-auto px-6 py-8",children:[s.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Total Tests"}),s.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(n,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.totalTests}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",o.testsThisWeek," this week"]})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Average Score"}),s.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(n,{children:[s.jsxs("div",{className:"text-2xl font-bold",children:[o.averageScore,"%"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Band ",(e=>{const s=Math.round(e/100*40);return T(s,"academic-reading")})(o.averageScore)," equivalent"]})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Target Band"}),s.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(n,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.targetBand}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Current goal"})]})]}),s.jsxs(a,{children:[s.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(t,{className:"text-sm font-medium",children:"Study Streak"}),s.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(n,{children:[s.jsx("div",{className:"text-2xl font-bold",children:o.streakDays}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Days in a row"})]})]})]}),s.jsxs(P,{defaultValue:"overview",className:"space-y-6",children:[s.jsxs(E,{className:"grid w-full grid-cols-3",children:[s.jsx(A,{value:"overview",children:"Overview"}),s.jsx(A,{value:"progress",children:"Progress"}),s.jsx(A,{value:"study-plan",children:"Study Plan"})]}),s.jsxs(B,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Skill Areas"}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:V.map(e=>{const l=e.icon;return s.jsxs(a,{className:"hover:shadow-md transition-shadow",children:[s.jsxs(r,{className:"pb-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg ${e.bgColor} flex items-center justify-center`,children:s.jsx(l,{className:`w-5 h-5 ${e.color}`})}),s.jsxs(f,{variant:"outline",className:"text-xs",children:["Band ",e.recentScore]})]}),s.jsx(t,{className:"text-base",children:e.title}),s.jsx(S,{className:"text-sm",children:e.description})]}),s.jsx(n,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{children:[e.progress,"%"]})]}),s.jsx(k,{value:e.progress,className:"h-2"})]})})]},e.id)})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Test Results"}),s.jsx(a,{children:s.jsx(n,{className:"p-0",children:i.length>0?s.jsx("div",{className:"divide-y",children:i.slice(0,5).map(e=>s.jsxs("div",{className:"p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(_,{className:"w-4 h-4 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:e.test_type}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.cambridge_book," - Section ",e.section_number]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-medium",children:[e.score_percentage,"%"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(e.completed_at).toLocaleDateString()})]})]},e.id))}):s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[s.jsx(_,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No test results yet"}),s.jsx("p",{className:"text-sm",children:"Start practicing to see your progress here"})]})})})]})]}),s.jsx(B,{value:"progress",className:"space-y-6",children:s.jsxs(a,{children:[s.jsxs(r,{children:[s.jsx(t,{children:"Progress Analytics"}),s.jsx(S,{children:"Detailed breakdown of your performance over time"})]}),s.jsx(n,{children:s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(b,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Progress analytics coming soon"}),s.jsx("p",{className:"text-sm",children:"Track your improvement across all skills"})]})})]})}),s.jsxs(B,{value:"study-plan",className:"space-y-6",children:[s.jsx(z,{selectedLanguage:M,onLanguageChange:async s=>{try{const{error:a}=await I.from("user_preferences").upsert({user_id:null==e?void 0:e.id,native_language:s,updated_at:(new Date).toISOString()});if(a)throw a;R(s)}catch(a){console.error("Error updating language:",a)}}}),s.jsxs(a,{children:[s.jsxs(r,{children:[s.jsx(t,{children:"AI-Powered Study Plan"}),s.jsx(S,{children:"Personalized recommendations based on your performance"})]}),s.jsx(n,{children:s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(y,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"AI study plan coming soon"}),s.jsx("p",{className:"text-sm",children:"Get personalized recommendations for your target band"})]})})]})]})]})]})]})};export{H as default};
