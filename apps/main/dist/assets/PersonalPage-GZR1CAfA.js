import{j as e,r as s,N as a}from"./vendor-react-JN_hy__U.js";import{F as r,C as t,b as n,c as l,a as c,S as i,i as d,j as o,k as x,l as m,E as u,s as h,G as j,e as g,B as p,o as f,P as v,H as N}from"./index-DXpPY1B7.js";import{T as b,a as y,b as w,c as S}from"./tabs-CUO_kQ2m.js";import{H as k}from"./Header-Dv13wy-4.js";import{G as _,w as T,U as C,af as D,be as L,H as P,K as E,N as A,ao as B,aJ as I,ax as W,aO as G}from"./vendor-ui-DG51EGkO.js";import"./vendor-react-dom-Cb-iy8Oc.js";import"./vendor-animation-ClPlB6zo.js";import"./vendor-i18n-DlHrixAm.js";import"./vendor-utils-D5HPTFR9.js";import"./vendor-supabase-D7XYLCUu.js";import"./vendor-charts-BpOKEG9Z.js";import"./vendor-date-DT7Rq6D9.js";import"./dropdown-menu-hg21KKzu.js";const H=({selectedLanguage:s,onLanguageChange:a})=>{const u=r(),h=u.find(e=>e.code===s);return e.jsxs(t,{className:"glass-effect border-border/30",children:[e.jsxs(n,{className:"pb-3",children:[e.jsxs(l,{className:"text-lg flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-primary"}),"Select Your Native Language"]}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Choose your mother language for better vocabulary and translation support"})]}),e.jsxs(c,{children:[e.jsxs(i,{value:s,onValueChange:a,children:[e.jsx(d,{className:"w-full bg-surface-1/50 border-border/30",children:e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:null==h?void 0:h.flag}),e.jsx("span",{children:null==h?void 0:h.name}),e.jsx(T,{className:"w-4 h-4 ml-auto text-text-secondary"})]})})}),e.jsx(x,{children:u.map(s=>e.jsx(m,{value:s.code,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:s.flag}),e.jsx("span",{children:s.name})]})},s.code))})]}),"en"!==s&&e.jsxs("div",{className:"mt-3 p-3 bg-primary/10 rounded-lg",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:"âœ¨ Translation support enabled"}),e.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Get vocabulary help and translations in ",null==h?void 0:h.name]})]})]})]})},q=()=>{const{user:r,profile:i,loading:d}=u(),[o,x]=s.useState([]),[m,_]=s.useState({totalTests:0,averageScore:0,streakDays:0,targetBand:7,currentLevel:"Intermediate",testsThisWeek:0}),[T,q]=s.useState(!0),[z,O]=s.useState("en");if(!d&&!r)return e.jsx(a,{to:"/auth",replace:!0});s.useEffect(()=>{r&&(F(),R())},[r]);const R=async()=>{try{const{data:e}=await h.from("user_preferences").select("native_language").eq("user_id",null==r?void 0:r.id).single();(null==e?void 0:e.native_language)&&O(j(e.native_language))}catch(e){console.error("Error loading native language:",e)}},F=async()=>{try{const{data:e,error:s}=await h.from("test_results").select("*").eq("user_id",null==r?void 0:r.id).order("completed_at",{ascending:!1}).limit(10);if(s)console.error("Error fetching test results:",s);else{x(e||[]);const s=(null==e?void 0:e.length)||0,a=s>0?e.reduce((e,s)=>e+(s.score_percentage||0),0)/s:0,r=new Date;r.setDate(r.getDate()-7);const t=(null==e?void 0:e.filter(e=>new Date(e.completed_at)>r).length)||0;_(e=>({...e,totalTests:s,averageScore:Math.round(a),testsThisWeek:t}))}}catch(e){console.error("Error loading dashboard data:",e)}finally{q(!1)}},M=[{id:"reading",title:"Reading",icon:B,color:"text-blue-600",bgColor:"bg-blue-50",description:"Comprehension & analysis",progress:75,recentScore:7.5},{id:"listening",title:"Listening",icon:I,color:"text-green-600",bgColor:"bg-green-50",description:"Audio comprehension",progress:68,recentScore:6.5},{id:"writing",title:"Writing",icon:W,color:"text-purple-600",bgColor:"bg-purple-50",description:"Essay & task response",progress:60,recentScore:6},{id:"speaking",title:"Speaking",icon:G,color:"text-orange-600",bgColor:"bg-orange-50",description:"Fluency & pronunciation",progress:72,recentScore:7}];return d||T?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(k,{}),e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading your dashboard..."})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(k,{}),e.jsx("div",{className:"border-b border-border/40 bg-background/95 backdrop-blur",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-electric-blue to-neon-green rounded-full flex items-center justify-center",children:e.jsx(C,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-foreground",children:["Welcome back, ",(null==i?void 0:i.full_name)||"Student","!"]}),e.jsx("p",{className:"text-muted-foreground",children:"Track your progress and continue your IELTS journey"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:"secondary",className:"text-sm",children:m.currentLevel}),e.jsxs(p,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]})})}),e.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Total Tests"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.totalTests}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",m.testsThisWeek," this week"]})]})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Average Score"}),e.jsx(P,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[m.averageScore,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Band ",(e=>{const s=Math.round(e/100*40);return N(s,"academic-reading")})(m.averageScore)," equivalent"]})]})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Target Band"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.targetBand}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current goal"})]})]}),e.jsxs(t,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Study Streak"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.streakDays}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Days in a row"})]})]})]}),e.jsxs(b,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(y,{className:"grid w-full grid-cols-3",children:[e.jsx(w,{value:"overview",children:"Overview"}),e.jsx(w,{value:"progress",children:"Progress"}),e.jsx(w,{value:"study-plan",children:"Study Plan"})]}),e.jsxs(S,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Skill Areas"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:M.map(s=>{const a=s.icon;return e.jsxs(t,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(n,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${s.bgColor} flex items-center justify-center`,children:e.jsx(a,{className:`w-5 h-5 ${s.color}`})}),e.jsxs(g,{variant:"outline",className:"text-xs",children:["Band ",s.recentScore]})]}),e.jsx(l,{className:"text-base",children:s.title}),e.jsx(f,{className:"text-sm",children:s.description})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx(v,{value:s.progress,className:"h-2"})]})})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Test Results"}),e.jsx(t,{children:e.jsx(c,{className:"p-0",children:o.length>0?e.jsx("div",{className:"divide-y",children:o.slice(0,5).map(s=>e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(B,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.test_type}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.cambridge_book," - Section ",s.section_number]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[s.score_percentage,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.completed_at).toLocaleDateString()})]})]},s.id))}):e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No test results yet"}),e.jsx("p",{className:"text-sm",children:"Start practicing to see your progress here"})]})})})]})]}),e.jsx(S,{value:"progress",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"Progress Analytics"}),e.jsx(f,{children:"Detailed breakdown of your performance over time"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Progress analytics coming soon"}),e.jsx("p",{className:"text-sm",children:"Track your improvement across all skills"})]})})]})}),e.jsxs(S,{value:"study-plan",className:"space-y-6",children:[e.jsx(H,{selectedLanguage:z,onLanguageChange:async e=>{try{const{error:s}=await h.from("user_preferences").upsert({user_id:null==r?void 0:r.id,native_language:e,updated_at:(new Date).toISOString()});if(s)throw s;O(e)}catch(s){console.error("Error updating language:",s)}}}),e.jsxs(t,{children:[e.jsxs(n,{children:[e.jsx(l,{children:"AI-Powered Study Plan"}),e.jsx(f,{children:"Personalized recommendations based on your performance"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(E,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"AI study plan coming soon"}),e.jsx("p",{className:"text-sm",children:"Get personalized recommendations for your target band"})]})})]})]})]})]})]})};export{q as default};
