import{r as e,g as r,j as s,C as t,b as n,c as a,x as i,a as o,a8 as l,T as d,S as c,o as m,p as u,q as g,s as h,B as x}from"./index-CclrDLeN.js";import{s as p}from"./supabase-DUkWVuqu.js";const y=[{id:"Cherry",name:"Cherry - Cheerful & Friendly",gender:"Female"},{id:"Ethan",name:"Ethan - Bright & Energetic",gender:"Male"},{id:"Nofish",name:"Nofish - Designer Voice",gender:"Neutral"},{id:"Jennifer",name:"Jennifer - Premium Cinematic",gender:"Female"},{id:"Ryan",name:"Ryan - Rhythmic & Dramatic",gender:"Male"},{id:"Katerina",name:"Katerina - Mature & Rhythmic",gender:"Female"},{id:"Elias",name:"Elias - Academic & Clear",gender:"Male"},{id:"Jada",name:"Shanghai-Jada - Lively",gender:"Female"},{id:"Dylan",name:"Beijing-Dylan - Teenager",gender:"Male"},{id:"Sunny",name:"Sichuan-Sunny - Sweet",gender:"Female"},{id:"Li",name:"Nanjing-Li - Patient Teacher",gender:"Female"},{id:"Marcus",name:"Shaanxi-Marcus - Sincere",gender:"Male"},{id:"Roy",name:"Minnan-Roy - Humorous",gender:"Male"},{id:"Peter",name:"Tianjin-Peter - Crosstalk",gender:"Male"},{id:"Rocky",name:"Cantonese-Rocky - Witty",gender:"Male"},{id:"Kiki",name:"Cantonese-Kiki - Sweet Friend",gender:"Female"},{id:"Eric",name:"Sichuan-Eric - Refined",gender:"Male"}];function f(){const[f,j]=e.useState("Hello! I'm English Tutora, your IELTS Speaking coach. Let's practice together."),[v,b]=e.useState("Cherry"),[N,L]=e.useState(!1),[S,M]=e.useState(null),[E,C]=e.useState(!1),[w,T]=e.useState(null),[k,F]=e.useState(""),{toast:R}=r(),[A,$]=e.useState("What are some tips for IELTS Speaking Part 2?"),[O,J]=e.useState(null),[P,B]=e.useState(!1),[I,D]=e.useState(null);return s.jsx("div",{className:"container mx-auto p-6 max-w-4xl",children:s.jsxs(t,{children:[s.jsxs(n,{children:[s.jsx(a,{children:"Qwen 3 TTS Flash & LLM Test Page"}),s.jsx(i,{children:"Test Qwen 3 TTS Flash API for speech synthesis and LLM for conversation. Test different voices, texts, and AI responses."})]}),s.jsxs(o,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"text",children:"Text to Convert"}),s.jsx(d,{id:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Enter text to convert to speech...",rows:4,maxLength:600}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[f.length," / 600 characters (max for Qwen3-TTS)"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"voice",children:"Voice"}),s.jsxs(c,{value:v,onValueChange:b,children:[s.jsx(m,{id:"voice",children:s.jsx(u,{})}),s.jsx(g,{children:y.map(e=>s.jsx(h,{value:e.id,children:e.name},e.id))})]})]}),s.jsx(x,{onClick:async()=>{L(!0),M(null),C(!1),T(null),F("");try{console.log("ğŸµ Testing Qwen TTS with:",{text:f,voice:v}),F("ğŸ”„ Calling Edge Function...");const{data:r,error:s}=await p.functions.invoke("openrouter-qwen-tts",{body:{text:f,voice:v,language_type:"English"}});if(console.log("Response:",{data:r,error:s}),F(`ğŸ“¥ Response received: ${r?"Has data":"No data"}, ${s?"Has error":"No error"}`),s){console.error("Error object:",s),console.error("Error type:",typeof s),console.error("Error keys:",Object.keys(s||{}));let e="Unknown error";return e=s.message?s.message:s.context?"string"==typeof s.context?s.context:JSON.stringify(s.context):s.details?"string"==typeof s.details?s.details:JSON.stringify(s.details):JSON.stringify(s,Object.getOwnPropertyNames(s)),M(e),F(`âŒ Error: ${e}`),void R({title:"Error",description:e,variant:"destructive"})}if(!r)return M("No data returned from function"),void F("âŒ No data in response");if(r.error||!1===r.success){const e="string"==typeof r.error?r.error:JSON.stringify(r.error||r);return M(e),F(`âŒ Function returned error: ${e}`),void R({title:"Error",description:e,variant:"destructive"})}if(r.audioContent){C(!0),F(`âœ… Audio content received (${r.audioContent.length} bytes)`);try{let e=r.audioContent.trim().replace(/\s/g,"");for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";F(`ğŸ”§ Base64 cleaned (${e.length} chars), decoding...`);const s=atob(e),t=new Uint8Array(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);const n=new Blob([t],{type:"audio/wav"}),a=URL.createObjectURL(n);T(a),F(`âœ… Audio decoded successfully (${n.size} bytes), creating player...`);new Audio(a).play().catch(e=>{console.error("Auto-play failed:",e),F(`âš ï¸ Auto-play failed: ${e.message}`),R({title:"Audio ready",description:"Click play to listen"})}),R({title:"Success!",description:`Audio generated successfully (${r.audioContent.length} bytes)`})}catch(e){const r=`Failed to decode audio: ${e.message||e}`;M(r),F(`âŒ Decode error: ${r}`)}}else M("No audio content in response"),F(`âŒ Response keys: ${Object.keys(r).join(", ")}`)}catch(r){console.error("Test error:",r);const e=r.message||String(r);M(e),F(`âŒ Exception: ${e}`),R({title:"Error",description:e,variant:"destructive"})}finally{L(!1)}},disabled:N||!f.trim(),className:"w-full",children:N?"ğŸ”„ Generating...":"ğŸµ Generate Speech"}),k&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:s.jsx("p",{className:"text-xs font-mono text-blue-800",children:k})}),S&&s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[s.jsx("p",{className:"text-sm font-semibold text-red-800",children:"Error:"}),s.jsx("p",{className:"text-sm text-red-600 mt-1 font-mono break-all",children:S})]}),E&&s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-md",children:[s.jsx("p",{className:"text-sm font-semibold text-green-800",children:"âœ… Success!"}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Audio generated successfully. ",w&&"Playing audio..."]})]}),w&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{children:"Audio Player"}),s.jsx("audio",{controls:!0,src:w,className:"w-full"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Audio URL: ",w.substring(0,50),"..."]})]}),s.jsxs("div",{className:"pt-6 border-t",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"ğŸ¤– Test LLM Conversation"}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsx(l,{htmlFor:"llm-message",children:"LLM Message"}),s.jsx(d,{id:"llm-message",value:A,onChange:e=>$(e.target.value),placeholder:"Enter a message to test the LLM...",rows:3})]}),s.jsx(x,{onClick:async()=>{B(!0),D(null),J(null);try{console.log("ğŸ¤– Testing LLM with message:",A),F("ğŸ”„ Calling AI Speaking Chat function...");const{data:e,error:r}=await p.functions.invoke("ai-speaking-chat",{body:{message:A,audioBase64:null}});if(console.log("LLM Response:",{data:e,error:r}),r){const e=r.message||JSON.stringify(r);return D(e),F(`âŒ LLM Error: ${e}`),void R({title:"LLM Error",description:e,variant:"destructive"})}if(!e)return void D("No data returned from function");if(!1===e.success||e.error){const r="string"==typeof e.error?e.error:JSON.stringify(e.error);return D(r),void R({title:"LLM Error",description:r,variant:"destructive"})}e.response?(J(e.response),F("âœ… LLM response received"),R({title:"Success!",description:"LLM response received"})):D("No response in data")}catch(e){console.error("LLM test error:",e);const r=e.message||String(e);D(r),R({title:"Error",description:r,variant:"destructive"})}finally{B(!1)}},disabled:P||!A.trim(),className:"w-full mb-4",variant:"outline",children:P?"ğŸ”„ Getting response...":"ğŸ¤– Test LLM"}),I&&s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md mb-4",children:[s.jsx("p",{className:"text-sm font-semibold text-red-800",children:"LLM Error:"}),s.jsx("p",{className:"text-sm text-red-600 mt-1 font-mono break-all",children:I})]}),O&&s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-md",children:[s.jsx("p",{className:"text-sm font-semibold text-green-800 mb-2",children:"âœ… LLM Response:"}),s.jsx("p",{className:"text-sm text-green-700 whitespace-pre-wrap",children:O})]})]})]})]})})}export{f as default};
