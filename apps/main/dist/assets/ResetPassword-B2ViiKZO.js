import{u as e,bt as t,r as s,j as r,ar as a}from"./index-x_G9xLa2.js";import{s as d}from"./supabase-DWL4C3fA.js";const o=()=>{const o=e(),[l]=t(),n=l.get("email"),[i,c]=s.useState("request"),[m,u]=s.useState(n||""),[x,f]=s.useState(""),[h,b]=s.useState(""),[p,w]=s.useState(""),[g,j]=s.useState(!1),[v,y]=s.useState(null),[N,k]=s.useState(null);return r.jsxs("div",{className:"min-h-screen w-full font-sans bg-[#f5f2e8] text-[#3c3c3c]",children:[r.jsx("div",{className:"fixed inset-0 bg-[#f5f2e8] -z-10"}),r.jsxs("div",{className:"relative z-10 w-full min-h-screen flex flex-col items-center justify-center px-4 py-10",children:[r.jsxs("button",{type:"button",onClick:()=>o(-1),className:"absolute top-4 left-4 inline-flex items-center gap-2 text-sm text-[#3c3c3c] hover:text-black bg-white/80 backdrop-blur px-3 py-2 rounded-xl border border-[#e6e0d4] font-medium","aria-label":"Go back",children:[r.jsx(a,{className:"w-4 h-4"}),"Back"]}),r.jsx("div",{className:"w-full max-w-md rounded-2xl overflow-hidden shadow-sm bg-white border-2 border-[#d97757]/20 mx-auto",children:r.jsx("div",{className:"p-8 md:p-10 bg-white",children:"request"===i?r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-2xl font-serif font-medium text-[#d97757] text-center mb-2",children:"Reset Password"}),r.jsx("p",{className:"text-sm text-[#666666] text-center mb-6 font-sans",children:"Enter your email to receive a reset code"}),r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),y(null),k(null),m){j(!0);try{const{data:e,error:t}=await d.functions.invoke("request-password-reset",{body:{email:m}});if(t)throw t;if(null==e?void 0:e.error)throw new Error(e.error);k("Password reset code sent! Please check your email for a 6-digit verification code."),c("verify")}catch(t){y(t.message||"Failed to send reset code.")}finally{j(!1)}}else y("Please enter your email address.")},className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Email address"}),r.jsx("input",{id:"email",type:"email",required:!0,value:m,onChange:e=>u(e.target.value),className:"w-full p-3 rounded-xl border border-[#d97757]/20 bg-white text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:""})]}),v&&r.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-100",children:v}),N&&r.jsx("div",{className:"text-sm text-emerald-600 bg-emerald-50 p-3 rounded-lg border border-emerald-100",children:N}),r.jsx("button",{type:"submit",disabled:g,className:"w-full py-3 px-4 bg-[#d97757] text-white font-medium rounded-xl shadow-md hover:bg-[#c56a4b] transform hover:-translate-y-0.5 transition-all font-sans disabled:opacity-50",children:g?"Sending...":"Send Reset Code"}),r.jsx("button",{type:"button",onClick:()=>o("/auth"),className:"w-full py-2 text-sm text-[#666666] hover:text-[#2d2d2d] transition-colors font-sans",children:"Back to Sign In"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-2xl font-serif font-medium text-[#d97757] text-center mb-2",children:"Enter Reset Code"}),r.jsx("p",{className:"text-sm text-[#666666] text-center mb-6 font-sans",children:"Check your email for the 6-digit code"}),r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),y(null),k(null),x&&6===x.length)if(!h||h.length<6)y("Password must be at least 6 characters.");else if(h===p){j(!0);try{const{data:e,error:t}=await d.functions.invoke("reset-password-with-otp",{body:{email:m,code:x,newPassword:h}});if(t)throw t;k("Password reset successfully! Redirecting..."),setTimeout(()=>o("/auth"),1500)}catch(t){y(t.message||"Failed to reset password.")}finally{j(!1)}}else y("Passwords do not match.");else y("Please enter the 6-digit code.")},className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Reset Code"}),r.jsx("input",{id:"code",type:"text",required:!0,maxLength:6,value:x,onChange:e=>f(e.target.value.replace(/\D/g,"")),className:"w-full p-3 rounded-xl border border-[#d97757]/20 bg-white text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all text-center text-2xl tracking-widest font-mono",placeholder:"000000"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"New Password"}),r.jsx("input",{id:"password",type:"password",required:!0,value:h,onChange:e=>b(e.target.value),className:"w-full p-3 rounded-xl border border-[#d97757]/20 bg-white text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"••••••••"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirm",className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Confirm Password"}),r.jsx("input",{id:"confirm",type:"password",required:!0,value:p,onChange:e=>w(e.target.value),className:"w-full p-3 rounded-xl border border-[#d97757]/20 bg-white text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"••••••••"})]}),v&&r.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-100",children:v}),N&&r.jsx("div",{className:"text-sm text-emerald-600 bg-emerald-50 p-3 rounded-lg border border-emerald-100",children:N}),r.jsx("button",{type:"submit",disabled:g,className:"w-full py-3 px-4 bg-[#d97757] text-white font-medium rounded-xl shadow-md hover:bg-[#c56a4b] transform hover:-translate-y-0.5 transition-all font-sans disabled:opacity-50",children:g?"Resetting...":"Reset Password"}),r.jsx("button",{type:"button",onClick:()=>c("request"),className:"w-full py-2 text-sm text-[#666666] hover:text-[#2d2d2d] transition-colors font-sans",children:"Resend Code"})]})]})})})]})]})};export{o as default};
