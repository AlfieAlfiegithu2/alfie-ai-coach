import{u as e,b7 as r,r as t,j as s}from"./index-R5Se49EE.js";import{s as o}from"./supabase-Bqkrifq5.js";const a=()=>{const a=e(),[d]=r(),l=d.get("email"),[n,i]=t.useState("request"),[c,u]=t.useState(l||""),[m,x]=t.useState(""),[f,b]=t.useState(""),[g,h]=t.useState(""),[p,y]=t.useState(!1),[w,j]=t.useState(null),[v,N]=t.useState(null);return s.jsxs("div",{className:"min-h-screen w-full font-sans",children:[s.jsx("div",{className:"fixed inset-0 bg-cover bg-center bg-no-repeat -z-10",style:{backgroundImage:"url('/lovable-uploads/38d81cb0-fd21-4737-b0f5-32bc5d0ae774.png')"}}),s.jsx("div",{className:"fixed inset-0 bg-background/50 backdrop-blur-sm -z-10"}),s.jsx("div",{className:"relative z-10 w-full min-h-screen flex flex-col items-center justify-center px-4 py-10",children:s.jsx("div",{className:"w-full max-w-md rounded-2xl overflow-hidden shadow-xl bg-card/90 border border-border mx-auto",children:s.jsx("div",{className:"p-6 md:p-8 bg-card",children:"request"===n?s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-2xl font-semibold text-foreground text-center mb-2",children:"Reset Password"}),s.jsx("p",{className:"text-sm text-muted-foreground text-center mb-6",children:"Enter your email to receive a reset code"}),s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),j(null),N(null),c){y(!0);try{const{data:e,error:r}=await o.functions.invoke("request-password-reset",{body:{email:c}});if(r)throw r;if(null==e?void 0:e.error)throw new Error(e.error);N("Password reset code sent! Please check your email for a 6-digit verification code."),i("verify")}catch(r){j(r.message||"Failed to send reset code.")}finally{y(!1)}}else j("Please enter your email address.")},className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Email address"}),s.jsx("input",{id:"email",type:"email",required:!0,value:c,onChange:e=>u(e.target.value),className:"w-full p-3 rounded-xl border border-border bg-background text-foreground shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all",placeholder:"your@email.com"})]}),w&&s.jsx("div",{className:"text-sm text-red-500",children:w}),v&&s.jsx("div",{className:"text-sm text-emerald-600",children:v}),s.jsx("button",{type:"submit",disabled:p,className:"w-full py-3 px-4 bg-primary text-primary-foreground font-medium rounded-xl shadow-sm hover:bg-primary/90 disabled:opacity-50",children:p?"Sending...":"Send Reset Code"}),s.jsx("button",{type:"button",onClick:()=>a("/auth"),className:"w-full py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Back to Sign In"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"text-2xl font-semibold text-foreground text-center mb-2",children:"Enter Reset Code"}),s.jsx("p",{className:"text-sm text-muted-foreground text-center mb-6",children:"Check your email for the 6-digit code"}),s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),j(null),N(null),m&&6===m.length)if(!f||f.length<6)j("Password must be at least 6 characters.");else if(f===g){y(!0);try{const{data:e,error:r}=await o.functions.invoke("reset-password-with-otp",{body:{email:c,code:m,newPassword:f}});if(r)throw r;N("Password reset successfully! Redirecting..."),setTimeout(()=>a("/auth"),1500)}catch(r){j(r.message||"Failed to reset password.")}finally{y(!1)}}else j("Passwords do not match.");else j("Please enter the 6-digit code.")},className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Reset Code"}),s.jsx("input",{id:"code",type:"text",required:!0,maxLength:6,value:m,onChange:e=>x(e.target.value.replace(/\D/g,"")),className:"w-full p-3 rounded-xl border border-border bg-background text-foreground shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all text-center text-2xl tracking-widest font-mono",placeholder:"000000"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-muted-foreground mb-2",children:"New Password"}),s.jsx("input",{id:"password",type:"password",required:!0,value:f,onChange:e=>b(e.target.value),className:"w-full p-3 rounded-xl border border-border bg-background text-foreground shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all",placeholder:"••••••••"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirm",className:"block text-sm font-medium text-muted-foreground mb-2",children:"Confirm Password"}),s.jsx("input",{id:"confirm",type:"password",required:!0,value:g,onChange:e=>h(e.target.value),className:"w-full p-3 rounded-xl border border-border bg-background text-foreground shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition-all",placeholder:"••••••••"})]}),w&&s.jsx("div",{className:"text-sm text-red-500",children:w}),v&&s.jsx("div",{className:"text-sm text-emerald-600",children:v}),s.jsx("button",{type:"submit",disabled:p,className:"w-full py-3 px-4 bg-primary text-primary-foreground font-medium rounded-xl shadow-sm hover:bg-primary/90 disabled:opacity-50",children:p?"Resetting...":"Reset Password"}),s.jsx("button",{type:"button",onClick:()=>i("request"),className:"w-full py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Resend Code"})]})]})})})})]})};export{a as default};
