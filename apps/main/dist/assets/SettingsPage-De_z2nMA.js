import{y as e,u as s,g as a,A as r,r as l,j as t,C as i,a8 as n,c,Z as d,b as o,a as m,a9 as x,B as h,aa as u,U as j,ab as p,I as g,Q as f,S as N,o as v,p as b,q as y,s as w,G as k,ac as C,K as S,k as F}from"./index-Dn1FbCoL.js";import{S as _}from"./switch-DEb2vKro.js";import{S as B}from"./separator-D4FeQnFx.js";import{s as A}from"./supabase-DUkWVuqu.js";import{A as D,a as P,b as T,c as U,d as E,e as L,f as I,g as G,h as Y}from"./alert-dialog-CjvLcW48.js";import{C as q}from"./crown-Cmh8160d.js";import{C as M}from"./circle-alert-DpJyDEgt.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),V=e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),z=()=>{const e=s(),{toast:z}=a(),{user:K,profile:W}=r(),[$,H]=l.useState(!0),[Q,X]=l.useState(!1),[Z,J]=l.useState({status:"free",displayName:"Explorer",expiresAt:null,stripeCustomerId:null,stripeSubscriptionId:null}),[O,ee]=l.useState({name:"",email:"",targetBand:"7.5",testDate:"",translationLanguage:"English",notifications:!0,emailUpdates:!1,reminderTime:"09:00",studyGoal:"30"});l.useEffect(()=>{(async()=>{var e;if(K)try{const{data:s}=await A.from("profiles").select("full_name, native_language, subscription_status, subscription_expires_at, stripe_customer_id").eq("id",K.id).single(),{data:a}=await A.from("user_preferences").select("*").eq("user_id",K.id).single(),r=(null==s?void 0:s.subscription_status)||"free";let l="Explorer";"premium"===r||"pro"===r?l="Pro":"ultra"===r&&(l="Ultra"),J({status:r,displayName:l,expiresAt:(null==s?void 0:s.subscription_expires_at)||null,stripeCustomerId:(null==s?void 0:s.stripe_customer_id)||null,stripeSubscriptionId:null}),ee({name:(null==s?void 0:s.full_name)||K.email||"",email:K.email||"",targetBand:(null==(e=null==a?void 0:a.target_score)?void 0:e.toString())||"7.5",testDate:(null==a?void 0:a.target_deadline)||"",translationLanguage:(null==s?void 0:s.native_language)||"English",notifications:!0,emailUpdates:!1,reminderTime:"09:00",studyGoal:"30"})}catch(s){console.error("Error loading settings:",s)}finally{H(!1)}else H(!1)})()},[K]);const se="premium"===Z.status||"pro"===Z.status||"ultra"===Z.status;return $?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx(i,{className:"p-8 text-center",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(n,{className:"w-5 h-5 animate-spin"}),t.jsx(c,{className:"text-2xl",children:"Loading Settings..."})]})})}):t.jsx(d,{title:"Settings",showBackButton:!0,children:t.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[t.jsxs(i,{className:"card-modern border-2 border-[#d97757]/20 bg-gradient-to-br from-white to-[#faf8f6]",children:[t.jsx(o,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(V,{className:"w-5 h-5 text-[#d97757]"}),"Subscription & Billing"]})}),t.jsxs(m,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between p-5 bg-white rounded-xl border border-[#e6e0d4] shadow-sm",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-xl font-bold text-[#2d2d2d]",children:[Z.displayName," Plan"]}),(()=>{const{status:e,displayName:s}=Z;return"ultra"===e?t.jsxs(F,{className:"bg-gradient-to-r from-amber-500 to-yellow-400 text-white border-0 shadow-lg",children:[t.jsx(q,{className:"w-3 h-3 mr-1"}),s]}):"premium"===e||"pro"===e?t.jsxs(F,{className:"bg-gradient-to-r from-[#d97757] to-[#e8956f] text-white border-0",children:[t.jsx(u,{className:"w-3 h-3 mr-1"}),s]}):t.jsx(F,{variant:"secondary",className:"bg-gray-100 text-gray-600",children:s})})()]}),t.jsx("p",{className:"text-sm text-[#666666]",children:se?Z.expiresAt?t.jsxs(t.Fragment,{children:["Active until ",new Date(Z.expiresAt).toLocaleDateString()]}):t.jsx(t.Fragment,{children:"Your subscription is active"}):t.jsx(t.Fragment,{children:"Free forever â€¢ Limited features"})})]}),se&&t.jsx(x,{className:"w-8 h-8 text-green-500"})]}),t.jsxs("div",{className:"grid gap-3",children:[t.jsx("h4",{className:"text-sm font-semibold text-[#2d2d2d] uppercase tracking-wide",children:"Your Plan Includes:"}),se?t.jsxs("ul",{className:"grid gap-2 text-sm text-[#666666]",children:[t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Unlimited AI Practice Tests"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Examiner-Level Detailed Feedback"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Advanced Pronunciation Coaching"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Personalized Study Roadmap"]}),"ultra"===Z.status&&t.jsxs(t.Fragment,{children:[t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}),"1-on-1 Personal Meeting with Developers"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(q,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}),"Direct Access to New Beta Features"]})]})]}):t.jsxs("ul",{className:"grid gap-2 text-sm text-[#666666]",children:[t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Access to 1 Full Practice Test"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Basic AI Scoring & Feedback"]}),t.jsxs("li",{className:"flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"Limited Vocabulary Builder"]}),t.jsxs("li",{className:"flex items-center gap-2 text-[#999999]",children:[t.jsx(M,{className:"w-4 h-4 flex-shrink-0"}),"Upgrade for unlimited tests & advanced feedback"]})]})]}),t.jsx("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:se?t.jsxs(t.Fragment,{children:["ultra"!==Z.status&&t.jsxs(h,{onClick:()=>e("/pay?plan=ultra"),className:"flex-1 bg-gradient-to-r from-amber-500 to-yellow-400 hover:from-amber-600 hover:to-yellow-500 text-white",children:[t.jsx(q,{className:"w-4 h-4 mr-2"}),"Upgrade to Ultra"]}),t.jsxs(D,{children:[t.jsx(P,{asChild:!0,children:t.jsx(h,{variant:"outline",className:"flex-1 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700",children:"Cancel Subscription"})}),t.jsxs(T,{children:[t.jsxs(U,{children:[t.jsx(E,{children:"Cancel Your Subscription?"}),t.jsxs(L,{className:"space-y-2",children:[t.jsxs("p",{children:["Are you sure you want to cancel your ",Z.displayName," subscription?"]}),t.jsx("p",{children:"You'll lose access to:"}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1 mt-2",children:[t.jsx("li",{children:"Unlimited AI Practice Tests"}),t.jsx("li",{children:"Examiner-Level Detailed Feedback"}),t.jsx("li",{children:"Advanced Pronunciation Coaching"}),t.jsx("li",{children:"Personalized Study Roadmap"})]}),t.jsx("p",{className:"mt-3 text-sm",children:"Your access will continue until the end of your current billing period."})]})]}),t.jsxs(I,{children:[t.jsx(G,{children:"Keep My Subscription"}),t.jsx(Y,{onClick:async()=>{X(!0);try{const{data:e,error:s}=await A.functions.invoke("cancel-subscription",{body:{userId:null==K?void 0:K.id}});if(s)throw s;z({title:"Subscription Cancelled",description:"Your subscription has been cancelled. You'll retain access until the end of your billing period."}),J(e=>({...e,status:"free",displayName:"Explorer"}))}catch(e){console.error("Error cancelling subscription:",e),z({title:"Cancellation Failed",description:e.message||"Please contact support at hello@englishaidol.com",variant:"destructive"})}finally{X(!1)}},className:"bg-red-600 hover:bg-red-700",disabled:Q,children:Q?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 mr-2 animate-spin"}),"Cancelling..."]}):"Yes, Cancel"})]})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs(h,{onClick:()=>e("/pay?plan=premium"),className:"flex-1 bg-[#d97757] hover:bg-[#c56a4b] text-white",children:[t.jsx(u,{className:"w-4 h-4 mr-2"}),"Upgrade to Pro - $49/mo"]}),t.jsxs(h,{onClick:()=>e("/pay?plan=ultra"),variant:"outline",className:"flex-1 border-amber-300 text-amber-600 hover:bg-amber-50",children:[t.jsx(q,{className:"w-4 h-4 mr-2"}),"Go Ultra - $199/mo"]})]})})]})]}),t.jsxs(i,{className:"card-modern",children:[t.jsx(o,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(j,{className:"w-5 h-5 text-brand-blue"}),"Profile Information"]})}),t.jsx(m,{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(p,{htmlFor:"name",children:"Full Name"}),t.jsx(g,{id:"name",value:O.name,onChange:e=>ee({...O,name:e.target.value}),className:"input-modern"})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"email",children:"Email Address"}),t.jsx(g,{id:"email",type:"email",value:O.email,disabled:!0,className:"input-modern bg-gray-50"})]})]})})]}),t.jsxs(i,{className:"card-modern",children:[t.jsx(o,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(f,{className:"w-5 h-5 text-brand-green"}),"Study Goals"]})}),t.jsxs(m,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(p,{htmlFor:"targetBand",children:"Target IELTS Band"}),t.jsxs(N,{value:O.targetBand,onValueChange:e=>ee({...O,targetBand:e}),children:[t.jsx(v,{className:"glass-button",children:t.jsx(b,{})}),t.jsxs(y,{children:[t.jsx(w,{value:"6.0",children:"Band 6.0"}),t.jsx(w,{value:"6.5",children:"Band 6.5"}),t.jsx(w,{value:"7.0",children:"Band 7.0"}),t.jsx(w,{value:"7.5",children:"Band 7.5"}),t.jsx(w,{value:"8.0",children:"Band 8.0"}),t.jsx(w,{value:"8.5",children:"Band 8.5"}),t.jsx(w,{value:"9.0",children:"Band 9.0"})]})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"testDate",children:"Target Test Date"}),t.jsx(g,{id:"testDate",type:"date",value:O.testDate,onChange:e=>ee({...O,testDate:e.target.value}),className:"input-modern"})]})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"studyGoal",children:"Daily Study Goal (minutes)"}),t.jsxs(N,{value:O.studyGoal,onValueChange:e=>ee({...O,studyGoal:e}),children:[t.jsx(v,{className:"glass-button",children:t.jsx(b,{})}),t.jsxs(y,{children:[t.jsx(w,{value:"15",children:"15 minutes"}),t.jsx(w,{value:"30",children:"30 minutes"}),t.jsx(w,{value:"45",children:"45 minutes"}),t.jsx(w,{value:"60",children:"1 hour"}),t.jsx(w,{value:"90",children:"1.5 hours"}),t.jsx(w,{value:"120",children:"2 hours"})]})]})]})]})]}),t.jsxs(i,{className:"card-modern",children:[t.jsx(o,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(k,{className:"w-5 h-5 text-brand-purple"}),"Language & Translation"]})}),t.jsx(m,{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx(p,{htmlFor:"translationLanguage",children:"Translation Language"}),t.jsxs(N,{value:O.translationLanguage,onValueChange:e=>ee({...O,translationLanguage:e}),children:[t.jsx(v,{className:"glass-button",children:t.jsx(b,{})}),t.jsx(y,{children:C().map(e=>t.jsx(w,{value:e.value,children:e.label},e.value))})]}),t.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Choose your preferred language for word translations during reading practice"})]})})]}),t.jsxs(i,{className:"card-modern",children:[t.jsx(o,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(R,{className:"w-5 h-5 text-brand-orange"}),"Notifications & Reminders"]})}),t.jsxs(m,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(p,{htmlFor:"notifications",children:"Push Notifications"}),t.jsx("p",{className:"text-sm text-text-secondary",children:"Receive study reminders and progress updates"})]}),t.jsx(_,{id:"notifications",checked:O.notifications,onCheckedChange:e=>ee({...O,notifications:e})})]}),t.jsx(B,{}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(p,{htmlFor:"emailUpdates",children:"Email Updates"}),t.jsx("p",{className:"text-sm text-text-secondary",children:"Weekly progress reports and study tips"})]}),t.jsx(_,{id:"emailUpdates",checked:O.emailUpdates,onCheckedChange:e=>ee({...O,emailUpdates:e})})]}),t.jsxs("div",{children:[t.jsx(p,{htmlFor:"reminderTime",children:"Daily Reminder Time"}),t.jsx(g,{id:"reminderTime",type:"time",value:O.reminderTime,onChange:e=>ee({...O,reminderTime:e.target.value}),className:"input-modern"})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs(h,{onClick:async()=>{if(K)try{await A.from("profiles").update({full_name:O.name,native_language:O.translationLanguage}).eq("id",K.id),await A.from("user_preferences").upsert({user_id:K.id,target_score:parseFloat(O.targetBand),target_deadline:O.testDate||null,preferred_name:O.name}),z({title:"Settings Saved",description:"Your preferences have been updated successfully."})}catch(e){console.error("Error saving settings:",e),z({title:"Error",description:"Failed to save settings. Please try again.",variant:"destructive"})}},className:"btn-primary bg-[#d97757] hover:bg-[#c56a4b]",children:[t.jsx(S,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})]})})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{z as default};
