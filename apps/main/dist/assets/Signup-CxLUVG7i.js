import{A as e,u as s,r as a,j as t,N as l,_ as r,U as n,a1 as o,E as d,a2 as i,J as c}from"./index-BwcFSPrQ.js";import{s as m}from"./supabase-DUkWVuqu.js";import{M as u}from"./mail-5nkSw7rM.js";import{L as x}from"./lock-JG6-vBGm.js";const f=()=>{const{user:f,loading:h}=e(),b=s(),[p,j]=a.useState(""),[v,g]=a.useState(""),[w,N]=a.useState(""),[y,k]=a.useState(""),[P,S]=a.useState(!1),[C,A]=a.useState(null),[E,q]=a.useState(!1),[F,J]=a.useState(!1);return h?t.jsx("div",{className:"min-h-screen w-full font-sans flex flex-col items-center justify-center bg-[#f5f2e8]",children:t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[t.jsx("div",{className:"relative w-20 h-20",children:t.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-[#e6e0d4] border-t-[#d97757] animate-spin"})}),t.jsx("div",{className:"text-xl font-serif font-medium text-[#2d2d2d]",children:"Loading…"})]})}):!h&&f?t.jsx(l,{to:"/dashboard",replace:!0}):t.jsx("div",{className:"min-h-screen w-full font-sans bg-[#f5f2e8] text-[#3c3c3c]",children:t.jsx("div",{className:"relative z-10 w-full min-h-screen flex flex-col items-center justify-center px-4 py-10",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("button",{type:"button",onClick:()=>b("/"),className:"mb-6 inline-flex items-center gap-2 text-sm text-[#666666] hover:text-[#d97757] font-medium transition-colors px-2 py-1 rounded-lg hover:bg-[#d97757]/5","aria-label":"Go back",children:[t.jsx(r,{className:"w-4 h-4"}),"Back to Home"]}),t.jsx("div",{className:"w-full rounded-2xl overflow-hidden shadow-sm bg-white border-2 border-[#d97757]/20",children:t.jsxs("div",{className:"p-8 md:p-10 bg-white",children:[t.jsx("h3",{className:"text-2xl font-serif font-medium text-[#d97757] text-center mb-2",children:"Create Account"}),t.jsx("p",{className:"text-center text-[#666666] text-sm mb-8 font-sans",children:"Start your English mastery journey today"}),t.jsxs("form",{onSubmit:async e=>{var s,a,t;if(e.preventDefault(),A(null),p.trim())if(v)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v))if(w)if(w.length<6)A("Password must be at least 6 characters");else if(w===y){S(!0);try{const{data:e,error:s}=await m.functions.invoke("create-user",{body:{email:v,password:w,fullName:p.trim()}});if(s)throw s;if(null==e?void 0:e.error)throw new Error(e.error);const{error:a}=await m.auth.signInWithPassword({email:v,password:w});if(a)return c.success("Account created! Please sign in."),void b("/auth");c.success("Account created successfully!"),b("/dashboard")}catch(l){console.error("Signup error:",l),(null==(s=l.message)?void 0:s.includes("already registered"))?A("This email is already registered. Try signing in instead."):(null==(a=l.message)?void 0:a.includes("invalid"))?A("Please check your email format and try again."):(null==(t=l.message)?void 0:t.includes("Edge Function"))?A("Service temporarily unavailable. Please try again in a moment."):A(l.message||"Failed to create account. Please try again.")}finally{S(!1)}}else A("Passwords do not match");else A("Please set a password");else A("Please enter a valid email address");else A("Please enter your email address");else A("Please enter your nickname")},className:"space-y-5",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Nickname"}),t.jsxs("div",{className:"relative",children:[t.jsx(n,{className:"absolute left-3 top-3.5 h-5 w-5 text-[#d97757]/50"}),t.jsx("input",{type:"text",required:!0,value:p,onChange:e=>j(e.target.value),className:"w-full pl-10 p-3 rounded-xl border border-[#d97757]/20 bg-[#faf8f6] text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"Johnny"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Email Address"}),t.jsxs("div",{className:"relative",children:[t.jsx(u,{className:"absolute left-3 top-3.5 h-5 w-5 text-[#d97757]/50"}),t.jsx("input",{type:"email",required:!0,value:v,onChange:e=>g(e.target.value),className:"w-full pl-10 p-3 rounded-xl border border-[#d97757]/20 bg-[#faf8f6] text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"john@example.com"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(x,{className:"absolute left-3 top-3.5 h-5 w-5 text-[#d97757]/50"}),t.jsx("input",{type:E?"text":"password",required:!0,value:w,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-12 p-3 rounded-xl border border-[#d97757]/20 bg-[#faf8f6] text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"••••••••"}),t.jsx("button",{type:"button",onClick:()=>q(!E),className:"absolute right-3 top-3.5 text-[#666666] hover:text-[#d97757] transition-colors",children:E?t.jsx(o,{className:"h-5 w-5"}):t.jsx(d,{className:"h-5 w-5"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[#3c3c3c] mb-2 font-sans",children:"Confirm Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(x,{className:"absolute left-3 top-3.5 h-5 w-5 text-[#d97757]/50"}),t.jsx("input",{type:F?"text":"password",required:!0,value:y,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-12 p-3 rounded-xl border border-[#d97757]/20 bg-[#faf8f6] text-[#2d2d2d] shadow-sm focus:outline-none focus:ring-2 focus:ring-[#d97757]/20 focus:border-[#d97757] transition-all font-sans placeholder-[#666666]/50",placeholder:"••••••••"}),t.jsx("button",{type:"button",onClick:()=>J(!F),className:"absolute right-3 top-3.5 text-[#666666] hover:text-[#d97757] transition-colors",children:F?t.jsx(o,{className:"h-5 w-5"}):t.jsx(d,{className:"h-5 w-5"})})]})]}),C&&t.jsxs("div",{className:"p-3 bg-red-50 border border-red-100 rounded-lg text-sm text-red-600 flex items-start gap-2 animate-in fade-in slide-in-from-top-1",children:[t.jsx("div",{className:"mt-0.5",children:"⚠️"}),t.jsx("div",{children:C})]}),t.jsx("button",{type:"submit",disabled:P,className:"w-full py-4 px-6 font-medium rounded-xl shadow-md transform transition-all font-sans flex items-center justify-center gap-2 bg-[#d97757] text-white hover:bg-[#c56a4b] hover:-translate-y-0.5 disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:transform-none",children:P?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-white/30 border-t-white animate-spin"}),"Creating Account..."]}):"Create Account"}),t.jsxs("div",{className:"text-center text-sm text-[#666666] font-sans mt-6",children:["Already have an account? ",t.jsx(i,{className:"text-[#d97757] font-medium hover:underline",to:"/auth",children:"Sign in"})]})]})]})})]})})})};export{f as default};
