import{c as e,r as s,j as a,L as t}from"./vendor-react-rLLBBC7n.js";import{y as r,B as i,C as n,a as d,s as l}from"./index-KxDfHqNJ.js";import{C as c}from"./checkbox-BqZ742qD.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-ui-BGi_EvHx.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";function o(){const{deckId:o}=e(),[m,x]=s.useState("Deck"),[h,f]=s.useState([]),[u,j]=s.useState({}),[p,v]=s.useState(()=>{const e=localStorage.getItem("vocab-deck-shuffle-enabled");return!!e&&JSON.parse(e)});s.useEffect(()=>{(async()=>{if(!o)return;const{data:e}=await l.from("vocab_decks").select("name").eq("id",o).maybeSingle();x((null==e?void 0:e.name)||"Deck");const{data:s}=await l.from("vocab_cards").select("id, term, translation, pos, examples_json, is_known").eq("deck_id",o).order("created_at",{ascending:!0}).limit(50);let a=s||[];if(p&&(a=a.sort(()=>Math.random()-.5)),f(a),a.length>0){const e=a.map(e=>e.id),{data:s}=await l.from("vocab_images").select("card_id, url").in("card_id",e),t={};null==s||s.forEach(e=>{t[e.card_id]=e.url}),j(t)}})()},[o,p]);return a.jsx(r,{title:m,showBackButton:!0,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex justify-end mb-2",children:a.jsxs(i,{variant:p?"default":"outline",size:"sm",onClick:()=>{const e=!p;v(e),localStorage.setItem("vocab-deck-shuffle-enabled",JSON.stringify(e))},children:["ðŸ”€ ",p?"Shuffled":"Shuffle"]})}),a.jsx(n,{children:a.jsxs(d,{className:"p-0 divide-y",children:[h.map(e=>a.jsxs("div",{className:"p-4 flex items-center gap-4",children:[u[e.id]?a.jsx("div",{className:"w-12 h-12 flex-shrink-0 rounded-lg overflow-hidden bg-white border border-gray-200",children:a.jsx("img",{src:u[e.id],alt:e.term,className:"w-full h-full object-cover",loading:"lazy"})}):a.jsx("div",{className:"w-12 h-12 flex-shrink-0 rounded-lg bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center border border-gray-200",children:a.jsx("span",{className:"text-lg font-medium text-gray-500",children:e.term.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"font-medium",children:[e.term," ",e.pos?a.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",e.pos,")"]}):null]}),a.jsx("div",{className:"text-xs text-muted-foreground",children:e.translation}),Array.isArray(e.examples_json)&&e.examples_json[0]&&a.jsxs("div",{className:"text-xs text-muted-foreground italic truncate",children:['"',e.examples_json[0],'"']})]}),a.jsx("div",{className:"flex items-center gap-3 flex-shrink-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{checked:!!e.is_known,onCheckedChange:()=>(async e=>{const s=!e.is_known;await l.from("vocab_cards").update({is_known:s}).eq("id",e.id),f(a=>a.map(a=>a.id===e.id?{...a,is_known:s}:a))})(e)})," ",a.jsx("span",{className:"text-xs",children:"Known"})]})})]},e.id)),0===h.length&&a.jsx("div",{className:"p-6 text-sm text-muted-foreground",children:"No cards in this deck yet."})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(i,{asChild:!0,children:a.jsx(t,{to:`/vocabulary/test/${o}`,children:"Start Test"})}),a.jsx(i,{variant:"outline",asChild:!0,children:a.jsx(t,{to:"/vocabulary",children:"All Decks"})})]})]})})}export{o as default};
