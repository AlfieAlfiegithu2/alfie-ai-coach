import{c as e,ae as a,u as s,a1 as l,r,j as t,bG as o,aa as n,B as c,ar as i,S as d,p as m,ah as h,q as f,s as g,t as u,ad as x,a as p,e as v,af as b}from"./index-C7_FyMei.js";import{s as j}from"./supabase-DWL4C3fA.js";import{f as y}from"./d1Client-Dci7FtIR.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=e("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]),N=e("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]),w=[1,2,3,4],E=[{code:"ko",name:"í•œêµ­ì–´",flag:"ðŸ‡°ðŸ‡·"},{code:"ja",name:"æ—¥æœ¬èªž",flag:"ðŸ‡¯ðŸ‡µ"},{code:"zh",name:"ä¸­æ–‡",flag:"ðŸ‡¨ðŸ‡³"},{code:"vi",name:"Tiáº¿ng Viá»‡t",flag:"ðŸ‡»ðŸ‡³"},{code:"es",name:"EspaÃ±ol",flag:"ðŸ‡ªðŸ‡¸"},{code:"fr",name:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{code:"de",name:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{code:"pt",name:"PortuguÃªs",flag:"ðŸ‡§ðŸ‡·"},{code:"ru",name:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"},{code:"ar",name:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",flag:"ðŸ‡¸ðŸ‡¦"},{code:"hi",name:"à¤¹à¤¿à¤¨à¥à¤¦à¥€",flag:"ðŸ‡®ðŸ‡³"},{code:"id",name:"Bahasa Indonesia",flag:"ðŸ‡®ðŸ‡©"}],B={1:{name:"Level 1",band:"Foundation",Icon:N},2:{name:"Level 2",band:"Elementary",Icon:k},3:{name:"Level 3",band:"Intermediate",Icon:v},4:{name:"Level 4",band:"Advanced",Icon:b}};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function L(){const{user:e,loading:v}=a(),b=s();l();const[k,N]=r.useState(1),[L,C]=r.useState([]),[D,M]=r.useState(!0),[S,V]=r.useState({}),[A,F]=r.useState("ko");r.useEffect(()=>{(async()=>{if(e)try{const{data:a}=await j.from("profiles").select("native_language").eq("id",e.id).single();(null==a?void 0:a.native_language)&&F(a.native_language)}catch(a){console.error("Error loading user preferences:",a)}})()},[e]);r.useEffect(()=>{(async()=>{M(!0);try{let a=[];try{const e=await y({limit:1e4});console.log("VocabLevels: Loaded",e.length,"cards from D1"),a=e.map(e=>({id:e.id,term:e.term,level:e.level}))}catch(e){console.warn("VocabLevels: D1 fetch failed, falling back to Supabase:",e)}if(0===a.length){console.log("VocabLevels: Falling back to Supabase...");const{data:e,error:s}=await j.from("vocab_cards").select("id, term, level").order("created_at",{ascending:!0}).limit(1e4);!s&&e?(a=e.map(e=>({id:e.id,term:e.term,level:e.level||1})),console.log("VocabLevels: Loaded",a.length,"cards from Supabase fallback")):console.error("VocabLevels: Supabase fallback also failed:",s)}const s=Math.ceil(a.length/4),l=a.map((e,a)=>{let l=e.level||1;return(l>4||l<1)&&(l=Math.floor(a/s)+1,l>4&&(l=4)),{id:e.id,term:e.term,level:l}});C(l);const r={};l.forEach(e=>{const a=e.level;r[a]=(r[a]||0)+1}),V(r)}catch(a){console.error("VocabLevels: Error loading cards:",a)}finally{M(!1)}})()},[e]);const I=r.useMemo(()=>{const e=L.filter(e=>e.level===k),a=[],s=Math.ceil(e.length/20);for(let l=0;l<e.length;l+=20){const r=e.slice(l,l+20),t=Math.floor(l/20)+1;a.push({id:`${k}-${t}`,name:`Test ${t}`,wordCount:r.length,level:k,testNumber:t,totalTestsInLevel:s})}return a},[L,k]);return v?t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#FEF9E7]",children:t.jsx(o,{})}):t.jsx("div",{className:"min-h-screen relative bg-[#FEF9E7]",children:t.jsx("div",{className:"relative z-10",children:t.jsx(n,{title:"Vocabulary Tests",showBackButton:!1,transparentBackground:!0,children:t.jsx("div",{className:"min-h-screen py-8",children:t.jsx("div",{className:"container mx-auto px-4",children:t.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[t.jsx("div",{className:"flex items-center mb-4",children:t.jsxs(c,{variant:"ghost",onClick:()=>b("/vocabulary-book"),className:"hover:bg-[#A68B5B] hover:text-white transition-colors rounded-full px-4",style:{color:"#5D4E37"},children:[t.jsx(i,{className:"w-4 h-4 mr-2"}),"Back to Vocabulary"]})}),t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white/50 backdrop-blur-sm p-4 rounded-xl border border-[#E8D5A3] shadow-sm",children:[t.jsx("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:w.map(e=>{const a=k===e,s=B[e];return t.jsxs(c,{variant:a?"default":"outline",onClick:()=>N(e),className:"flex items-center gap-2 "+(a?"":"hover:bg-[#A68B5B]/10"),style:a?{backgroundColor:"#A68B5B",color:"#fff"}:{color:"#5D4E37",borderColor:"#E8D5A3",backgroundColor:"transparent"},children:[t.jsx(s.Icon,{className:"w-4 h-4"}),t.jsx("span",{children:s.name})]},e)})}),t.jsxs(d,{value:A,onValueChange:async a=>{if(F(a),e)try{await j.from("profiles").update({native_language:a}).eq("id",e.id)}catch(s){console.error("Error saving language preference:",s)}},children:[t.jsxs(m,{className:"w-[180px]",style:{backgroundColor:"rgba(255,255,255,0.8)",color:"#5D4E37",borderColor:"#E8D5A3"},children:[t.jsx(h,{className:"w-4 h-4 mr-2 opacity-70"}),t.jsx(f,{})]}),t.jsx(g,{children:E.map(e=>t.jsx(u,{value:e.code,children:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-lg",children:e.flag}),t.jsx("span",{children:e.name})]})},e.code))})]})]}),D?t.jsx("div",{className:"flex justify-center py-12",children:t.jsx(o,{})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-2",style:{color:"#5D4E37"},children:[B[k].name," - ",B[k].band]}),t.jsxs("p",{className:"text-[#8B6914]/80",children:[S[k]||0," words available"]})]}),t.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:I.map(e=>t.jsx(x,{className:"cursor-pointer h-[120px] hover:scale-105 transition-all duration-300 hover:shadow-lg flex items-center justify-center group",onClick:()=>b(`/vocabulary/test/${e.id}?lang=${A}`),style:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:"#E8D5A3"},children:t.jsx(p,{className:"p-3 text-center flex flex-col items-center justify-center h-full w-full",children:t.jsx("h3",{className:"font-semibold text-base group-hover:text-[#A68B5B] transition-colors",style:{color:"#5D4E37"},children:e.name})})},e.id))})]})]})})})})})})}export{L as default};
