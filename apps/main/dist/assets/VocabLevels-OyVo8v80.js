import{u as e,r as a,j as s}from"./vendor-react-rLLBBC7n.js";import{E as r,q as l,a1 as o,y as n,B as t,S as c,i,j as d,k as m,l as h,A as f,a as u,s as x}from"./index-BDl0jLJK.js";import{f as g}from"./d1Client-DHU_uMQx.js";import{az as j,G as v,cm as p,cn as b,ao as y,an as N}from"./vendor-ui-BGi_EvHx.js";import"./vendor-react-dom-CgqbTh6h.js";import"./vendor-charts-0DeywwxG.js";import"./vendor-i18n-gE2_DBDv.js";import"./vendor-utils-Cn4gX4Gv.js";import"./vendor-supabase-DcWtwiPX.js";import"./vendor-animation-DlplP_f6.js";import"./vendor-date-DT7Rq6D9.js";const E=[1,2,3,4],w=[{code:"ko",name:"í•œêµ­ì–´",flag:"ðŸ‡°ðŸ‡·"},{code:"ja",name:"æ—¥æœ¬èªž",flag:"ðŸ‡¯ðŸ‡µ"},{code:"zh",name:"ä¸­æ–‡",flag:"ðŸ‡¨ðŸ‡³"},{code:"vi",name:"Tiáº¿ng Viá»‡t",flag:"ðŸ‡»ðŸ‡³"},{code:"es",name:"EspaÃ±ol",flag:"ðŸ‡ªðŸ‡¸"},{code:"fr",name:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{code:"de",name:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{code:"pt",name:"PortuguÃªs",flag:"ðŸ‡§ðŸ‡·"},{code:"ru",name:"Ð ÑƒÑÑÐºÐ¸Ð¹",flag:"ðŸ‡·ðŸ‡º"},{code:"ar",name:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",flag:"ðŸ‡¸ðŸ‡¦"},{code:"hi",name:"à¤¹à¤¿à¤¨à¥à¤¦à¥€",flag:"ðŸ‡®ðŸ‡³"},{code:"id",name:"Bahasa Indonesia",flag:"ðŸ‡®ðŸ‡©"}],k={1:{name:"Level 1",band:"Foundation",Icon:p},2:{name:"Level 2",band:"Elementary",Icon:b},3:{name:"Level 3",band:"Intermediate",Icon:y},4:{name:"Level 4",band:"Advanced",Icon:N}};function B(){const{user:p,loading:b}=r(),y=e();l();const[N,B]=a.useState(1),[C,D]=a.useState([]),[A,I]=a.useState(!0),[L,F]=a.useState({}),[S,V]=a.useState("ko");a.useEffect(()=>{(async()=>{if(p)try{const{data:e}=await x.from("profiles").select("native_language").eq("id",p.id).single();(null==e?void 0:e.native_language)&&V(e.native_language)}catch(e){console.error("Error loading user preferences:",e)}})()},[p]);a.useEffect(()=>{(async()=>{I(!0);try{const e=await g({limit:1e4});console.log("VocabLevels: Loaded",e.length,"cards from D1");const a=Math.ceil(e.length/4),s=e.map((e,s)=>{let r=e.level||1;return(r>4||r<1)&&(r=Math.floor(s/a)+1,r>4&&(r=4)),{id:e.id,term:e.term,level:r}});D(s);const r={};s.forEach(e=>{const a=e.level;r[a]=(r[a]||0)+1}),F(r)}catch(e){console.error("VocabLevels: Error loading cards from D1:",e)}finally{I(!1)}})()},[p]);const M=a.useMemo(()=>{const e=C.filter(e=>e.level===N),a=[],s=Math.ceil(e.length/20);for(let r=0;r<e.length;r+=20){const l=e.slice(r,r+20),o=Math.floor(r/20)+1;a.push({id:`${N}-${o}`,name:`Test ${o}`,wordCount:l.length,level:N,testNumber:o,totalTestsInLevel:s})}return a},[C,N]);return b?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#FEF9E7]",children:s.jsx(o,{})}):s.jsx("div",{className:"min-h-screen relative bg-[#FEF9E7]",children:s.jsx("div",{className:"relative z-10",children:s.jsx(n,{title:"Vocabulary Tests",showBackButton:!1,transparentBackground:!0,children:s.jsx("div",{className:"min-h-screen py-8",children:s.jsx("div",{className:"container mx-auto px-4",children:s.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[s.jsx("div",{className:"flex items-center mb-4",children:s.jsxs(t,{variant:"ghost",onClick:()=>y("/vocabulary-book"),className:"hover:bg-[#A68B5B] hover:text-white transition-colors rounded-full px-4",style:{color:"#5D4E37"},children:[s.jsx(j,{className:"w-4 h-4 mr-2"}),"Back to Vocabulary"]})}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 bg-white/50 backdrop-blur-sm p-4 rounded-xl border border-[#E8D5A3] shadow-sm",children:[s.jsx("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:E.map(e=>{const a=N===e,r=k[e];return s.jsxs(t,{variant:a?"default":"outline",onClick:()=>B(e),className:"flex items-center gap-2 "+(a?"":"hover:bg-[#A68B5B]/10"),style:a?{backgroundColor:"#A68B5B",color:"#fff"}:{color:"#5D4E37",borderColor:"#E8D5A3",backgroundColor:"transparent"},children:[s.jsx(r.Icon,{className:"w-4 h-4"}),s.jsx("span",{children:r.name})]},e)})}),s.jsxs(c,{value:S,onValueChange:async e=>{if(V(e),p)try{await x.from("profiles").update({native_language:e}).eq("id",p.id)}catch(a){console.error("Error saving language preference:",a)}},children:[s.jsxs(i,{className:"w-[180px]",style:{backgroundColor:"rgba(255,255,255,0.8)",color:"#5D4E37",borderColor:"#E8D5A3"},children:[s.jsx(v,{className:"w-4 h-4 mr-2 opacity-70"}),s.jsx(d,{})]}),s.jsx(m,{children:w.map(e=>s.jsx(h,{value:e.code,children:s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg",children:e.flag}),s.jsx("span",{children:e.name})]})},e.code))})]})]}),A?s.jsx("div",{className:"flex justify-center py-12",children:s.jsx(o,{})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold mb-2",style:{color:"#5D4E37"},children:[k[N].name," - ",k[N].band]}),s.jsxs("p",{className:"text-[#8B6914]/80",children:[L[N]||0," words available"]})]}),s.jsx("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:M.map(e=>s.jsx(f,{className:"cursor-pointer h-[120px] hover:scale-105 transition-all duration-300 hover:shadow-lg flex items-center justify-center group",onClick:()=>y(`/vocabulary/test/${e.id}?lang=${S}`),style:{backgroundColor:"rgba(255,255,255,0.8)",borderColor:"#E8D5A3"},children:s.jsx(u,{className:"p-3 text-center flex flex-col items-center justify-center h-full w-full",children:s.jsx("h3",{className:"font-semibold text-base group-hover:text-[#A68B5B] transition-colors",style:{color:"#5D4E37"},children:e.name})})},e.id))})]})]})})})})})})}export{B as default};
