import{G as e,bt as a,u as s,a8 as t,r as n,j as l,aa as i,B as o,at as r,ar as c,C as d,a as m,av as u,V as h,bG as v}from"./index-C7_FyMei.js";import{s as x}from"./supabase-DWL4C3fA.js";import{b as g,f as p}from"./d1Client-Dci7FtIR.js";import{V as b}from"./volume-x-DExB_aNl.js";function j(){var j,f,N,S,w,y,k,_,C,T;const{deckId:E}=e(),[q]=a(),$=q.get("lang"),L=s(),{theme:A}=t(),[V,z]=n.useState("Deck Test"),[I,M]=n.useState([]),[F,D]=n.useState(0),[R,O]=n.useState({}),[B,P]=n.useState(!1),J=n.useRef(null),[U,G]=n.useState(!1),[W,X]=n.useState(null);n.useEffect(()=>{if(!$||0===I.length)return;(async()=>{console.log(`VocabTest: Fetching translations for ${$} from D1`);const e=I.map(e=>e.id);try{const a=await g(e,$),s={},t={};a.forEach(e=>{e.translations&&e.translations.length>0&&(s[e.card_id]=e.translations[0],t[e.card_id]=e.translations)}),O(s),M(e=>e.map(e=>({...e,translation:s[e.id]||e.translation,translations:t[e.id]||[]})))}catch(a){console.error("VocabTest: Error fetching translations from D1:",a)}})()},[$,0===I.length?0:I[0].id]);const[H,K]=n.useState({}),[Q,Y]=n.useState(""),[Z,ee]=n.useState(!1),[ae,se]=n.useState([]),[te,ne]=n.useState(null),[le,ie]=n.useState(null),[oe,re]=n.useState(null),[ce,de]=n.useState(!1),[me,ue]=n.useState(!1),[he,ve]=n.useState(!1),[xe,ge]=n.useState(0),[pe,be]=n.useState({}),[je,fe]=n.useState(0),[Ne,Se]=n.useState(!1),[we,ye]=n.useState([]),[ke,_e]=n.useState(null),[Ce,Te]=n.useState(null),[Ee,qe]=n.useState(0),[$e,Le]=n.useState(null),[Ae,Ve]=n.useState([]),[ze,Ie]=n.useState({}),[Me,Fe]=n.useState([]),[De,Re]=n.useState(!1),[Oe,Be]=n.useState(!1),[Pe,Je]=n.useState("");n.useState(()=>{const e=localStorage.getItem("vocab-shuffle-enabled");return!!e&&JSON.parse(e)});const Ue=I.length,Ge=I[F]||null,We=ce?I[je]:null,Xe=2===xe?I[Ee]:null,He=2===xe&&Me[Ee]||null,Ke="note"===A.name,Qe=n.useMemo(()=>Ke?{"--behind-gradient":"linear-gradient(to bottom, #E6D29D 0%, #D4C08B 100%)","--inner-gradient":"linear-gradient(145deg, #FEF9E7 0%, #FFFDF5 100%)"}:{"--behind-gradient":"radial-gradient(farthest-side circle at 50% 50%, hsla(220,15%,70%,0.1) 4%, hsla(220,10%,60%,0.05) 10%, hsla(220,5%,50%,0.02) 50%, hsla(220,0%,40%,0) 100%), radial-gradient(35% 52% at 55% 20%, hsla(210,20%,60%,0.1) 0%, hsla(210,15%,50%,0) 100%), radial-gradient(100% 100% at 50% 50%, hsla(200,25%,55%,0.05) 1%, hsla(200,20%,45%,0) 76%), conic-gradient(from 124deg at 50% 50%, hsla(215,20%,65%,0.1) 0%, hsla(215,15%,55%,0.08) 40%, hsla(215,15%,55%,0.08) 60%, hsla(215,20%,65%,0.1) 100%)","--inner-gradient":"linear-gradient(145deg, hsla(220,10%,15%,0.6) 0%, hsla(210,15%,20%,0.4) 100%)"},[Ke]),Ye=n.useMemo(()=>Ke?Qe:{"--behind-gradient":"radial-gradient(farthest-side circle at 50% 50%, hsla(220,15%,70%,0.1) 4%, hsla(220,10%,60%,0.05) 10%, hsla(220,5%,50%,0.02) 50%, hsla(220,0%,40%,0) 100%), radial-gradient(35% 52% at 55% 20%, hsla(210,20%,60%,0.1) 0%, hsla(210,15%,50%,0) 100%), radial-gradient(100% 100% at 50% 50%, hsla(200,25%,55%,0.05) 1%, hsla(200,20%,45%,0) 76%), conic-gradient(from 124deg at 50% 50%, hsla(215,20%,65%,0.1) 0%, hsla(215,15%,55%,0.08) 40%, hsla(215,15%,55%,0.08) 60%, hsla(215,20%,65%,0.1) 100%)","--inner-gradient":"linear-gradient(145deg, hsla(220,10%,15%,0.6) 0%, hsla(210,15%,20%,0.4) 100%)"},[Ke,Qe]);n.useEffect(()=>{(async()=>{var e,a,s;if(!E)return void console.log("VocabTest: No deckId provided");console.log("VocabTest: Loading deckId:",E),await x.auth.getSession();const t=decodeURIComponent(String(E)).trim();console.log("VocabTest: Safe deckId:",t);const n=t.match(/^(\d+)-(\d+)$/);if(n){const e=parseInt(n[1]),a=parseInt(n[2]),s=20,t=["Level 1","Level 2","Level 3","Level 4"][e-1]||`Level ${e}`;console.log(`VocabTest: Synthetic deck detected - Level ${e}, Set ${a}`);const l=(e-1)*500+(a-1)*s;console.log(`VocabTest: Fetching cards with offset ${l}, limit 100`);const i=performance.now(),o=await p({limit:100,offset:l}),r=performance.now()-i;console.log(`VocabTest: Loaded ${o.length} cards in ${r.toFixed(0)}ms`);let c=o.map((a,s)=>({id:a.id,term:a.term,translation:a.term,translations:[],pos:a.pos,ipa:a.ipa,context_sentence:a.context_sentence,examples_json:a.examples_json||[],audio_url:a.audio_url,level:e})).slice(0,s);console.log(`VocabTest: Cards in set ${a}:`,c.length),z(`${t} - Test ${a}`);const d=localStorage.getItem("vocab-shuffle-enabled");return d&&JSON.parse(d)&&(c=c.sort(()=>Math.random()-.5)),M(c),D(0),void P(!0)}const{data:l}=await x.auth.getUser(),i=null==(e=null==l?void 0:l.user)?void 0:e.id,[o,r]=await Promise.all([x.from("vocab_cards").select("id, term, translation, pos, ipa, context_sentence, examples_json").eq("deck_id",t).or(`user_id.eq.${i||"null"},is_public.eq.true`).order("created_at",{ascending:!0}).limit(1e3),x.from("vocab_cards").select("vocab_decks!inner(name)").eq("deck_id",t).limit(1)]);console.log("VocabTest: Cards query result:",o),console.log("VocabTest: Deck name query result:",r);const c=null==(s=null==(a=((null==r?void 0:r.data)||[])[0])?void 0:a.vocab_decks)?void 0:s.name;z(c||"Deck Test");let d=(null==o?void 0:o.data)||[];if(console.log("VocabTest: Initial rows count:",d.length),0===d.length){const{data:e}=await x.from("vocab_cards").select("id, term, translation, pos, ipa, context_sentence, examples_json").eq("deck_id",t).eq("is_public",!0).order("created_at",{ascending:!0}).limit(1e3);d=e||[],console.log("VocabTest: Public fallback rows count:",d.length)}if(0===d.length){const{data:e}=await x.from("vocab_cards").select("id, term, translation, pos, ipa, context_sentence, examples_json, vocab_decks!inner(id)").eq("vocab_decks.id",t).order("created_at",{ascending:!0}).limit(1e3);d=(e||[]).map(e=>({id:e.id,term:e.term,translation:e.translation,translations:[],pos:e.pos,ipa:e.ipa,context_sentence:e.context_sentence,examples_json:e.examples_json})),console.log("VocabTest: Join fallback rows count:",d.length)}console.log("VocabTest: Final rows count:",d.length);const m=localStorage.getItem("vocab-shuffle-enabled");m&&JSON.parse(m)&&(d=d.sort(()=>Math.random()-.5)),M(d),D(0)})()},[E]);const Ze=n.useMemo(()=>Ge?Array.isArray(Ge.examples_json)&&Ge.examples_json[0]?Ge.examples_json[0]:Ge.context_sentence||"":"",[Ge]);n.useMemo(()=>We?Array.isArray(We.examples_json)&&We.examples_json[0]?We.examples_json[0]:We.context_sentence||"":"",[We]);n.useEffect(()=>{const e=localStorage.getItem("vocab-notes");if(e)try{K(JSON.parse(e))}catch(a){console.error("Error loading notes:",a)}},[]),n.useEffect(()=>{Object.keys(H).length>0&&(localStorage.setItem("vocab-notes",JSON.stringify(H)),Y("Saved"),setTimeout(()=>Y(""),2e3))},[H]);const ea=Ge&&H[Ge.id]||"";n.useEffect(()=>{Z&&Ge&&aa()},[Z,Ge]),n.useEffect(()=>{Ne&&We&&sa()},[Ne,We]),n.useEffect(()=>{2===xe&&(He||Xe)&&ta()},[xe,He,Xe]),n.useEffect(()=>{1===xe&&We&&sa()},[xe,We,je]);const aa=()=>{if(!Ge)return;const e=I.filter(e=>e.id!==Ge.id&&e.translation).map(e=>e.translation).filter(e=>e!==Ge.translation).slice(0,3),a=[Ge.translation,...e].sort(()=>Math.random()-.5);se(a),ne(null),ie(null)},sa=()=>{if(!We)return;const e=(We.translation||"").toString(),a=new Set;I.forEach(s=>{if(!s||s.id===We.id)return;const t=(s.translation||"").toString().trim();t&&t.toLowerCase()!==e.toLowerCase()&&(a.has(t.toLowerCase())||a.add(t.toLowerCase()))});let s=Array.from(a).map(e=>{const a=I.find(a=>(a.translation||"").toString().trim().toLowerCase()===e);return((null==a?void 0:a.translation)||"").toString()});s=s.sort(()=>Math.random()-.5).slice(0,3);const t=["A temporary or short-lived occurrence","An idea that lacks practical application","Something rare or infrequently encountered","A minor detail with little significance","A device used to measure performance"],n=new Set([e.toLowerCase(),...s.map(e=>e.toLowerCase())]);for(const i of t){if(s.length>=3)break;n.has(i.toLowerCase())||(s.push(i),n.add(i.toLowerCase()))}for(;s.length<3;){const e=`Option ${s.length+1}`;if(n.has(e.toLowerCase()))break;s.push(e),n.add(e.toLowerCase())}const l=[e,...s].filter(e=>"string"==typeof e&&e.trim().length>0).sort(()=>Math.random()-.5);ye(l),_e(null),Te(null)},ta=()=>{const e=He||Xe;if(!e)return;const a=I.filter(a=>a.id!==e.id&&a.translation).map(e=>e.translation).filter(a=>a!==e.translation).slice(0,3),s=[e.translation,...a].sort(()=>Math.random()-.5);Ve(s),Le(null)},na=e=>{Je(e),Be(!0),setTimeout(()=>Be(!1),3e3)},la=async(e,a)=>{if(B)console.log("VocabTest: Skipping SRS save for D1 card (not in Supabase)");else try{const{data:s}=await x.auth.getUser();if(!(null==s?void 0:s.user))return;const{error:t}=await x.from("vocab_reviews").insert({user_id:s.user.id,card_id:e,rating:a?3:1});t&&console.error("Error saving SRS data:",t)}catch(s){console.error("Error saving SRS data:",s)}},[ia,oa]=n.useState(!1);return n.useEffect(()=>{ee(!1),ie(null),ne(null)},[F]),l.jsxs(i,{title:V,transparentBackground:Ke,fullWidth:Ke,noPadding:Ke,children:[Ke&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"#FEF9E7",zIndex:-1}}),l.jsxs("div",{className:"space-y-4 "+(Ke?"min-h-screen px-4 py-8":""),style:Ke?{background:"#FEF9E7",minHeight:"100vh"}:{},children:[l.jsx(o,{asChild:!0,variant:Ke?"ghost":"secondary",size:"sm",className:"vocab-back-button mb-4 "+(Ke?"hover:bg-[#A68B5B] hover:text-white transition-colors":""),style:Ke?{color:"#5D4E37"}:{},onClick:e=>e.stopPropagation(),children:l.jsxs(r,{to:"/vocabulary",className:"flex items-center gap-2",children:[l.jsx(c,{className:"w-4 h-4"}),"Back"]})}),me&&l.jsx("div",{className:"vocab-screen-container",children:l.jsx(d,{children:l.jsxs(m,{className:"p-6 space-y-4",children:[l.jsx("div",{className:"text-lg font-semibold",children:"Get ready for two quick tests"}),l.jsxs("ul",{className:"text-sm text-muted-foreground list-disc pl-6 space-y-1",children:[l.jsx("li",{children:"Test 1: See the English word with the same image from learning, choose the correct meaning."}),l.jsx("li",{children:"Test 2: See only the English word, choose the correct meaning."})]}),l.jsx("div",{className:"flex gap-2 justify-center pt-2",children:l.jsx(o,{onClick:()=>{ue(!1),de(!0),ge(1),fe(0),be({}),Se(!1),Fe(I)},children:"Start Test 1"})})]})})}),he&&l.jsx("div",{className:"vocab-screen-container",children:l.jsx(d,{children:l.jsxs(m,{className:"p-6 space-y-4",children:[l.jsx("div",{className:"text-lg font-semibold",children:"Next: Word-only test"}),l.jsx("div",{className:"text-sm text-muted-foreground",children:"Now you will only see the English word. Choose the correct meaning."}),l.jsx("div",{className:"flex gap-2 justify-center pt-2",children:l.jsx(o,{onClick:()=>{ve(!1),ge(2),qe(0),Ie({})},children:"Start Test 2"})})]})})}),ce&&We&&1===xe?l.jsxs("div",{className:"vocab-screen-container","data-theme":A.name,onClick:e=>{if(e.target.closest(".vocab-progress, .vocab-back-button"))return;const a=e.currentTarget.getBoundingClientRect(),s=e.clientX-a.left,t=a.width,n=.6*t;s<.4*t?je>0&&(re("prev"),setTimeout(()=>re(null),600),fe(je-1),Se(!1)):s>n&&je<Ue-1&&(re("next"),setTimeout(()=>re(null),600),fe(je+1),Se(!1))},children:[l.jsxs("div",{className:"vocab-progress",children:[l.jsxs("div",{className:"text-sm text-white/80 font-medium",children:["Test 1: ",je+1," / ",Ue]}),l.jsxs("div",{className:"text-xs text-white/60 mt-1",children:["Score: ",Object.values(pe).filter(e=>!0===e).length," correct"]})]}),l.jsx("div",{className:"vocab-card-container "+(oe?`page-turn-${oe}`:""),children:l.jsx("div",{className:"vocab-card-wrapper test1-mode",style:Qe,children:l.jsx("div",{className:"vocab-card-inner",children:l.jsx("section",{className:"vocab-card front",children:l.jsxs("div",{className:"vocab-inside",children:[l.jsx("div",{className:"vocab-shine"}),l.jsx("div",{className:"vocab-glare"}),l.jsx("div",{className:"vocab-image-content",children:l.jsx("div",{className:"word-image-placeholder",children:l.jsx("div",{className:"text-6xl font-bold text-white/80 select-none",children:(null==(f=null==(j=We.term)?void 0:j.slice(0,1))?void 0:f.toUpperCase())||"A"})})}),l.jsxs("div",{className:"vocab-content",children:[l.jsxs("div",{className:"vocab-details",children:[l.jsx("h3",{className:"vocab-term",children:We.term}),l.jsx("p",{className:"vocab-pos",children:We.pos||"word"}),We.ipa&&l.jsxs("p",{className:"vocab-ipa",children:["/",We.ipa,"/"]})]}),l.jsxs("div",{className:"vocab-quiz mt-4",children:[l.jsx("div",{className:"quiz-options",children:we.map((e,a)=>l.jsx("button",{className:"quiz-option "+(ke===e?"correct"===Ce?"correct":"incorrect"===Ce?"incorrect":"selected":""),onClick:()=>!ke&&(e=>{_e(e);const a=e===(null==We?void 0:We.translation);Te(a?"correct":"incorrect"),We&&(be({...pe,[We.id]:a}),la(We.id,a))})(e),disabled:!!ke,children:e},a))}),Ce&&"incorrect"===Ce&&l.jsx("div",{className:`quiz-feedback ${Ce}`,children:"✗ Incorrect"})]})]})]})})})})}),l.jsx("div",{style:{textAlign:"center",marginTop:"20px"},children:l.jsx(o,{variant:"outline",onClick:()=>{const e=Object.values(pe).filter(e=>!0===e).length;if(1===xe)de(!1),ve(!0);else{const a=`Test Results:\n${e} out of ${Ue} correct (${Math.round(e/Ue*100)}%)`;alert(a),de(!1)}},children:1===xe?"Continue to Test 2":"Finish Test"})})]}):2===xe?l.jsxs("div",{className:"vocab-screen-container","data-theme":A.name,onClick:e=>{if(e.target.closest(".vocab-progress, .vocab-back-button, .vocab-add-button, .quiz-option"))return;if(!$e)return;const a=e.currentTarget.getBoundingClientRect();if(e.clientX-a.left>.6*a.width){const e=Me.length||Ue;Ee<e-1?(re("next"),setTimeout(()=>re(null),600),qe(Ee+1),Le(null)):Re(!0)}},children:[l.jsxs("div",{className:"vocab-progress",children:[l.jsxs("div",{className:"text-sm text-white/80 font-medium",children:["Test 2: ",Math.min(Ee+1,Me.length||Ue)," / ",Me.length||Ue]}),l.jsxs("div",{className:"text-xs text-white/60 mt-1",children:["Score: ",Object.values(ze).filter(e=>!0===e).length," correct"]})]}),l.jsx("div",{className:"vocab-card-container "+(oe?`page-turn-${oe}`:""),children:l.jsx("div",{className:"vocab-card-wrapper test2-mode",style:Ye,children:l.jsx("div",{className:"vocab-card-inner",children:l.jsx("section",{className:"vocab-card front",children:l.jsxs("div",{className:"vocab-inside",children:[l.jsx("div",{className:"vocab-shine"}),l.jsx("div",{className:"vocab-glare"}),l.jsxs("div",{className:"vocab-content",children:[l.jsxs("div",{className:"vocab-details",children:[l.jsx("h3",{className:"vocab-term",children:null==(N=He||Xe)?void 0:N.term}),l.jsx("p",{className:"vocab-pos",children:(null==(S=He||Xe)?void 0:S.pos)||"word"}),(null==(w=He||Xe)?void 0:w.ipa)&&l.jsxs("p",{className:"vocab-ipa",children:["/",null==(y=He||Xe)?void 0:y.ipa,"/"]})]}),l.jsx("div",{className:"vocab-quiz",children:l.jsx("div",{className:"quiz-options",children:Ae.map((e,a)=>{var s;return l.jsx("button",{className:"quiz-option "+($e===e?e===(null==(s=He||Xe)?void 0:s.translation)?"correct":"incorrect":""),onClick:()=>!$e&&(e=>{Le(e);const a=He||Xe,s=e===(null==a?void 0:a.translation);a&&(Ie({...ze,[a.id]:!!s}),la(a.id,!!s))})(e),disabled:!!$e,children:e},a)})})})]})]})})})})}),De&&l.jsx("div",{className:"mt-4",children:l.jsx(d,{className:"w-full max-w-2xl mx-auto",children:l.jsxs(m,{className:"p-6 space-y-4",children:[l.jsx("div",{className:"text-lg font-semibold text-center",children:"Results"}),l.jsxs("div",{className:"text-center text-muted-foreground",children:["Correct: ",Object.values(ze).filter(e=>!0===e).length," / ",Me.length||Ue]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium mb-2",children:"Need more practice"}),l.jsx("div",{className:"grid gap-2",children:(Me.length?Me:I).filter(e=>!ze[e.id]).map(e=>l.jsxs("div",{className:"rounded-md border p-3 flex items-center justify-between",children:[l.jsx("div",{className:"text-sm font-medium",children:e.term}),l.jsx("div",{className:"text-xs text-muted-foreground",children:e.translation})]},e.id))})]}),l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsx(o,{onClick:()=>{const e=(Me.length?Me:I).filter(e=>!ze[e.id]);if(0===e.length)return Re(!1),void L("/vocabulary");Fe(e),Ie({}),qe(0),Le(null),Re(!1)},children:0===(Me.length?Me:I).filter(e=>!ze[e.id]).length?"Done":"Retake wrong only"}),l.jsx(o,{variant:"secondary",onClick:()=>L("/vocabulary"),children:"Back to Vocabulary"})]})]})})})]}):Ge?l.jsxs("div",{className:"vocab-screen-container","data-theme":A.name,onClick:e=>{if(e.target.closest(".vocab-navigation, .vocab-notes-section, .vocab-progress, .vocab-back-button"))return;const a=e.currentTarget.getBoundingClientRect(),s=e.clientX-a.left,t=a.width,n=.6*t;s<.4*t?F>0&&(re("prev"),setTimeout(()=>re(null),600),D(e=>Math.max(e-1,0))):s>n&&(F<Ue-1?(re("next"),setTimeout(()=>re(null),600),D(e=>Math.min(e+1,Math.max(0,Ue-1)))):F===Ue-1&&ue(!0))},children:[l.jsx("div",{className:"vocab-progress",children:l.jsx("div",{className:"text-sm text-white/80 font-medium",children:Ue?`${F+1} / ${Ue}`:"0 / 0"})}),l.jsxs("div",{className:"vocab-card-container "+(oe?`page-turn-${oe}`:""),children:[l.jsx("div",{className:"vocab-card-wrapper "+(Z?"flipped":""),onClick:e=>{e.target.closest(".quiz-option")||(e.stopPropagation(),ee(!Z))},style:Qe,children:l.jsxs("div",{className:"vocab-card-inner",children:[l.jsx("section",{className:"vocab-card front",children:l.jsxs("div",{className:"vocab-inside",children:[l.jsx("div",{className:"vocab-shine"}),l.jsx("div",{className:"vocab-glare"}),l.jsx("div",{className:"vocab-image-content",children:l.jsx("div",{className:"word-image-placeholder",children:l.jsx("div",{className:"text-6xl font-bold text-white/80 select-none",children:(null==(_=null==(k=Ge.term)?void 0:k.slice(0,1))?void 0:_.toUpperCase())||"A"})})}),l.jsxs("div",{className:"vocab-content",children:[l.jsxs("div",{className:"vocab-details",children:[l.jsxs("div",{className:"vocab-term-row",children:[l.jsx("h3",{className:"vocab-term",children:Ge.term}),Ge.audio_url&&l.jsx("button",{className:`vocab-audio-btn ${U&&W===Ge.id?"playing":""} ${ia?"loading":""}`,onClick:e=>{e.stopPropagation(),((e,a)=>{if(U&&W===a)return J.current&&(J.current.pause(),J.current.currentTime=0),G(!1),X(null),void oa(!1);ia||(J.current&&(J.current.pause(),J.current.currentTime=0),oa(!0),J.current=new Audio(e),J.current.onerror=()=>{console.warn("Audio unavailable:",e),na("Audio unavailable"),G(!1),X(null),oa(!1)},J.current.play().then(()=>{G(!0),X(a),oa(!1)}).catch(a=>"AbortError"===a.name?(console.log("Audio play aborted (normal when toggling quickly)"),void oa(!1)):"NotSupportedError"===a.name?(console.warn("Audio file not available:",e),void oa(!1)):(console.error("Error playing audio:",a),na("Could not play audio"),G(!1),X(null),void oa(!1))),J.current.onended=()=>{G(!1),X(null)})})(Ge.audio_url,Ge.id)},disabled:ia,title:ia?"Loading...":U&&W===Ge.id?"Stop":"Play pronunciation",children:ia?l.jsx(u,{className:"w-5 h-5 animate-spin"}):U&&W===Ge.id?l.jsx(b,{className:"w-5 h-5"}):l.jsx(h,{className:"w-5 h-5"})})]}),l.jsx("p",{className:"vocab-pos",children:Ge.pos||"word"}),Ge.ipa&&l.jsxs("p",{className:"vocab-ipa",children:["/",Ge.ipa,"/"]})]}),((null==(C=Ge.translations)?void 0:C.length)>0||Ge.translation)&&l.jsx("div",{className:"vocab-translation",children:(null==(T=Ge.translations)?void 0:T.length)>1?l.jsx("div",{className:"translation-text",children:Ge.translations.map((e,a)=>l.jsxs("span",{children:[e,a<Ge.translations.length-1?", ":""]},a))}):l.jsx("div",{className:"translation-text",children:Ge.translation})}),Ze&&l.jsx("div",{className:"vocab-example",children:l.jsx("div",{className:"example-text",dangerouslySetInnerHTML:{__html:((e,a)=>{if(!e||!a)return e;const s=new RegExp(`\\b(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi");return e.replace(s,e=>`<mark class="highlighted-word">${e}</mark>`)})(Ze,(null==Ge?void 0:Ge.term)||"")}})})]})]})}),l.jsx("section",{className:"vocab-card back",children:l.jsxs("div",{className:"vocab-inside",children:[l.jsx("div",{className:"vocab-shine"}),l.jsx("div",{className:"vocab-glare"}),l.jsxs("div",{className:"vocab-quiz",children:[l.jsxs("div",{className:"quiz-header",children:[l.jsx("h3",{className:"quiz-question",children:"What is the translation of:"}),l.jsx("div",{className:"quiz-word",children:Ge.term})]}),l.jsx("div",{className:"quiz-options",children:ae.map((e,a)=>l.jsx("button",{className:"quiz-option "+(te===e?"correct"===le?"correct":"incorrect"===le?"incorrect":"selected":""),onClick:()=>!te&&(e=>{ne(e);const a=e===(null==Ge?void 0:Ge.translation);ie(a?"correct":"incorrect"),Ge&&la(Ge.id,a)})(e),disabled:!!te,children:e},a))}),le&&"incorrect"===le&&l.jsx("div",{className:`quiz-feedback ${le}`,children:"✗ Incorrect"})]})]})})]})}),l.jsxs("div",{className:"vocab-notes-section",onClick:e=>e.stopPropagation(),children:[l.jsx("textarea",{className:"notes-textarea",placeholder:"",value:ea,onChange:e=>{return Ge&&(a=Ge.id,s=e.target.value,void K(e=>({...e,[a]:s})));var a,s},rows:3}),Q&&l.jsx("div",{className:"notes-save-indicator "+("Saved"===Q?"notes-saved":""),children:Q})]})]})]}):l.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:l.jsx(v,{})}),Oe&&l.jsx("div",{className:"vocab-toast",children:Pe})]})]})}export{j as default};
