const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminDashboard-BlYBvKdz.js","assets/vendor-react-JN_hy__U.js","assets/vendor-react-dom-Cb-iy8Oc.js","assets/vendor-animation-ClPlB6zo.js","assets/AdminLayout-D3lPYw5Y.js","assets/vendor-ui-DG51EGkO.js","assets/vendor-i18n-DlHrixAm.js","assets/vendor-utils-D5HPTFR9.js","assets/vendor-supabase-D7XYLCUu.js","assets/vendor-charts-BpOKEG9Z.js","assets/vendor-date-DT7Rq6D9.js","assets/AdminReading-DVVZKHJE.js","assets/table-K6aSiYdl.js","assets/collapsible-CWlZ7QcT.js","assets/CSVImport-BoWRa86L.js","assets/alert-BV1wokst.js","assets/AdminListening-RM1NW6mv.js","assets/AdminWriting-DeEdhadV.js","assets/AdminSpeaking-Cfaw5nFZ.js","assets/AdminIELTS-DajXv7Xw.js","assets/tabs-CUO_kQ2m.js","assets/separator-Bv0Pudil.js","assets/alert-dialog-BwGJZs3W.js","assets/skills-NqzSOyzV.js","assets/AdminPTE-DxlsWTNO.js","assets/AdminTOEFL-BqLV7H6-.js","assets/ModuleSelector-DibL1cOC.js","assets/AdminTOEIC-Dg0VDV-2.js","assets/AdminTOEICListening-DbZn3VX1.js","assets/ImageQuestionExtractor-66fJ2WkK.js","assets/AdminTOEICReading-DdMh45Og.js","assets/TOEICListeningTest-Cc7CWJNO.js","assets/Header-Dv13wy-4.js","assets/dropdown-menu-hg21KKzu.js","assets/TOEICReadingTest-D3Vyaz9u.js","assets/scroll-area-BNmJIUH0.js","assets/TOEICReadingResult-nomw-Rlq.js","assets/TOEICPortal-h17OhRcr.js","assets/AdminPTESpeakingWriting-K4gNoZqa.js","assets/AdminPTEReading-C0vNwzX7.js","assets/AdminPTEListening-DrEytk62.js","assets/PTESpeakingWritingTest-BEm5eibL.js","assets/shimmering-text-CGAxJt3i.js","assets/PTEReadingTest-DvE6Fclm.js","assets/checkbox-Xp4fA8WG.js","assets/PTEListeningTest-BVA66RVx.js","assets/AdminGeneral-OBov-yx4.js","assets/PersonalPage-GZR1CAfA.js","assets/TestSelection-7JEO0pyc.js","assets/Auth-Ch8JR-85.js","assets/NotFound-Czk44B-Y.js","assets/CommunityPage-CZ8A7Cf4.js","assets/SettingsPage-CcaEBvUt.js","assets/switch-BN6iUzgJ.js","assets/PTEPortal-DTE2JB1X.js","assets/TOEFLPortal-lK1UJTM_.js","assets/GeneralPortal-DWymOHfc.js","assets/EnhancedGeneralPortal-Dvt28ArJ.js","assets/IELTSPortal-BqZ4uBmw.js","assets/IELTSSkillHub-GQ4cGBC-.js","assets/IELTSSkillTests-G5P5wtqU.js","assets/AdminIELTSSkillManagement-CTENchny.js","assets/IELTSTestModules-Cn0-1Ffu.js","assets/QwenTTSTest-BZ3ev3s3.js","assets/AdminTestManagement-Pc_BVGzw.js","assets/AdminTestDetails-cXv_nqid.js","assets/AdminSectionManagement-Hc9KYB58.js","assets/AdminReadingManagement-DK21Vme7.js","assets/AdminIELTSReadingDashboard-BnJyhP-0.js","assets/AdminIELTSListening-0ue_dRHK.js","assets/AdminIELTSWriting-5bL1pBAh.js","assets/AdminIELTSWritingTest-D066eo3Z.js","assets/cloudflare-r2-BQTbMcui.js","assets/AdminIELTSReadingTest-CVCoAxAB.js","assets/AdminIELTSSpeaking-Dkm6W-MR.js","assets/IELTSWritingTest-D1kVLacz.js","assets/languages-qPB6CivY.js","assets/IELTSWritingProResults-BfOAMYBg.js","assets/PenguinClapAnimation-Czda42R5.js","assets/IELTSWritingResults-DIWZr47U.js","assets/AnnotatedWritingText-B6LuC5Sa.js","assets/ReadingResults-DnLDmyUw.js","assets/ListeningResults-DyP1R9N9.js","assets/IELTSSpeakingResults-CqcASzA2.js","assets/CustomAudioPlayer-DZldFkLw.js","assets/IELTSSpeakingTest-Bs8GJyw_.js","assets/slider-DoXo1FeJ.js","assets/EnhancedReadingTest-Dq746lm1.js","assets/Pricing-XLndgLk_.js","assets/AdminSkillsPractice-BEKky-Jh.js","assets/AdminSkillManager-ORYBkg2t.js","assets/SkillPractice-C6kBFoeB.js","assets/VocabularyMapView-DwJe3eyJ.js","assets/AISpeakingCall-D48zUMOK.js","assets/AISpeakingTutor-C0c99l_f.js","assets/AdminVocabularyTests-D8ERYCiE.js","assets/AdminVocabBook-D_SDxoFs.js","assets/AdminVocabManager-BOHiqRWu.js","assets/AdminVocabularyTestDetail-BQBwDdbj.js","assets/VocabularyQuizPreview-DUT6ZHr6.js","assets/AdminGrammarTests-D6P6iRnF.js","assets/AdminGrammarTestDetail-DM2ZVVGF.js","assets/AdminParaphrasingTests-sb3hjF2Q.js","assets/AdminParaphrasingTestDetail-BybOa-vb.js","assets/AdminPronunciationTests-yj87DG28.js","assets/AdminPronunciationTestDetail-BLPhW-Xe.js","assets/AdminSentenceScrambleTests-Xgd2A2db.js","assets/AdminSentenceScrambleTestDetail-BvHefOJr.js","assets/AdminListeningForDetailsTests-BoM9ArbT.js","assets/AdminListeningForDetailsTestDetail-BXpVY_EW.js","assets/VocabularyQuiz-pDTWFX5G.js","assets/CelebrationLottieAnimation-De7X-m8e.js","assets/GrammarQuiz-CbrvS50L.js","assets/ParaphraseQuiz-DcgsII6K.js","assets/SentenceScrambleQuiz-CHpea66y.js","assets/ListeningQuiz-CQF9Veoh.js","assets/VocabularyMap-DgpLx2CZ.js","assets/VocabularyBook-CdpNnBKu.js","assets/d1Client-DHU_uMQx.js","assets/VocabHome-B0qE_mVv.js","assets/VocabDeck-A9KxnDy0.js","assets/VocabReview-B6BtXWm5.js","assets/VocabLevels-DME58U_L.js","assets/VocabTest-C1Uk0NWx.js","assets/VocabTest-pHZLh13M.css","assets/Signup-mUHpyKC6.js","assets/AuthCallback-D4IpqJL9.js","assets/WritingHistory-BnWAbDXG.js","assets/WritingResultsDetail-CCrG3Zgf.js","assets/Pay-abLPjvHr.js","assets/ResetPassword-37TfJbW1.js","assets/MyWordBook-BF3HBoNK.js","assets/AdminAnalytics-CIxGjmBz.js","assets/OnboardingAssessment-CoZ4e-6g.js","assets/taskBank-C_v_y-ZR.js","assets/Plan-DMf8Wi4v.js","assets/BlogListing-D4l7yp8I.js","assets/blogUtils-DAXgFpPF.js","assets/BlogDetail-2_lR0XuC.js","assets/AdminBlogManagement-626MnREE.js","assets/AdminBookCreation-zxLCmRx2.js","assets/jspdf.es.min-vK8Sab3n.js","assets/AdminTemplates-CGQ7op9r.js","assets/AdminAffiliates-DQ5MgS97.js","assets/AdminAffiliateDetail-AydqUscM.js","assets/GrammarPortal-DOwlaF70.js","assets/GrammarLesson-nWYHJstc.js","assets/AdminGrammarDashboard-DlqQXAuM.js","assets/AdminGrammarLessonEditor-ClaVjqLe.js","assets/BusinessPortal-DfMW0zEt.js","assets/ResumeBuilder-DbeBbfU2.js","assets/html2canvas.esm-BTH0Ap93.js","assets/EmailPractice-DcqMwFiI.js","assets/InterviewPractice-C2cu4wp4.js","assets/NCLEXPortal-BGEnzBXe.js","assets/NCLEXTest-BJfRvev9.js","assets/AdminNCLEX-O5f-hZ2d.js","assets/AdminNCLEXTestDetail-Dtq7FJy2.js","assets/BooksLibrary-B_xO7EfQ.js","assets/BookReader-DShol5QV.js","assets/TemplatesGallery-CUywm3oq.js","assets/PrivacyPolicy-DdrVtsLo.js","assets/RefundPolicy-D2ds0mEq.js","assets/TermsOfService-zxqmexsE.js","assets/Support-D7WxcyO9.js","assets/PodcastListing-CWbSMfKu.js","assets/AdminPodcast-B628bFxf.js"])))=>i.map(i=>d[i]);
var e,t,s=Object.defineProperty,a=(e,t,a)=>((e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);import{r,j as n,R as i,u as o,L as l,b as c,N as d,c as u,d as m,B as h,e as g,f as p}from"./vendor-react-JN_hy__U.js";import{R as x,d as f}from"./vendor-react-dom-Cb-iy8Oc.js";import{i as b,B as y,a as v,b as j,u as w,_,I as N}from"./vendor-i18n-DlHrixAm.js";import{t as k,c as E,V as S,R as T,A as C,C as I,X as A,T as P,D as L,a as M,P as O,b as R,d as D,e as F,f as z,S as B,g as $,I as q,h as V,i as W,j as U,k as G,l as Y,m as H,n as J,L as X,o as Q,p as K,q as Z,r as ee,s as te,u as se,v as ae,B as re,w as ne,M as ie,U as oe,x as le,y as ce,z as de,E as ue,G as me,F as he,H as ge,J as pe,K as xe,N as fe,O as be,Q as ye,W as ve,Y as je,Z as we,_ as _e,$ as Ne,a0 as ke,a1 as Ee,a2 as Se,a3 as Te,a4 as Ce,a5 as Ie,a6 as Ae,a7 as Pe,a8 as Le,a9 as Me,aa as Oe,ab as Re,ac as De,ad as Fe,ae as ze,af as Be,ag as $e,ah as qe,ai as Ve,aj as We,ak as Ue,al as Ge,am as Ye,an as He,ao as Je,ap as Xe,aq as Qe,ar as Ke,as as Ze,at as et,au as tt,av as st,aw as at,ax as rt,ay as nt,az as it,aA as ot,aB as lt,aC as ct,aD as dt,aE as ut,aF as mt,aG as ht,aH as gt,aI as pt,aJ as xt,aK as ft,aL as bt,aM as yt,aN as vt,aO as jt,aP as wt}from"./vendor-ui-DG51EGkO.js";import{Q as _t,a as Nt}from"./vendor-utils-D5HPTFR9.js";import{g as kt,m as Et,A as St,L as Tt,u as Ct,b as It,d as At}from"./vendor-animation-ClPlB6zo.js";import{c as Pt}from"./vendor-supabase-D7XYLCUu.js";import{R as Lt,B as Mt,C as Ot,X as Rt,Y as Dt,T as Ft,a as zt,L as Bt,b as $t}from"./vendor-charts-BpOKEG9Z.js";import{i as qt,s as Vt,a as Wt,d as Ut,b as Gt,e as Yt,c as Ht,f as Jt,g as Xt,h as Qt,j as Kt,k as Zt,l as es,m as ts,n as ss,o as as,p as rs,q as ns,r as is,t as os,u as ls,v as cs,w as ds,x as us,y as ms,z as hs,A as gs,B as ps,C as xs,D as fs,E as bs,F as ys}from"./vendor-date-DT7Rq6D9.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let vs=0;const js=new Map,ws=e=>{if(js.has(e))return;const t=setTimeout(()=>{js.delete(e),Es({type:"REMOVE_TOAST",toastId:e})},1e6);js.set(e,t)},_s=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?ws(s):e.toasts.forEach(e=>{ws(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},Ns=[];let ks={toasts:[]};function Es(e){ks=_s(ks,e),Ns.forEach(e=>{e(ks)})}function Ss({...e}){const t=(vs=(vs+1)%Number.MAX_SAFE_INTEGER,vs.toString()),s=()=>Es({type:"DISMISS_TOAST",toastId:t});return Es({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>Es({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function Ts(){const[e,t]=r.useState(ks);return r.useEffect(()=>(Ns.push(t),()=>{const e=Ns.indexOf(t);e>-1&&Ns.splice(e,1)}),[e]),{...e,toast:Ss,dismiss:e=>Es({type:"DISMISS_TOAST",toastId:e})}}function Cs(...e){return k(E(e))}const Is=O,As=r.forwardRef(({className:e,...t},s)=>n.jsx(S,{ref:s,className:Cs("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));As.displayName=S.displayName;const Ps=M("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ls=r.forwardRef(({className:e,variant:t,...s},a)=>n.jsx(T,{ref:a,className:Cs(Ps({variant:t}),e),...s}));Ls.displayName=T.displayName;r.forwardRef(({className:e,...t},s)=>n.jsx(C,{ref:s,className:Cs("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=C.displayName;const Ms=r.forwardRef(({className:e,...t},s)=>n.jsx(I,{ref:s,className:Cs("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:n.jsx(A,{className:"h-4 w-4"})}));Ms.displayName=I.displayName;const Os=r.forwardRef(({className:e,...t},s)=>n.jsx(P,{ref:s,className:Cs("text-sm font-semibold",e),...t}));Os.displayName=P.displayName;const Rs=r.forwardRef(({className:e,...t},s)=>n.jsx(L,{ref:s,className:Cs("text-sm opacity-90",e),...t}));function Ds(){const{toasts:e}=Ts();return n.jsxs(Is,{children:[e.map(function({id:e,title:t,description:s,action:a,...r}){return n.jsxs(Ls,{...r,children:[n.jsxs("div",{className:"grid gap-1",children:[t&&n.jsx(Os,{children:t}),s&&n.jsx(Rs,{children:s})]}),a,n.jsx(Ms,{})]},e)}),n.jsx(As,{})]})}Rs.displayName=L.displayName;var Fs=["light","dark"],zs="(prefers-color-scheme: dark)",Bs="undefined"==typeof window,$s=r.createContext(void 0),qs={setTheme:e=>{},themes:[]},Vs=e=>r.useContext($s)?e.children:r.createElement(Us,{...e}),Ws=["light","dark"],Us=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:s=!0,enableColorScheme:a=!0,storageKey:n="theme",themes:i=Ws,defaultTheme:o=(s?"system":"light"),attribute:l="data-theme",value:c,children:d,nonce:u})=>{let[m,h]=r.useState(()=>Ys(n,o)),[g,p]=r.useState(()=>Ys(n)),x=c?Object.values(c):i,f=r.useCallback(e=>{let r=e;if(!r)return;"system"===e&&s&&(r=Js());let n=c?c[r]:r,i=t?Hs():null,d=document.documentElement;if("class"===l?(d.classList.remove(...x),n&&d.classList.add(n)):n?d.setAttribute(l,n):d.removeAttribute(l),a){let e=Fs.includes(o)?o:null,t=Fs.includes(r)?r:e;d.style.colorScheme=t}null==i||i()},[]),b=r.useCallback(e=>{let t="function"==typeof e?e(e):e;h(t);try{localStorage.setItem(n,t)}catch(s){}},[e]),y=r.useCallback(t=>{let a=Js(t);p(a),"system"===m&&s&&!e&&f("system")},[m,e]);r.useEffect(()=>{let e=window.matchMedia(zs);return e.addListener(y),y(e),()=>e.removeListener(y)},[y]),r.useEffect(()=>{let e=e=>{if(e.key!==n)return;let t=e.newValue||o;b(t)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[b]),r.useEffect(()=>{f(null!=e?e:m)},[e,m]);let v=r.useMemo(()=>({theme:m,setTheme:b,forcedTheme:e,resolvedTheme:"system"===m?g:m,themes:s?[...i,"system"]:i,systemTheme:s?g:void 0}),[m,b,e,g,s,i]);return r.createElement($s.Provider,{value:v},r.createElement(Gs,{forcedTheme:e,disableTransitionOnChange:t,enableSystem:s,enableColorScheme:a,storageKey:n,themes:i,defaultTheme:o,attribute:l,value:c,children:d,attrs:x,nonce:u}),d)},Gs=r.memo(({forcedTheme:e,storageKey:t,attribute:s,enableSystem:a,enableColorScheme:n,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let d="system"===i,u="class"===s?`var d=document.documentElement,c=d.classList;c.remove(${l.map(e=>`'${e}'`).join(",")});`:`var d=document.documentElement,n='${s}',s='setAttribute';`,m=n?Fs.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(e,t=!1,a=!0)=>{let r=o?o[e]:e,i=t?e+"|| ''":`'${r}'`,l="";return n&&a&&!t&&Fs.includes(e)&&(l+=`d.style.colorScheme = '${e}';`),"class"===s?l+=t||r?`c.add(${i})`:"null":r&&(l+=`d[s](n,${i})`),l},g=e?`!function(){${u}${h(e)}}()`:a?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${zs}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${d?"":"else{"+h(i,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${m}}catch(t){}}();`;return r.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:g}})}),Ys=(e,t)=>{if(Bs)return;let s;try{s=localStorage.getItem(e)||void 0}catch(a){}return s||t},Hs=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},Js=e=>(e||(e=window.matchMedia(zs)),e.matches?"dark":"light"),Xs=Array(12).fill(0),Qs=({visible:e})=>i.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},i.createElement("div",{className:"sonner-spinner"},Xs.map((e,t)=>i.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),Ks=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Zs=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},i.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),ea=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},i.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ta=i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},i.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),sa=1,aa=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:s,...a}=e,r="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:sa++,n=this.toasts.find(e=>e.id===r),i=void 0===e.dismissible||e.dismissible;return n?this.toasts=this.toasts.map(t=>t.id===r?(this.publish({...t,...e,id:r,title:s}),{...t,...e,id:r,dismissible:i,title:s}):t):this.addToast({title:s,...a,dismissible:i,id:r}),r},this.dismiss=e=>(e||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;void 0!==t.loading&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));let a=e instanceof Promise?e:e(),r=void 0!==s;return a.then(async e=>{if(ra(e)&&!e.ok){r=!1;let a="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description;this.create({id:s,type:"error",message:a,description:n})}else if(void 0!==t.success){r=!1;let a="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description;this.create({id:s,type:"success",message:a,description:n})}}).catch(async e=>{if(void 0!==t.error){r=!1;let a="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description;this.create({id:s,type:"error",message:a,description:n})}}).finally(()=>{var e;r&&(this.dismiss(s),s=void 0),null==(e=t.finally)||e.call(t)}),s},this.custom=(e,t)=>{let s=(null==t?void 0:t.id)||sa++;return this.create({jsx:e(s),id:s,...t}),s},this.subscribers=[],this.toasts=[]}},ra=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,na=(e,t)=>{let s=(null==t?void 0:t.id)||sa++;return aa.addToast({title:e,...t,id:s}),s},ia=Object.assign(na,{success:aa.success,info:aa.info,warning:aa.warning,error:aa.error,custom:aa.custom,message:aa.message,promise:aa.promise,dismiss:aa.dismiss,loading:aa.loading},{getHistory:()=>aa.toasts});function oa(e){return void 0!==e.label}!function(e,{insertAt:t}={}){if("undefined"==typeof document)return;let s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===t&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}(':where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n');var la=3,ca=14;function da(...e){return e.filter(Boolean).join(" ")}var ua=e=>{var t,s,a,r,n,o,l,c,d,u;let{invert:m,toast:h,unstyled:g,interacting:p,setHeights:x,visibleToasts:f,heights:b,index:y,toasts:v,expanded:j,removeToast:w,defaultRichColors:_,closeButton:N,style:k,cancelButtonStyle:E,actionButtonStyle:S,className:T="",descriptionClassName:C="",duration:I,position:A,gap:P,loadingIcon:L,expandByDefault:M,classNames:O,icons:R,closeButtonAriaLabel:D="Close toast",pauseWhenPageIsHidden:F,cn:z}=e,[B,$]=i.useState(!1),[q,V]=i.useState(!1),[W,U]=i.useState(!1),[G,Y]=i.useState(!1),[H,J]=i.useState(0),[X,Q]=i.useState(0),K=i.useRef(null),Z=i.useRef(null),ee=0===y,te=y+1<=f,se=h.type,ae=!1!==h.dismissible,re=h.className||"",ne=h.descriptionClassName||"",ie=i.useMemo(()=>b.findIndex(e=>e.toastId===h.id)||0,[b,h.id]),oe=i.useMemo(()=>{var e;return null!=(e=h.closeButton)?e:N},[h.closeButton,N]),le=i.useMemo(()=>h.duration||I||4e3,[h.duration,I]),ce=i.useRef(0),de=i.useRef(0),ue=i.useRef(0),me=i.useRef(null),[he,ge]=A.split("-"),pe=i.useMemo(()=>b.reduce((e,t,s)=>s>=ie?e:e+t.height,0),[b,ie]),xe=(()=>{let[e,t]=i.useState(document.hidden);return i.useEffect(()=>{let e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),fe=h.invert||m,be="loading"===se;de.current=i.useMemo(()=>ie*P+pe,[ie,pe]),i.useEffect(()=>{$(!0)},[]),i.useLayoutEffect(()=>{if(!B)return;let e=Z.current,t=e.style.height;e.style.height="auto";let s=e.getBoundingClientRect().height;e.style.height=t,Q(s),x(e=>e.find(e=>e.toastId===h.id)?e.map(e=>e.toastId===h.id?{...e,height:s}:e):[{toastId:h.id,height:s,position:h.position},...e])},[B,h.title,h.description,x,h.id]);let ye=i.useCallback(()=>{V(!0),J(de.current),x(e=>e.filter(e=>e.toastId!==h.id)),setTimeout(()=>{w(h)},200)},[h,w,x,de]);return i.useEffect(()=>{if(h.promise&&"loading"===se||h.duration===1/0||"loading"===h.type)return;let e,t=le;return j||p||F&&xe?(()=>{if(ue.current<ce.current){let e=(new Date).getTime()-ce.current;t-=e}ue.current=(new Date).getTime()})():t!==1/0&&(ce.current=(new Date).getTime(),e=setTimeout(()=>{var e;null==(e=h.onAutoClose)||e.call(h,h),ye()},t)),()=>clearTimeout(e)},[j,p,M,h,le,ye,h.promise,se,F,xe]),i.useEffect(()=>{let e=Z.current;if(e){let t=e.getBoundingClientRect().height;return Q(t),x(e=>[{toastId:h.id,height:t,position:h.position},...e]),()=>x(e=>e.filter(e=>e.toastId!==h.id))}},[x,h.id]),i.useEffect(()=>{h.delete&&ye()},[ye,h.delete]),i.createElement("li",{"aria-live":h.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Z,className:z(T,re,null==O?void 0:O.toast,null==(t=null==h?void 0:h.classNames)?void 0:t.toast,null==O?void 0:O.default,null==O?void 0:O[se],null==(s=null==h?void 0:h.classNames)?void 0:s[se]),"data-sonner-toast":"","data-rich-colors":null!=(a=h.richColors)?a:_,"data-styled":!(h.jsx||h.unstyled||g),"data-mounted":B,"data-promise":!!h.promise,"data-removed":q,"data-visible":te,"data-y-position":he,"data-x-position":ge,"data-index":y,"data-front":ee,"data-swiping":W,"data-dismissible":ae,"data-type":se,"data-invert":fe,"data-swipe-out":G,"data-expanded":!!(j||M&&B),style:{"--index":y,"--toasts-before":y,"--z-index":v.length-y,"--offset":`${q?H:de.current}px`,"--initial-height":M?"auto":`${X}px`,...k,...h.style},onPointerDown:e=>{be||!ae||(K.current=new Date,J(de.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(U(!0),me.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,s,a;if(G||!ae)return;me.current=null;let r=Number((null==(e=Z.current)?void 0:e.style.getPropertyValue("--swipe-amount").replace("px",""))||0),n=(new Date).getTime()-(null==(t=K.current)?void 0:t.getTime()),i=Math.abs(r)/n;if(Math.abs(r)>=20||i>.11)return J(de.current),null==(s=h.onDismiss)||s.call(h,h),ye(),void Y(!0);null==(a=Z.current)||a.style.setProperty("--swipe-amount","0px"),U(!1)},onPointerMove:e=>{var t;if(!me.current||!ae)return;let s=e.clientY-me.current.y,a=e.clientX-me.current.x,r=("top"===he?Math.min:Math.max)(0,s),n="touch"===e.pointerType?10:2;Math.abs(r)>n?null==(t=Z.current)||t.style.setProperty("--swipe-amount",`${s}px`):Math.abs(a)>n&&(me.current=null)}},oe&&!h.jsx?i.createElement("button",{"aria-label":D,"data-disabled":be,"data-close-button":!0,onClick:be||!ae?()=>{}:()=>{var e;ye(),null==(e=h.onDismiss)||e.call(h,h)},className:z(null==O?void 0:O.closeButton,null==(r=null==h?void 0:h.classNames)?void 0:r.closeButton)},i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},i.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,h.jsx||i.isValidElement(h.title)?h.jsx||h.title:i.createElement(i.Fragment,null,se||h.icon||h.promise?i.createElement("div",{"data-icon":"",className:z(null==O?void 0:O.icon,null==(n=null==h?void 0:h.classNames)?void 0:n.icon)},h.promise||"loading"===h.type&&!h.icon?h.icon||(null!=R&&R.loading?i.createElement("div",{className:"sonner-loader","data-visible":"loading"===se},R.loading):L?i.createElement("div",{className:"sonner-loader","data-visible":"loading"===se},L):i.createElement(Qs,{visible:"loading"===se})):null,"loading"!==h.type?h.icon||(null==R?void 0:R[se])||(e=>{switch(e){case"success":return Ks;case"info":return ea;case"warning":return Zs;case"error":return ta;default:return null}})(se):null):null,i.createElement("div",{"data-content":"",className:z(null==O?void 0:O.content,null==(o=null==h?void 0:h.classNames)?void 0:o.content)},i.createElement("div",{"data-title":"",className:z(null==O?void 0:O.title,null==(l=null==h?void 0:h.classNames)?void 0:l.title)},h.title),h.description?i.createElement("div",{"data-description":"",className:z(C,ne,null==O?void 0:O.description,null==(c=null==h?void 0:h.classNames)?void 0:c.description)},h.description):null),i.isValidElement(h.cancel)?h.cancel:h.cancel&&oa(h.cancel)?i.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||E,onClick:e=>{var t,s;oa(h.cancel)&&ae&&(null==(s=(t=h.cancel).onClick)||s.call(t,e),ye())},className:z(null==O?void 0:O.cancelButton,null==(d=null==h?void 0:h.classNames)?void 0:d.cancelButton)},h.cancel.label):null,i.isValidElement(h.action)?h.action:h.action&&oa(h.action)?i.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||S,onClick:e=>{var t,s;oa(h.action)&&(e.defaultPrevented||(null==(s=(t=h.action).onClick)||s.call(t,e),ye()))},className:z(null==O?void 0:O.actionButton,null==(u=null==h?void 0:h.classNames)?void 0:u.actionButton)},h.action.label):null))};function ma(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}var ha=e=>{let{invert:t,position:s="bottom-right",hotkey:a=["altKey","KeyT"],expand:r,closeButton:n,className:o,offset:l,theme:c="light",richColors:d,duration:u,style:m,visibleToasts:h=la,toastOptions:g,dir:p=ma(),gap:f=ca,loadingIcon:b,icons:y,containerAriaLabel:v="Notifications",pauseWhenPageIsHidden:j,cn:w=da}=e,[_,N]=i.useState([]),k=i.useMemo(()=>Array.from(new Set([s].concat(_.filter(e=>e.position).map(e=>e.position)))),[_,s]),[E,S]=i.useState([]),[T,C]=i.useState(!1),[I,A]=i.useState(!1),[P,L]=i.useState("system"!==c?c:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),M=i.useRef(null),O=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),R=i.useRef(null),D=i.useRef(!1),F=i.useCallback(e=>{var t;null!=(t=_.find(t=>t.id===e.id))&&t.delete||aa.dismiss(e.id),N(t=>t.filter(({id:t})=>t!==e.id))},[_]);return i.useEffect(()=>aa.subscribe(e=>{e.dismiss?N(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t)):setTimeout(()=>{x.flushSync(()=>{N(t=>{let s=t.findIndex(t=>t.id===e.id);return-1!==s?[...t.slice(0,s),{...t[s],...e},...t.slice(s+1)]:[e,...t]})})})}),[]),i.useEffect(()=>{"system"===c?("system"===c&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?L("dark"):L("light")),"undefined"!=typeof window&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:e})=>{L(e?"dark":"light")})):L(c)},[c]),i.useEffect(()=>{_.length<=1&&C(!1)},[_]),i.useEffect(()=>{let e=e=>{var t,s;a.every(t=>e[t]||e.code===t)&&(C(!0),null==(t=M.current)||t.focus()),"Escape"===e.code&&(document.activeElement===M.current||null!=(s=M.current)&&s.contains(document.activeElement))&&C(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a]),i.useEffect(()=>{if(M.current)return()=>{R.current&&(R.current.focus({preventScroll:!0}),R.current=null,D.current=!1)}},[M.current]),_.length?i.createElement("section",{"aria-label":`${v} ${O}`,tabIndex:-1},k.map((e,s)=>{var a;let[c,x]=e.split("-");return i.createElement("ol",{key:e,dir:"auto"===p?ma():p,tabIndex:-1,ref:M,className:o,"data-sonner-toaster":!0,"data-theme":P,"data-y-position":c,"data-x-position":x,style:{"--front-toast-height":`${(null==(a=E[0])?void 0:a.height)||0}px`,"--offset":"number"==typeof l?`${l}px`:l||"32px","--width":"356px","--gap":`${f}px`,...m},onBlur:e=>{D.current&&!e.currentTarget.contains(e.relatedTarget)&&(D.current=!1,R.current&&(R.current.focus({preventScroll:!0}),R.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||D.current||(D.current=!0,R.current=e.relatedTarget)},onMouseEnter:()=>C(!0),onMouseMove:()=>C(!0),onMouseLeave:()=>{I||C(!1)},onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||A(!0)},onPointerUp:()=>A(!1)},_.filter(t=>!t.position&&0===s||t.position===e).map((s,a)=>{var o,l;return i.createElement(ua,{key:s.id,icons:y,index:a,toast:s,defaultRichColors:d,duration:null!=(o=null==g?void 0:g.duration)?o:u,className:null==g?void 0:g.className,descriptionClassName:null==g?void 0:g.descriptionClassName,invert:t,visibleToasts:h,closeButton:null!=(l=null==g?void 0:g.closeButton)?l:n,interacting:I,position:e,style:null==g?void 0:g.style,unstyled:null==g?void 0:g.unstyled,classNames:null==g?void 0:g.classNames,cancelButtonStyle:null==g?void 0:g.cancelButtonStyle,actionButtonStyle:null==g?void 0:g.actionButtonStyle,removeToast:F,toasts:_.filter(e=>e.position==s.position),heights:E.filter(e=>e.position==s.position),setHeights:S,expandByDefault:r,gap:f,loadingIcon:b,expanded:T,pauseWhenPageIsHidden:j,cn:w})}))})):null};const ga=({...e})=>{const{theme:t="system"}=null!=(s=r.useContext($s))?s:qs;var s;return n.jsx(ha,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},pa=D,xa=F,fa=z,ba=r.forwardRef(({className:e,sideOffset:t=4,...s},a)=>n.jsx(R,{ref:a,sideOffset:t,className:Cs("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));ba.displayName=R.displayName;var ya="undefined"!=typeof Element,va="function"==typeof Map,ja="function"==typeof Set,wa="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function _a(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var s,a,r,n;if(Array.isArray(e)){if((s=e.length)!=t.length)return!1;for(a=s;0!==a--;)if(!_a(e[a],t[a]))return!1;return!0}if(va&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(n=e.entries();!(a=n.next()).done;)if(!t.has(a.value[0]))return!1;for(n=e.entries();!(a=n.next()).done;)if(!_a(a.value[1],t.get(a.value[0])))return!1;return!0}if(ja&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(n=e.entries();!(a=n.next()).done;)if(!t.has(a.value[0]))return!1;return!0}if(wa&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((s=e.length)!=t.length)return!1;for(a=s;0!==a--;)if(e[a]!==t[a])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((s=(r=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(a=s;0!==a--;)if(!Object.prototype.hasOwnProperty.call(t,r[a]))return!1;if(ya&&e instanceof Element)return!1;for(a=s;0!==a--;)if(("_owner"!==r[a]&&"__v"!==r[a]&&"__o"!==r[a]||!e.$$typeof)&&!_a(e[r[a]],t[r[a]]))return!1;return!0}return e!=e&&t!=t}const Na=kt(function(e,t){try{return _a(e,t)}catch(s){if((s.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw s}});const ka=kt(function(e,t,s,a,r,n,i,o){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[s,a,r,n,i,o],d=0;(l=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}});const Ea=kt(function(e,t,s,a){var r=s?s.call(a,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(t),l=0;l<n.length;l++){var c=n[l];if(!o(c))return!1;var d=e[c],u=t[c];if(!1===(r=s?s.call(a,d,u,c):void 0)||void 0===r&&d!==u)return!1}return!0});var Sa=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(Sa||{}),Ta={rel:["amphtml","canonical","alternate"]},Ca={type:["application/ld+json"]},Ia={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},Aa=Object.values(Sa),Pa={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},La=Object.entries(Pa).reduce((e,[t,s])=>(e[s]=t,e),{}),Ma="data-rh",Oa="defaultTitle",Ra="defer",Da="encodeSpecialCharacters",Fa="onChangeClientState",za="titleTemplate",Ba="prioritizeSeoTags",$a=(e,t)=>{for(let s=e.length-1;s>=0;s-=1){const a=e[s];if(Object.prototype.hasOwnProperty.call(a,t))return a[t]}return null},qa=e=>{let t=$a(e,"title");const s=$a(e,za);if(Array.isArray(t)&&(t=t.join("")),s&&t)return s.replace(/%s/g,()=>t);const a=$a(e,Oa);return t||a||void 0},Va=e=>$a(e,Fa)||(()=>{}),Wa=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>({...e,...t}),{}),Ua=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,s)=>{if(!t.length){const a=Object.keys(s);for(let r=0;r<a.length;r+=1){const n=a[r].toLowerCase();if(-1!==e.indexOf(n)&&s[n])return t.concat(s)}}return t},[]),Ga=(e,t,s)=>{const a={};return s.filter(t=>{return!!Array.isArray(t[e])||(void 0!==t[e]&&(s=`Helmet: ${e} should be of type "Array". Instead found type "${typeof t[e]}"`,console&&"function"==typeof console.warn&&console.warn(s)),!1);var s}).map(t=>t[e]).reverse().reduce((e,s)=>{const r={};s.filter(e=>{let s;const n=Object.keys(e);for(let a=0;a<n.length;a+=1){const r=n[a],i=r.toLowerCase();-1===t.indexOf(i)||"rel"===s&&"canonical"===e[s].toLowerCase()||"rel"===i&&"stylesheet"===e[i].toLowerCase()||(s=i),-1===t.indexOf(r)||"innerHTML"!==r&&"cssText"!==r&&"itemprop"!==r||(s=r)}if(!s||!e[s])return!1;const i=e[s].toLowerCase();return a[s]||(a[s]={}),r[s]||(r[s]={}),!a[s][i]&&(r[s][i]=!0,!0)}).reverse().forEach(t=>e.push(t));const n=Object.keys(r);for(let t=0;t<n.length;t+=1){const e=n[t],s={...a[e],...r[e]};a[e]=s}return e},[]).reverse()},Ya=(e,t)=>{if(Array.isArray(e)&&e.length)for(let s=0;s<e.length;s+=1){if(e[s][t])return!0}return!1},Ha=e=>Array.isArray(e)?e.join(""):e,Ja=(e,t)=>Array.isArray(e)?e.reduce((e,s)=>(((e,t)=>{const s=Object.keys(e);for(let a=0;a<s.length;a+=1)if(t[s[a]]&&t[s[a]].includes(e[s[a]]))return!0;return!1})(s,t)?e.priority.push(s):e.default.push(s),e),{priority:[],default:[]}):{default:e,priority:[]},Xa=(e,t)=>({...e,[t]:void 0}),Qa=["noscript","script","style"],Ka=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),Za=e=>Object.keys(e).reduce((t,s)=>{const a=void 0!==e[s]?`${s}="${e[s]}"`:`${s}`;return t?`${t} ${a}`:a},""),er=(e,t={})=>Object.keys(e).reduce((t,s)=>(t[Pa[s]||s]=e[s],t),t),tr=(e,t)=>t.map((t,s)=>{const a={key:s,[Ma]:!0};return Object.keys(t).forEach(e=>{const s=Pa[e]||e;if("innerHTML"===s||"cssText"===s){const e=t.innerHTML||t.cssText;a.dangerouslySetInnerHTML={__html:e}}else a[s]=t[e]}),i.createElement(e,a)}),sr=(e,t,s=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,s)=>{const a=er(s,{key:t,[Ma]:!0});return[i.createElement("title",a,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,s,a)=>{const r=Za(s),n=Ha(t);return r?`<${e} ${Ma}="true" ${r}>${Ka(n,a)}</${e}>`:`<${e} ${Ma}="true">${Ka(n,a)}</${e}>`})(e,t.title,t.titleAttributes,s)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>er(t),toString:()=>Za(t)};default:return{toComponent:()=>tr(e,t),toString:()=>((e,t,s=!0)=>t.reduce((t,a)=>{const r=a,n=Object.keys(r).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const a=void 0===r[t]?t:`${t}="${Ka(r[t],s)}"`;return e?`${e} ${a}`:a},""),i=r.innerHTML||r.cssText||"",o=-1===Qa.indexOf(e);return`${t}<${e} ${Ma}="true" ${n}${o?"/>":`>${i}</${e}>`}`},""))(e,t,s)}}},ar=e=>{const{baseTag:t,bodyAttributes:s,encode:a=!0,htmlAttributes:r,noscriptTags:n,styleTags:i,title:o="",titleAttributes:l,prioritizeSeoTags:c}=e;let{linkTags:d,metaTags:u,scriptTags:m}=e,h={toComponent:()=>{},toString:()=>""};return c&&({priorityMethods:h,linkTags:d,metaTags:u,scriptTags:m}=(({metaTags:e,linkTags:t,scriptTags:s,encode:a})=>{const r=Ja(e,Ia),n=Ja(t,Ta),i=Ja(s,Ca);return{priorityMethods:{toComponent:()=>[...tr("meta",r.priority),...tr("link",n.priority),...tr("script",i.priority)],toString:()=>`${sr("meta",r.priority,a)} ${sr("link",n.priority,a)} ${sr("script",i.priority,a)}`},metaTags:r.default,linkTags:n.default,scriptTags:i.default}})(e)),{priority:h,base:sr("base",t,a),bodyAttributes:sr("bodyAttributes",s,a),htmlAttributes:sr("htmlAttributes",r,a),link:sr("link",d,a),meta:sr("meta",u,a),noscript:sr("noscript",n,a),script:sr("script",m,a),style:sr("style",i,a),title:sr("title",{title:o,titleAttributes:l},a)}},rr=[],nr=!("undefined"==typeof window||!window.document||!window.document.createElement),ir=class{constructor(e,t){a(this,"instances",[]),a(this,"canUseDOM",nr),a(this,"context"),a(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?rr:this.instances,add:e=>{(this.canUseDOM?rr:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?rr:this.instances).indexOf(e);(this.canUseDOM?rr:this.instances).splice(t,1)}}}),this.context=e,this.canUseDOM=t||!1,t||(e.helmet=ar({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},or=i.createContext({}),lr=(e=class extends r.Component{constructor(t){super(t),a(this,"helmetData"),this.helmetData=new ir(this.props.context||{},e.canUseDOM)}render(){return i.createElement(or.Provider,{value:this.helmetData.value},this.props.children)}},a(e,"canUseDOM",nr),e),cr=(e,t)=>{const s=document.head||document.querySelector("head"),a=s.querySelectorAll(`${e}[${Ma}]`),r=[].slice.call(a),n=[];let i;return t&&t.length&&t.forEach(t=>{const s=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)s.innerHTML=t.innerHTML;else if("cssText"===e)s.styleSheet?s.styleSheet.cssText=t.cssText:s.appendChild(document.createTextNode(t.cssText));else{const a=e,r=void 0===t[a]?"":t[a];s.setAttribute(e,r)}s.setAttribute(Ma,"true"),r.some((e,t)=>(i=t,s.isEqualNode(e)))?r.splice(i,1):n.push(s)}),r.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),n.forEach(e=>s.appendChild(e)),{oldTags:r,newTags:n}},dr=(e,t)=>{const s=document.getElementsByTagName(e)[0];if(!s)return;const a=s.getAttribute(Ma),r=a?a.split(","):[],n=[...r],i=Object.keys(t);for(const o of i){const e=t[o]||"";s.getAttribute(o)!==e&&s.setAttribute(o,e),-1===r.indexOf(o)&&r.push(o);const a=n.indexOf(o);-1!==a&&n.splice(a,1)}for(let o=n.length-1;o>=0;o-=1)s.removeAttribute(n[o]);r.length===n.length?s.removeAttribute(Ma):s.getAttribute(Ma)!==i.join(",")&&s.setAttribute(Ma,i.join(","))},ur=(e,t)=>{const{baseTag:s,bodyAttributes:a,htmlAttributes:r,linkTags:n,metaTags:i,noscriptTags:o,onChangeClientState:l,scriptTags:c,styleTags:d,title:u,titleAttributes:m}=e;dr("body",a),dr("html",r),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=Ha(e)),dr("title",t)})(u,m);const h={baseTag:cr("base",s),linkTags:cr("link",n),metaTags:cr("meta",i),noscriptTags:cr("noscript",o),scriptTags:cr("script",c),styleTags:cr("style",d)},g={},p={};Object.keys(h).forEach(e=>{const{newTags:t,oldTags:s}=h[e];t.length&&(g[e]=t),s.length&&(p[e]=h[e].oldTags)}),t&&t(),l(e,g,p)},mr=null,hr=e=>{mr&&cancelAnimationFrame(mr),e.defer?mr=requestAnimationFrame(()=>{ur(e,()=>{mr=null})}):(ur(e),mr=null)},gr=class extends r.Component{constructor(){super(...arguments),a(this,"rendered",!1)}shouldComponentUpdate(e){return!Ea(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let s=null;const a=(r=e.get().map(e=>{const t={...e.props};return delete t.context,t}),{baseTag:Ua(["href"],r),bodyAttributes:Wa("bodyAttributes",r),defer:$a(r,Ra),encode:$a(r,Da),htmlAttributes:Wa("htmlAttributes",r),linkTags:Ga("link",["rel","href"],r),metaTags:Ga("meta",["name","charset","http-equiv","property","itemprop"],r),noscriptTags:Ga("noscript",["innerHTML"],r),onChangeClientState:Va(r),scriptTags:Ga("script",["src","innerHTML"],r),styleTags:Ga("style",["cssText"],r),title:qa(r),titleAttributes:Wa("titleAttributes",r),prioritizeSeoTags:Ya(r,Ba)});var r;lr.canUseDOM?hr(a):ar&&(s=ar(a)),t(s)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},pr=(t=class extends r.Component{shouldComponentUpdate(e){return!Na(Xa(this.props,"helmetData"),Xa(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,s,a){return{...t,[e.type]:[...t[e.type]||[],{...s,...this.mapNestedChildrenToProps(e,a)}]}}mapObjectTypeChildren(e,t,s,a){switch(e.type){case"title":return{...t,[e.type]:a,titleAttributes:{...s}};case"body":return{...t,bodyAttributes:{...s}};case"html":return{...t,htmlAttributes:{...s}};default:return{...t,[e.type]:{...s}}}}mapArrayTypeChildrenToProps(e,t){let s={...t};return Object.keys(e).forEach(t=>{s={...s,[t]:e[t]}}),s}warnOnInvalidChildren(e,t){return ka(Aa.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${Aa.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),ka(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let s={};return i.Children.forEach(e,e=>{if(!e||!e.props)return;const{children:a,...r}=e.props,n=Object.keys(r).reduce((e,t)=>(e[La[t]||t]=r[t],e),{});let{type:i}=e;switch("symbol"==typeof i?i=i.toString():this.warnOnInvalidChildren(e,a),i){case"Symbol(react.fragment)":t=this.mapChildrenToProps(a,t);break;case"link":case"meta":case"noscript":case"script":case"style":s=this.flattenArrayTypeChildren(e,s,n,a);break;default:t=this.mapObjectTypeChildren(e,t,n,a)}}),this.mapArrayTypeChildrenToProps(s,t)}render(){const{children:e,...t}=this.props;let s={...t},{helmetData:a}=t;if(e&&(s=this.mapChildrenToProps(e,s)),a&&!(a instanceof ir)){a=new ir(a.context,!0),delete s.helmetData}return a?i.createElement(gr,{...s,context:a.value}):i.createElement(or.Consumer,null,e=>i.createElement(gr,{...s,context:e}))}},a(t,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),t);function xr(e){if(!e)return"en";return e.split("-")[0].toLowerCase()}const fr=["en","ko","zh","ja","es","pt","fr","de","ru","hi","vi","ar","bn","ur","id","tr","fa","ta","ne","th","yue","ms","kk","sr","tl"];b.use(y).use(v).use(j).init({fallbackLng:"en",debug:!1,detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"ui_language",convertDetectedLanguage:e=>{const t=xr(e);return fr.includes(t)?t:"en"}},backend:{loadPath:(e,t)=>{const s=xr(e[0]);return`${"/".endsWith("/")?"/":"//"}locales/${s}.json`},requestOptions:{cache:"default"},allowMultiLoading:!1},preload:["en"],interpolation:{escapeValue:!1},parseMissingKeyHandler:e=>{try{const t=String(e||"").split(".").pop()||"";return t?t.replace(/[-_]/g," "):""}catch{return""}},react:{useSuspense:!1,bindI18n:"languageChanged loaded",bindI18nStore:"added removed",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transKeepBasicHtmlNodesFor:["br","strong","i","em"]},initImmediate:!1}),b.on("failedLoading",(e,t,s)=>{console.warn(`Failed loading ${t} for ${e}: ${s}`)}),b.on("missingKey",(e,t,s,a)=>{console.warn(`Missing translation key: ${s} for ${e.join(", ")}`)});const br={note:{name:"note",label:"Note",description:"Warm paper-like appearance",colors:{background:"#FEF9E7",backgroundGradient:"linear-gradient(to bottom, #FEF9E7 0%, #FDF6E3 100%)",backgroundOverlay:"rgba(254, 249, 231, 0.7)",backgroundImageColor:"#F5E6D3",border:"#E8D5A3",textPrimary:"#5D4E37",textSecondary:"#8B6914",textAccent:"#A68B5B",cardBackground:"#FEF9E7",cardBorder:"#E8D5A3",hoverBackground:"rgba(255, 255, 255, 0.6)",shadow:"0 2px 8px rgba(0,0,0,0.1), inset 0 1px 0 rgba(255,255,255,0.5)",chartLine:"#8B6914",chartTarget:"#C97D60",buttonPrimary:"#A68B5B",buttonPrimaryHover:"#8B6914"},styles:{cardStyle:{background:"linear-gradient(to bottom, #FEF9E7 0%, #FDF6E3 100%)",boxShadow:"0 2px 8px rgba(0,0,0,0.1), inset 0 1px 0 rgba(255,255,255,0.5)"}}},glassmorphism:{name:"glassmorphism",label:"Glassmorphism",description:"Frosted glass effect",colors:{background:"rgba(255, 255, 255, 0.4)",backgroundOverlay:"rgba(255, 255, 255, 0.6)",backgroundImageColor:"#a2d2ff",border:"rgba(255, 255, 255, 0.5)",textPrimary:"#0f172a",textSecondary:"#334155",textAccent:"#475569",cardBackground:"rgba(255, 255, 255, 0.5)",cardBorder:"rgba(255, 255, 255, 0.5)",hoverBackground:"rgba(255, 255, 255, 0.6)",shadow:"0 8px 32px 0 rgba(31, 38, 135, 0.15)",chartLine:"rgb(59, 130, 246)",chartTarget:"rgb(239, 68, 68)",buttonPrimary:"#3b82f6",buttonPrimaryHover:"#2563eb"},styles:{cardStyle:{background:"rgba(255, 255, 255, 0.45)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.15)",border:"1px solid rgba(255, 255, 255, 0.18)"}}},dark:{name:"dark",label:"Dark",description:"Dark mode theme",colors:{background:"#0f172a",backgroundGradient:"linear-gradient(to bottom, #1e293b 0%, #0f172a 100%)",backgroundOverlay:"rgba(15, 23, 42, 0.9)",backgroundImageColor:"#0f172a",border:"#334155",textPrimary:"#f1f5f9",textSecondary:"#cbd5e1",textAccent:"#94a3b8",cardBackground:"#1e293b",cardBorder:"#334155",hoverBackground:"#334155",shadow:"0 4px 12px rgba(0,0,0,0.3)",chartLine:"#60a5fa",chartTarget:"#f87171",buttonPrimary:"#64748b",buttonPrimaryHover:"#475569"},styles:{cardStyle:{background:"linear-gradient(to bottom, #1e293b 0%, #0f172a 100%)",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"}}},minimalist:{name:"minimalist",label:"Minimalist",description:"Clean and simple",colors:{background:"#ffffff",backgroundOverlay:"rgba(255, 255, 255, 0.9)",backgroundImageColor:"#f9fafb",border:"#e5e7eb",textPrimary:"#111827",textSecondary:"#6b7280",textAccent:"#9ca3af",cardBackground:"#ffffff",cardBorder:"#e5e7eb",hoverBackground:"#f9fafb",shadow:"0 1px 3px rgba(0,0,0,0.1)",chartLine:"#3b82f6",chartTarget:"#ef4444",buttonPrimary:"#2563eb",buttonPrimaryHover:"#1d4ed8"},styles:{cardStyle:{boxShadow:"0 1px 3px rgba(0,0,0,0.1)"}}}},yr=(e="note")=>br[e]||br.note,vr=e=>{"undefined"!=typeof window&&localStorage.setItem("dashboard-theme",e)},jr=Pt("https://cuumxmfzhwljylbdlflj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN1dW14bWZ6aHdsanlsYmRsZmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1MTkxMjEsImV4cCI6MjA2OTA5NTEyMX0.8jqO_ciOttSxSLZnKY0i5oJmEn79ROF53TjUMYhNemI",{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{fetch:async(e,t)=>{const s=new AbortController,a=setTimeout(()=>s.abort(),6e4);try{return await fetch(e,{...t,signal:s.signal})}catch(r){if("AbortError"!==r.name&&("Failed to fetch"===r.message||r.message.includes("ERR_CONNECTION_CLOSED")||r.message.includes("NetworkError")))return console.log("Retrying fetch due to connection error...",r.message),await new Promise(e=>setTimeout(e,1e3)),fetch(e,t);throw r}finally{clearTimeout(a)}},headers:{"X-Client-Info":"supabase-js-web"}}}),wr=jr,_r=Object.freeze(Object.defineProperty({__proto__:null,adminSupabase:wr,supabase:jr},Symbol.toStringTag,{value:"Module"}));function Nr(e){if(!e)return"en";const t=String(e).toLowerCase(),s=[{code:"en",name:"English"},{code:"zh",name:""},{code:"zh-TW",name:""},{code:"hi",name:""},{code:"es",name:"Espaol"},{code:"fr",name:"Franais"},{code:"ar",name:""},{code:"bn",name:""},{code:"pt",name:"Portugus"},{code:"ru",name:""},{code:"ja",name:""},{code:"ur",name:""},{code:"id",name:"Bahasa Indonesia"},{code:"de",name:"Deutsch"},{code:"vi",name:"Ting Vit"},{code:"tr",name:"Trke"},{code:"it",name:"Italiano"},{code:"ko",name:""},{code:"fa",name:""},{code:"ta",name:""},{code:"th",name:""},{code:"yue",name:""},{code:"ms",name:"Bahasa Melayu"},{code:"te",name:""},{code:"mr",name:""},{code:"gu",name:""},{code:"kn",name:""},{code:"ml",name:""},{code:"pa",name:""},{code:"or",name:""},{code:"as",name:""},{code:"sw",name:"Kiswahili"},{code:"ha",name:"Hausa"},{code:"yo",name:"Yorb"},{code:"ig",name:"ss gb"},{code:"am",name:""},{code:"zu",name:"isiZulu"},{code:"af",name:"Afrikaans"},{code:"pl",name:"Polski"},{code:"uk",name:""},{code:"ro",name:"Romn"},{code:"nl",name:"Nederlands"},{code:"el",name:""},{code:"cs",name:"etina"},{code:"hu",name:"Magyar"},{code:"sv",name:"Svenska"},{code:"bg",name:""},{code:"sr",name:""},{code:"hr",name:"Hrvatski"},{code:"sk",name:"Slovenina"},{code:"no",name:"Norsk"},{code:"da",name:"Dansk"},{code:"fi",name:"Suomi"},{code:"sq",name:"Shqip"},{code:"sl",name:"Slovenina"},{code:"et",name:"Eesti"},{code:"lv",name:"Latvieu"},{code:"lt",name:"Lietuvi"},{code:"uz",name:"Ozbek"},{code:"kk",name:""},{code:"az",name:"Azrbaycan"},{code:"mn",name:""},{code:"he",name:""},{code:"ps",name:""},{code:"ka",name:""},{code:"hy",name:""},{code:"tl",name:"Filipino"},{code:"my",name:""},{code:"km",name:""},{code:"si",name:""},{code:"ne",name:""}].map(e=>e.code);if(s.includes(t))return t;const a=t.split("-")[0];if(s.includes(a))return a;return{english:"en",korean:"ko","":"ko",chinese:"zh","":"zh","chinese (simplified)":"zh",taiwanese:"zh-TW","":"zh-TW","chinese (traditional)":"zh-TW","traditional chinese":"zh-TW",japanese:"ja","":"ja",spanish:"es","espaol":"es",portuguese:"pt","portugus":"pt",french:"fr","franais":"fr",german:"de",deutsch:"de",russian:"ru","":"ru",hindi:"hi","":"hi",vietnamese:"vi","ting vit":"vi",arabic:"ar","":"ar",bengali:"bn","":"bn",urdu:"ur","":"ur",indonesian:"id","bahasa indonesia":"id",turkish:"tr","trke":"tr",persian:"fa",farsi:"fa","":"fa",tamil:"ta","":"ta",nepali:"ne","":"ne",thai:"th","":"th",cantonese:"yue","":"yue",malay:"ms","bahasa melayu":"ms",kazakh:"kk"," ":"kk","":"kk",italian:"it",italiano:"it",telugu:"te","":"te",marathi:"mr","":"mr",gujarati:"gu","":"gu",kannada:"kn","":"kn",malayalam:"ml","":"ml",punjabi:"pa","":"pa",odia:"or","":"or",assamese:"as","":"as",swahili:"sw",kiswahili:"sw",hausa:"ha",yoruba:"yo","yorb":"yo",igbo:"ig","ss gb":"ig",amharic:"am","":"am",zulu:"zu",isizulu:"zu",afrikaans:"af",polish:"pl",polski:"pl",ukrainian:"uk","":"uk",romanian:"ro","romn":"ro",dutch:"nl",nederlands:"nl",greek:"el","":"el",czech:"cs","etina":"cs",hungarian:"hu",magyar:"hu",swedish:"sv",svenska:"sv",bulgarian:"bg","":"bg",serbian:"sr","":"sr",croatian:"hr",hrvatski:"hr",slovak:"sk","slovenina":"sk",norwegian:"no",norsk:"no",danish:"da",dansk:"da",finnish:"fi",suomi:"fi",albanian:"sq",shqip:"sq",slovenian:"sl","slovenina":"sl",estonian:"et",eesti:"et",latvian:"lv","latvieu":"lv",lithuanian:"lt","lietuvi":"lt",uzbek:"uz","ozbek":"uz",azeri:"az",azerbaijani:"az","azrbaycan":"az",mongolian:"mn","":"mn",hebrew:"he","":"he",pashto:"ps","":"ps",georgian:"ka","":"ka",armenian:"hy","":"hy",filipino:"tl",tagalog:"tl",burmese:"my","":"my",khmer:"km","":"km",sinhala:"si","":"si"}[t]||"en"}const kr={en:"",zh:"","zh-TW":"",hi:"",es:"",fr:"",ar:"",bn:"",pt:"",ru:"",ja:"",ur:"",id:"",de:"",vi:"",tr:"",it:"",ko:"",fa:"",ta:"",th:"",yue:"",ms:"",te:"",mr:"",gu:"",kn:"",ml:"",pa:"",or:"",as:"",sw:"",ha:"",yo:"",ig:"",am:"",zu:"",af:"",pl:"",uk:"",ro:"",nl:"",el:"",cs:"",hu:"",sv:"",bg:"",sr:"",hr:"",sk:"",no:"",da:"",fi:"",sq:"",sl:"",et:"",lv:"",lt:"",uz:"",kk:"",az:"",mn:"",he:"",ps:"",ka:"",hy:"",tl:"",my:"",km:"",si:"",ne:""};function Er(){return[{code:"en",name:"English"},{code:"zh",name:""},{code:"zh-TW",name:""},{code:"hi",name:""},{code:"es",name:"Espaol"},{code:"fr",name:"Franais"},{code:"ar",name:""},{code:"bn",name:""},{code:"pt",name:"Portugus"},{code:"ru",name:""},{code:"ja",name:""},{code:"ur",name:""},{code:"id",name:"Bahasa Indonesia"},{code:"de",name:"Deutsch"},{code:"vi",name:"Ting Vit"},{code:"tr",name:"Trke"},{code:"it",name:"Italiano"},{code:"ko",name:""},{code:"fa",name:""},{code:"ta",name:""},{code:"th",name:""},{code:"yue",name:""},{code:"ms",name:"Bahasa Melayu"},{code:"te",name:""},{code:"mr",name:""},{code:"gu",name:""},{code:"kn",name:""},{code:"ml",name:""},{code:"pa",name:""},{code:"or",name:""},{code:"as",name:""},{code:"sw",name:"Kiswahili"},{code:"ha",name:"Hausa"},{code:"yo",name:"Yorb"},{code:"ig",name:"ss gb"},{code:"am",name:""},{code:"zu",name:"isiZulu"},{code:"af",name:"Afrikaans"},{code:"pl",name:"Polski"},{code:"uk",name:""},{code:"ro",name:"Romn"},{code:"nl",name:"Nederlands"},{code:"el",name:""},{code:"cs",name:"etina"},{code:"hu",name:"Magyar"},{code:"sv",name:"Svenska"},{code:"bg",name:""},{code:"sr",name:""},{code:"hr",name:"Hrvatski"},{code:"sk",name:"Slovenina"},{code:"no",name:"Norsk"},{code:"da",name:"Dansk"},{code:"fi",name:"Suomi"},{code:"sq",name:"Shqip"},{code:"sl",name:"Slovenina"},{code:"et",name:"Eesti"},{code:"lv",name:"Latvieu"},{code:"lt",name:"Lietuvi"},{code:"uz",name:"Ozbek"},{code:"kk",name:""},{code:"az",name:"Azrbaycan"},{code:"mn",name:""},{code:"he",name:""},{code:"ps",name:""},{code:"ka",name:""},{code:"hy",name:""},{code:"tl",name:"Filipino"},{code:"my",name:""},{code:"km",name:""},{code:"si",name:""},{code:"ne",name:""}].map(e=>({code:e.code,name:e.name,nativeName:e.name,flag:kr[e.code]||""}))}const Sr={en:"English",zh:"Chinese","zh-TW":"Taiwanese",hi:"Hindi",es:"Spanish",fr:"French",ar:"Arabic",bn:"Bengali",pt:"Portuguese",ru:"Russian",ja:"Japanese",ur:"Urdu",id:"Indonesian",de:"German",vi:"Vietnamese",tr:"Turkish",it:"Italian",ko:"Korean",fa:"Persian",ta:"Tamil",th:"Thai",yue:"Cantonese",ms:"Malay",te:"Telugu",mr:"Marathi",gu:"Gujarati",kn:"Kannada",ml:"Malayalam",pa:"Punjabi",or:"Odia",as:"Assamese",sw:"Swahili",ha:"Hausa",yo:"Yoruba",ig:"Igbo",am:"Amharic",zu:"Zulu",af:"Afrikaans",pl:"Polish",uk:"Ukrainian",ro:"Romanian",nl:"Dutch",el:"Greek",cs:"Czech",hu:"Hungarian",sv:"Swedish",bg:"Bulgarian",sr:"Serbian",hr:"Croatian",sk:"Slovak",no:"Norwegian",da:"Danish",fi:"Finnish",sq:"Albanian",sl:"Slovenian",et:"Estonian",lv:"Latvian",lt:"Lithuanian",uz:"Uzbek",kk:"Kazakh",az:"Azerbaijani",mn:"Mongolian",he:"Hebrew",ps:"Pashto",ka:"Georgian",hy:"Armenian",tl:"Filipino",my:"Burmese",km:"Khmer",si:"Sinhala",ne:"Nepali"};function Tr(){return[{code:"en",name:"English"},{code:"zh",name:""},{code:"zh-TW",name:""},{code:"hi",name:""},{code:"es",name:"Espaol"},{code:"fr",name:"Franais"},{code:"ar",name:""},{code:"bn",name:""},{code:"pt",name:"Portugus"},{code:"ru",name:""},{code:"ja",name:""},{code:"ur",name:""},{code:"id",name:"Bahasa Indonesia"},{code:"de",name:"Deutsch"},{code:"vi",name:"Ting Vit"},{code:"tr",name:"Trke"},{code:"it",name:"Italiano"},{code:"ko",name:""},{code:"fa",name:""},{code:"ta",name:""},{code:"th",name:""},{code:"yue",name:""},{code:"ms",name:"Bahasa Melayu"},{code:"te",name:""},{code:"mr",name:""},{code:"gu",name:""},{code:"kn",name:""},{code:"ml",name:""},{code:"pa",name:""},{code:"or",name:""},{code:"as",name:""},{code:"sw",name:"Kiswahili"},{code:"ha",name:"Hausa"},{code:"yo",name:"Yorb"},{code:"ig",name:"ss gb"},{code:"am",name:""},{code:"zu",name:"isiZulu"},{code:"af",name:"Afrikaans"},{code:"pl",name:"Polski"},{code:"uk",name:""},{code:"ro",name:"Romn"},{code:"nl",name:"Nederlands"},{code:"el",name:""},{code:"cs",name:"etina"},{code:"hu",name:"Magyar"},{code:"sv",name:"Svenska"},{code:"bg",name:""},{code:"sr",name:""},{code:"hr",name:"Hrvatski"},{code:"sk",name:"Slovenina"},{code:"no",name:"Norsk"},{code:"da",name:"Dansk"},{code:"fi",name:"Suomi"},{code:"sq",name:"Shqip"},{code:"sl",name:"Slovenina"},{code:"et",name:"Eesti"},{code:"lv",name:"Latvieu"},{code:"lt",name:"Lietuvi"},{code:"uz",name:"Ozbek"},{code:"kk",name:""},{code:"az",name:"Azrbaycan"},{code:"mn",name:""},{code:"he",name:""},{code:"ps",name:""},{code:"ka",name:""},{code:"hy",name:""},{code:"tl",name:"Filipino"},{code:"my",name:""},{code:"km",name:""},{code:"si",name:""},{code:"ne",name:""}].map(e=>({value:Sr[e.code]||e.code,label:`${Sr[e.code]||e.code} (${e.name})`}))}function Cr(e){if(!e)return"en";const t=Nr(e);if(Sr[t])return t;const s={};return Object.entries(Sr).forEach(([e,t])=>{s[t.toLowerCase()]=e}),s[e.toLowerCase()]||"en"}const Ir=(()=>{var e,t;if("undefined"!=typeof window){const e=window.location.origin;return e.includes("englishaidol.com")?"https://englishaidol.com":e}const s=null==(t=null==(e=import.meta)?void 0:e.env)?void 0:t.VITE_PUBLIC_SITE_URL;return s||"https://englishaidol.com"})(),Ar={siteUrl:Ir,supabase:{url:"https://cuumxmfzhwljylbdlflj.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN1dW14bWZ6aHdsanlsYmRsZmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1MTkxMjEsImV4cCI6MjA2OTA5NTEyMX0.8jqO_ciOttSxSLZnKY0i5oJmEn79ROF53TjUMYhNemI"},stripe:{publishableKey:"pk_live_51RuyWMCg5LtU404t1y36hENdj5Xi4UtGVknVBVUAF1T6AqN6LoRSzsjKrkQw3Rbnue4NFqzQeYctzA37gEWHJF9A0020cmaMDg"},oauth:{google:{redirectTo:`${Ir}/auth/callback`}}};function Pr(){const[e,t]=r.useState(null),[s,a]=r.useState(null),[n,i]=r.useState(null),[o,l]=r.useState(!0),{toast:c}=Ts();r.useEffect(()=>{let e=!0,s=null,r=!1,n=0;const{data:{subscription:o}}=jr.auth.onAuthStateChange(async(n,o)=>{var c;e&&(r=!0,s&&(clearTimeout(s),s=null),console.log(" Auth state change:",n,(null==(c=null==o?void 0:o.user)?void 0:c.email)||"no user"),a(o),t((null==o?void 0:o.user)??null),l(!1),(null==o?void 0:o.user)?d(o.user.id).catch(e=>{console.error("Error fetching profile:",e)}):i(null))}),c=async(i=0)=>{const o=Math.min(1e3*Math.pow(2,i),4e3);try{const s=new Promise((e,t)=>{setTimeout(()=>t(new Error("Session fetch timeout")),5e3)}),{data:{session:n},error:i}=await Promise.race([jr.auth.getSession(),s]);if(!e)return;if(i)throw i;r||(console.log(" Session retrieved successfully"),r=!0,a(n),t((null==n?void 0:n.user)??null),l(!1),(null==n?void 0:n.user)&&d(n.user.id).catch(e=>{console.error("Error fetching profile:",e)}))}catch(u){if(!e)return;n++;n<3&&!r?(console.log(` Retrying auth session in ${o}ms...`),s=setTimeout(()=>{e&&!r&&c(i+1)},o)):r||(console.warn(" Auth session fetch failed after retries, proceeding without session"),a(null),t(null),l(!1))}};return c(),()=>{e=!1,s&&clearTimeout(s),o.unsubscribe()}},[]);const d=async(e,t=0)=>{var s,a,r,n,o,l;const c=Math.min(1e3*Math.pow(2,t),3e3);try{const{data:n,error:o}=await jr.from("profiles").select("*").eq("id",e).maybeSingle();if(o){if(((null==(s=o.message)?void 0:s.includes("Failed to fetch"))||(null==(a=o.message)?void 0:a.includes("ERR_CONNECTION_CLOSED"))||(null==(r=o.message)?void 0:r.includes("NetworkError")))&&t<2)return await new Promise(e=>setTimeout(e,c)),d(e,t+1);0}if(n){const e={id:n.id,full_name:n.full_name||"",role:n.role||"user",subscription_status:n.subscription_status||"free",native_language:n.native_language||"en",avatar_url:n.avatar_url,created_at:n.created_at};i(e);try{if(!localStorage.getItem("ui_language")&&(null==n?void 0:n.native_language)){const e=Nr(n.native_language);e&&(await b.changeLanguage(e),localStorage.setItem("ui_language",e))}}catch(u){console.warn("Language sync skipped:",u)}}else console.log("No profile found for user:",e),i(null);return n}catch(m){if(((null==(n=m.message)?void 0:n.includes("Failed to fetch"))||(null==(o=m.message)?void 0:o.includes("ERR_CONNECTION_CLOSED"))||(null==(l=m.message)?void 0:l.includes("NetworkError")))&&t<2)return await new Promise(e=>setTimeout(e,c)),d(e,t+1)}};return{user:e,session:s,profile:n,loading:o,signIn:async(e,s)=>{try{const{data:n,error:i}=await jr.auth.signInWithPassword({email:e,password:s});if(i)return console.error(" Sign in error:",i),{error:i.message};if(n.session){console.log(" Sign in successful, session received:",n.session.user.email),a(n.session),t(n.session.user);try{await d(n.session.user.id)}catch(r){console.error("Error fetching profile:",r)}l(!1)}return c({title:"Welcome back!",description:"You have successfully signed in."}),{}}catch(n){return console.error(" Sign in exception:",n),{error:n.message||"An error occurred during sign in"}}},signUp:async(e,t,s)=>{try{const a=`${"http://localhost:5173"}/auth/callback`,{error:r}=await jr.auth.signUp({email:e,password:t,options:{emailRedirectTo:a,data:{full_name:s}}});return r?{error:r.message}:(c({title:"Account created!",description:"Please check your email to verify your account."}),{})}catch(a){return{error:a.message||"An error occurred during sign up"}}},signInWithGoogle:async()=>{try{const e=`${"http://localhost:5173"}/auth/callback`;console.log(" Initiating Google OAuth sign-in, redirectTo:",e);const{error:t}=await jr.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{prompt:"select_account",access_type:"online"}}});return t?(console.error(" Google OAuth error:",t),{error:t.message}):(console.log(" Google OAuth redirect initiated"),{})}catch(e){return console.error(" Google OAuth exception:",e),{error:e.message||"An error occurred during Google sign in"}}},signOut:async()=>{try{const{error:e}=await jr.auth.signOut();if(e)throw console.error("Error signing out:",e),e;return c({title:"Signed out",description:"You have been signed out successfully."}),localStorage.clear(),sessionStorage.clear(),{success:!0}}catch(e){throw console.error("Error signing out:",e),e}},resetPassword:async e=>{try{const{data:t}=await jr.auth.getUser(),{error:s}=await jr.auth.resetPasswordForEmail(e,{redirectTo:`${Ar.siteUrl}/reset-password`});return s?{error:s.message}:(c({title:"If the account exists, check your email",description:"We've sent password reset instructions to the address provided if it's associated with an account."}),{})}catch(t){return{error:t.message||"An error occurred during password reset"}}},refreshProfile:async()=>{(null==e?void 0:e.id)&&await d(e.id)},updateProfileAvatar:t=>{var s;(null==e?void 0:e.id)&&i(n?{...n,avatar_url:t}:{id:e.id,full_name:(null==(s=e.email)?void 0:s.split("@")[0])||"",role:"user",subscription_status:"free",native_language:"en",avatar_url:t})}}}const Lr=r.createContext(void 0),Mr=({children:e})=>{const{user:t}=Pr(),[s,a]=r.useState("undefined"==typeof window?"note":localStorage.getItem("dashboard-theme")||"note"),[i,o]=r.useState(yr(s));r.useEffect(()=>{if(t){const e=async(s=0)=>{var r,n,i,l,c,d,u,m,h,g,p,x;try{const{data:u,error:m}=await jr.from("user_preferences").select("*").eq("user_id",t.id).maybeSingle();if(m){const t=(null==(r=m.message)?void 0:r.includes("ERR_CONNECTION_CLOSED"))||(null==(n=m.message)?void 0:n.includes("Failed to fetch"))||(null==(i=m.message)?void 0:i.includes("NetworkError"));"PGRST204"===m.code||"42703"===m.code||"42P01"===m.code||(null==(l=m.message)?void 0:l.toLowerCase().includes("column"))||(null==(c=m.message)?void 0:c.toLowerCase().includes("does not exist"))||(null==(d=m.message)||d.toLowerCase().includes("bad request"));return t&&s<1?(await new Promise(e=>setTimeout(e,2e3)),e(s+1)):void 0}if(u&&u.dashboard_theme){const e=u.dashboard_theme;a(e),o(yr(e)),vr(e)}}catch(f){const t=(null==(u=null==f?void 0:f.message)?void 0:u.includes("ERR_CONNECTION_CLOSED"))||(null==(m=null==f?void 0:f.message)?void 0:m.includes("Failed to fetch"))||(null==(h=null==f?void 0:f.message)?void 0:h.includes("NetworkError"));"PGRST204"===(null==f?void 0:f.code)||"42703"===(null==f?void 0:f.code)||"42P01"===(null==f?void 0:f.code)||(null==(g=null==f?void 0:f.message)?void 0:g.toLowerCase().includes("column"))||(null==(p=null==f?void 0:f.message)?void 0:p.toLowerCase().includes("does not exist"))||(null==(x=null==f?void 0:f.message)||x.toLowerCase().includes("bad request"));if(t&&s<1)return await new Promise(e=>setTimeout(e,2e3)),e(s+1);0}};e()}},[t]),r.useEffect(()=>{o(yr(s)),vr(s),window.dispatchEvent(new CustomEvent("theme-changed",{detail:s}))},[s]);return n.jsx(Lr.Provider,{value:{theme:i,themeName:s,setTheme:async e=>{a(e),vr(e),t&&(async()=>{var s,a,r,n;try{const{error:i}=await jr.from("user_preferences").select("dashboard_theme").eq("user_id",t.id).limit(1);if("PGRST204"===(null==i?void 0:i.code)||"42703"===(null==i?void 0:i.code)||"42P01"===(null==i?void 0:i.code)||400===(null==i?void 0:i.status)||(null==(s=null==i?void 0:i.message)?void 0:s.toLowerCase().includes("dashboard_theme"))||(null==(a=null==i?void 0:i.message)?void 0:a.toLowerCase().includes("column"))||(null==(r=null==i?void 0:i.message)?void 0:r.toLowerCase().includes("does not exist"))||(null==(n=null==i?void 0:i.message)?void 0:n.toLowerCase().includes("bad request")))return;const{error:o}=await jr.from("user_preferences").upsert({user_id:t.id,dashboard_theme:e},{onConflict:"user_id"});0}catch(i){}})(),window.dispatchEvent(new CustomEvent("theme-changed",{detail:e}))}},children:e})},Or=()=>{const e=r.useContext(Lr);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e},Rr=r.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:Cs("rounded-2xl border border-border bg-card text-card-foreground shadow-soft soft-border",e),...t}));Rr.displayName="Card";const Dr=r.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:Cs("flex flex-col space-y-1.5 p-6",e),...t}));Dr.displayName="CardHeader";const Fr=r.forwardRef(({className:e,...t},s)=>n.jsx("h3",{ref:s,className:Cs("text-2xl font-semibold leading-none tracking-tight",e),...t}));Fr.displayName="CardTitle";const zr=r.forwardRef(({className:e,...t},s)=>n.jsx("p",{ref:s,className:Cs("text-sm text-muted-foreground leading-relaxed",e),...t}));zr.displayName="CardDescription";const Br=r.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:Cs("p-6 pt-0",e),...t}));Br.displayName="CardContent";r.forwardRef(({className:e,...t},s)=>n.jsx("div",{ref:s,className:Cs("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";const $r=M("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-soft",destructive:"bg-destructive text-destructive-foreground shadow-soft",outline:"border border-border bg-background text-foreground soft-border",secondary:"bg-secondary text-secondary-foreground shadow-soft",ghost:"",link:"text-primary underline-offset-4",hero:"bg-gentle-blue text-white shadow-medium font-medium",success:"bg-soft-green text-foreground shadow-soft",neon:"bg-gentle-blue text-white shadow-medium font-medium",tech:"bg-secondary text-secondary-foreground shadow-soft border border-gentle-blue/20"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),qr=r.forwardRef(({className:e,variant:t,size:s,asChild:a=!1,...r},i)=>{const o=a?B:"button";return n.jsx(o,{className:Cs($r({variant:t,size:s,className:e})),ref:i,...r})});qr.displayName="Button";const Vr=r.forwardRef(({className:e,type:t,style:s,...a},r)=>n.jsx("input",{type:t,className:Cs("flex h-10 w-full rounded-md border bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm transition-colors",e),style:{borderColor:"inherit",...s},ref:r,...a}));Vr.displayName="Input";const Wr=se,Ur=ae,Gr=r.forwardRef(({className:e,children:t,...s},a)=>n.jsxs($,{ref:a,className:Cs("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,n.jsx(q,{asChild:!0,children:n.jsx(V,{className:"h-4 w-4 opacity-50"})})]}));Gr.displayName=$.displayName;const Yr=r.forwardRef(({className:e,...t},s)=>n.jsx(W,{ref:s,className:Cs("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(U,{className:"h-4 w-4"})}));Yr.displayName=W.displayName;const Hr=r.forwardRef(({className:e,...t},s)=>n.jsx(G,{ref:s,className:Cs("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(V,{className:"h-4 w-4"})}));Hr.displayName=G.displayName;const Jr=r.forwardRef(({className:e,children:t,position:s="popper",...a},r)=>n.jsx(Y,{children:n.jsxs(H,{ref:r,className:Cs("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[n.jsx(Yr,{}),n.jsx(J,{className:Cs("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(Hr,{})]})}));Jr.displayName=H.displayName;r.forwardRef(({className:e,...t},s)=>n.jsx(X,{ref:s,className:Cs("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=X.displayName;const Xr=r.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(Q,{ref:a,className:Cs("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(K,{children:n.jsx(Z,{className:"h-4 w-4"})})}),n.jsx(ee,{children:t})]}));Xr.displayName=Q.displayName;r.forwardRef(({className:e,...t},s)=>n.jsx(te,{ref:s,className:Cs("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=te.displayName;const Qr=({size:e="md",className:t="",message:s="Loading...",speed:a=1})=>{const i=r.useRef(null);return r.useEffect(()=>{const e=i.current;if(e){const t=e.querySelector("dotlottie-wc");t&&t.setAttribute("speed",a.toString())}},[a]),n.jsxs("div",{className:`flex flex-col items-center justify-center gap-4 ${t}`,ref:i,children:[n.jsx("dotlottie-wc",{src:"https://lottie.host/f9eec83f-15c9-410c-937c-c3a0d2024d6a/EoOyrmY8jW.lottie",style:{sm:{width:"120px",height:"120px"},md:{width:"200px",height:"200px"},lg:{width:"300px",height:"300px"}}[e],speed:a.toString(),autoplay:!0,loop:!0}),n.jsx("p",{className:"text-text-secondary text-sm font-medium animate-pulse",children:s})]})},Kr=({selectedLanguage:e="en",onLanguageChange:t})=>{var s;const[a,i]=r.useState(!1),[o,l]=r.useState(!1),[c,d]=r.useState("medium"),[u,m]=r.useState("general"),[h,g]=r.useState([{id:"1",text:"Hello! I'm your AI tutor. How can I help you with your English learning today?",isUser:!1,timestamp:new Date}]),[p,x]=r.useState(""),[f,b]=r.useState(!1),y=r.useRef(null),v=[{value:"general",label:"General"},{value:"grammar",label:"Grammar"},{value:"vocabulary",label:"Vocabulary"},{value:"pronunciation",label:"Pronunciation"},{value:"writing",label:"Writing"},{value:"speaking",label:"Speaking"},{value:"reading",label:"Reading"},{value:"listening",label:"Listening"}];r.useEffect(()=>{var e;null==(e=y.current)||e.scrollIntoView({behavior:"smooth"})},[h]);const j=async()=>{if(!p.trim())return;const t={id:Date.now().toString(),text:p,isUser:!0,timestamp:new Date};g(e=>[...e,t]),x(""),b(!0);try{const{data:t,error:s}=await jr.functions.invoke("gemini-chat",{body:{message:p,context:u,language:e}});if(s)throw s;const a={id:(Date.now()+1).toString(),text:t.response||"I apologize, but I couldn't process your request. Please try again.",isUser:!1,timestamp:new Date};g(e=>[...e,a])}catch(s){console.error("Error sending message:",s);const e={id:(Date.now()+1).toString(),text:"Sorry, I encountered an error. Please try again later.",isUser:!1,timestamp:new Date};g(t=>[...t,e])}finally{b(!1)}};return a?n.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:n.jsxs(Rr,{className:`backdrop-blur-lg bg-background/30 border-border/20 shadow-xl transition-all duration-300 ${o?"w-80 h-16":(()=>{switch(c){case"small":return"w-80 h-96";case"large":return"w-[28rem] h-[36rem]";default:return"w-96 h-[32rem]"}})()}`,children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/30",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(re,{className:"h-5 w-5 text-brand-blue"}),n.jsx("span",{className:"font-semibold text-sm",children:"AI English Tutor"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Wr,{value:e,onValueChange:t,children:[n.jsx(Gr,{className:"w-20 h-8 text-xs",children:n.jsx(ne,{className:"h-3 w-3"})}),n.jsx(Jr,{children:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"pt",name:"Portuguese"},{code:"ru",name:"Russian"},{code:"zh",name:"Chinese"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"ar",name:"Arabic"},{code:"hi",name:"Hindi"},{code:"vi",name:"Vietnamese"},{code:"th",name:"Thai"}].map(e=>n.jsx(Xr,{value:e.code,className:"text-xs",children:e.name},e.code))})]}),n.jsx(qr,{variant:"ghost",size:"sm",onClick:()=>l(!o),className:"h-8 w-8 p-0",children:n.jsx(ie,{className:"h-4 w-4"})}),n.jsx(qr,{variant:"ghost",size:"sm",onClick:()=>i(!1),className:"h-8 w-8 p-0",children:n.jsx(A,{className:"h-4 w-4"})})]})]}),!o&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"px-4 py-2 border-b border-border/30",children:n.jsxs(Wr,{value:u,onValueChange:m,children:[n.jsx(Gr,{className:"w-full h-8 text-xs",children:n.jsxs("span",{className:"text-xs",children:["Topic: ",null==(s=v.find(e=>e.value===u))?void 0:s.label]})}),n.jsx(Jr,{children:v.map(e=>n.jsx(Xr,{value:e.value,className:"text-xs",children:e.label},e.value))})]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{height:"small"===c?"16rem":"large"===c?"24rem":"20rem"},children:[h.map(t=>n.jsxs("div",{className:"flex gap-2 "+(t.isUser?"justify-end":"justify-start"),children:[!t.isUser&&n.jsx("div",{className:"flex-shrink-0",children:n.jsx(re,{className:"h-6 w-6 text-brand-blue"})}),n.jsxs("div",{className:"max-w-[75%] p-3 rounded-2xl text-sm "+(t.isUser?"bg-brand-blue text-white":"glass-effect border border-border/30"),children:[n.jsx("p",{className:"leading-relaxed",children:t.text}),!t.isUser&&"en"!==e&&n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>(async t=>{if("en"!==e)try{const{data:s,error:a}=await jr.functions.invoke("gemini-chat",{body:{message:`Translate the following text to ${e}: "${t}"`,context:"translation"}});if(!a&&s.response){const e={id:Date.now().toString(),text:`Translation: ${s.response}`,isUser:!1,timestamp:new Date};g(t=>[...t,e])}}catch(s){console.error("Translation error:",s)}})(t.text),className:"mt-2 h-6 text-xs text-brand-blue hover:text-brand-blue/80",children:[n.jsx(ne,{className:"h-3 w-3 mr-1"}),"Translate"]})]}),t.isUser&&n.jsx("div",{className:"flex-shrink-0",children:n.jsx(oe,{className:"h-6 w-6 text-text-secondary"})})]},t.id)),f&&n.jsx("div",{className:"flex gap-2 justify-start",children:n.jsx(Qr,{size:"sm",message:""})}),n.jsx("div",{ref:y})]}),n.jsx("div",{className:"p-4 border-t border-border/30",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Vr,{value:p,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j())},placeholder:"small"===c?"Type here...":"Ask me anything about English...",className:"flex-1 border-border/30 bg-surface-1/80 backdrop-blur-sm text-sm min-h-[40px]",disabled:f}),n.jsx(qr,{onClick:j,disabled:f||!p.trim(),className:"h-10 w-10 p-0 bg-brand-blue hover:bg-brand-blue/90 flex-shrink-0",children:n.jsx(le,{className:"h-4 w-4"})})]})})]})]})}):n.jsx("div",{className:"fixed bottom-6 right-6 z-50"})},Zr=({message:e="Processing...",subMessage:t="Please wait while we analyze your work",size:s=300})=>(r.useEffect(()=>{const e=document.createElement("script");return e.src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.6.2/dist/dotlottie-wc.js",e.type="module",document.querySelector('script[src*="dotlottie-wc"]')||document.head.appendChild(e),()=>{}},[]),n.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("dotlottie-wc",{src:"https://lottie.host/f9eec83f-15c9-410c-937c-c3a0d2024d6a/EoOyrmY8jW.lottie",style:{width:`${s}px`,height:`${s}px`},speed:"1",autoplay:!0,loop:!0})}),n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx("div",{className:"text-lg font-medium text-text-primary",children:e}),n.jsx("div",{className:"text-sm text-text-secondary",children:t})]})]})),en=()=>{const{theme:e}=Or();return{cardClassName:r.useMemo(()=>{switch(e.name){case"note":default:return"bg-[#FEF9E7] border-[#E8D5A3]";case"glassmorphism":return"bg-white/10 border-white/20 backdrop-blur-xl";case"dark":return"bg-[#1e293b] border-[#334155]";case"minimalist":return"bg-white border-[#e5e7eb]"}},[e.name]),cardStyle:r.useMemo(()=>e.styles.cardStyle||{},[e]),textPrimary:r.useMemo(()=>e.colors.textPrimary,[e]),textSecondary:r.useMemo(()=>e.colors.textSecondary,[e]),textAccent:r.useMemo(()=>e.colors.textAccent,[e]),border:r.useMemo(()=>e.colors.border,[e]),hoverBg:r.useMemo(()=>e.colors.hoverBackground,[e]),buttonPrimary:r.useMemo(()=>e.colors.buttonPrimary,[e]),buttonPrimaryHover:r.useMemo(()=>e.colors.buttonPrimaryHover,[e]),chartLine:r.useMemo(()=>e.colors.chartLine,[e]),chartTarget:r.useMemo(()=>e.colors.chartTarget,[e]),backgroundOverlay:r.useMemo(()=>e.colors.backgroundOverlay||"rgba(255, 255, 255, 0.2)",[e]),backgroundImageColor:r.useMemo(()=>e.colors.backgroundImageColor||"#a2d2ff",[e]),cardBackground:r.useMemo(()=>{switch(e.name){case"note":return"#FEF9E7";case"glassmorphism":case"dark":return"rgba(255, 255, 255, 0.1)";case"minimalist":return"#ffffff";default:return"rgba(255, 255, 255, 0.6)"}},[e.name]),theme:e}};function tn({selectedText:e,position:t,onClose:s,targetLanguage:a}){var i;const[o,l]=r.useState(null),[c,d]=r.useState(!0),[u,m]=r.useState(!1),[h,g]=r.useState(!1),[p,x]=r.useState({width:window.innerWidth,height:window.innerHeight}),{toast:f}=Ts(),{user:b}=Pr(),y=en();r.useEffect(()=>{const e=()=>{x({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),r.useEffect(()=>{(async()=>{if(e)if("en"!==a)try{d(!0),console.log(" Fetching translation for:",e,"to",a);const s=new Promise((e,t)=>setTimeout(()=>t(new Error("Translation request timeout")),15e3)),r=jr.functions.invoke("translation-service",{body:{text:e,sourceLang:"auto",targetLang:a,includeContext:!0}}).catch(e=>{throw console.error(" Translation service connection error:",e),new Error(`Connection error: ${e.message||"Network error"}`)}),n=await Promise.race([r,s]),{data:i,error:o}=n;if(console.log(" Translation response:",{data:i,error:o}),o)throw console.error(" Translation service error:",o),o;if(!(null==i?void 0:i.success)||!(null==i?void 0:i.result))throw console.error(" Translation failed:",i),new Error((null==i?void 0:i.error)||"Translation failed");if(console.log(" Translation received:",i.result),i.result.simple&&"string"==typeof i.result.translation){console.log(" Got cached simple translation, fetching full details...");return void(async()=>{var t;try{console.log(" Fetching full translation details with bypassCache...");const r=jr.functions.invoke("translation-service",{body:{text:e,sourceLang:"auto",targetLang:a,includeContext:!0,bypassCache:!0}}).catch(e=>{throw console.error(" Full details connection error:",e),new Error(`Connection error: ${e.message||"Network error"}`)}),n=new Promise((e,t)=>setTimeout(()=>t(new Error("Full details timeout")),15e3)),o=await Promise.race([r,n]);if(console.log(" Full details response:",o),(null==(t=null==o?void 0:o.data)?void 0:t.success)&&o.data.result){const t=o.data.result;console.log(" Full details result structure:",{hasTranslation:!!t.translation,hasAlternatives:!!t.alternatives,alternativesType:Array.isArray(t.alternatives)?"array":typeof t.alternatives,alternativesLength:Array.isArray(t.alternatives)?t.alternatives.length:0,hasPos:!!t.pos,hasIpa:!!t.ipa,isSimple:t.simple});let r=[];if(t.alternatives&&Array.isArray(t.alternatives)&&(r=t.alternatives.map(e=>"string"==typeof e?e:e&&"object"==typeof e&&e.meaning?{meaning:e.meaning,pos:e.pos}:e&&"object"==typeof e&&e.translation?e.translation:null).filter(e=>null!==e)),console.log(" Processed alternatives:",r),t.simple)console.log(" Response still marked as simple, but using available data..."),l({translation:t.translation||i.result.translation,alternatives:r,pos:t.pos||void 0,ipa:t.ipa||void 0,context:t.context||void 0});else{console.log(" Full translation details received:",{translation:t.translation,alternativesCount:r.length,pos:t.pos,ipa:t.ipa});const n={translation:t.translation||i.result.translation,alternatives:r,pos:t.pos||void 0,ipa:t.ipa||void 0,context:t.context||void 0};l(n);try{const t=`${e.toLowerCase()}-${a}`;sessionStorage.setItem(`translation_${t}`,JSON.stringify(n))}catch(s){}}}else console.log(" Full details fetch failed, using cached translation"),l({translation:i.result.translation,alternatives:[]})}catch(r){console.error(" Error fetching full details:",r);const t=(null==r?void 0:r.message)||String(r)||"Unknown error",s=t.includes("timeout")||t.includes("Timeout"),o=t.includes("ERR_CONNECTION_RESET")||t.includes("Connection error")||t.includes("NetworkError")||t.includes("Failed to fetch");if(s||o)try{const t=`${e.toLowerCase()}-${a}`,s=sessionStorage.getItem(`translation_${t}`);if(s){const e=JSON.parse(s);return console.log(" Using cached translation for full details fallback:",e),l({translation:e.translation||i.result.translation,alternatives:e.alternatives||[],pos:e.pos,ipa:e.ipa}),void d(!1)}}catch(n){console.log(" Could not read cache:",n)}l({translation:i.result.translation,alternatives:[]})}finally{d(!1)}})()}{const s=i.result;let r=[];s.alternatives&&Array.isArray(s.alternatives)&&(r=s.alternatives.map(e=>"string"==typeof e?e:e&&"object"==typeof e&&e.meaning?{meaning:e.meaning,pos:e.pos}:e&&"object"==typeof e&&e.translation?e.translation:null).filter(e=>null!==e)),console.log(" Non-cached translation received:",{translation:s.translation,alternativesCount:r.length,alternatives:r,pos:s.pos,ipa:s.ipa});const n={translation:s.translation,alternatives:r,pos:s.pos||void 0,ipa:s.ipa||void 0,context:s.context||void 0};l(n);try{const t=`${e.toLowerCase()}-${a}`;sessionStorage.setItem(`translation_${t}`,JSON.stringify(n))}catch(t){}}}catch(s){console.error(" Translation error:",s);const t=(null==s?void 0:s.message)||String(s)||"Unknown error",n=t.includes("timeout")||t.includes("Timeout"),i=t.includes("ERR_CONNECTION_RESET")||t.includes("Connection error")||t.includes("NetworkError")||t.includes("Failed to fetch");if(n||i){console.warn(" Translation timeout/connection error, checking cache...");try{const t=`${e.toLowerCase()}-${a}`,s=sessionStorage.getItem(`translation_${t}`);if(s){const t=JSON.parse(s);return console.log(" Using cached translation:",t),l({translation:t.translation||e,alternatives:t.alternatives||[],pos:t.pos,ipa:t.ipa}),void d(!1)}}catch(r){console.log(" Could not read cache:",r)}console.warn("Translation timeout/connection error, showing fallback"),l({translation:e,alternatives:[]})}else f({title:"Translation Error",description:t,variant:"destructive"}),l(null)}finally{d(!1)}else try{d(!0),console.log(" Fetching definition for:",e);const{data:t,error:s}=await jr.functions.invoke("translation-service",{body:{text:e,sourceLang:"en",targetLang:"en",includeContext:!0}});if(console.log(" Definition response:",{data:t,error:s}),s)throw s;(null==t?void 0:t.success)&&(null==t?void 0:t.result)?l(t.result):l({translation:e,alternatives:[],context:"Definition not available"})}catch(s){console.error(" Definition error:",s),l({translation:e,alternatives:[]})}finally{d(!1)}})()},[e,a,f]);const v=async()=>{var t;if(b){if(o){m(!0);try{const s=(null==(t=o.alternatives)?void 0:t.map(e=>"string"==typeof e?e:e.meaning||"").filter(Boolean))||[],a=e.trim().toLowerCase(),{data:r}=await jr.from("user_vocabulary").select("id, word").eq("user_id",b.id);if(null==r?void 0:r.some(e=>!!(null==e?void 0:e.word)&&e.word.trim().toLowerCase()===a))return f({title:"Already Saved",description:"This word is already in your wordbook"}),void g(!0);const n=[o.translation,...s.map(e=>"string"==typeof e?e:null==e?void 0:e.meaning).filter(Boolean)].filter((e,t,s)=>s.indexOf(e)===t),{error:i}=await jr.from("user_vocabulary").insert({user_id:b.id,word:a,translations:n,part_of_speech:o.pos||null});if(i)throw console.error("Insert error details:",i),i;g(!0),f({title:"Word Added",description:`"${e}" has been added to your wordbook`})}catch(s){console.error("Save error:",s),f({title:"Save Failed",description:s.message||"Failed to save word to wordbook",variant:"destructive"})}finally{m(!1)}}}else f({title:"Login Required",description:"Please log in to add words to your wordbook",variant:"destructive"})},j=(e=>{const t=["ar","he","fa","ur","ps","hi","bn","ta","te","mr","gu","kn","ml","pa","or","as","th","my","km","si","ne"].includes(e);return{width:280,fontSize:{original:"text-base",translation:"text-sm",ipa:"text-xs"},lineHeight:t?"leading-relaxed":"leading-normal"}})(a),w=j.width,_={position:"fixed",left:`${Math.max(16,Math.min(t.x-w/2,p.width-w-16))}px`,top:`${Math.max(16,Math.min(t.y,p.height-300-16))}px`,zIndex:9999,width:`${w}px`,maxHeight:c?"none":p.height-32+"px",overflowY:c?"visible":"auto",overflowX:"visible"},N=e.trim().split(/\s+/).length>1,k=(null==o?void 0:o.translation)||"",E=(null==o?void 0:o.pos)||"",S={},T=e=>e?e.toLowerCase().trim():"",C=T(E);if(k){const e=C;S[e]||(S[e]=[]),S[e].includes(k)||S[e].push(k)}console.log(" Processing alternatives:",{hasAlternatives:!!(null==o?void 0:o.alternatives),alternativesLength:(null==(i=null==o?void 0:o.alternatives)?void 0:i.length)||0,alternatives:null==o?void 0:o.alternatives}),(null==o?void 0:o.alternatives)&&o.alternatives.length>0&&o.alternatives.forEach((e,t)=>{const s="string"==typeof e?e:null==e?void 0:e.meaning,a="object"==typeof e&&(null==e?void 0:e.pos)?T(e.pos):C;if(console.log(`  Alternative ${t}:`,{meaning:s,altPOS:a,alt:e}),s&&s!==k){const e=a||C;S[e]||(S[e]=[]),S[e].includes(s)?console.log(`   Skipped duplicate "${s}"`):(S[e].push(s),console.log(`   Added "${s}" to POS group "${e}"`))}}),console.log(" Final translationsByPOS:",S),Object.keys(S).forEach(e=>{0===S[e].length&&delete S[e]});const I=C&&S[C]?[E||C,...Object.keys(S).filter(e=>T(e)!==C).sort()]:Object.keys(S).sort();return n.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:s,children:n.jsxs(Rr,{style:{..._,backgroundColor:y.cardBackground,borderColor:y.border,backdropFilter:"glassmorphism"===y.theme.name?"blur(10px)":"none",boxShadow:"glassmorphism"===y.theme.name?"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)":"dark"===y.theme.name?"0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2)":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},onClick:e=>e.stopPropagation(),className:"rounded-2xl shadow-lg animate-fade-in animate-slide-up "+(c?"overflow-visible":""),children:[n.jsxs(Dr,{className:"pb-2 px-3 pt-3 relative",children:[n.jsx(qr,{variant:"ghost",size:"sm",onClick:s,className:"absolute top-3 right-3 h-6 w-6 p-0 rounded-lg",style:{color:y.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=y.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:n.jsx(A,{className:"h-3.5 w-3.5"})}),n.jsxs("div",{className:"text-center animate-fade-in",children:[n.jsx("p",{className:`${j.fontSize.original} font-semibold ${j.lineHeight}`,style:{color:y.textPrimary},children:e}),n.jsx("div",{className:"space-y-0.5 mt-0.5",children:E&&""!==E.trim()&&n.jsx("p",{className:"text-xs font-medium",style:{color:y.textSecondary},children:E})})]})]}),n.jsx(Br,{className:"px-3 pb-3 pt-4 overflow-visible",children:c?n.jsx("div",{className:"flex items-center justify-center py-4 overflow-visible relative",style:{minHeight:"120px"},children:n.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-visible",children:n.jsx(Zr,{message:"Translating...",subMessage:"",size:120})})}):o?n.jsx(n.Fragment,{children:n.jsx("div",{className:"space-y-3 min-h-[60px] flex flex-col justify-center text-center relative",children:Object.keys(S).length>0?I.map((e,t)=>{const s=T(e),a=S[s]||[];if(0===a.length)return null;const r=I.length>1&&e&&""!==e.trim()&&t>0,i=t===I.length-1,o=a.length-1;return n.jsxs("div",{className:"space-y-1.5 animate-fade-in",style:{animationDelay:.1*t+"s",animationFillMode:"both"},children:[r&&n.jsx("p",{className:"text-xs font-medium animate-slide-up",style:{color:y.textSecondary},children:e}),a.map((s,a)=>{const r=i&&a===o;return n.jsxs("div",{className:"relative w-full flex items-center justify-center animate-slide-up",style:{animationDelay:.1*t+.05*a+"s",animationFillMode:"both"},children:[n.jsx("p",{className:`${j.fontSize.translation} font-normal ${j.lineHeight} text-center`,style:{color:y.textPrimary},children:s}),b&&!N&&r&&n.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2",children:n.jsx(pa,{children:n.jsxs(xa,{children:[n.jsx(fa,{asChild:!0,children:n.jsx("button",{onClick:v,disabled:u||h,className:"h-5 w-5 transition-all hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center flex-shrink-0",style:{color:y.textSecondary},onMouseEnter:e=>{u||h||(e.currentTarget.style.color=y.buttonPrimary)},onMouseLeave:e=>{e.currentTarget.style.color=y.textSecondary},children:h?n.jsx(Z,{className:"h-4 w-4"}):u?n.jsx(ce,{className:"h-4 w-4 animate-spin"}):n.jsx(de,{className:"h-4 w-4"})})}),n.jsx(ba,{side:"top",className:"text-xs z-[10000]",children:h?"Added to Wordbook":u?"Adding...":"Add to Wordbook"})]})})})]},`${e}-${a}`)})]},e)}):n.jsxs("div",{className:"relative w-full flex items-center justify-center animate-fade-in animate-slide-up",style:{animationDelay:"0.1s",animationFillMode:"both"},children:[n.jsx("p",{className:`${j.fontSize.translation} font-normal ${j.lineHeight} text-center`,style:{color:y.textPrimary},children:k}),b&&!N&&n.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2",children:n.jsx(pa,{children:n.jsxs(xa,{children:[n.jsx(fa,{asChild:!0,children:n.jsx("button",{onClick:v,disabled:u||h,className:"h-5 w-5 text-slate-400 dark:text-slate-500 hover:text-primary dark:hover:text-primary transition-all hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center flex-shrink-0",children:h?n.jsx(Z,{className:"h-4 w-4"}):u?n.jsx(ce,{className:"h-4 w-4 animate-spin"}):n.jsx(de,{className:"h-4 w-4"})})}),n.jsx(ba,{side:"top",className:"text-xs z-[10000]",children:h?"Added to Wordbook":u?"Adding...":"Add to Wordbook"})]})})})]})})}):n.jsx("div",{className:"py-6 text-center",children:n.jsx("p",{className:"text-xs",style:{color:y.textSecondary},children:"Translation not available"})})})]})})}const sn=({selectedText:e,position:t,onClose:s,onCopy:a,onTranslate:i})=>{const o=r.useRef(null),l=en();r.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&s()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]);const{left:c,top:d}=(()=>{const e=10,s=window.innerWidth,a=window.innerHeight,r=window.scrollY;let n=t.x-100,i=t.y+8;return n<e&&(n=e),n+200>s-e&&(n=s-200-e),i+50>a+r-e&&(i=t.y-50-8),i<r+e&&(i=r+e),{left:n,top:i}})();return n.jsxs("div",{ref:o,className:"fixed z-[10000] flex items-center gap-2 p-1 rounded-lg shadow-lg",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),style:{left:`${c}px`,top:`${d}px`,backgroundColor:l.cardBackground,borderColor:l.border,borderWidth:"1px",borderStyle:"solid",backdropFilter:"glassmorphism"===l.theme.name?"blur(10px)":"none",boxShadow:"glassmorphism"===l.theme.name?"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)":"dark"===l.theme.name?"0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2)":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},children:[n.jsxs(qr,{onClick:async()=>{try{await navigator.clipboard.writeText(e),a(),s()}catch(t){console.error("Failed to copy text:",t)}},variant:"ghost",size:"sm",className:"text-sm flex items-center gap-2",style:{color:l.textPrimary,backgroundColor:"transparent"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=l.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[n.jsx(ue,{className:"w-4 h-4"}),"Copy"]}),n.jsxs(qr,{onClick:i,variant:"ghost",size:"sm",className:"text-sm flex items-center gap-2",style:{color:l.textPrimary,backgroundColor:"transparent"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=l.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[n.jsx(ne,{className:"w-4 h-4"}),"Translate"]}),n.jsx(qr,{onClick:s,variant:"ghost",size:"icon",className:"w-6 h-6",style:{color:l.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=l.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:n.jsx(A,{className:"w-4 h-4"})})]})},an=({children:e})=>{const[t,s]=r.useState(null),[a,i]=r.useState(null),[o,l]=r.useState(!1),[c,d]=r.useState(!1),[u,m]=r.useState("en"),{user:h,profile:g}=Pr(),{toast:p}=Ts();r.useRef(0),r.useRef(null);const x=r.useRef(null),f=r.useRef(null),b=r.useRef(!1);r.useEffect(()=>{(async()=>{const e=localStorage.getItem("word_translation_language");if(e){const t=Nr(e);m(t)}if(h)try{const{data:e,error:t}=await jr.from("user_preferences").select("word_translation_language, native_language").eq("user_id",h.id).maybeSingle();if(!t&&e){const t=e,s=(null==t?void 0:t.word_translation_language)||(null==t?void 0:t.native_language);if(s){const e=Nr(s);m(e),localStorage.setItem("word_translation_language",e)}}}catch(t){console.warn("Error loading word translation language:",t)}else if(null==g?void 0:g.native_language){const e=Nr(g.native_language);m(e)}})()},[h,g]),r.useEffect(()=>{const e=()=>{const e=localStorage.getItem("word_translation_language");if(e){const t=Nr(e);m(t),console.log(" Word translation language updated:",t)}};return window.addEventListener("word-translation-language-updated",e),window.addEventListener("storage",t=>{"word_translation_language"!==t.key&&"word-translation-language-updated"!==t.key||e()}),()=>{window.removeEventListener("word-translation-language-updated",e)}},[]),r.useEffect(()=>{const e=e=>{const t=e.target;"BUTTON"===t.tagName||"A"===t.tagName||t.closest("button")||t.closest("a")||t.closest('[role="button"]')||t.closest('[contenteditable="true"]')||setTimeout(()=>{const e=window.getSelection();if(!e)return;const t=e.toString().trim();if(t&&0!==t.length){console.log(" Double-click detected, selected text:",t);try{const a=e.getRangeAt(0).getBoundingClientRect();a&&(i({x:a.left+a.width/2,y:a.bottom+8}),s(t),l(!0),d(!1),console.log(" Action menu triggered for:",t))}catch(a){console.error("Error getting selection range:",a)}}else console.log(" No text selected on double-click")},10)};return document.addEventListener("dblclick",e),()=>document.removeEventListener("dblclick",e)},[]),r.useEffect(()=>{let e;const t=e=>{const t=e.target;"BUTTON"===t.tagName||"A"===t.tagName||t.closest("button")||t.closest("a")||t.closest('[role="button"]')||t.closest('[contenteditable="true"]')||(f.current={x:e.clientX,y:e.clientY,time:Date.now()},b.current=!1)},a=e=>{if(!f.current)return;const t=Math.abs(e.clientX-f.current.x),s=Math.abs(e.clientY-f.current.y);(t>5||s>5)&&(b.current=!0)},r=t=>{if(!f.current)return;const a=Math.abs(t.clientX-f.current.x),r=Math.abs(t.clientY-f.current.y);b.current&&(a>10||r>10)?(clearTimeout(e),e=setTimeout(()=>{const e=window.getSelection(),t=null==e?void 0:e.toString().trim(),a=document.activeElement;if("INPUT"===(null==a?void 0:a.tagName)||"TEXTAREA"===(null==a?void 0:a.tagName)||"true"===(null==a?void 0:a.getAttribute("contenteditable")))return f.current=null,void(b.current=!1);if(t&&t.split(/\s+/).length>2){const a=null==e?void 0:e.getRangeAt(0),r=null==a?void 0:a.getBoundingClientRect();r&&(i({x:r.left+r.width/2,y:r.bottom+8}),s(t),l(!0),d(!1),console.log(" Action menu triggered for sentence:",t))}f.current=null,b.current=!1},200)):(f.current=null,b.current=!1)};return document.addEventListener("mousedown",t),document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r),clearTimeout(e)}},[]),r.useEffect(()=>{let e;const t=e=>{x.current={x:e.touches[0].clientX,y:e.touches[0].clientY,time:Date.now()}},a=t=>{if(!x.current)return;const a=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY,n=(Date.now(),Math.abs(a-x.current.x)),o=Math.abs(r-x.current.y);(n>10||o>10)&&(clearTimeout(e),e=setTimeout(()=>{const e=window.getSelection(),t=null==e?void 0:e.toString().trim(),a=document.activeElement;if("INPUT"!==(null==a?void 0:a.tagName)&&"TEXTAREA"!==(null==a?void 0:a.tagName)&&"true"!==(null==a?void 0:a.getAttribute("contenteditable"))&&t&&t.length>=2){const a=null==e?void 0:e.getRangeAt(0),r=null==a?void 0:a.getBoundingClientRect();r&&(i({x:r.left+r.width/2,y:r.bottom+8}),s(t),l(!0),d(!1))}},300)),x.current=null};return document.addEventListener("touchstart",t),document.addEventListener("touchend",a),()=>{document.removeEventListener("touchstart",t),document.removeEventListener("touchend",a),clearTimeout(e)}},[]);const y=()=>{var e;s(null),i(null),l(!1),d(!1),null==(e=window.getSelection())||e.removeAllRanges()};return n.jsxs(n.Fragment,{children:[e,o&&t&&a&&n.jsx(sn,{selectedText:t,position:a,onClose:y,onCopy:()=>{p({title:"Copied!",description:`"${t}" has been copied to clipboard.`,duration:2e3})},onTranslate:()=>{l(!1),d(!0)}}),c&&t&&a&&n.jsx(tn,{selectedText:t,position:a,onClose:y,targetLanguage:u})]})},rn=({onLanguageSelected:e})=>{const{i18n:t}=w(),[s,a]=r.useState(!1),[i,o]=r.useState(""),l=Er();r.useEffect(()=>{const e=localStorage.getItem("language_choice_made"),t=localStorage.getItem("ui_language");if(e||t)return;const s=navigator.language.split("-")[0];l.map(e=>e.code).includes(s)&&(o(s),a(!0))},[]);const c=()=>{localStorage.setItem("language_choice_made","true"),a(!1)};if(!s)return null;const d=(u=i,l.find(e=>e.code===u));var u;return n.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200 shadow-sm",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(me,{className:"w-5 h-5 text-blue-600"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:null==d?void 0:d.flag}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Continue in ",null==d?void 0:d.name,"?"]}),n.jsxs("p",{className:"text-xs text-slate-600",children:["We detected you speak ",null==d?void 0:d.name]})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>(async s=>{try{await t.changeLanguage(s),localStorage.setItem("ui_language",s),localStorage.setItem("language_choice_made","true"),a(!1),null==e||e(s)}catch(r){console.error("Failed to change language:",r)}})(i),className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Yes"}),n.jsx("button",{onClick:c,className:"px-3 py-2 text-slate-600 text-sm hover:text-slate-800 transition-colors",children:"Keep English"}),n.jsx("button",{onClick:c,className:"p-1 text-slate-400 hover:text-slate-600 transition-colors","aria-label":"Dismiss",children:n.jsx(A,{className:"w-4 h-4"})})]})]})})})},nn=new Date("2025-12-27T00:00:00Z"),on="comingSoonDismissedV1",ln="comingSoonSubscribedV1",cn="comingSoonSnoozedUntilV1",dn=()=>{try{return new Date<nn}catch{return!0}},un=()=>{const[e,t]=r.useState(!1),[s,a]=r.useState(""),[i,o]=r.useState(!1),[l,c]=r.useState(!1),[d,u]=r.useState("");r.useEffect(()=>{if(dn())try{const e="true"===localStorage.getItem(on),s="true"===localStorage.getItem(ln),a=localStorage.getItem(cn),r=a?new Date(a):null,n=new Date,i=r instanceof Date&&!isNaN(r.getTime())&&r>n;e||s||i||t(!0)}catch{t(!0)}},[]);return e&&dn()?n.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-slate-900/65 backdrop-blur-sm",children:n.jsxs("div",{className:"relative w-full max-w-[720px] mx-4 sm:mx-6 rounded-3xl bg-white/96 shadow-2xl border border-white/60 p-5 sm:p-7 md:p-8 overflow-hidden",children:[n.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-3xl bg-gradient-to-br from-sky-50/85 via-white/40 to-indigo-50/40"}),n.jsxs("div",{className:"relative flex flex-col gap-4",children:[n.jsx("button",{onClick:()=>{try{localStorage.setItem(on,"true")}catch{}t(!1)},className:"absolute right-2 top-2 sm:right-3 sm:top-3 text-slate-400 hover:text-slate-700 transition-colors","aria-label":"Close",children:n.jsx(A,{className:"w-4 h-4"})}),n.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-sky-50 border border-sky-100 text-[10px] sm:text-xs font-semibold text-sky-700 tracking-[0.16em] uppercase font-nunito",children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-sky-500 animate-pulse"}),n.jsx("span",{children:"IELTS Speaking Experience Preview"})]}),n.jsx("h2",{className:"text-2xl sm:text-3xl md:text-[32px] font-extrabold tracking-tight text-slate-900 leading-tight font-nunito",children:"Your AI IELTS Speaking coach is almost ready."}),n.jsxs("p",{className:"text-[12px] sm:text-sm md:text-base text-slate-600 leading-relaxed font-nunito max-w-3xl",children:["We are finalizing an examiner-level IELTS Speaking journey: smart part 13 question flows, real-time scoring, and feedback that feels like a real speaking room, not a chatbot demo. Public launch is targeted for"," ",n.jsx("span",{className:"font-semibold text-slate-900",children:"27 December"}),". Leave your email for early access and launch-only speaking bonuses."]}),l?n.jsx("div",{className:"mt-2 sm:mt-3 text-[11px] sm:text-sm text-emerald-700 bg-emerald-50/90 border border-emerald-100 rounded-2xl px-3 py-2 font-nunito",children:"You're in. We'll email you as soon as your IELTS Speaking coach is live."}):n.jsxs("form",{onSubmit:async e=>{var t,a;e.preventDefault(),u("");const r=s.trim();if(r&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)){o(!0);try{const e="undefined"!=typeof navigator?navigator.userAgent:null,s="undefined"!=typeof window?window.location.pathname:null,{error:n}=await jr.from("coming_soon_signups").insert({email:r,user_agent:e,page_path:s});if(n){const e=(null==(a=null==(t=n.message)?void 0:t.toLowerCase)?void 0:a.call(t))||"";if("23505"===n.code||e.includes("duplicate")){c(!0);try{localStorage.setItem(ln,"true")}catch{}return}return console.error("Error saving coming soon signup:",n),void u("Something went wrong. Please try again in a moment.")}c(!0);try{localStorage.setItem(ln,"true")}catch{}}catch(n){console.error("Unexpected signup error:",n),u("Something went wrong. Please try again in a moment.")}finally{o(!1)}}else u("Please enter a valid email address.")},className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"coming-soon-email",className:"block text-[10px] sm:text-xs font-semibold text-slate-800 mb-1 font-nunito",children:"Get first access to the IELTS Speaking launch"}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx(Vr,{id:"coming-soon-email",type:"email",required:!0,placeholder:"you@example.com",value:s,onChange:e=>a(e.target.value),className:"flex-1 text-[11px] sm:text-sm h-9 sm:h-10 rounded-xl border-slate-200/90 bg-white/95 font-nunito"}),n.jsx(qr,{type:"submit",className:"h-9 sm:h-10 px-4 sm:px-5 rounded-xl bg-sky-600 hover:bg-sky-700 text-[10px] sm:text-xs font-semibold shadow-sm",disabled:i,children:i?"Saving...":"Notify me"})]})]}),d&&n.jsx("p",{className:"text-[10px] sm:text-xs text-red-600 font-nunito",children:d}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-between mt-1",children:[n.jsx("p",{className:"text-[9px] sm:text-[10px] text-slate-500 leading-snug font-nunito",children:"We'll only use your email for launch updates and key improvements. No spam."}),n.jsx("button",{type:"button",onClick:()=>{try{const e=new Date;e.setHours(e.getHours()+24),localStorage.setItem(cn,e.toISOString())}catch{}t(!1)},className:"text-[9px] sm:text-[10px] text-slate-500 hover:text-slate-800 underline-offset-2 hover:underline font-nunito",children:"Remind me later (24h)"})]})]})]})]})}):null},mn=Er(),hn=()=>{const{i18n:e}=w(),t=en(),[s,a]=r.useState(!1),i=r.useRef(null),o=mn.find(t=>t.code===e.language)||mn[0];return r.useEffect(()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&a(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),r.useEffect(()=>{try{const t=localStorage.getItem("alfie-language");t&&t!==e.language&&e.changeLanguage(t).catch(e=>console.error("Failed to restore language from storage",e))}catch(t){console.warn("Unable to read persisted language",t)}},[e]),n.jsxs("div",{className:"relative",ref:i,children:[n.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-2 px-3 py-2 rounded-lg border transition-all text-sm font-medium focus:outline-none focus:ring-2",style:{backgroundColor:"glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)",borderColor:t.border,color:t.textPrimary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=t.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)"},"aria-label":"Select language","aria-expanded":s,"aria-haspopup":"listbox",children:[n.jsx("span",{className:"text-lg",children:o.flag}),n.jsx("span",{className:"flex-1 text-center",children:o.nativeName}),n.jsx(V,{className:"w-3 h-3 transition-transform "+(s?"rotate-180":"")})]}),s&&n.jsx("div",{className:"absolute left-0 mt-2 w-56 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",style:{backgroundColor:t.cardBackground,borderColor:t.border,borderWidth:"1px",borderStyle:"solid"},role:"listbox","aria-label":"Language options",children:n.jsx("div",{className:"py-2",children:mn.map(s=>n.jsxs("button",{onClick:()=>(async t=>{try{await e.changeLanguage(t);try{localStorage.setItem("alfie-language",t)}catch(s){console.warn("Unable to persist language preference",s)}a(!1)}catch(r){console.error("Failed to change language:",r)}})(s.code),className:"w-full flex items-center justify-between px-4 py-2 text-left transition-colors",style:{backgroundColor:e.language===s.code?t.hoverBg:"transparent"},onMouseEnter:a=>{e.language!==s.code&&(a.currentTarget.style.backgroundColor=t.hoverBg)},onMouseLeave:t=>{e.language!==s.code&&(t.currentTarget.style.backgroundColor="transparent")},role:"option","aria-selected":e.language===s.code,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:s.flag}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm font-medium",style:{color:t.textPrimary},children:s.nativeName}),n.jsx("span",{className:"text-xs",style:{color:t.textSecondary},children:s.name})]})]}),e.language===s.code&&n.jsx(Z,{className:"w-4 h-4",style:{color:t.buttonPrimary}})]},s.code))})})]})},gn=(e,t,s)=>{const[a,n]=r.useState(t),[i,o]=r.useState(!1);return r.useEffect(()=>{if("en"===s)return void n(t);(async()=>{o(!0);try{const{data:a,error:r}=await jr.from("page_translations").select("content").eq("page_key",e).eq("language_code",s).single();if(a&&!r)return n(a.content),void o(!1);const{data:i,error:l}=await jr.functions.invoke("translate-page",{body:{pageKey:e,targetLanguage:s,content:t}});l?(console.error(`Translation error for ${s}:`,l),n(t)):(null==i?void 0:i.translation)?(console.log(`Successfully loaded translation for ${s}`),n(i.translation)):(console.warn(`No translation data returned for ${s}`),n(t))}catch(a){console.error("Failed to fetch translation:",a),n(t)}finally{o(!1)}})()},[e,s]),{content:a,isLoading:i}},pn=({title:e,subtitle:t,price:s,period:a,features:r,buttonText:i,onButtonClick:o,isPopular:l=!1,badge:c,isPremium:d=!1,isBlack:u=!1,isGold:m=!1,originalPrice:h,limitedTimeOffer:g=!1,className:p=""})=>{const x=e.toLowerCase().includes("pro")||u,f=l?`relative flex flex-col h-full rounded-2xl border p-8 border-neutral-200 bg-white shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 scale-105 ring-1 ring-black/5 ${p}`:`flex flex-col h-full rounded-2xl border p-8 border-neutral-100 bg-white shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1 ${p}`,b=x?"mt-8 w-full inline-flex items-center justify-center gap-2 rounded-xl px-4 py-4 text-sm font-medium transition bg-gradient-to-r from-[#d97757] to-[#e8956e] text-white hover:from-[#c86646] hover:to-[#d7845d] shadow-lg hover:shadow-xl":d?"mt-8 w-full inline-flex items-center justify-center gap-2 rounded-xl px-4 py-4 text-sm font-medium transition bg-[#1a1a1a] text-white hover:bg-black shadow-lg hover:shadow-xl":"mt-8 w-full inline-flex items-center justify-center gap-2 rounded-xl px-4 py-4 text-sm font-medium transition bg-white border border-neutral-200 text-neutral-900 hover:bg-neutral-50";return n.jsxs("div",{className:f,children:[l&&c&&n.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:n.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full px-4 py-1.5 text-xs font-medium text-white shadow-lg "+(x?"bg-gradient-to-r from-[#d97757] to-[#e8956e]":"bg-[#1a1a1a]"),children:[n.jsx(he,{className:"h-3 w-3 text-amber-300"}),c]})}),n.jsxs("div",{className:"text-center "+(l?"mt-2":""),children:[n.jsx("h3",{className:"text-xl font-medium tracking-tight font-serif text-[#1a1a1a]",children:e}),n.jsx("p",{className:"mt-3 text-sm text-neutral-500 min-h-[40px] leading-relaxed",children:t}),n.jsxs("div",{className:"mt-8 flex items-baseline justify-center gap-1",children:[n.jsx("span",{className:"text-5xl font-serif font-medium text-[#1a1a1a] tracking-tight",children:s}),n.jsx("span",{className:"text-sm text-neutral-500 font-medium",children:a})]})]}),n.jsx("div",{className:"mt-8 pt-8 border-t border-neutral-100 flex-grow",children:n.jsx("ul",{className:"space-y-4",children:r.map((t,s)=>{const a=s===r.length-1&&"Starter"===e;return n.jsxs("li",{className:"flex items-start gap-3 text-sm "+(a?"text-neutral-400 line-through":"text-neutral-700"),children:[a?n.jsx(A,{className:"h-4 w-4 text-neutral-300 flex-shrink-0 mt-0.5"}):n.jsx(Z,{className:"h-4 w-4 text-emerald-600 flex-shrink-0 mt-0.5"}),n.jsx("span",{className:"leading-tight",children:t})]},s)})})}),n.jsx("button",{onClick:o,className:b,children:i})]})},xn=({className:e})=>{w();const[t,s]=r.useState("overall"),[a,i]=r.useState(!1);r.useEffect(()=>{const e=setTimeout(()=>{i(!0)},300);return()=>clearTimeout(e)},[]);const o=[{id:"ielts",label:"IELTS",icon:ge,color:"#d97757",baseline:3.2,target:7.1},{id:"toeic",label:"TOEIC",icon:null,color:"#3b82f6",baseline:550,target:900},{id:"toefl",label:"TOEFL",icon:null,color:"#10b981",baseline:60,target:110},{id:"pte",label:"PTE",icon:null,color:"#f59e0b",baseline:42,target:85}],l={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{duration:.3}}};return n.jsx(Et.div,{className:e,initial:"hidden",animate:a?"visible":"hidden",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,staggerChildren:.1}}},children:n.jsx(Rr,{className:"bg-[#fcfaf8] border-[#e6e0d4] shadow-sm overflow-hidden min-h-[500px]",children:n.jsxs(Br,{className:"pt-8",children:[n.jsx(Et.div,{variants:l,className:"mb-8 grid grid-cols-2 lg:grid-cols-4 gap-3",children:o.map(e=>(t===e.id||"overall"===t&&e.id,n.jsx(Et.button,{variants:l,whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>s(e.id),className:"p-3 rounded-lg border transition-all duration-300 "+(t===e.id?"border-[#d97757] bg-white shadow-md":"border-[#e6e0d4] bg-[#faf8f6] hover:bg-white hover:border-[#d97757]/50"),children:n.jsx("div",{className:"text-center",children:n.jsx("div",{className:"text-sm font-bold font-serif "+(t===e.id?"text-[#2d2d2d]":"text-[#666666]"),children:e.label})})},e.id)))}),n.jsx(St,{mode:"wait",children:n.jsx(Et.div,{variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{duration:.4}}},initial:"hidden",animate:"visible",exit:"hidden",className:"relative",children:(()=>{const e=o.find(e=>e.id===("overall"===t?"ielts":t))||o[0],s=(e=>{const t=[],s=e.baseline,a=e.target,r=a-s;for(let n=0;n<=6;n++){let e;if(0===n)e=0;else{const t=n/6*6-3;let s=1/(1+Math.exp(-t));const a=1/(1+Math.exp(3));s=(s-a)/(1/(1+Math.exp(-3))-a);const r=.05*(Math.random()-.5);e=Math.max(0,Math.min(1,s+r))}let i=s+r*e;6===n&&(i=a);const o=1200,l=Math.floor(o*(n/6)*(.8+.4*Math.random())+100*n);t.push({month:0===n?"Start":`Month ${n}`,score:Math.max(s,Math.min(a,Math.round(10*i)/10)),label:0===n?"Starting Point":`Month ${n} Progress`,description:Math.round(10*i)/10+" Band Score",students:l})}return t})(e);return e.icon,n.jsxs("div",{className:"bg-white rounded-xl p-6 border border-[#e6e0d4] shadow-sm",children:[n.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("h3",{className:"text-xl font-bold text-[#2d2d2d] font-serif",children:[e.label," Mastery Path"]})})}),n.jsx("div",{className:"h-[300px] w-full",children:n.jsx(Lt,{width:"100%",height:"100%",children:n.jsxs(Mt,{data:s,margin:{top:20,right:10,left:0,bottom:0},children:[n.jsx(Ot,{strokeDasharray:"3 3",vertical:!1,stroke:"#e6e0d4"}),n.jsx(Rt,{dataKey:"month",stroke:"#666666",fontSize:12,tickLine:!1,axisLine:!1,tick:{fontFamily:"'Montserrat', sans-serif",fill:"#666666"},dy:10}),n.jsx(Dt,{stroke:"#666666",fontSize:12,domain:[Math.floor(.8*e.baseline),Math.ceil(1.1*e.target)],tickLine:!1,axisLine:!1,tickFormatter:e=>`${e}`,tick:{fontFamily:"'Montserrat', sans-serif",fill:"#666666"},dx:-10}),n.jsx(Ft,{cursor:{fill:"#f5f2e8",opacity:.5},content:({active:e,payload:t,label:s})=>{if(e&&t&&t.length){const e=t[0].payload;return n.jsxs("div",{className:"bg-white border border-[#e6e0d4] rounded-lg p-3 shadow-lg",children:[n.jsx("p",{className:"font-serif font-bold text-[#2d2d2d] mb-1",children:e.month}),n.jsxs("div",{className:"flex items-baseline gap-2",children:[n.jsx("p",{className:"text-xl font-bold text-[#d97757]",children:e.score}),n.jsx("span",{className:"text-xs text-[#666666] font-medium uppercase",children:"Band Score"})]})]})}return null}}),n.jsx(zt,{dataKey:"score",fill:e.color,radius:[4,4,0,0],animationDuration:1500,barSize:40})]})})})]})})()},t||"default")})]})})})},fn=e=>({IELTS:["IELTS Reading","IELTS Listening","IELTS Writing","IELTS Speaking","Academic English","Test Strategies"],TOEFL:["TOEFL Reading","TOEFL Listening","TOEFL Speaking","TOEFL Writing","Academic English"],PTE:["PTE Reading","PTE Listening","PTE Speaking","PTE Writing","Academic English"],"General English":["Grammar","Vocabulary","Speaking","Listening","Writing","Reading","Pronunciation"],"Business English":["Business Communication","Professional Writing","Presentation Skills","Meeting Skills"],"Academic English":["Academic Writing","Research Skills","Citation","Academic Reading"]}[e]||["English Language Skills"]),bn=({title:e,description:t,keywords:s,image:a,url:r,type:i="website",author:o="English AIdol",published:l,modified:c,section:d,tags:u,structuredData:m,schemaType:h,courseType:g,courseLevel:p,serviceName:x,serviceDescription:f,faqs:b,breadcrumbs:y,hreflang:v,lang:j="en",howToSteps:w,totalTime:_,questionText:N,answerText:k})=>{const E="English AIdol",S=e||"English AIdol - AI-Powered English Learning Platform | IELTS & General English",T=t||"Master English with AI-powered learning. Join 50,000+ students achieving their English goals with personalized AI feedback, comprehensive practice tests, and expert guidance for IELTS and General English. Created by TESOL-certified experts and former IELTS examiners.",C=a||"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/social-images/social-1758811085448-Upscale_this_adorable_bunny_character_wearing_glas-1758810348175.png",I=r||"https://englishaidol.com",A=s||"English learning, IELTS preparation, AI tutor, language learning, speaking practice, writing feedback, vocabulary builder, grammar practice, TOEFL, PTE, TOEIC, English AIdol, AI English tutor, IELTS practice tests, English exam preparation";let P=m;if(h)switch(h){case"organization":P={"@context":"https://schema.org","@type":"EducationalOrganization",name:"English AIdol",alternateName:"English AI dol",description:"Master English with AI-powered learning. Join 50,000+ students achieving their English goals with personalized AI feedback, comprehensive practice tests, and expert guidance for IELTS and General English. Created by TESOL-certified experts and former IELTS examiners.",url:"https://englishaidol.com",logo:"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/uploads/1758811060051-Create_an_icon_featuring_a_cartoon-style_white_rab-1758811037411.png",image:"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/social-images/social-1758811085448-Upscale_this_adorable_bunny_character_wearing_glas-1758810348175.png",foundingDate:"2024",slogan:"AI-Powered English Learning Platform",knowsAbout:["IELTS Preparation","English Language Learning","AI Tutoring","Language Assessment","English Exam Preparation"],contactPoint:{"@type":"ContactPoint",contactType:"customer service",availableLanguage:["English"],contactOption:"TollFree",email:"hello@englishaidol.com"},sameAs:["https://www.instagram.com/englishaidol","https://www.facebook.com/englishaidol","https://twitter.com/englishaidol"],hasEducationalCredential:{"@type":"EducationalCredential",name:"IELTS Preparation",description:"Comprehensive IELTS preparation with AI-powered feedback validated by former IELTS examiners"},offers:[{"@type":"Service",name:"IELTS Preparation",description:"AI-powered IELTS preparation with 98% correlation to real exam scores, created by former IELTS examiners"},{"@type":"Service",name:"General English Learning",description:"Personalized English learning with AI feedback, vocabulary building, and grammar practice"},{"@type":"Service",name:"Speaking Practice",description:"AI-powered pronunciation and fluency training with instant feedback"},{"@type":"Service",name:"Writing Feedback",description:"Detailed writing analysis using exact IELTS Band Descriptors"}],areaServed:{"@type":"Country",name:"Worldwide"},aggregateRating:{"@type":"AggregateRating",ratingValue:"4.8",reviewCount:"5000",bestRating:"5",worstRating:"1"},serviceType:["IELTS Preparation","TOEFL Preparation","TOEIC Preparation","PTE Preparation","General English Learning","Vocabulary Building","Grammar Practice","Speaking Practice","Writing Feedback","AI-Powered Tutoring"]};break;case"course":g&&(P=((e,t)=>({"@context":"https://schema.org","@type":"Course",name:`${e} Preparation Course`,description:`Comprehensive ${e} preparation with AI-powered feedback and practice tests`,provider:{"@type":"EducationalOrganization",name:"English AIdol"},courseMode:"online",timeRequired:"P4M",educationalLevel:t||"Intermediate to Advanced",teaches:fn(e),isAccessibleForFree:!0,hasCourseInstance:{"@type":"CourseInstance",courseMode:"online",instructor:{"@type":"EducationalOrganization",name:"English AIdol AI System"}}}))(g,p));break;case"service":x&&f&&(P=((e,t)=>({"@context":"https://schema.org","@type":"Service",name:e,description:t,provider:{"@type":"EducationalOrganization",name:"English AIdol"},serviceType:"Online Education",areaServed:{"@type":"Country",name:"Worldwide"},offers:{"@type":"Offer",priceSpecification:{"@type":"PriceSpecification",price:"0",priceCurrency:"USD",referenceQuantity:{"@type":"QuantitativeValue",value:"1",unitText:"month"}},availability:"https://schema.org/InStock",seller:{"@type":"EducationalOrganization",name:"English AIdol"}}}))(x,f));break;case"website":P={"@context":"https://schema.org","@type":"WebSite",name:"English AIdol",alternateName:"English AI dol",description:"AI-powered English learning platform for IELTS and General English mastery",url:"https://englishaidol.com",potentialAction:{"@type":"SearchAction",target:"https://englishaidol.com/search?q={search_term_string}","query-input":"required name=search_term_string"},publisher:{"@type":"EducationalOrganization",name:"English AIdol"}};break;case"localBusiness":P={"@context":"https://schema.org","@type":"LocalBusiness","@id":"https://englishaidol.com/#organization",name:"English AIdol",image:"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/uploads/1758811060051-Create_an_icon_featuring_a_cartoon-style_white_rab-1758811037411.png",url:"https://englishaidol.com",telephone:"+1-555-0123",address:{"@type":"PostalAddress",streetAddress:"Online Platform",addressLocality:"Global",addressCountry:"US"},geo:{"@type":"GeoCoordinates",latitude:40.7128,longitude:-74.006},openingHoursSpecification:{"@type":"OpeningHoursSpecification",dayOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],opens:"00:00",closes:"23:59"},sameAs:["https://www.instagram.com/englishaidol","https://www.facebook.com/englishaidol","https://twitter.com/englishaidol"]};break;case"faq":b&&b.length>0&&(P=(e=>({"@context":"https://schema.org","@type":"FAQPage",mainEntity:e.map(e=>({"@type":"Question",name:e.question,acceptedAnswer:{"@type":"Answer",text:e.answer}}))}))(b));break;case"breadcrumb":y&&y.length>0&&(P=(e=>({"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:e.map((e,t)=>({"@type":"ListItem",position:t+1,name:e.name,item:e.url}))}))(y));break;case"article":e&&t&&(P=((e,t,s,a,r,n,i)=>({"@context":"https://schema.org","@type":"BlogPosting",headline:e,description:t,url:s,datePublished:a||(new Date).toISOString(),dateModified:r||a||(new Date).toISOString(),author:{"@type":"Organization",name:n||"English AIdol",url:"https://englishaidol.com"},publisher:{"@type":"Organization",name:"English AIdol",url:"https://englishaidol.com",logo:{"@type":"ImageObject",url:"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/uploads/1758811060051-Create_an_icon_featuring_a_cartoon-style_white_rab-1758811037411.png"}},image:i||"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/social-images/social-1758811085448-Upscale_this_adorable_bunny_character_wearing_glas-1758810348175.png",mainEntityOfPage:{"@type":"WebPage","@id":s},isAccessibleForFree:!0,inLanguage:"en"}))(e,t,I,l,c,o,C));break;case"articleWithFaq":e&&t&&b&&b.length>0&&(P=((e,t,s,a,r,n,i)=>({"@context":"https://schema.org","@graph":[{"@type":"BlogPosting",headline:e,description:t,url:s,datePublished:r||(new Date).toISOString(),dateModified:n||r||(new Date).toISOString(),author:{"@type":"Organization",name:"English AIdol",url:"https://englishaidol.com"},publisher:{"@type":"Organization",name:"English AIdol",url:"https://englishaidol.com",logo:{"@type":"ImageObject",url:"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/uploads/1758811060051-Create_an_icon_featuring_a_cartoon-style_white_rab-1758811037411.png"}},image:i||"https://storage.googleapis.com/gpt-engineer-file-uploads/oufTM9t5lFf51A21C2I86dAQL9J3/social-images/social-1758811085448-Upscale_this_adorable_bunny_character_wearing_glas-1758810348175.png",mainEntityOfPage:{"@type":"WebPage","@id":s},isAccessibleForFree:!0,inLanguage:"en"},{"@type":"FAQPage",mainEntity:a.map(e=>({"@type":"Question",name:e.question,acceptedAnswer:{"@type":"Answer",text:e.answer}}))}]}))(e,t,I,b,l,c,C));break;case"howTo":e&&t&&w&&w.length>0&&(P=((e,t,s,a,r)=>({"@context":"https://schema.org","@type":"HowTo",name:e,description:t,image:r,totalTime:a||"PT30M",step:s.map((e,t)=>({"@type":"HowToStep",position:t+1,name:e.name,text:e.text,image:e.image})),author:{"@type":"Organization",name:"English AIdol",url:"https://englishaidol.com"}}))(e,t,w,_,C));break;case"qaPage":N&&k&&(P=((e,t,s)=>({"@context":"https://schema.org","@type":"QAPage",mainEntity:{"@type":"Question",name:e,text:e,answerCount:1,acceptedAnswer:{"@type":"Answer",text:t,url:s,author:{"@type":"Organization",name:"English AIdol",url:"https://englishaidol.com"}}}}))(N,k,I))}return n.jsxs(pr,{children:[n.jsx("html",{lang:j}),n.jsx("title",{children:S}),n.jsx("meta",{name:"description",content:T}),n.jsx("meta",{name:"keywords",content:A}),n.jsx("meta",{name:"author",content:o}),n.jsx("meta",{name:"robots",content:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"}),n.jsx("meta",{name:"googlebot",content:"index, follow"}),n.jsx("meta",{name:"application-name",content:E}),n.jsx("meta",{name:"apple-mobile-web-app-title",content:E}),l&&n.jsx("meta",{name:"article:published_time",content:l}),c&&n.jsx("meta",{name:"article:modified_time",content:c}),d&&n.jsx("meta",{name:"article:section",content:d}),u&&u.map(e=>n.jsx("meta",{name:"article:tag",content:e},e)),n.jsx("meta",{property:"og:title",content:S}),n.jsx("meta",{property:"og:description",content:T}),n.jsx("meta",{property:"og:image",content:C}),n.jsx("meta",{property:"og:url",content:I}),n.jsx("meta",{property:"og:type",content:i}),n.jsx("meta",{property:"og:site_name",content:E}),n.jsx("meta",{property:"og:locale",content:j}),v&&v.map(e=>n.jsx("meta",{property:"og:locale:alternate",content:e.lang},e.lang)),n.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),n.jsx("meta",{name:"twitter:site",content:"@englishaidol"}),n.jsx("meta",{name:"twitter:title",content:S}),n.jsx("meta",{name:"twitter:description",content:T}),n.jsx("meta",{name:"twitter:image",content:C}),n.jsx("link",{rel:"canonical",href:I}),v&&v.map(e=>n.jsx("link",{rel:"alternate",hrefLang:e.lang,href:e.url},e.lang)),v&&n.jsx("link",{rel:"alternate",hrefLang:"x-default",href:I}),P&&n.jsx("script",{type:"application/ld+json",children:JSON.stringify(P)})]})},yn=()=>{const e=o(),{t:t,i18n:s}=w(),{toast:a}=Ts(),{user:i,loading:c}=Pr(),[d,u]=r.useState(!1),[m,h]=r.useState("monthly"),g={hero:{title:"Master English with AI-Powered Learning",subtitle:"Join 50,000+ students achieving their goals across IELTS, TOEFL, PTE, TOEIC, and General English with personalized AI feedback and expert guidance.",startButton:"Start Your Journey",exploreButton:"Explore All Tests"},highlights:{aiFeedback:{title:"AI-Powered Feedback",description:"Get instant, detailed analysis of your English skills with personalized improvement suggestions."},adaptive:{title:"Adaptive Learning",description:"Smart algorithms that adapt to your pace and focus on your weak areas for optimal progress."},proven:{title:"Proven Results",description:"95% success rate with students achieving their target scores faster than traditional methods."},community:{title:"Expert Community",description:"Connect with certified instructors and fellow learners for support and motivation."}},programs:{title:"Learning Programs",subtitle:"Choose your path to English mastery with our comprehensive programs.",cards:{ielts:{title:"IELTS"},toefl:{title:"TOEFL"},toeic:{title:"TOEIC"},pte:{title:"PTE"},general:{title:"General English"}}},features:{title:"AI-powered learning that adapts to you",subtitle:"Our advanced AI technology creates personalized learning experiences that help you achieve your English goals faster and more effectively.",list:{aiFeedback:{title:"AI-Powered Feedback",description:"Get instant, personalized feedback on your performance with detailed analysis."},adaptive:{title:"Adaptive Learning",description:"Smart algorithm adapts to your learning pace and identifies weak areas."},realtime:{title:"Real-time Progress",description:"Track your improvement with comprehensive analytics and score predictions."},community:{title:"Expert Community",description:"Connect with fellow learners and certified English instructors worldwide."}},stats:{students:"Active students",success:"Success rate",support:"AI support"},askQuestion:"Ask a Question",startLearning:"Start Learning",engineTitle:"AI Learning Engine",engineSubtitle:"Intelligent feedback system"},pricing:{title:"Pricing",discounts:{monthly:"Monthly",threeMonths:"3 Months",sixMonths:"6 Months",save10:"Save 15%",save30:"Save 30%"},free:{title:"Explorer",subtitle:"Experience the power of AI learning completely risk-free.",price:"$0",period:"/forever",features:["Access to 1 Full Practice Test","Basic AI Scoring & Feedback","Limited Vocabulary Builder","Community Forum Access"],button:"Start Free Journey"},pro:{title:"Pro",subtitle:"Unlock your full potential with unlimited AI mentorship.",badge:"Most Popular",priceMonthly:"$78",price3Months:"$68",price6Months:"$58",period:"/mo",features:["Unlimited AI Practice Tests","Examiner-Level Detailed Feedback","Advanced Pronunciation Coaching","Writing Style & Tone Analysis","Personalized Study Roadmap","Priority Support Channel"],button:"Become a Pro"},ultra:{title:"Ultra",subtitle:"The ultimate mentorship package for serious achievers.",priceMonthly:"$300",price3Months:"$270",price6Months:"$240",period:"/mo",features:["Everything in Pro Plan","1-on-1 Personal Meeting with Developers","All Premium Templates & E-books","Direct Access to New Beta Features"],button:"Get Ultra Access"}},testimonials:{title:"Student Success Stories",subtitle:"Real achievements from learners who trusted our platform."},experts:{line:"Created by TESOLcertified experts and former/current IELTS examiners."},comparison:{title:"Why our universal scoring system leads the industry",columns:["Human tutors","Our Multi-Exam AI","Traditional self-study"],rows:['{"label":"Scoring consistency","traditional":"Varies by tutor mood/fatigue","ai":"100% consistent across IELTS, TOEFL, PTE, TOEIC","self":"Guesswork"}','{"label":"Feedback accuracy","traditional":"Subjective","ai":"98% correlation with real exam results","self":"No feedback"}','{"label":"Cost per month","traditional":"$1000$5000 for intensive tutoring","ai":"$49 unlimited access","self":"Free but unreliable"}','{"label":"Exam coverage","traditional":"Specialized tutors needed","ai":"IELTS, TOEFL, PTE, TOEIC, General English","self":"Fragmented resources"}','{"label":"Band descriptors used","traditional":"Tutor\'s interpretation","ai":"Official Rubrics for Each Exam","self":"None"}']},faq:{title:"Expert-validated scoring for every major exam",items:['{"q":"Does this work for TOEFL, PTE, and TOEIC as well as IELTS?","a":"Absolutely. Our AI engine has been trained on thousands of official samples from IELTS, TOEFL, PTE, and TOEIC. It automatically detects which exam you are practicing for and applies the specific scoring rubrics and band descriptors for that test. Whether you need a TOEFL score of 100+, a PTE 79+, or a TOEIC 900+, our feedback is tailored to that exam\'s unique criteria."}','{"q":"How accurate is the scoring for Speaking and Writing?","a":"Our scoring correlates 98% with official exam results across all supported tests. This isn\'t just generic grammar checking; our system evaluates Task Response, Coherence, Lexical Resource, and Pronunciation just like a certified examiner would. We regularly calibrate our AI against real recent exam papers to ensure maximum accuracy."}','{"q":"Can I practice General English without preparing for an exam?","a":"Yes! Our General English module is perfect for professionals and learners who want to improve their fluency, vocabulary, and confidence without the pressure of a specific test format. You still get the same high-quality AI feedback to track your improvement over time."}','{"q":"Is the \'Ultra\' plan really worth it?","a":"If you are serious about achieving a high score quickly, the Ultra plan offers unparalleled value. The 1-on-1 sessions with our developers allow you to deep-dive into how the AI works and get personalized strategy tips. Plus, lifetime legacy status means you lock in your rate forever, even as we add more advanced features."}']},cta:{badge:"Start Your English Journey",title:"Ready to master English?",subtitle:"Join thousands of successful students and start your personalized learning journey today.",startTrial:"Start Free Trial",tryTest:"Try Practice Test",note:"No credit card required. Start learning immediately.",successTitle:"Your Success Awaits",successSubtitle:"Join the AI revolution in English learning"},footer:{description:"AI-powered English learning platform for IELTS and General English mastery.",email:"hello@englishaidol.com",phone:"Available 24/7 via AI Chat",learning:{title:"Learning",ielts:"IELTS Preparation",general:"General English",features:"AI Features",stories:"Success Stories"},resources:{title:"Resources",practice:"Practice Tests",writing:"Writing Feedback",speaking:"Speaking Practice",vocabulary:"Vocabulary Builder"},connect:{title:"Connect"},copyright:" 2024 English AIdol. All rights reserved.",privacy:"Privacy",terms:"Terms",support:"Support"}},{content:p,isLoading:x}=gn("hero-page",g,s.language),f=e=>(e=>{let t=p;for(const s of e){if(!t||"object"!=typeof t)return"";t=t[s]}return"string"==typeof t?t:""})(e)||(e=>{let t=g;for(const s of e){if(!t||"object"!=typeof t)return"";t=t[s]}return"string"==typeof t?t:""})(e),b=e=>{let t=p;for(const s of e){if(!t||"object"!=typeof t){let t=g;for(const s of e)t&&"object"==typeof t&&(t=t[s]);return Array.isArray(t)?t:[]}t=t[s]}return Array.isArray(t)?t:[]},y=()=>{c||e(i?"/dashboard":"/auth")};return f(["features","list","aiFeedback","title"]),f(["features","list","aiFeedback","description"]),f(["features","list","adaptive","title"]),f(["features","list","adaptive","description"]),f(["features","list","realtime","title"]),f(["features","list","realtime","description"]),f(["features","list","community","title"]),f(["features","list","community","description"]),n.jsxs("div",{className:"min-h-screen antialiased text-[#3c3c3c] bg-[#f5f2e8]",style:{fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', sans-serif"},children:[n.jsx(bn,{title:"English AIdol - AI-Powered English Learning Platform | IELTS & General English",description:"Master English with AI-powered learning. Join thousands of students achieving their English goals with personalized AI feedback, comprehensive practice tests, and expert guidance for IELTS, TOEFL, PTE, TOEIC, and General English. Created by TESOL-certified experts.",keywords:"English learning, IELTS preparation, AI tutor, language learning, speaking practice, writing feedback, vocabulary builder, grammar practice, TOEFL, PTE, TOEIC, English AIdol, AI English tutor, IELTS practice tests, English exam preparation, AI speaking scoring, instant writing feedback, IELTS mock test, PTE practice",type:"website",schemaType:"organization",url:"https://englishaidol.com"}),n.jsx(rn,{onLanguageSelected:e=>{a({title:"Language Updated",description:"Interface language changed to your preference."})}}),n.jsx("header",{className:"fixed z-50 top-0 right-0 left-0 bg-[#f5f2e8]/80 backdrop-blur-md border-b border-[#e6e0d4]",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"flex items-center justify-between py-4",children:[n.jsx("nav",{className:"hidden items-center gap-8 md:flex"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"md:block",children:n.jsx(hn,{})}),i?n.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-full bg-[#d97757] text-white font-medium hover:bg-[#c56a4b] transition-colors shadow-sm text-sm",children:[n.jsx(fe,{className:"h-4 w-4"}),i?t("header.dashboard",{defaultValue:"Dashboard"}):t("header.startFreeTrial",{defaultValue:"Start Free Trial"})]}):n.jsx("button",{onClick:()=>e("/auth"),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-full bg-[#d97757] text-white font-medium hover:bg-[#c56a4b] transition-colors shadow-sm text-sm",children:t("header.signIn",{defaultValue:"Sign In"})})]}),n.jsx("button",{onClick:()=>u(!d),className:"md:hidden inline-flex h-10 w-10 items-center justify-center rounded-full bg-[#e6e0d4]/50 hover:bg-[#e6e0d4] text-[#3c3c3c] transition-colors","aria-label":"Open menu",children:d?n.jsx(A,{className:"h-5 w-5"}):n.jsx(be,{className:"h-5 w-5"})})]}),d&&n.jsx("div",{className:"border-t px-4 py-4 md:hidden border-[#e6e0d4] bg-[#f5f2e8]",children:n.jsx("nav",{className:"grid gap-4",children:n.jsx("div",{className:"flex gap-2",children:i?n.jsxs("button",{onClick:y,className:"flex-1 inline-flex justify-center items-center gap-2 px-5 py-3 rounded-full bg-[#d97757] text-white font-medium hover:bg-[#c56a4b] transition-colors shadow-sm text-sm",children:[n.jsx(fe,{className:"h-4 w-4"}),i?t("header.dashboard",{defaultValue:"Dashboard"}):t("header.startFree",{defaultValue:"Start Free"})]}):n.jsx("button",{onClick:()=>e("/auth"),className:"flex-1 inline-flex justify-center items-center gap-2 px-5 py-3 rounded-full bg-[#d97757] text-white font-medium hover:bg-[#c56a4b] transition-colors shadow-sm text-sm",children:t("header.signIn",{defaultValue:"Sign In"})})})})})]})}),n.jsx("section",{className:"pt-32 pb-20 relative min-h-[90vh] flex items-center bg-[#f5f2e8] overflow-hidden",children:n.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full",children:n.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 lg:gap-20 items-center",children:[n.jsxs("div",{className:"max-w-2xl text-left text-center lg:text-left",children:[n.jsx(Et.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},className:"text-4xl sm:text-5xl lg:text-6xl font-black tracking-tight text-[#2d2d2d] leading-[1.1]",style:{fontFamily:"'Montserrat', sans-serif",fontWeight:"900"},children:f(["hero","title"])}),n.jsx(Et.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2,ease:"easeOut"},className:"mt-8 text-lg sm:text-xl text-[#666666] leading-relaxed",style:{fontFamily:"'Inter', sans-serif",fontWeight:"400"},children:f(["hero","subtitle"])}),n.jsx(Et.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3,ease:"easeOut"},className:"mt-6",children:n.jsxs("button",{onClick:y,className:"inline-flex items-center justify-center gap-2 px-8 py-4 rounded-full bg-[#d97757] text-white font-medium hover:bg-[#c56a4b] transition-all shadow-md hover:shadow-lg text-base min-h-[48px] w-full sm:w-auto sm:min-w-[200px]",children:[n.jsx(ye,{className:"h-4 w-4"}),"Get Started Now"]})})]}),n.jsxs(Et.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:1,delay:.2,ease:"easeOut"},className:"relative lg:block h-full min-h-[300px] sm:min-h-[400px] lg:min-h-[500px] w-full mt-12 lg:mt-0",children:[n.jsx("div",{className:"absolute inset-0 bg-[#d97757]/5 rounded-[3rem] transform rotate-3 scale-95 z-0"}),n.jsx("img",{className:"relative z-10 w-full h-auto object-cover rounded-[2.5rem] shadow-xl border border-[#e6e0d4]",src:"/hero-image.png",alt:"English AIdol Learning Interface",loading:"lazy",decoding:"async"})]})]})})}),n.jsx("section",{className:"py-12 bg-[#f5f2e8]",id:"programs",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"text-center mb-16",children:[n.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-[#2d2d2d]",style:{fontFamily:"'Montserrat', sans-serif"},children:f(["programs","title"])}),n.jsx("p",{className:"mt-4 text-lg text-[#666666] font-sans",children:f(["programs","subtitle"])})]}),n.jsx("div",{className:"grid gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[{id:"ielts",img:"/hero-nov06.png",title:"IELTS",path:"/ielts-portal"},{id:"toefl",img:"/Generated Image October 19, 2025 - 11_14PM.png",title:"TOEFL",path:"/toefl-portal"},{id:"toeic",img:"/TOEIC.png",title:"TOEIC",path:"/toeic"},{id:"pte",img:"/PTE.png",title:"PTE",path:"/pte-portal"},{id:"business",img:"/business-english.png",title:"Business",path:"/business-portal"},{id:"general",img:"/general english.png",title:"General English",path:"/general-portal"}].map(t=>n.jsxs("div",{className:"group flex flex-col items-center p-6 rounded-2xl bg-[#faf8f6] border border-[#e6e0d4] transition-all duration-300 hover:shadow-lg hover:-translate-y-1 cursor-pointer",onClick:()=>e(t.path),children:[n.jsx("div",{className:"w-24 h-24 mb-6 overflow-hidden rounded-xl bg-white p-2 shadow-sm flex items-center justify-center",children:n.jsx("img",{src:t.img,alt:t.title,className:"w-full h-full object-contain",loading:"lazy",decoding:"async"})}),n.jsx("h3",{className:"text-lg font-serif font-medium text-[#3c3c3c]",children:f(["programs","cards",t.id,"title"])})]},t.id))})]})}),n.jsx("section",{className:"py-24 bg-[#f5f2e8]",id:"improvement",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"text-center mb-16",children:[n.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-[#2d2d2d]",style:{fontFamily:"'Montserrat', sans-serif"},children:"Track Your English Progress"}),n.jsx("p",{className:"mt-4 text-lg text-[#666666] font-sans max-w-2xl mx-auto",children:"Click on any skill below to see your personalized improvement journey  Based on 5,683 active students achieving their goals in just 4.6 months average"})]}),n.jsx("div",{className:"max-w-4xl mx-auto",children:n.jsx(xn,{})})]})}),n.jsx("section",{className:"py-24 bg-[#f5f2e8]",id:"comparison",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-[#2d2d2d] text-center mb-16",style:{fontFamily:"'Inter', sans-serif"},children:f(["comparison","title"])}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[n.jsxs("div",{className:"group rounded-3xl p-8 border border-[#e6e0d4] bg-white hover:border-[#d97757]/30 transition-all duration-300 hover:shadow-xl hover:-translate-y-1 relative overflow-hidden flex flex-col",children:[n.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-[#e6e0d4]/10 rounded-bl-full -mr-4 -mt-4 transition-transform group-hover:scale-110"}),n.jsx("h3",{className:"text-xl font-bold text-[#2d2d2d] mb-8 text-center border-b border-[#e6e0d4] pb-4 relative z-10",style:{fontFamily:"'Inter', sans-serif"},children:"Human Tutors"}),n.jsx("ul",{className:"space-y-6 relative z-10 flex-1",children:b(["comparison","rows"]).map((e,t)=>{let s;try{s=JSON.parse(e)}catch{return null}return n.jsxs("li",{className:"flex flex-col gap-1.5 min-h-[80px]",children:[n.jsx("span",{className:"text-xs font-bold text-[#999999] uppercase tracking-wider",children:s.label}),n.jsxs("div",{className:"flex items-start gap-2 text-[#666666] font-medium font-sans text-sm",children:[n.jsx(ve,{className:"h-4 w-4 mt-0.5 text-[#999999] flex-shrink-0"}),n.jsx("span",{children:s.traditional})]})]},t)})})]}),n.jsxs("div",{className:"group rounded-3xl p-8 border-2 border-[#d97757] bg-white shadow-2xl transform scale-105 relative z-20 overflow-visible flex flex-col",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#fffaf8] to-white opacity-50"}),n.jsxs("div",{className:"relative z-10 flex-1",children:[n.jsx("h3",{className:"text-2xl font-bold text-[#d97757] mb-8 text-center border-b border-[#d97757]/10 pb-4",style:{fontFamily:"'Inter', sans-serif"},children:"English AIdol"}),n.jsx("ul",{className:"space-y-6",children:b(["comparison","rows"]).map((e,t)=>{let s;try{s=JSON.parse(e)}catch{return null}return n.jsxs("li",{className:"flex flex-col gap-2 min-h-[80px]",children:[n.jsx("span",{className:"text-xs font-bold text-[#d97757] uppercase tracking-wider",children:s.label}),n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"mt-0.5 bg-[#d97757] p-1 rounded-full flex-shrink-0 shadow-sm",children:n.jsx(Z,{className:"h-3 w-3 text-white"})}),n.jsx("span",{className:"text-[#2d2d2d] font-bold font-sans text-sm leading-snug",children:s.ai})]})]},t)})})]})]}),n.jsxs("div",{className:"group rounded-3xl p-8 border border-[#e6e0d4] bg-white hover:border-[#d97757]/30 transition-all duration-300 hover:shadow-xl hover:-translate-y-1 relative overflow-hidden flex flex-col",children:[n.jsx("div",{className:"absolute top-0 left-0 w-24 h-24 bg-[#e6e0d4]/10 rounded-br-full -ml-4 -mt-4 transition-transform group-hover:scale-110"}),n.jsx("h3",{className:"text-xl font-bold text-[#2d2d2d] mb-8 text-center border-b border-[#e6e0d4] pb-4 relative z-10",style:{fontFamily:"'Inter', sans-serif"},children:"Self-Study"}),n.jsx("ul",{className:"space-y-6 relative z-10 flex-1",children:b(["comparison","rows"]).map((e,t)=>{let s;try{s=JSON.parse(e)}catch{return null}return n.jsxs("li",{className:"flex flex-col gap-1.5 min-h-[80px]",children:[n.jsx("span",{className:"text-xs font-bold text-[#999999] uppercase tracking-wider",children:s.label}),n.jsxs("div",{className:"flex items-start gap-2 text-[#666666] font-medium font-sans text-sm",children:[n.jsx(A,{className:"h-4 w-4 mt-0.5 text-[#999999] flex-shrink-0"}),n.jsx("span",{children:s.self})]})]},t)})})]})]})]})}),n.jsx("section",{className:"py-24 bg-[#f5f2e8]",id:"faq",children:n.jsxs("div",{className:"mx-auto max-w-3xl px-4 sm:px-6 lg:px-8",children:[n.jsx("h2",{className:"text-3xl sm:text-4xl font-serif font-medium text-[#2d2d2d] text-center mb-12",children:f(["faq","title"])}),n.jsx("div",{className:"space-y-4",children:b(["faq","items"]).map((e,t)=>{let s;try{s=JSON.parse(e)}catch{return null}return n.jsxs(Et.details,{initial:{opacity:0,y:10},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.4,delay:.05*t},className:"group rounded-xl border border-[#e6e0d4] bg-white open:shadow-md transition-all duration-200",children:[n.jsxs("summary",{className:"cursor-pointer font-serif font-medium text-[#3c3c3c] px-6 py-5 flex items-center justify-between select-none",children:[n.jsx("span",{className:"text-lg",children:s.q}),n.jsx(V,{className:"h-5 w-5 text-[#666666] transition-transform group-open:rotate-180"})]}),n.jsx(Et.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:n.jsx("p",{className:"px-6 pb-6 text-[#666666] font-sans leading-relaxed border-t border-[#f5f2e8] pt-4",children:s.a})})]},t)})})]})}),n.jsx("section",{className:"py-24 bg-[#f5f2e8] border-t border-[#e6e0d4]",id:"pricing",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsx("div",{className:"text-center mb-12",children:n.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-[#2d2d2d]",style:{fontFamily:"'Montserrat', sans-serif"},children:f(["pricing","title"])})}),n.jsx("div",{className:"mb-16 flex justify-center",children:n.jsxs("div",{className:"inline-flex rounded-lg border border-[#e6e0d4] bg-[#faf8f6] p-1 shadow-sm",children:[n.jsx("button",{onClick:()=>h("monthly"),"data-discount":"monthly",className:"rounded-md px-6 py-2.5 text-sm font-medium transition font-sans "+("monthly"===m?"bg-white text-[#2d2d2d] shadow-sm":"text-[#666666] hover:bg-white/50"),children:f(["pricing","discounts","monthly"])}),n.jsxs("button",{onClick:()=>h("3months"),"data-discount":"3months",className:"rounded-md px-6 py-2.5 text-sm font-medium transition font-sans "+("3months"===m?"bg-white text-[#2d2d2d] shadow-sm":"text-[#666666] hover:bg-white/50"),children:[f(["pricing","discounts","threeMonths"]),n.jsx("span",{className:"ml-2 text-xs text-[#d97757] font-semibold",children:f(["pricing","discounts","save10"])})]}),n.jsxs("button",{onClick:()=>h("6months"),"data-discount":"6months",className:"rounded-md px-6 py-2.5 text-sm font-medium transition font-sans "+("6months"===m?"bg-white text-[#2d2d2d] shadow-sm":"text-[#666666] hover:bg-white/50"),children:[f(["pricing","discounts","sixMonths"]),n.jsx("span",{className:"ml-2 text-xs text-[#d97757] font-semibold",children:f(["pricing","discounts","save30"])})]})]})}),n.jsxs("div",{className:"grid gap-8 md:grid-cols-3 max-w-7xl mx-auto",children:[n.jsx(pn,{title:f(["pricing","free","title"]),subtitle:f(["pricing","free","subtitle"]),price:f(["pricing","free","price"]),period:f(["pricing","free","period"]),features:b(["pricing","free","features"]),buttonText:f(["pricing","free","button"]),onButtonClick:y,isPopular:!0,className:"min-h-[600px]"}),n.jsx(pn,{title:f(["pricing","pro","title"]),subtitle:f(["pricing","pro","subtitle"]),price:"3months"===m?"$45":"6months"===m?"$35":"$49",period:f(["pricing","pro","period"]),features:b(["pricing","pro","features"]),buttonText:f(["pricing","pro","button"]),onButtonClick:async()=>{const{data:{session:t}}=await jr.auth.getSession();if(!t)return a({title:"Authentication Required",description:"Please sign in to upgrade to Pro.",variant:"destructive"}),void e("/auth");e("/pay?plan=premium")},isPopular:!0,badge:f(["pricing","pro","badge"]),originalPrice:"$78",limitedTimeOffer:!0,className:"min-h-[600px]"}),n.jsx(pn,{title:f(["pricing","ultra","title"]),subtitle:f(["pricing","ultra","subtitle"]),price:"3months"===m?"$179":"6months"===m?"$159":"$199",period:f(["pricing","ultra","period"]),features:b(["pricing","ultra","features"]),buttonText:f(["pricing","ultra","button"]),onButtonClick:async()=>{const{data:{session:t}}=await jr.auth.getSession();if(!t)return a({title:"Authentication Required",description:"Please sign in to upgrade to Ultra.",variant:"destructive"}),void e("/auth");e("/pay?plan=ultra")},isPopular:!0,isPremium:!0,isGold:!0,originalPrice:"$300",limitedTimeOffer:!0,className:"min-h-[600px]"})]})]})}),n.jsx("section",{className:"py-24 bg-[#f5f2e8]",id:"highlights-bottom",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center mb-24",children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("div",{className:"w-80 h-80 bg-gradient-to-br from-white to-[#f5f2e8] rounded-full flex items-center justify-center border border-[#e6e0d4] shadow-sm",children:n.jsx(pe,{className:"w-32 h-32 text-[#d97757] opacity-80"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-3xl sm:text-4xl font-serif font-medium text-[#2d2d2d] mb-6",children:f(["highlights","aiFeedback","title"])}),n.jsx("p",{className:"text-lg text-[#666666] font-sans leading-relaxed",children:f(["highlights","aiFeedback","description"])})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center mb-24 lg:auto-cols-max",children:[n.jsx("div",{className:"lg:order-2 flex items-center justify-center",children:n.jsx("div",{className:"w-80 h-80 bg-gradient-to-br from-white to-[#f5f2e8] rounded-full flex items-center justify-center border border-[#e6e0d4] shadow-sm",children:n.jsx(xe,{className:"w-32 h-32 text-[#d97757] opacity-80"})})}),n.jsxs("div",{className:"lg:order-1",children:[n.jsx("h3",{className:"text-3xl sm:text-4xl font-serif font-medium text-[#2d2d2d] mb-6",children:f(["highlights","adaptive","title"])}),n.jsx("p",{className:"text-lg text-[#666666] font-sans leading-relaxed",children:f(["highlights","adaptive","description"])})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center mb-24",children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("div",{className:"w-80 h-80 bg-gradient-to-br from-white to-[#f5f2e8] rounded-full flex items-center justify-center border border-[#e6e0d4] shadow-sm",children:n.jsx(ge,{className:"w-32 h-32 text-[#d97757] opacity-80"})})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-3xl sm:text-4xl font-serif font-medium text-[#2d2d2d] mb-6",children:f(["highlights","proven","title"])}),n.jsx("p",{className:"text-lg text-[#666666] font-sans leading-relaxed",children:f(["highlights","proven","description"])})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center lg:auto-cols-max",children:[n.jsx("div",{className:"lg:order-2 flex items-center justify-center",children:n.jsx("div",{className:"w-80 h-80 bg-gradient-to-br from-white to-[#f5f2e8] rounded-full flex items-center justify-center border border-[#e6e0d4] shadow-sm",children:n.jsx(he,{className:"w-32 h-32 text-[#d97757] opacity-80"})})}),n.jsxs("div",{className:"lg:order-1",children:[n.jsx("h3",{className:"text-3xl sm:text-4xl font-serif font-medium text-[#2d2d2d] mb-6",children:f(["highlights","community","title"])}),n.jsx("p",{className:"text-lg text-[#666666] font-sans leading-relaxed",children:f(["highlights","community","description"])})]})]})]})}),n.jsx("footer",{className:"border-t border-[#e6e0d4] bg-[#faf8f6] py-20",children:n.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[n.jsxs("div",{className:"grid gap-12 sm:grid-cols-2 lg:grid-cols-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center gap-2 mb-6",children:n.jsx("img",{src:"/1000031328.png",alt:"English AIdol Logo",className:"h-16 w-auto opacity-90 grayscale-[0.2]"})}),n.jsx("p",{className:"mt-3 text-sm text-[#666666] font-sans leading-relaxed",children:"Simple, Transparent Pricing. Invest in your future with the most advanced AI English tutor available."})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-serif font-semibold text-[#2d2d2d] tracking-wide uppercase mb-6",children:f(["footer","learning","title"])}),n.jsxs("ul",{className:"space-y-3 text-sm text-[#666666] font-sans",children:[n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/ielts-portal",children:"IELTS Preparation"})}),n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/toefl-portal",children:"TOEFL Preparation"})}),n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/pte-portal",children:"PTE Preparation"})}),n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/toeic",children:"TOEIC Preparation"})}),n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/business-portal",children:"Business English"})}),n.jsx("li",{children:n.jsx("a",{className:"hover:text-[#d97757] transition-colors",href:"/general-portal",children:"General English"})})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-serif font-semibold text-[#2d2d2d] tracking-wide uppercase mb-6",children:"Blog & Resources"}),n.jsx("p",{className:"text-sm text-[#666666] font-sans leading-relaxed mb-4",children:"Discover expert tips, real IELTS examiner insights, and AI-powered study strategies."}),n.jsxs(l,{to:"/blog",className:"inline-flex items-center gap-2 text-[#d97757] hover:text-[#c56a4b] font-medium font-sans text-sm",children:[n.jsx("span",{children:"Visit the Blog"}),n.jsx(je,{className:"h-3 w-3"})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-serif font-semibold text-[#2d2d2d] tracking-wide uppercase mb-6",children:"Company Info"}),n.jsxs("div",{className:"text-sm text-[#666666] font-sans leading-relaxed space-y-2",children:[n.jsx("p",{className:"font-semibold text-[#2d2d2d]",children:"ENGLISHAIDOL LLC"}),n.jsx("p",{children:"5830 E 2nd St, Ste 7000 #29281"}),n.jsx("p",{children:"Casper, Wyoming 82609"}),n.jsx("p",{children:"United States"})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx("a",{className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-[#e6e0d4] bg-white text-[#666666] transition hover:border-[#d97757] hover:text-[#d97757]",href:"#","aria-label":"Instagram",children:n.jsx(we,{className:"h-4 w-4"})}),n.jsx("a",{className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-[#e6e0d4] bg-white text-[#666666] transition hover:border-[#d97757] hover:text-[#d97757]",href:"#","aria-label":"Facebook",children:n.jsx(_e,{className:"h-4 w-4"})}),n.jsx("a",{className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-[#e6e0d4] bg-white text-[#666666] transition hover:border-[#d97757] hover:text-[#d97757]",href:"#","aria-label":"Twitter",children:n.jsx(Ne,{className:"h-4 w-4"})})]})]})]}),n.jsxs("div",{className:"mt-16 flex flex-col items-center justify-between gap-6 border-t border-[#e6e0d4] pt-8 text-xs sm:flex-row text-[#666666] font-sans",children:[n.jsx("p",{children:f(["footer","copyright"])}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx(l,{className:"hover:text-[#d97757] transition-colors",to:"/privacy-policy",children:f(["footer","privacy"])}),n.jsx(l,{className:"hover:text-[#d97757] transition-colors",to:"/refund-policy",children:"Refund Policy"}),n.jsx(l,{className:"hover:text-[#d97757] transition-colors",to:"/terms-of-service",children:f(["footer","terms"])}),n.jsx(l,{className:"hover:text-[#d97757] transition-colors",to:"/support",children:f(["footer","support"])})]})]}),n.jsxs("div",{className:"mt-6 pt-6 border-t border-[#e6e0d4]/50 text-[10px] text-[#666666]/60 space-y-2 font-sans max-w-4xl mx-auto text-center",children:[n.jsx("p",{children:"We securely store your practice data and audio recordings long-term so you can review your history, track progress, and receive better AI feedback over time."}),n.jsx("p",{children:"All feedback and scores are AI-generated for learning purposes only. This is not an official test, does not guarantee future exam results, and does not constitute legal, immigration, or professional advice."})]})]})}),n.jsx(Kr,{})]})},vn=({animationData:e,className:t="",loop:s=!0,autoplay:a=!0,speed:i=1,onComplete:o})=>{const l=r.useRef(null);return r.useEffect(()=>{l.current&&l.current.setSpeed(i)},[i]),n.jsx(Tt,{lottieRef:l,animationData:e,className:t,loop:s,autoplay:a,onComplete:o})},jn={v:"5.7.4",fr:60,ip:0,op:60,w:100,h:100,nm:"Loading",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Circle",sr:1,ks:{o:{a:0,k:100},r:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{t:60,s:[360]}]},p:{a:0,k:[50,50,0]},a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[40,40]},p:{a:0,k:[0,0]}},{ty:"st",c:{a:0,k:[.2,.6,1,1]},o:{a:0,k:100},w:{a:0,k:3}},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100}}]}],ip:0,op:60,st:0}]},wn=({animationData:e=jn,size:t="md",className:s=""})=>n.jsx("div",{className:`${{sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"}[t]} ${s}`,children:n.jsx(vn,{animationData:e,className:"w-full h-full",loop:!0,autoplay:!0})}),_n=Ie,Nn=Ae,kn=Pe,En=Se,Sn=r.forwardRef(({className:e,...t},s)=>n.jsx(ke,{ref:s,className:Cs("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Sn.displayName=ke.displayName;const Tn=r.forwardRef(({className:e,children:t,...s},a)=>n.jsxs(kn,{children:[n.jsx(Sn,{}),n.jsxs(Ee,{ref:a,className:Cs("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,n.jsxs(Se,{className:"absolute right-4 top-4 rounded-sm ring-offset-background transition-all hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground z-50 p-1 hover:bg-black/10 dark:hover:bg-white/10",children:[n.jsx(A,{className:"h-5 w-5 text-gray-600 dark:text-gray-300"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Tn.displayName=Ee.displayName;const Cn=({className:e,...t})=>n.jsx("div",{className:Cs("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Cn.displayName="DialogHeader";const In=({className:e,...t})=>n.jsx("div",{className:Cs("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});In.displayName="DialogFooter";const An=r.forwardRef(({className:e,...t},s)=>n.jsx(Te,{ref:s,className:Cs("text-lg font-semibold leading-none tracking-tight",e),...t}));An.displayName=Te.displayName;const Pn=r.forwardRef(({className:e,...t},s)=>n.jsx(Ce,{ref:s,className:Cs("text-sm text-muted-foreground",e),...t}));Pn.displayName=Ce.displayName;const Ln=M("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Mn=r.forwardRef(({className:e,...t},s)=>n.jsx(Le,{ref:s,className:Cs(Ln(),e),...t}));Mn.displayName=Le.displayName;var On=function(){return On=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},On.apply(this,arguments)};function Rn(e,t,s){for(var a,r=0,n=t.length;r<n;r++)!a&&r in t||(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function Dn(e){return"multiple"===e.mode}function Fn(e){return"range"===e.mode}function zn(e){return"single"===e.mode}"function"==typeof SuppressedError&&SuppressedError;var Bn={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};var $n=Object.freeze({__proto__:null,formatCaption:function(e,t){return xs(e,"LLLL y",t)},formatDay:function(e,t){return xs(e,"d",t)},formatMonthCaption:function(e,t){return xs(e,"LLLL",t)},formatWeekNumber:function(e){return"".concat(e)},formatWeekdayName:function(e,t){return xs(e,"cccccc",t)},formatYearCaption:function(e,t){return xs(e,"yyyy",t)}}),qn=Object.freeze({__proto__:null,labelDay:function(e,t,s){return xs(e,"do MMMM (EEEE)",s)},labelMonthDropdown:function(){return"Month: "},labelNext:function(){return"Go to next month"},labelPrevious:function(){return"Go to previous month"},labelWeekNumber:function(e){return"Week n. ".concat(e)},labelWeekday:function(e,t){return xs(e,"cccc",t)},labelYearDropdown:function(){return"Year: "}});var Vn=r.createContext(void 0);function Wn(e){var t,s,a=e.initialProps,r={captionLayout:"buttons",classNames:Bn,formatters:$n,labels:qn,locale:as,modifiersClassNames:{},modifiers:{},numberOfMonths:1,styles:{},today:new Date,mode:"default"},i=function(e){var t=e.fromYear,s=e.toYear,a=e.fromMonth,r=e.toMonth,n=e.fromDate,i=e.toDate;return a?n=Gt(a):t&&(n=new Date(t,0,1)),r?i=Yt(r):s&&(i=new Date(s,11,31)),{fromDate:n?Ht(n):void 0,toDate:i?Ht(i):void 0}}(a),o=i.fromDate,l=i.toDate,c=null!==(t=a.captionLayout)&&void 0!==t?t:r.captionLayout;"buttons"===c||o&&l||(c="buttons"),(zn(a)||Dn(a)||Fn(a))&&(s=a.onSelect);var d=On(On(On({},r),a),{captionLayout:c,classNames:On(On({},r.classNames),a.classNames),components:On({},a.components),formatters:On(On({},r.formatters),a.formatters),fromDate:o,labels:On(On({},r.labels),a.labels),mode:a.mode||r.mode,modifiers:On(On({},r.modifiers),a.modifiers),modifiersClassNames:On(On({},r.modifiersClassNames),a.modifiersClassNames),onSelect:s,styles:On(On({},r.styles),a.styles),toDate:l});return n.jsx(Vn.Provider,{value:d,children:e.children})}function Un(){var e=r.useContext(Vn);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Gn(e){var t=Un(),s=t.locale,a=t.classNames,r=t.styles,i=t.formatters.formatCaption;return n.jsx("div",{className:a.caption_label,style:r.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:s})})}function Yn(e){return n.jsx("svg",On({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Hn(e){var t,s,a=e.onChange,r=e.value,i=e.children,o=e.caption,l=e.className,c=e.style,d=Un(),u=null!==(s=null===(t=d.components)||void 0===t?void 0:t.IconDropdown)&&void 0!==s?s:Yn;return n.jsxs("div",{className:l,style:c,children:[n.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:r,onChange:a,children:i}),n.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[o,n.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function Jn(e){var t,s=Un(),a=s.fromDate,r=s.toDate,i=s.styles,o=s.locale,l=s.formatters.formatMonthCaption,c=s.classNames,d=s.components,u=s.labels.labelMonthDropdown;if(!a)return n.jsx(n.Fragment,{});if(!r)return n.jsx(n.Fragment,{});var m=[];if(rs(a,r))for(var h=Gt(a),g=a.getMonth();g<=r.getMonth();g++)m.push(ns(h,g));else for(h=Gt(new Date),g=0;g<=11;g++)m.push(ns(h,g));var p=null!==(t=null==d?void 0:d.Dropdown)&&void 0!==t?t:Hn;return n.jsx(p,{name:"months","aria-label":u(),className:c.dropdown_month,style:i.dropdown_month,onChange:function(t){var s=Number(t.target.value),a=ns(Gt(e.displayMonth),s);e.onChange(a)},value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:m.map(function(e){return n.jsx("option",{value:e.getMonth(),children:l(e,{locale:o})},e.getMonth())})})}function Xn(e){var t,s=e.displayMonth,a=Un(),r=a.fromDate,i=a.toDate,o=a.locale,l=a.styles,c=a.classNames,d=a.components,u=a.formatters.formatYearCaption,m=a.labels.labelYearDropdown,h=[];if(!r)return n.jsx(n.Fragment,{});if(!i)return n.jsx(n.Fragment,{});for(var g=r.getFullYear(),p=i.getFullYear(),x=g;x<=p;x++)h.push(is(os(new Date),x));var f=null!==(t=null==d?void 0:d.Dropdown)&&void 0!==t?t:Hn;return n.jsx(f,{name:"years","aria-label":m(),className:c.dropdown_year,style:l.dropdown_year,onChange:function(t){var a=is(Gt(s),Number(t.target.value));e.onChange(a)},value:s.getFullYear(),caption:u(s,{locale:o}),children:h.map(function(e){return n.jsx("option",{value:e.getFullYear(),children:u(e,{locale:o})},e.getFullYear())})})}function Qn(){var e=Un(),t=function(e){var t=e.month,s=e.defaultMonth,a=e.today,r=t||s||a||new Date,n=e.toDate,i=e.fromDate,o=e.numberOfMonths,l=void 0===o?1:o;return n&&Xt(n,r)<0&&(r=Jt(n,-1*(l-1))),i&&Xt(r,i)<0&&(r=i),Gt(r)}(e),s=function(e,t){var s=r.useState(e),a=s[0];return[void 0===t?a:t,s[1]]}(t,e.month),a=s[0],n=s[1];return[a,function(t){var s;if(!e.disableNavigation){var a=Gt(t);n(a),null===(s=e.onMonthChange)||void 0===s||s.call(e,a)}}]}var Kn=r.createContext(void 0);function Zn(e){var t=Un(),s=Qn(),a=s[0],r=s[1],i=function(e,t){for(var s=t.reverseMonths,a=t.numberOfMonths,r=Gt(e),n=Gt(Jt(r,a)),i=Xt(n,r),o=[],l=0;l<i;l++){var c=Jt(r,l);o.push(c)}return s&&(o=o.reverse()),o}(a,t),o=function(e,t){if(!t.disableNavigation){var s=t.toDate,a=t.pagedNavigation,r=t.numberOfMonths,n=void 0===r?1:r,i=a?n:1,o=Gt(e);if(!s)return Jt(o,i);if(!(Xt(s,e)<n))return Jt(o,i)}}(a,t),l=function(e,t){if(!t.disableNavigation){var s=t.fromDate,a=t.pagedNavigation,r=t.numberOfMonths,n=a?void 0===r?1:r:1,i=Gt(e);if(!s)return Jt(i,-n);if(!(Xt(i,s)<=0))return Jt(i,-n)}}(a,t),c=function(e){return i.some(function(t){return Qt(e,t)})},d={currentMonth:a,displayMonths:i,goToMonth:r,goToDate:function(e,s){c(e)||(s&&Kt(e,s)?r(Jt(e,1+-1*t.numberOfMonths)):r(e))},previousMonth:l,nextMonth:o,isDateDisplayed:c};return n.jsx(Kn.Provider,{value:d,children:e.children})}function ei(){var e=r.useContext(Kn);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function ti(e){var t,s=Un(),a=s.classNames,r=s.styles,i=s.components,o=ei().goToMonth,l=function(t){o(Jt(t,e.displayIndex?-e.displayIndex:0))},c=null!==(t=null==i?void 0:i.CaptionLabel)&&void 0!==t?t:Gn,d=n.jsx(c,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:a.caption_dropdowns,style:r.caption_dropdowns,children:[n.jsx("div",{className:a.vhidden,children:d}),n.jsx(Jn,{onChange:l,displayMonth:e.displayMonth}),n.jsx(Xn,{onChange:l,displayMonth:e.displayMonth})]})}function si(e){return n.jsx("svg",On({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function ai(e){return n.jsx("svg",On({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var ri=r.forwardRef(function(e,t){var s=Un(),a=s.classNames,r=s.styles,i=[a.button_reset,a.button];e.className&&i.push(e.className);var o=i.join(" "),l=On(On({},r.button_reset),r.button);return e.style&&Object.assign(l,e.style),n.jsx("button",On({},e,{ref:t,type:"button",className:o,style:l}))});function ni(e){var t,s,a=Un(),r=a.dir,i=a.locale,o=a.classNames,l=a.styles,c=a.labels,d=c.labelPrevious,u=c.labelNext,m=a.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var h=d(e.previousMonth,{locale:i}),g=[o.nav_button,o.nav_button_previous].join(" "),p=u(e.nextMonth,{locale:i}),x=[o.nav_button,o.nav_button_next].join(" "),f=null!==(t=null==m?void 0:m.IconRight)&&void 0!==t?t:ai,b=null!==(s=null==m?void 0:m.IconLeft)&&void 0!==s?s:si;return n.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&n.jsx(ri,{name:"previous-month","aria-label":h,className:g,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:"rtl"===r?n.jsx(f,{className:o.nav_icon,style:l.nav_icon}):n.jsx(b,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&n.jsx(ri,{name:"next-month","aria-label":p,className:x,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:"rtl"===r?n.jsx(b,{className:o.nav_icon,style:l.nav_icon}):n.jsx(f,{className:o.nav_icon,style:l.nav_icon})})]})}function ii(e){var t=Un().numberOfMonths,s=ei(),a=s.previousMonth,r=s.nextMonth,i=s.goToMonth,o=s.displayMonths,l=o.findIndex(function(t){return Qt(e.displayMonth,t)}),c=0===l,d=l===o.length-1,u=t>1&&(c||!d),m=t>1&&(d||!c);return n.jsx(ni,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:m,nextMonth:r,previousMonth:a,onPreviousClick:function(){a&&i(a)},onNextClick:function(){r&&i(r)}})}function oi(e){var t,s,a=Un(),r=a.classNames,i=a.disableNavigation,o=a.styles,l=a.captionLayout,c=a.components,d=null!==(t=null==c?void 0:c.CaptionLabel)&&void 0!==t?t:Gn;return s=i?n.jsx(d,{id:e.id,displayMonth:e.displayMonth}):"dropdown"===l?n.jsx(ti,{displayMonth:e.displayMonth,id:e.id}):"dropdown-buttons"===l?n.jsxs(n.Fragment,{children:[n.jsx(ti,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(ii,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):n.jsxs(n.Fragment,{children:[n.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(ii,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:r.caption,style:o.caption,children:s})}function li(e){var t=Un(),s=t.footer,a=t.styles,r=t.classNames.tfoot;return s?n.jsx("tfoot",{className:r,style:a.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:s})})}):n.jsx(n.Fragment,{})}function ci(){var e=Un(),t=e.classNames,s=e.styles,a=e.showWeekNumber,r=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=function(e,t,s){for(var a=s?ms(new Date):hs(new Date,{locale:e,weekStartsOn:t}),r=[],n=0;n<7;n++){var i=Wt(a,n);r.push(i)}return r}(r,i,o);return n.jsxs("tr",{style:s.head_row,className:t.head_row,children:[a&&n.jsx("td",{style:s.head_cell,className:t.head_cell}),d.map(function(e,a){return n.jsx("th",{scope:"col",className:t.head_cell,style:s.head_cell,"aria-label":c(e,{locale:r}),children:l(e,{locale:r})},a)})]})}function di(){var e,t=Un(),s=t.classNames,a=t.styles,r=t.components,i=null!==(e=null==r?void 0:r.HeadRow)&&void 0!==e?e:ci;return n.jsx("thead",{style:a.head,className:s.head,children:n.jsx(i,{})})}function ui(e){var t=Un(),s=t.locale,a=t.formatters.formatDay;return n.jsx(n.Fragment,{children:a(e.date,{locale:s})})}var mi=r.createContext(void 0);function hi(e){if(!Dn(e.initialProps)){return n.jsx(mi.Provider,{value:{selected:void 0,modifiers:{disabled:[]}},children:e.children})}return n.jsx(gi,{initialProps:e.initialProps,children:e.children})}function gi(e){var t=e.initialProps,s=e.children,a=t.selected,r=t.min,i=t.max,o={disabled:[]};a&&o.disabled.push(function(e){var t=i&&a.length>i-1,s=a.some(function(t){return qt(t,e)});return Boolean(t&&!s)});var l={selected:a,onDayClick:function(e,s,n){var o,l;if((null===(o=t.onDayClick)||void 0===o||o.call(t,e,s,n),!Boolean(s.selected&&r&&(null==a?void 0:a.length)===r))&&!Boolean(!s.selected&&i&&(null==a?void 0:a.length)===i)){var c=a?Rn([],a):[];if(s.selected){var d=c.findIndex(function(t){return qt(e,t)});c.splice(d,1)}else c.push(e);null===(l=t.onSelect)||void 0===l||l.call(t,c,e,s,n)}},modifiers:o};return n.jsx(mi.Provider,{value:l,children:s})}function pi(){var e=r.useContext(mi);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}var xi,fi,bi=r.createContext(void 0);function yi(e){if(!Fn(e.initialProps)){return n.jsx(bi.Provider,{value:{selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}},children:e.children})}return n.jsx(vi,{initialProps:e.initialProps,children:e.children})}function vi(e){var t=e.initialProps,s=e.children,a=t.selected,r=a||{},i=r.from,o=r.to,l=t.min,c=t.max,d={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(d.range_start=[i],o?(d.range_end=[o],qt(i,o)||(d.range_middle=[{after:i,before:o}])):d.range_end=[i]):o&&(d.range_start=[o],d.range_end=[o]),l&&(i&&!o&&d.disabled.push({after:Vt(i,l-1),before:Wt(i,l-1)}),i&&o&&d.disabled.push({after:i,before:Wt(i,l-1)}),!i&&o&&d.disabled.push({after:Vt(o,l-1),before:Wt(o,l-1)})),c){if(i&&!o&&(d.disabled.push({before:Wt(i,1-c)}),d.disabled.push({after:Wt(i,c-1)})),i&&o){var u=c-(Ut(o,i)+1);d.disabled.push({before:Vt(i,u)}),d.disabled.push({after:Wt(o,u)})}!i&&o&&(d.disabled.push({before:Wt(o,1-c)}),d.disabled.push({after:Wt(o,c-1)}))}return n.jsx(bi.Provider,{value:{selected:a,onDayClick:function(e,s,r){var n,i;null===(n=t.onDayClick)||void 0===n||n.call(t,e,s,r);var o=function(e,t){var s=t||{},a=s.from,r=s.to;if(a&&r){if(qt(r,e)&&qt(a,e))return;if(qt(r,e))return{from:r,to:void 0};if(qt(a,e))return;return Zt(a,e)?{from:e,to:r}:{from:a,to:e}}return r?Zt(e,r)?{from:r,to:e}:{from:e,to:r}:a?Kt(e,a)?{from:e,to:a}:{from:a,to:e}:{from:e,to:void 0}}(e,a);null===(i=t.onSelect)||void 0===i||i.call(t,o,e,s,r)},modifiers:d},children:s})}function ji(){var e=r.useContext(bi);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function wi(e){return Array.isArray(e)?Rn([],e):void 0!==e?[e]:[]}(fi=xi||(xi={})).Outside="outside",fi.Disabled="disabled",fi.Selected="selected",fi.Hidden="hidden",fi.Today="today",fi.RangeStart="range_start",fi.RangeEnd="range_end",fi.RangeMiddle="range_middle";var _i=xi.Selected,Ni=xi.Disabled,ki=xi.Hidden,Ei=xi.Today,Si=xi.RangeEnd,Ti=xi.RangeMiddle,Ci=xi.RangeStart,Ii=xi.Outside;var Ai=r.createContext(void 0);function Pi(e){var t=Un(),s=function(e,t,s){var a,r=((a={})[_i]=wi(e.selected),a[Ni]=wi(e.disabled),a[ki]=wi(e.hidden),a[Ei]=[e.today],a[Si]=[],a[Ti]=[],a[Ci]=[],a[Ii]=[],a);return e.fromDate&&r[Ni].push({before:e.fromDate}),e.toDate&&r[Ni].push({after:e.toDate}),Dn(e)?r[Ni]=r[Ni].concat(t.modifiers[Ni]):Fn(e)&&(r[Ni]=r[Ni].concat(s.modifiers[Ni]),r[Ci]=s.modifiers[Ci],r[Ti]=s.modifiers[Ti],r[Si]=s.modifiers[Si]),r}(t,pi(),ji()),a=function(e){var t={};return Object.entries(e).forEach(function(e){var s=e[0],a=e[1];t[s]=wi(a)}),t}(t.modifiers),r=On(On({},s),a);return n.jsx(Ai.Provider,{value:r,children:e.children})}function Li(){var e=r.useContext(Ai);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Mi(e,t){return t.some(function(t){if("boolean"==typeof t)return t;if(fs(t))return qt(e,t);var s,a,r,n,i;if(function(e){return Array.isArray(e)&&e.every(fs)}(t))return t.includes(e);if(function(e){return Boolean(e&&"object"==typeof e&&"from"in e)}(t))return s=e,n=(a=t).from,i=a.to,n&&i?(Ut(i,n)<0&&(n=(r=[i,n])[0],i=r[1]),Ut(s,n)>=0&&Ut(i,s)>=0):i?qt(i,s):!!n&&qt(n,s);if(function(e){return Boolean(e&&"object"==typeof e&&"dayOfWeek"in e)}(t))return t.dayOfWeek.includes(e.getDay());if(function(e){return Boolean(e&&"object"==typeof e&&"before"in e&&"after"in e)}(t)){var o=Ut(t.before,e)>0,l=Ut(t.after,e)<0;return Zt(t.before,t.after)?l&&o:o||l}return function(e){return Boolean(e&&"object"==typeof e&&"after"in e)}(t)?Ut(e,t.after)>0:function(e){return Boolean(e&&"object"==typeof e&&"before"in e)}(t)?Ut(t.before,e)>0:"function"==typeof t&&t(e)})}function Oi(e,t,s){var a=Object.keys(t).reduce(function(s,a){var r=t[a];return Mi(e,r)&&s.push(a),s},[]),r={};return a.forEach(function(e){return r[e]=!0}),s&&!Qt(e,s)&&(r.outside=!0),r}function Ri(e,t){var s=t.moveBy,a=t.direction,r=t.context,n=t.modifiers,i=t.retry,o=void 0===i?{count:0,lastFocused:e}:i,l=r.weekStartsOn,c=r.fromDate,d=r.toDate,u=r.locale,m={day:Wt,week:ss,month:Jt,year:bs,startOfWeek:function(e){return r.ISOWeek?ms(e):hs(e,{locale:u,weekStartsOn:l})},endOfWeek:function(e){return r.ISOWeek?ds(e):us(e,{locale:u,weekStartsOn:l})}}[s](e,"after"===a?1:-1);"before"===a&&c?m=ls([c,m]):"after"===a&&d&&(m=cs([d,m]));var h=!0;if(n){var g=Oi(m,n);h=!g.disabled&&!g.hidden}return h?m:o.count>365?o.lastFocused:Ri(m,{moveBy:s,direction:a,context:r,modifiers:n,retry:On(On({},o),{count:o.count+1})})}var Di=r.createContext(void 0);function Fi(e){var t=ei(),s=Li(),a=r.useState(),i=a[0],o=a[1],l=r.useState(),c=l[0],d=l[1],u=function(e,t){for(var s,a,r=Gt(e[0]),n=Yt(e[e.length-1]),i=r;i<=n;){var o=Oi(i,t);if(o.disabled||o.hidden)i=Wt(i,1);else{if(o.selected)return i;o.today&&!a&&(a=i),s||(s=i),i=Wt(i,1)}}return a||s}(t.displayMonths,s),m=(null!=i?i:c&&t.isDateDisplayed(c))?c:u,h=function(e){o(e)},g=Un(),p=function(e,a){if(i){var r=Ri(i,{moveBy:e,direction:a,context:g,modifiers:s});qt(i,r)||(t.goToDate(r,i),h(r))}},x={focusedDay:i,focusTarget:m,blur:function(){d(i),o(void 0)},focus:h,focusDayAfter:function(){return p("day","after")},focusDayBefore:function(){return p("day","before")},focusWeekAfter:function(){return p("week","after")},focusWeekBefore:function(){return p("week","before")},focusMonthBefore:function(){return p("month","before")},focusMonthAfter:function(){return p("month","after")},focusYearBefore:function(){return p("year","before")},focusYearAfter:function(){return p("year","after")},focusStartOfWeek:function(){return p("startOfWeek","before")},focusEndOfWeek:function(){return p("endOfWeek","after")}};return n.jsx(Di.Provider,{value:x,children:e.children})}function zi(){var e=r.useContext(Di);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}var Bi=r.createContext(void 0);function $i(e){if(!zn(e.initialProps)){return n.jsx(Bi.Provider,{value:{selected:void 0},children:e.children})}return n.jsx(qi,{initialProps:e.initialProps,children:e.children})}function qi(e){var t=e.initialProps,s=e.children,a={selected:t.selected,onDayClick:function(e,s,a){var r,n,i;null===(r=t.onDayClick)||void 0===r||r.call(t,e,s,a),!s.selected||t.required?null===(i=t.onSelect)||void 0===i||i.call(t,e,e,s,a):null===(n=t.onSelect)||void 0===n||n.call(t,void 0,e,s,a)}};return n.jsx(Bi.Provider,{value:a,children:s})}function Vi(){var e=r.useContext(Bi);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Wi(e,t){var s=[e.classNames.day];return Object.keys(t).forEach(function(t){var a=e.modifiersClassNames[t];if(a)s.push(a);else if(function(e){return Object.values(xi).includes(e)}(t)){var r=e.classNames["day_".concat(t)];r&&s.push(r)}}),s}function Ui(e,t,s){var a,i,o,l=Un(),c=zi(),d=function(e,t){return Oi(e,Li(),t)}(e,t),u=function(e,t){var s=Un(),a=Vi(),r=pi(),n=ji(),i=zi(),o=i.focusDayAfter,l=i.focusDayBefore,c=i.focusWeekAfter,d=i.focusWeekBefore,u=i.blur,m=i.focus,h=i.focusMonthBefore,g=i.focusMonthAfter,p=i.focusYearBefore,x=i.focusYearAfter,f=i.focusStartOfWeek,b=i.focusEndOfWeek;return{onClick:function(i){var o,l,c,d;zn(s)?null===(o=a.onDayClick)||void 0===o||o.call(a,e,t,i):Dn(s)?null===(l=r.onDayClick)||void 0===l||l.call(r,e,t,i):Fn(s)?null===(c=n.onDayClick)||void 0===c||c.call(n,e,t,i):null===(d=s.onDayClick)||void 0===d||d.call(s,e,t,i)},onFocus:function(a){var r;m(e),null===(r=s.onDayFocus)||void 0===r||r.call(s,e,t,a)},onBlur:function(a){var r;u(),null===(r=s.onDayBlur)||void 0===r||r.call(s,e,t,a)},onKeyDown:function(a){var r;switch(a.key){case"ArrowLeft":a.preventDefault(),a.stopPropagation(),"rtl"===s.dir?o():l();break;case"ArrowRight":a.preventDefault(),a.stopPropagation(),"rtl"===s.dir?l():o();break;case"ArrowDown":a.preventDefault(),a.stopPropagation(),c();break;case"ArrowUp":a.preventDefault(),a.stopPropagation(),d();break;case"PageUp":a.preventDefault(),a.stopPropagation(),a.shiftKey?p():h();break;case"PageDown":a.preventDefault(),a.stopPropagation(),a.shiftKey?x():g();break;case"Home":a.preventDefault(),a.stopPropagation(),f();break;case"End":a.preventDefault(),a.stopPropagation(),b()}null===(r=s.onDayKeyDown)||void 0===r||r.call(s,e,t,a)},onKeyUp:function(a){var r;null===(r=s.onDayKeyUp)||void 0===r||r.call(s,e,t,a)},onMouseEnter:function(a){var r;null===(r=s.onDayMouseEnter)||void 0===r||r.call(s,e,t,a)},onMouseLeave:function(a){var r;null===(r=s.onDayMouseLeave)||void 0===r||r.call(s,e,t,a)},onPointerEnter:function(a){var r;null===(r=s.onDayPointerEnter)||void 0===r||r.call(s,e,t,a)},onPointerLeave:function(a){var r;null===(r=s.onDayPointerLeave)||void 0===r||r.call(s,e,t,a)},onTouchCancel:function(a){var r;null===(r=s.onDayTouchCancel)||void 0===r||r.call(s,e,t,a)},onTouchEnd:function(a){var r;null===(r=s.onDayTouchEnd)||void 0===r||r.call(s,e,t,a)},onTouchMove:function(a){var r;null===(r=s.onDayTouchMove)||void 0===r||r.call(s,e,t,a)},onTouchStart:function(a){var r;null===(r=s.onDayTouchStart)||void 0===r||r.call(s,e,t,a)}}}(e,d),m=function(){var e=Un(),t=Vi(),s=pi(),a=ji();return zn(e)?t.selected:Dn(e)?s.selected:Fn(e)?a.selected:void 0}(),h=Boolean(l.onDayClick||"default"!==l.mode);r.useEffect(function(){var t;d.outside||c.focusedDay&&h&&qt(c.focusedDay,e)&&(null===(t=s.current)||void 0===t||t.focus())},[c.focusedDay,e,s,h,d.outside]);var g=Wi(l,d).join(" "),p=function(e,t){var s=On({},e.styles.day);return Object.keys(t).forEach(function(t){var a;s=On(On({},s),null===(a=e.modifiersStyles)||void 0===a?void 0:a[t])}),s}(l,d),x=Boolean(d.outside&&!l.showOutsideDays||d.hidden),f=null!==(o=null===(i=l.components)||void 0===i?void 0:i.DayContent)&&void 0!==o?o:ui,b={style:p,className:g,children:n.jsx(f,{date:e,displayMonth:t,activeModifiers:d}),role:"gridcell"},y=c.focusTarget&&qt(c.focusTarget,e)&&!d.outside,v=c.focusedDay&&qt(c.focusedDay,e),j=On(On(On({},b),((a={disabled:d.disabled,role:"gridcell"})["aria-selected"]=d.selected,a.tabIndex=v||y?0:-1,a)),u);return{isButton:h,isHidden:x,activeModifiers:d,selectedDays:m,buttonProps:j,divProps:b}}function Gi(e){var t=r.useRef(null),s=Ui(e.date,e.displayMonth,t);return s.isHidden?n.jsx("div",{role:"gridcell"}):s.isButton?n.jsx(ri,On({name:"day",ref:t},s.buttonProps)):n.jsx("div",On({},s.divProps))}function Yi(e){var t=e.number,s=e.dates,a=Un(),r=a.onWeekNumberClick,i=a.styles,o=a.classNames,l=a.locale,c=a.labels.labelWeekNumber,d=(0,a.formatters.formatWeekNumber)(Number(t),{locale:l});if(!r)return n.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:d});var u=c(Number(t),{locale:l});return n.jsx(ri,{name:"week-number","aria-label":u,className:o.weeknumber,style:i.weeknumber,onClick:function(e){r(t,s,e)},children:d})}function Hi(e){var t,s,a,r=Un(),i=r.styles,o=r.classNames,l=r.showWeekNumber,c=r.components,d=null!==(t=null==c?void 0:c.Day)&&void 0!==t?t:Gi,u=null!==(s=null==c?void 0:c.WeekNumber)&&void 0!==s?s:Yi;return l&&(a=n.jsx("td",{className:o.cell,style:i.cell,children:n.jsx(u,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:o.row,style:i.row,children:[a,e.dates.map(function(t){return n.jsx("td",{className:o.cell,style:i.cell,role:"presentation",children:n.jsx(d,{displayMonth:e.displayMonth,date:t})},es(t))})]})}function Ji(e,t,s){for(var a=(null==s?void 0:s.ISOWeek)?ds(t):us(t,s),r=(null==s?void 0:s.ISOWeek)?ms(e):hs(e,s),n=Ut(a,r),i=[],o=0;o<=n;o++)i.push(Wt(r,o));return i.reduce(function(e,t){var a=(null==s?void 0:s.ISOWeek)?gs(t):ps(t,s),r=e.find(function(e){return e.weekNumber===a});return r?(r.dates.push(t),e):(e.push({weekNumber:a,dates:[t]}),e)},[])}function Xi(e){var t,s,a,r=Un(),i=r.locale,o=r.classNames,l=r.styles,c=r.hideHead,d=r.fixedWeeks,u=r.components,m=r.weekStartsOn,h=r.firstWeekContainsDate,g=r.ISOWeek,p=function(e,t){var s=Ji(Gt(e),Yt(e),t);if(null==t?void 0:t.useFixedWeeks){var a=ts(e,t);if(a<6){var r=s[s.length-1],n=r.dates[r.dates.length-1],i=ss(n,6-a),o=Ji(ss(n,1),i,t);s.push.apply(s,o)}}return s}(e.displayMonth,{useFixedWeeks:Boolean(d),ISOWeek:g,locale:i,weekStartsOn:m,firstWeekContainsDate:h}),x=null!==(t=null==u?void 0:u.Head)&&void 0!==t?t:di,f=null!==(s=null==u?void 0:u.Row)&&void 0!==s?s:Hi,b=null!==(a=null==u?void 0:u.Footer)&&void 0!==a?a:li;return n.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&n.jsx(x,{}),n.jsx("tbody",{className:o.tbody,style:l.tbody,children:p.map(function(t){return n.jsx(f,{displayMonth:e.displayMonth,dates:t.dates,weekNumber:t.weekNumber},t.weekNumber)})}),n.jsx(b,{displayMonth:e.displayMonth})]})}var Qi="undefined"!=typeof window&&window.document&&window.document.createElement?r.useLayoutEffect:r.useEffect,Ki=!1,Zi=0;function eo(){return"react-day-picker-".concat(++Zi)}function to(e){var t,s,a=Un(),i=a.dir,o=a.classNames,l=a.styles,c=a.components,d=ei().displayMonths,u=function(e){var t,s=null!=e?e:Ki?eo():null,a=r.useState(s),n=a[0],i=a[1];return Qi(function(){null===n&&i(eo())},[]),r.useEffect(function(){!1===Ki&&(Ki=!0)},[]),null!==(t=null!=e?e:n)&&void 0!==t?t:void 0}(a.id?"".concat(a.id,"-").concat(e.displayIndex):void 0),m=a.id?"".concat(a.id,"-grid-").concat(e.displayIndex):void 0,h=[o.month],g=l.month,p=0===e.displayIndex,x=e.displayIndex===d.length-1,f=!p&&!x;"rtl"===i&&(x=(t=[p,x])[0],p=t[1]),p&&(h.push(o.caption_start),g=On(On({},g),l.caption_start)),x&&(h.push(o.caption_end),g=On(On({},g),l.caption_end)),f&&(h.push(o.caption_between),g=On(On({},g),l.caption_between));var b=null!==(s=null==c?void 0:c.Caption)&&void 0!==s?s:oi;return n.jsxs("div",{className:h.join(" "),style:g,children:[n.jsx(b,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(Xi,{id:m,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function so(e){var t=Un(),s=t.classNames,a=t.styles;return n.jsx("div",{className:s.months,style:a.months,children:e.children})}function ao(e){var t,s,a=e.initialProps,i=Un(),o=zi(),l=ei(),c=r.useState(!1),d=c[0],u=c[1];r.useEffect(function(){i.initialFocus&&o.focusTarget&&(d||(o.focus(o.focusTarget),u(!0)))},[i.initialFocus,d,o.focus,o.focusTarget,o]);var m=[i.classNames.root,i.className];i.numberOfMonths>1&&m.push(i.classNames.multiple_months),i.showWeekNumber&&m.push(i.classNames.with_weeknumber);var h=On(On({},i.styles.root),i.style),g=Object.keys(a).filter(function(e){return e.startsWith("data-")}).reduce(function(e,t){var s;return On(On({},e),((s={})[t]=a[t],s))},{}),p=null!==(s=null===(t=a.components)||void 0===t?void 0:t.Months)&&void 0!==s?s:so;return n.jsx("div",On({className:m.join(" "),style:h,dir:i.dir,id:i.id,nonce:a.nonce,title:a.title,lang:a.lang},g,{children:n.jsx(p,{children:l.displayMonths.map(function(e,t){return n.jsx(to,{displayIndex:t,displayMonth:e},t)})})}))}function ro(e){var t=e.children,s=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s}(e,["children"]);return n.jsx(Wn,{initialProps:s,children:n.jsx(Zn,{children:n.jsx($i,{initialProps:s,children:n.jsx(hi,{initialProps:s,children:n.jsx(yi,{initialProps:s,children:n.jsx(Pi,{children:n.jsx(Fi,{children:t})})})})})})})}function no(e){return n.jsx(ro,On({},e,{children:n.jsx(ao,{initialProps:e})}))}function io({className:e,classNames:t,showOutsideDays:s=!0,...a}){const r=en();return n.jsx(no,{showOutsideDays:s,className:Cs("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Cs($r({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Cs($r({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"text-white hover:text-white focus:text-white",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},modifiersStyles:{selected:{backgroundColor:r.buttonPrimary,color:"#FFFFFF"},day:{color:r.textPrimary}},components:{IconLeft:({...e})=>n.jsx(Me,{className:"h-4 w-4",style:{color:r.textPrimary}}),IconRight:({...e})=>n.jsx(Oe,{className:"h-4 w-4",style:{color:r.textPrimary}})},...a})}io.displayName="Calendar";const oo=Fe,lo=ze,co=r.forwardRef(({className:e,align:t="center",sideOffset:s=4,...a},r)=>n.jsx(Re,{children:n.jsx(De,{ref:r,align:t,sideOffset:s,className:Cs("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));co.displayName=De.displayName;const uo=[{name:"Bear",src:"/bear.png"},{name:"Rabbit",src:"/rabbit.png"},{name:"Duck",src:"/duck.png"},{name:"Panda",src:"/panda.png"},{name:"Polar Bear",src:"/polar bear.png"},{name:"Hamster",src:"/Hamster.png"},{name:"Cat",src:"/cat.png"},{name:"Piglet",src:"/piglet.png"},{name:"Monkey",src:"/Monkey.png"},{name:"Seal",src:"/seal.png"},{name:"Fox",src:"/fox.png"},{name:"Puppy",src:"/puppy.png"},{name:"Otter",src:"/otter.png"},{name:"Koala",src:"/koala.png"},{name:"Chick",src:"/chick.png"},{name:"Hedgehog",src:"/hedgehog.png"}],mo=({children:e,onPhotoUpdate:t,onPhotoSelect:s})=>{const{user:a,refreshProfile:i,updateProfileAvatar:o}=Pr();Ts();const[l,c]=r.useState(!1),[d,u]=r.useState(!1);return n.jsxs(_n,{open:l,onOpenChange:c,children:[n.jsx(Nn,{asChild:!0,children:e}),n.jsxs(Tn,{className:"sm:max-w-xl bg-white/95 backdrop-blur-xl border-white/20",children:[n.jsxs(Cn,{children:[n.jsx(An,{children:"Choose Profile Photo"}),n.jsx(Pn,{children:"Select one of our friendly avatars."})]}),n.jsx("div",{className:"space-y-6",children:n.jsx("div",{children:n.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-4 max-h-[60vh] overflow-y-auto p-1",children:uo.map(e=>n.jsx("button",{onClick:()=>(async e=>{if(s)return s(e),void c(!1);if(a)try{o(e),null==t||t(),c(!1)}catch(r){console.error("Error updating avatar:",r)}})(e.src),disabled:d,className:"aspect-square rounded-full overflow-hidden bg-slate-100 hover:bg-slate-200 transition-all border-4 border-transparent hover:border-primary/20 hover:scale-105 active:scale-95 relative group shadow-sm",title:e.name,children:n.jsx("img",{src:e.src,alt:e.name,className:"w-full h-full object-cover"})},e.name))})})})]})]})},ho=()=>{const{user:e}=Pr(),t=en(),s=Er(),[a,i]=r.useState(!1),o=r.useRef(null),[l,c]=r.useState((()=>{try{const e=localStorage.getItem("preferred_feedback_language");if(e&&s.find(t=>t.code===e))return e}catch(e){}return"en"})()),[d,u]=r.useState(!0);r.useEffect(()=>{const t=()=>{if(e){(async()=>{try{const{data:t}=await jr.from("user_preferences").select("preferred_feedback_language, native_language").eq("user_id",e.id).maybeSingle(),a=t,r=(null==a?void 0:a.preferred_feedback_language)||(null==a?void 0:a.native_language);if(r){const e=s.find(e=>e.code===r);e&&c(e.code)}}catch(t){console.warn("Error reloading language:",t)}})()}};return window.addEventListener("storage",t),window.addEventListener("language-updated",t),()=>{window.removeEventListener("storage",t),window.removeEventListener("language-updated",t)}},[e,s]),r.useEffect(()=>{if(!e)return void u(!1);(async()=>{var t,a,r,n;try{u(!0),console.log(" Loading preferred feedback language for user:",e.id);const{data:i,error:o}=await jr.from("user_preferences").select("preferred_feedback_language, native_language").eq("user_id",e.id).maybeSingle();if(o){if("PGRST204"===o.code||"42703"===o.code||(null==(t=o.message)?void 0:t.includes("preferred_feedback_language"))||(null==(a=o.message)?void 0:a.includes("column"))||(null==(r=o.message)?void 0:r.includes("schema cache"))||(null==(n=o.message)?void 0:n.includes("does not exist"))){console.log(" preferred_feedback_language column not found, trying native_language...");const{data:t,error:a}=await jr.from("user_preferences").select("native_language").eq("user_id",e.id).maybeSingle();if(!a&&t){const e=null==t?void 0:t.native_language;if(e){const t=s.find(t=>t.code===e);if(t)return c(t.code),localStorage.setItem("preferred_feedback_language",t.code),u(!1),void console.log(" Loaded from native_language (fallback):",t.code,t.nativeName)}}return c("en"),localStorage.setItem("preferred_feedback_language","en"),void u(!1)}return console.warn(" Error loading preferences:",o),c("en"),localStorage.setItem("preferred_feedback_language","en"),void u(!1)}const l=i,d=(null==l?void 0:l.preferred_feedback_language)||(null==l?void 0:l.native_language);if(console.log(" Loaded preferences:",{preferred_feedback_language:null==l?void 0:l.preferred_feedback_language,native_language:null==l?void 0:l.native_language,selected:d}),d){const e=s.find(e=>e.code===d);e?(c(e.code),localStorage.setItem("preferred_feedback_language",e.code),u(!1),console.log(" Loaded preferred feedback language:",e.code,e.nativeName)):(console.warn(" Language code not found in languages array:",d,"defaulting to English"),c("en"),localStorage.setItem("preferred_feedback_language","en"),u(!1))}else console.log(" No feedback language preference found, using default: English"),c("en"),localStorage.setItem("preferred_feedback_language","en"),u(!1)}catch(i){console.warn(" Error loading test translation language:",i),c("en"),localStorage.setItem("preferred_feedback_language","en"),u(!1)}})()},[e]),r.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const m=s.find(e=>e.code===l)||s.find(e=>"en"===e.code)||s[0];return n.jsxs("div",{className:"relative",ref:o,children:[n.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-2 px-3 py-2 rounded-lg border transition-all text-sm font-medium focus:outline-none focus:ring-2",style:{backgroundColor:"glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)",borderColor:t.border,color:t.textPrimary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=t.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)"},"aria-label":"Select test translation language","aria-expanded":a,"aria-haspopup":"listbox",children:[n.jsx("span",{className:"text-lg",children:m.flag}),n.jsx("span",{className:"flex-1 text-center",children:m.nativeName}),n.jsx(V,{className:"w-3 h-3 transition-transform "+(a?"rotate-180":"")})]}),a&&n.jsx("div",{className:"absolute left-0 mt-2 w-56 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",style:{backgroundColor:t.cardBackground,borderColor:t.border,borderWidth:"1px",borderStyle:"solid"},role:"listbox","aria-label":"Test translation language options",children:n.jsx("div",{className:"py-2",children:s.map(a=>n.jsxs("button",{onClick:()=>(async t=>{var a,r,n,o,l,d;if(c(t),i(!1),e)try{const{data:i}=await jr.from("user_preferences").select("user_id").eq("user_id",e.id).maybeSingle();let u;if(i){const{error:i}=await jr.from("user_preferences").update({preferred_feedback_language:t}).eq("user_id",e.id);if(u=i,u&&("PGRST204"===u.code||"42703"===u.code||(null==(a=u.message)?void 0:a.includes("preferred_feedback_language"))||(null==(r=u.message)?void 0:r.includes("column"))||(null==(n=u.message)?void 0:n.includes("does not exist")))){console.log(" preferred_feedback_language column not found, using native_language as fallback...");const{error:a}=await jr.from("user_preferences").update({native_language:t}).eq("user_id",e.id);if(!a){console.log(" Saved to native_language (fallback - migration not applied yet):",t),u=null;const e=s.find(e=>e.code===t);return console.log(" Language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("preferred_feedback_language",t),window.dispatchEvent(new CustomEvent("language-updated")),void localStorage.setItem("feedback-language-updated",Date.now().toString())}}}else{const{error:a}=await jr.from("user_preferences").insert({user_id:e.id,preferred_feedback_language:t});if(u=a,u&&("PGRST204"===u.code||"42703"===u.code||(null==(o=u.message)?void 0:o.includes("preferred_feedback_language"))||(null==(l=u.message)?void 0:l.includes("column"))||(null==(d=u.message)?void 0:d.includes("does not exist")))){console.log(" preferred_feedback_language column not found, using native_language as fallback...");const{error:a}=await jr.from("user_preferences").insert({user_id:e.id,native_language:t});if(!a){console.log(" Saved to native_language (fallback - migration not applied yet):",t),u=null;const e=s.find(e=>e.code===t);return console.log(" Language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("preferred_feedback_language",t),window.dispatchEvent(new CustomEvent("language-updated")),void localStorage.setItem("feedback-language-updated",Date.now().toString())}}}if(u){console.error(" Error saving preferred feedback language:",u);const{data:t}=await jr.from("user_preferences").select("preferred_feedback_language, native_language").eq("user_id",e.id).maybeSingle(),a=t,r=(null==a?void 0:a.preferred_feedback_language)||(null==a?void 0:a.native_language);if(r){const e=s.find(e=>e.code===r);e&&(c(e.code),console.log(" Reverted to saved language:",e.code))}}else{const e=s.find(e=>e.code===t);console.log(" Preferred feedback language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("preferred_feedback_language",t),window.dispatchEvent(new CustomEvent("language-updated")),localStorage.setItem("feedback-language-updated",Date.now().toString())}}catch(u){console.error(" Error saving preferred feedback language:",u)}})(a.code),className:"w-full flex items-center justify-between px-4 py-2 text-left transition-colors",style:{backgroundColor:l===a.code?t.hoverBg:"transparent"},onMouseEnter:e=>{l!==a.code&&(e.currentTarget.style.backgroundColor=t.hoverBg)},onMouseLeave:e=>{l!==a.code&&(e.currentTarget.style.backgroundColor="transparent")},role:"option","aria-selected":l===a.code,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:a.flag}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm font-medium",style:{color:t.textPrimary},children:a.nativeName}),n.jsx("span",{className:"text-xs",style:{color:t.textSecondary},children:a.name})]})]}),l===a.code&&n.jsx(Z,{className:"w-4 h-4",style:{color:t.buttonPrimary}})]},a.code))})})]})},go=()=>{const{user:e}=Pr(),t=en(),s=Er(),[a,i]=r.useState(!1),o=r.useRef(null),[l,c]=r.useState((()=>{try{const e=localStorage.getItem("word_translation_language");if(e&&s.find(t=>t.code===e))return e}catch(e){}return"en"})()),[d,u]=r.useState(!0);r.useEffect(()=>{const t=()=>{if(e){(async()=>{try{const{data:t}=await jr.from("user_preferences").select("word_translation_language, native_language").eq("user_id",e.id).maybeSingle(),a=t,r=(null==a?void 0:a.word_translation_language)||(null==a?void 0:a.native_language);if(r){const e=s.find(e=>e.code===r);e&&c(e.code)}}catch(t){console.warn("Error reloading word translation language:",t)}})()}};return window.addEventListener("storage",t),window.addEventListener("word-translation-language-updated",t),()=>{window.removeEventListener("storage",t),window.removeEventListener("word-translation-language-updated",t)}},[e,s]),r.useEffect(()=>{if(!e)return void u(!1);(async()=>{var t,a,r,n;try{u(!0),console.log(" Loading word translation language for user:",e.id);const{data:i,error:o}=await jr.from("user_preferences").select("word_translation_language, native_language").eq("user_id",e.id).maybeSingle();if(o){if("PGRST204"===o.code||"42703"===o.code||(null==(t=o.message)?void 0:t.includes("word_translation_language"))||(null==(a=o.message)?void 0:a.includes("column"))||(null==(r=o.message)?void 0:r.includes("schema cache"))||(null==(n=o.message)?void 0:n.includes("does not exist"))){console.log(" word_translation_language column not found, trying native_language...");const{data:t,error:a}=await jr.from("user_preferences").select("native_language").eq("user_id",e.id).maybeSingle();if(!a&&t){const e=null==t?void 0:t.native_language;if(e){const t=s.find(t=>t.code===e);if(t)return c(t.code),localStorage.setItem("word_translation_language",t.code),u(!1),void console.log(" Loaded from native_language (fallback):",t.code,t.nativeName)}}return c("en"),localStorage.setItem("word_translation_language","en"),void u(!1)}return console.warn(" Error loading preferences:",o),c("en"),localStorage.setItem("word_translation_language","en"),void u(!1)}const l=i,d=(null==l?void 0:l.word_translation_language)||(null==l?void 0:l.native_language);if(console.log(" Loaded preferences:",{word_translation_language:null==l?void 0:l.word_translation_language,native_language:null==l?void 0:l.native_language,selected:d}),d){const e=s.find(e=>e.code===d);e?(c(e.code),localStorage.setItem("word_translation_language",e.code),u(!1),console.log(" Loaded word translation language:",e.code,e.nativeName)):(console.warn(" Language code not found in languages array:",d,"defaulting to English"),c("en"),localStorage.setItem("word_translation_language","en"),u(!1))}else console.log(" No word translation language preference found, using default: English"),c("en"),localStorage.setItem("word_translation_language","en"),u(!1)}catch(i){console.warn(" Error loading word translation language:",i),c("en"),localStorage.setItem("word_translation_language","en"),u(!1)}})()},[e]),r.useEffect(()=>{const e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const m=s.find(e=>e.code===l)||s.find(e=>"en"===e.code)||s[0];return n.jsxs("div",{className:"relative",ref:o,children:[n.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-2 px-3 py-2 rounded-lg border transition-all text-sm font-medium focus:outline-none focus:ring-2",style:{backgroundColor:"glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)",borderColor:t.border,color:t.textPrimary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=t.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="glassmorphism"===t.theme.name||"dark"===t.theme.name?"rgba(255,255,255,0.1)":"minimalist"===t.theme.name?"#ffffff":"rgba(255,255,255,0.5)"},"aria-label":"Select word translation language","aria-expanded":a,"aria-haspopup":"listbox",children:[n.jsx("span",{className:"text-lg",children:m.flag}),n.jsx("span",{className:"flex-1 text-center",children:m.nativeName}),n.jsx(V,{className:"w-3 h-3 transition-transform "+(a?"rotate-180":"")})]}),a&&n.jsx("div",{className:"absolute left-0 mt-2 w-56 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",style:{backgroundColor:t.cardBackground,borderColor:t.border,borderWidth:"1px",borderStyle:"solid"},role:"listbox","aria-label":"Word translation language options",children:n.jsx("div",{className:"py-2",children:s.map(a=>n.jsxs("button",{onClick:()=>(async t=>{var a,r,n,o,l,d;if(c(t),i(!1),e)try{const{data:i}=await jr.from("user_preferences").select("user_id").eq("user_id",e.id).maybeSingle();let u;if(i){const{error:i}=await jr.from("user_preferences").update({word_translation_language:t}).eq("user_id",e.id);if(u=i,u&&("PGRST204"===u.code||"42703"===u.code||(null==(a=u.message)?void 0:a.includes("word_translation_language"))||(null==(r=u.message)?void 0:r.includes("column"))||(null==(n=u.message)?void 0:n.includes("does not exist")))){console.log(" word_translation_language column not found, using native_language as fallback...");const{error:a}=await jr.from("user_preferences").update({native_language:t}).eq("user_id",e.id);if(!a){console.log(" Saved to native_language (fallback - migration not applied yet):",t),u=null;const e=s.find(e=>e.code===t);return console.log(" Language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("word_translation_language",t),window.dispatchEvent(new CustomEvent("word-translation-language-updated")),void localStorage.setItem("word-translation-language-updated",Date.now().toString())}}}else{const{error:a}=await jr.from("user_preferences").insert({user_id:e.id,word_translation_language:t});if(u=a,u&&("PGRST204"===u.code||"42703"===u.code||(null==(o=u.message)?void 0:o.includes("word_translation_language"))||(null==(l=u.message)?void 0:l.includes("column"))||(null==(d=u.message)?void 0:d.includes("does not exist")))){console.log(" word_translation_language column not found, using native_language as fallback...");const{error:a}=await jr.from("user_preferences").insert({user_id:e.id,native_language:t});if(!a){console.log(" Saved to native_language (fallback - migration not applied yet):",t),u=null;const e=s.find(e=>e.code===t);return console.log(" Language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("word_translation_language",t),window.dispatchEvent(new CustomEvent("word-translation-language-updated")),void localStorage.setItem("word-translation-language-updated",Date.now().toString())}}}if(u){console.error(" Error saving word translation language:",u);const{data:t}=await jr.from("user_preferences").select("word_translation_language, native_language").eq("user_id",e.id).maybeSingle(),a=t,r=(null==a?void 0:a.word_translation_language)||(null==a?void 0:a.native_language);if(r){const e=s.find(e=>e.code===r);e&&(c(e.code),console.log(" Reverted to saved language:",e.code))}}else{const e=s.find(e=>e.code===t);console.log(" Word translation language saved successfully:",t,(null==e?void 0:e.nativeName)||(null==e?void 0:e.name)),localStorage.setItem("word_translation_language",t),window.dispatchEvent(new CustomEvent("word-translation-language-updated")),localStorage.setItem("word-translation-language-updated",Date.now().toString())}}catch(u){console.error(" Error saving word translation language:",u)}})(a.code),className:"w-full flex items-center justify-between px-4 py-2 text-left transition-colors",style:{backgroundColor:l===a.code?t.hoverBg:"transparent"},onMouseEnter:e=>{l!==a.code&&(e.currentTarget.style.backgroundColor=t.hoverBg)},onMouseLeave:e=>{l!==a.code&&(e.currentTarget.style.backgroundColor="transparent")},role:"option","aria-selected":l===a.code,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-lg",children:a.flag}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-sm font-medium",style:{color:t.textPrimary},children:a.nativeName}),n.jsx("span",{className:"text-xs",style:{color:t.textSecondary},children:a.name})]})]}),l===a.code&&n.jsx(Z,{className:"w-4 h-4",style:{color:t.buttonPrimary}})]},a.code))})})]})},po=M("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function xo({className:e,variant:t,...s}){return n.jsx("div",{className:Cs(po({variant:t}),e),...s})}const fo=r.forwardRef(({className:e,...t},s)=>n.jsx("textarea",{className:Cs("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));fo.displayName="Textarea";const bo=({onSettingsChange:e,children:t,open:s,onOpenChange:a})=>{var i;const{user:l,signOut:c,profile:d,refreshProfile:u}=Pr(),m=o(),{t:h,i18n:g}=w(),{themeName:p,setTheme:x}=Or(),f=en(),[b,y]=r.useState(!1),v=void 0!==s?s:b,j=a||y,[_,N]=r.useState(!1),[k,E]=r.useState({target_test_type:"IELTS",target_score:7,target_deadline:null,preferred_name:"",target_scores:{reading:7,listening:7,writing:7,speaking:7,overall:7}}),[S,T]=r.useState(null),[C,I]=r.useState(null),[P,L]=r.useState(null),[M,O]=r.useState(!1),[R,D]=r.useState(null),[F,z]=r.useState("English"),[B,$]=r.useState("en"),[q,V]=r.useState("free"),[W,U]=r.useState("profile"),[G,Y]=r.useState(!1),[H,J]=r.useState(""),[X,Q]=r.useState(null),K=[{id:"too_expensive",label:"Too expensive"},{id:"not_using",label:"Not using it enough"},{id:"missing_features",label:"Missing features I need"},{id:"found_alternative",label:"Found a better alternative"},{id:"temporary",label:"Just need a break"},{id:"other",label:"Other reason"}],Z=r.useRef(null),ee=r.useRef(null),te=r.useRef(null),se=r.useRef(null),ae=r.useRef(null),re=r.useRef(null),ne=r.useRef(!1),ie={profile:Z,subscription:ee,preferences:te,appearance:se,danger:ae},le=e=>{var t;ne.current=!0;const s=ie[e];if((null==s?void 0:s.current)&&re.current){const e=s.current.offsetTop-12;re.current.scrollTo({top:e,behavior:"smooth"}),setTimeout(()=>{ne.current=!1},800)}else null==(t=null==s?void 0:s.current)||t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{ne.current=!1},800);U(e)};r.useEffect(()=>{const e=()=>{if(ne.current||!re.current)return;const e=re.current.scrollTop+100,t=["profile","subscription","preferences","appearance","danger"];for(const s of t){const t=ie[s].current;if(t){const{offsetTop:a,offsetHeight:r}=t;if(e>=a&&e<a+r){U(s);break}}}},t=re.current;return null==t||t.addEventListener("scroll",e),()=>null==t?void 0:t.removeEventListener("scroll",e)},[]);const ce=[{value:"IELTS",label:"IELTS",icon:me,color:"text-blue-600",bg:"bg-white"},{value:"PTE",label:"PTE Academic",icon:He,color:"text-orange-600",bg:"bg-white"},{value:"TOEFL",label:"TOEFL iBT",icon:Je,color:"text-blue-500",bg:"bg-white"},{value:"TOEIC",label:"TOEIC",icon:Xe,color:"text-purple-600",bg:"bg-white"},{value:"Business",label:"Business English",icon:Qe,color:"text-amber-600",bg:"bg-white"},{value:"NCLEX",label:"NCLEX",icon:Ke,color:"text-red-600",bg:"bg-white"},{value:"GENERAL",label:"General English",icon:Ze,color:"text-emerald-600",bg:"bg-white"}],de=[4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9];r.useEffect(()=>{if(l&&v&&(I(p),L(d?JSON.parse(JSON.stringify(d)):null),ue(),!(null==d?void 0:d.avatar_url)&&!R)){const e=uo[Math.floor(Math.random()*uo.length)];D(e.src),O(!0)}},[l,v,null==d?void 0:d.avatar_url]),r.useEffect(()=>{const e=()=>{const e=localStorage.getItem("word_translation_language");e&&($(e),console.log(" SettingsModal synced word translation language:",e))};return window.addEventListener("word-translation-language-updated",e),()=>{window.removeEventListener("word-translation-language-updated",e)}},[]);const ue=async(e=0)=>{var t,s,a,r,n,i;if(!l)return void console.log(" Cannot load preferences: No user");console.log(" Loading preferences for user:",l.id);try{const{data:r}=await jr.from("profiles").select("subscription_status").eq("id",l.id).maybeSingle();(null==r?void 0:r.subscription_status)&&V(r.subscription_status);const{data:n,error:i}=await jr.from("user_preferences").select("*").eq("user_id",l.id).maybeSingle();if(i){const r=(null==(t=i.message)?void 0:t.includes("ERR_CONNECTION_CLOSED"))||(null==(s=i.message)?void 0:s.includes("Failed to fetch"))||(null==(a=i.message)?void 0:a.includes("NetworkError"));return r&&e<1?(await new Promise(e=>setTimeout(e,2e3)),ue(e+1)):void 0}if(console.log(" Loaded preferences:",n),null==n?void 0:n.native_language){console.log(" Loaded native language from preferences:",n.native_language);const e=function(e){if(!e)return"English";const t=Nr(e);return Sr[t]||"English"}(n.native_language);z(e)}else console.log(" No native language found, using default");const o=n;if((null==o?void 0:o.word_translation_language)?(console.log(" Loaded word translation language from preferences:",o.word_translation_language),$(o.word_translation_language),localStorage.setItem("word_translation_language",o.word_translation_language)):(null==n?void 0:n.native_language)&&(console.log(" No word translation language found, using native_language as fallback"),$(n.native_language),localStorage.setItem("word_translation_language",n.native_language)),(null==n?void 0:n.dashboard_theme)&&x(n.dashboard_theme),n){const e={reading:7,listening:7,writing:7,speaking:7,overall:7},t={target_test_type:n.target_test_type||"IELTS",target_score:n.target_score||7,target_deadline:n.target_deadline?new Date(n.target_deadline):null,preferred_name:n.preferred_name||"",target_scores:n.target_scores||e};console.log(" Setting preferences:",t),E(t),T(JSON.parse(JSON.stringify(t)))}else console.log(" No existing preferences found, using defaults"),T(JSON.parse(JSON.stringify(k)))}catch(o){const t=(null==(r=null==o?void 0:o.message)?void 0:r.includes("ERR_CONNECTION_CLOSED"))||(null==(n=null==o?void 0:o.message)?void 0:n.includes("Failed to fetch"))||(null==(i=null==o?void 0:o.message)?void 0:i.includes("NetworkError"));if(t&&e<1)return await new Promise(e=>setTimeout(e,2e3)),ue(e+1);0}},he=async e=>{N(!0);try{const{error:t}=await jr.functions.invoke("cancel-subscription",{body:{reason:e||"No reason provided"}});if(t)throw t;ia.success("Subscription cancelled successfully"),await u()}catch(t){console.error("Error cancelling subscription:",t),ia.error(t.message||"Failed to cancel subscription")}finally{N(!1)}},ge=({tab:e,icon:t,label:s})=>n.jsxs("button",{onClick:()=>le(e),className:Cs("w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors",W===e?"bg-accent/10":"hover:bg-accent/5"),style:{color:W===e?f.buttonPrimary:f.textSecondary,backgroundColor:W===e?f.hoverBg:"transparent"},children:[n.jsx(t,{className:"w-4 h-4"}),s]});return n.jsxs(n.Fragment,{children:[n.jsxs(_n,{open:v,onOpenChange:e=>{!e&&M?(S&&(E(S),T(null)),C&&C!==p&&(x(C),vr(C),I(null)),l&&(u(),L(null)),O(!1)):e||(T(null),I(null),L(null)),j(e)},children:[n.jsx(Nn,{asChild:!0,children:t||n.jsxs(qr,{variant:"outline",size:"sm",className:"border",style:{backgroundColor:"glassmorphism"===f.theme.name||"dark"===f.theme.name?"rgba(255,255,255,0.1)":"minimalist"===f.theme.name?"#ffffff":"rgba(255,255,255,0.1)",borderColor:f.border,color:f.textPrimary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=f.hoverBg},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="glassmorphism"===f.theme.name||"dark"===f.theme.name?"rgba(255,255,255,0.1)":"minimalist"===f.theme.name?"#ffffff":"rgba(255,255,255,0.1)"},onClick:()=>console.log(" Settings button clicked"),children:[n.jsx(Be,{className:"w-4 h-4 mr-2"}),"Settings"]})}),n.jsxs(Tn,{className:`w-full h-[100dvh] sm:h-[85vh] sm:max-w-5xl p-0 overflow-hidden ${f.cardClassName} ${"note"===f.theme.name?"":"backdrop-blur-xl"} flex flex-col`,style:{...f.cardStyle,borderColor:f.border,backgroundColor:"note"===f.theme.name?f.backgroundImageColor:null==(i=f.cardStyle)?void 0:i.backgroundColor},onInteractOutside:e=>{e.preventDefault()},children:[n.jsxs("div",{className:"sr-only",children:[n.jsx(An,{children:"Settings"}),n.jsx(Pn,{children:"Manage your account settings and preferences."})]}),n.jsx(En,{asChild:!0,children:n.jsx("button",{"aria-label":"Close",className:"absolute top-3 right-3 rounded-full p-2 transition focus:outline-none focus-visible:outline-none",style:{color:f.textPrimary,backgroundColor:f.cardBackground,border:`1px solid ${f.border}`,boxShadow:"0 4px 12px rgba(0,0,0,0.08)"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=f.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor=f.cardBackground,children:n.jsx(A,{className:"w-4 h-4"})})}),n.jsxs("div",{className:"flex h-full",children:[n.jsxs("div",{className:"w-64 border-r p-6 space-y-1 overflow-y-auto hidden md:block flex-shrink-0",style:{borderColor:f.border},children:[n.jsx("h2",{className:"text-xl font-bold mb-6 px-2",style:{color:f.textPrimary},children:h("settings.title")}),n.jsx(ge,{tab:"profile",icon:oe,label:h("settings.nav.profile")}),n.jsx(ge,{tab:"subscription",icon:$e,label:h("settings.nav.subscription")}),n.jsx(ge,{tab:"preferences",icon:Be,label:h("settings.nav.preferences")}),n.jsx(ge,{tab:"appearance",icon:qe,label:h("settings.nav.appearance")}),n.jsx("div",{className:"pt-4 mt-4 border-t",style:{borderColor:f.border},children:n.jsxs("button",{onClick:()=>le("danger"),className:Cs("w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors"),style:{color:"danger"===W?"#ef4444":f.textSecondary,backgroundColor:"danger"===W?"rgba(239, 68, 68, 0.1)":"transparent"},children:[n.jsx(Ve,{className:"w-4 h-4"}),h("settings.nav.accountActions")]})})]}),n.jsx("div",{ref:re,className:"flex-1 overflow-y-auto",style:{backgroundColor:f.backgroundImageColor},children:n.jsxs("div",{className:"p-4 md:p-8 max-w-3xl mx-auto space-y-6 md:space-y-8 pb-12 min-h-full flex flex-col",children:[n.jsx("div",{className:"mb-4",children:n.jsx("h2",{className:"text-xl md:text-2xl font-bold",style:{color:f.textPrimary},children:h("settings.title")})}),n.jsx("div",{ref:Z,className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start",children:[n.jsx(mo,{onPhotoSelect:e=>{console.log(" Profile photo selected (pending save):",e),D(e),O(!0)},children:n.jsxs("div",{className:"w-24 h-24 rounded-full bg-slate-600 flex items-center justify-center overflow-hidden cursor-pointer hover:opacity-80 transition-opacity shadow-lg group relative",children:[R||(null==d?void 0:d.avatar_url)?n.jsx("img",{src:R||(null==d?void 0:d.avatar_url)||"",alt:"Profile",className:"w-full h-full object-cover"}):n.jsx(oe,{className:"w-10 h-10 text-white"}),n.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(qe,{className:"w-6 h-6 text-white"})})]})}),n.jsxs("div",{className:"flex-1 space-y-2 min-w-[220px]",children:[n.jsx("div",{children:n.jsx("h3",{className:"font-medium text-lg",style:{color:f.textPrimary},children:h("settings.nicknameProfile")})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Mn,{htmlFor:"preferred_name",className:"text-base",style:{color:f.textPrimary}}),n.jsx(Vr,{id:"preferred_name",value:k.preferred_name,onChange:e=>{E(t=>({...t,preferred_name:e.target.value})),O(!0)},placeholder:h("settings.enterNickname"),className:"h-12 text-lg px-4",style:{backgroundColor:f.cardBackground,borderColor:f.border,color:f.textPrimary}})]})]})]})}),n.jsx("div",{ref:ee,className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:n.jsx("div",{className:`relative overflow-hidden p-6 rounded-xl border ${f.cardClassName}`,style:{...f.cardStyle,borderColor:f.border},children:n.jsxs("div",{className:"relative z-10 space-y-8",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 pb-6 border-b border-dashed",style:{borderColor:f.border},children:[n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-xl",style:{color:f.textPrimary},children:h("settings.currentPlan")}),n.jsx("div",{className:"flex items-center gap-2 mt-1",children:"ultra"===q?n.jsx(xo,{className:"px-2 py-0.5 text-xs bg-gradient-to-r from-amber-500 to-yellow-400 text-white border-0 shadow-sm",children:h("settings.plan.ultra")}):"premium"===q||"pro"===q?n.jsx(xo,{className:"px-2 py-0.5 text-xs bg-gradient-to-r from-[#d97757] to-[#e8956f] text-white border-0",children:h("settings.plan.pro")}):n.jsx(xo,{variant:"outline",className:"px-2 py-0.5 text-xs font-normal text-muted-foreground",children:h("settings.plan.free")})})]})}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-sm font-medium text-muted-foreground whitespace-nowrap",children:h("settings.preparingFor")}),n.jsxs(Wr,{value:k.target_test_type,onValueChange:e=>{E(t=>({...t,target_test_type:e})),O(!0)},children:[n.jsx(Gr,{className:"w-[140px] h-9 bg-transparent",style:{borderColor:f.border,color:f.textPrimary},children:n.jsx(Ur,{})}),n.jsxs(Jr,{children:[ce.map(e=>n.jsx(Xr,{value:e.value,children:e.label},e.value)),n.jsx(Xr,{value:"GENERAL",children:h("settings.testTypes.GENERAL")})]})]})]})]}),n.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[n.jsxs("div",{className:"p-5 rounded-xl border",style:{borderColor:f.border,backgroundColor:f.cardBackground},children:[n.jsx("h4",{className:"font-semibold text-base mb-4",style:{color:f.textPrimary},children:h("settings.freeFeatures.title")}),n.jsx("ul",{className:"space-y-3",children:["dailyPractice","basicAnalysis","pronunciation","community"].map(e=>n.jsxs("li",{className:"flex items-start gap-3 text-sm text-muted-foreground",children:[n.jsx(We,{className:"w-4 h-4 mt-0.5 text-muted-foreground flex-shrink-0"}),n.jsx("span",{className:"leading-snug",children:h(`settings.freeFeatures.${e}`)})]},e))})]}),n.jsxs("div",{className:"p-5 rounded-xl border",style:{borderColor:"pro"===q||"premium"===q?f.buttonPrimary:f.border,backgroundColor:f.cardBackground},children:[n.jsx("h4",{className:"font-semibold text-base mb-4",style:{color:f.textPrimary},children:h("settings.proFeatures.title")}),n.jsx("ul",{className:"space-y-3",children:["unlimitedPractice","detailedFeedback","pronunciationCoaching","studyRoadmap"].map(e=>n.jsxs("li",{className:"flex items-start gap-3 text-sm text-muted-foreground",children:[n.jsx(We,{className:"w-4 h-4 mt-0.5 text-[#d97757] flex-shrink-0"}),n.jsx("span",{className:"leading-snug",children:h(`settings.proFeatures.${e}`)})]},e))})]}),n.jsxs("div",{className:"p-5 rounded-xl border",style:{borderColor:"ultra"===q?f.buttonPrimary:f.border,backgroundColor:f.cardBackground},children:[n.jsx("h4",{className:"font-semibold text-base mb-4",style:{color:f.textPrimary},children:h("settings.ultraFeatures.title")}),n.jsx("ul",{className:"space-y-3",children:["everythingPro","personalMeeting","premiumTemplates","betaAccess"].map(e=>n.jsxs("li",{className:"flex items-start gap-3 text-sm text-muted-foreground",children:[n.jsx(We,{className:"w-4 h-4 mt-0.5 text-amber-500 flex-shrink-0"}),n.jsx("span",{className:"leading-snug",children:h(`settings.ultraFeatures.${e}`)})]},e))})]})]}),n.jsx("div",{className:"flex flex-col sm:flex-row gap-4 pt-2",children:"free"===q?n.jsxs(n.Fragment,{children:[n.jsxs(qr,{size:"lg",onClick:()=>{j(!1),m("/pay?plan=premium")},className:"flex-1 bg-[#d97757] hover:bg-[#c56a4b] text-white h-12 shadow-md hover:shadow-lg transition-all",children:[n.jsx(Ue,{className:"w-5 h-5 mr-2"}),h("settings.upgradePro")]}),n.jsx(qr,{size:"lg",onClick:()=>{j(!1),m("/pay?plan=ultra")},className:"flex-1 bg-gradient-to-r from-amber-400 to-amber-500 hover:from-amber-500 hover:to-amber-600 text-white h-12 shadow-md hover:shadow-lg transition-all border-0",children:h("settings.goUltra")})]}):"ultra"!==q?n.jsxs(n.Fragment,{children:[n.jsx(qr,{size:"lg",onClick:()=>{j(!1),m("/pay?plan=ultra")},className:"flex-1 bg-gradient-to-r from-amber-400 to-amber-500 hover:from-amber-500 hover:to-amber-600 text-white h-12 shadow-md hover:shadow-lg transition-all border-0",children:h("settings.upgradeUltra")}),n.jsx(qr,{size:"lg",variant:"ghost",onClick:he,className:"flex-1 text-muted-foreground hover:text-destructive hover:bg-destructive/5 h-12",disabled:_,children:h(_?"settings.cancel.loading":"settings.cancelSubscription")})]}):n.jsx(qr,{size:"lg",variant:"outline",onClick:()=>{j(!1),m("/settings")},className:"w-full bg-transparent h-12 border-dashed",style:{borderColor:f.border,color:f.textSecondary},children:h("settings.manageSubscription")})})]})})}),n.jsxs("div",{ref:te,className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-semibold text-lg border-b pb-2",style:{borderColor:f.border,color:f.textPrimary},children:h("settings.languageSettings")}),n.jsxs("div",{className:"grid gap-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mn,{className:"text-base",style:{color:f.textPrimary},children:h("settings.displayLanguage")}),n.jsx(pa,{delayDuration:200,children:n.jsxs(xa,{children:[n.jsx(fa,{asChild:!0,children:n.jsx(Ge,{className:"w-4 h-4 cursor-help",style:{color:f.textSecondary}})}),n.jsx(ba,{className:"max-w-xs",children:n.jsx("p",{className:"text-sm",children:h("settings.displayLanguageTooltip")})})]})})]}),n.jsx(hn,{})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mn,{className:"text-base",style:{color:f.textPrimary},children:h("settings.preferredFeedbackLanguage")}),n.jsx(pa,{delayDuration:200,children:n.jsxs(xa,{children:[n.jsx(fa,{asChild:!0,children:n.jsx(Ge,{className:"w-4 h-4 cursor-help",style:{color:f.textSecondary}})}),n.jsx(ba,{className:"max-w-xs",children:n.jsx("p",{className:"text-sm",children:h("settings.feedbackLanguageTooltip")})})]})})]}),n.jsx(ho,{},v?"open":"closed")]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mn,{className:"text-base",style:{color:f.textPrimary},children:h("settings.wordTranslationLanguage")}),n.jsx(pa,{delayDuration:200,children:n.jsxs(xa,{children:[n.jsx(fa,{asChild:!0,children:n.jsx(Ge,{className:"w-4 h-4 cursor-help",style:{color:f.textSecondary}})}),n.jsx(ba,{className:"max-w-xs",children:n.jsx("p",{className:"text-sm",children:h("settings.wordTranslationLanguageTooltip")})})]})})]}),n.jsx(go,{},v?"open-word":"closed-word")]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-semibold text-lg border-b pb-2",style:{borderColor:f.border,color:f.textPrimary},children:h("settings.studyGoals")}),n.jsx("div",{className:"grid md:grid-cols-2 gap-6 pt-1",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx(Mn,{style:{color:f.textPrimary},children:h("settings.targetDeadline")}),n.jsxs(oo,{children:[n.jsx(lo,{asChild:!0,children:n.jsxs(qr,{variant:"outline",className:Cs("w-full justify-start text-left font-normal h-10 bg-transparent",!k.target_deadline&&"text-muted-foreground"),style:{borderColor:f.border,color:k.target_deadline?f.textPrimary:f.textSecondary,backgroundColor:"dark"===f.theme.name||"glassmorphism"===f.theme.name?f.backgroundImageColor:f.cardBackground},children:[n.jsx(fe,{className:"mr-2 h-4 w-4",style:{color:f.textPrimary}}),k.target_deadline?xs(k.target_deadline,"PPP"):n.jsx("span",{children:h("settings.pickDate")})]})}),n.jsx(co,{className:"w-auto p-0",align:"start",style:{backgroundColor:"dark"===f.theme.name||"glassmorphism"===f.theme.name?f.backgroundImageColor:f.cardBackground,borderColor:f.border,color:f.textPrimary},children:n.jsx(io,{mode:"single",className:"p-3",style:{color:f.textPrimary},selected:k.target_deadline||void 0,onSelect:e=>{E(t=>({...t,target_deadline:e||null})),O(!0)},disabled:e=>e<new Date,initialFocus:!0})})]})]})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Mn,{style:{color:f.textPrimary},children:h("settings.targetScores")}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(k.target_scores).map(([e,t])=>n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-xs font-medium uppercase tracking-wider text-muted-foreground",children:h(`settings.targetScoresSections.${e}`)}),n.jsxs(Wr,{value:t.toString(),onValueChange:t=>((e,t)=>{E(s=>({...s,target_scores:{...s.target_scores,[e]:t}})),O(!0)})(e,parseFloat(t)),children:[n.jsx(Gr,{className:"h-9 bg-transparent focus:ring-0 focus:outline-none focus-visible:ring-0 focus-visible:ring-offset-0 outline-none",style:{borderColor:f.border,color:f.textPrimary,backgroundColor:f.cardBackground,boxShadow:"none"},children:n.jsx(Ur,{})}),n.jsx(Jr,{style:{backgroundColor:f.cardBackground,color:f.textPrimary,borderColor:f.border},children:de.map(e=>n.jsx(Xr,{value:e.toString(),children:e},e))})]})]},e))})]})]})]}),n.jsxs("div",{ref:se,className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[n.jsx("h3",{className:"font-semibold text-lg border-b pb-2",style:{borderColor:f.border,color:f.textPrimary},children:h("settings.appearance")}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(br).map(e=>n.jsxs("button",{onClick:()=>{x(e.name),O(!0)},className:"p-4 rounded-xl border-2 transition-all text-left relative overflow-hidden group",style:{borderColor:p===e.name?f.buttonPrimary:f.border,backgroundColor:p===e.name?f.hoverBg:f.cardBackground},children:[n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsx("span",{className:"font-semibold",style:{color:f.textPrimary},children:e.label}),p===e.name&&n.jsx(We,{className:"w-5 h-5",style:{color:f.buttonPrimary}})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),n.jsx("div",{className:"flex gap-2",children:[e.colors.background,e.colors.cardBackground,e.colors.buttonPrimary].map((t,s)=>n.jsx("div",{className:"w-6 h-6 rounded-full border shadow-sm",style:{backgroundColor:t,borderColor:e.colors.border}},s))})]},e.name))})]}),n.jsx("div",{className:"pt-6 mt-2 border-t flex justify-end py-4",style:{borderColor:f.border},children:n.jsx(qr,{onClick:async()=>{var t,s,a,r,n,i,o,c,d,m;if(l){N(!0),console.log(" Saving preferences for user:",l.id,k);try{if(R){console.log(" Saving deferred profile photo...");const{error:e}=await jr.from("profiles").update({avatar_url:R}).eq("id",l.id);e?console.error(" Failed to save profile photo:",e):(await u(),D(null))}const{data:m}=await jr.from("user_preferences").select("user_id").eq("user_id",l.id).maybeSingle(),g=localStorage.getItem("word_translation_language")||B||"en",x={target_test_type:k.target_test_type,target_score:k.target_score,target_deadline:(null==(t=k.target_deadline)?void 0:t.toISOString().split("T")[0])||null,preferred_name:k.preferred_name,native_language:Cr(F),target_scores:k.target_scores,word_translation_language:g},f={user_id:l.id,...x};let b;const y={target_test_type:k.target_test_type,target_score:k.target_score,target_deadline:(null==(s=k.target_deadline)?void 0:s.toISOString().split("T")[0])||null,preferred_name:k.preferred_name,native_language:Cr(F),target_scores:k.target_scores};if(m){const{error:e}=await jr.from("user_preferences").update(x).eq("user_id",l.id);if(e&&((null==(a=e.message)?void 0:a.includes("word_translation_language"))||(null==(r=e.message)?void 0:r.includes("column"))||"42703"===e.code)){console.log(" word_translation_language column not found, saving without it...");const{error:e}=await jr.from("user_preferences").update(y).eq("user_id",l.id);b=e}else b=e}else{const e={...f,dashboard_theme:p},{error:t}=await jr.from("user_preferences").insert(e);if(t){if("PGRST204"===t.code||(null==(n=t.message)?void 0:n.includes("dashboard_theme"))||(null==(i=t.message)?void 0:i.includes("word_translation_language"))||"42703"===t.code){const{error:e}=await jr.from("user_preferences").insert({user_id:l.id,...y});b=e}else b=t}}if(b){if(!((null==(o=b.message)?void 0:o.includes("column"))||(null==(c=b.message)?void 0:c.includes("dashboard_theme"))||"42703"===b.code||"42P01"===b.code||"PGRST204"===b.code)){console.error(" Preferences save error:",b);throw"23502"===b.code||"23505"===b.code||(null==(d=b.message)?void 0:d.includes("violates"))?(ia.error(`Failed to save settings: ${b.message||"Validation error"}`),b):(ia.error(`Failed to save settings: ${b.message||"Unknown error"}`),b)}if(console.log(" Preferences saved (dashboard_theme column not available)"),ia.success("Settings saved successfully!"),k.preferred_name&&(null==l?void 0:l.id))try{localStorage.setItem(`nickname_${l.id}`,JSON.stringify({nickname:k.preferred_name,timestamp:Date.now()}))}catch(h){}}else if(console.log(" Preferences and language saved successfully"),ia.success("Settings saved successfully!"),k.preferred_name&&(null==l?void 0:l.id))try{localStorage.setItem(`nickname_${l.id}`,JSON.stringify({nickname:k.preferred_name,timestamp:Date.now()}))}catch(h){}localStorage.setItem("language-updated",Date.now().toString()),window.dispatchEvent(new StorageEvent("storage",{key:"language-updated"})),T(null),I(null),L(null),O(!1),null==e||e()}catch(g){console.error(" Error saving preferences:",g);(null==(m=null==g?void 0:g.message)?void 0:m.includes("column"))||"42703"===(null==g?void 0:g.code)||"42P01"===(null==g?void 0:g.code)||"PGRST204"===(null==g?void 0:g.code)?(ia.success("Settings saved successfully!"),null==e||e()):ia.error(`Failed to save settings: ${g.message||"Unknown error"}`)}finally{N(!1)}}},disabled:_,size:"lg",className:"w-full sm:w-auto min-w-[150px] text-white shadow-lg",style:{backgroundColor:f.buttonPrimary},children:h(_?"common.loading":"settings.save")})}),n.jsxs("div",{ref:ae,className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-8",children:[n.jsx("h3",{className:"font-semibold text-lg border-b pb-2",style:{borderColor:f.border,color:f.textPrimary},children:h("settings.accountActions")}),n.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[n.jsxs("button",{type:"button",onClick:async()=>{console.log(" Initiating logout for user:",null==l?void 0:l.id);try{await c(),console.log(" Logout successful"),m("/"),j(!1)}catch(e){console.error(" Logout error:",e),ia.error(`Failed to logout: ${e.message||"Unknown error"}`)}},className:"flex items-center justify-between p-4 rounded-lg border text-left transition",style:{borderColor:f.border,backgroundColor:f.cardBackground,color:f.textPrimary},children:[n.jsx("span",{className:"font-medium",children:h("settings.signOut")}),n.jsx(Ye,{className:"w-4 h-4"})]}),n.jsxs("button",{type:"button",onClick:()=>Y(!0),className:"flex items-center justify-between p-4 rounded-lg border text-left transition",style:{borderColor:f.border,backgroundColor:f.cardBackground,color:f.textPrimary},children:[n.jsx("span",{className:"font-medium",children:h("settings.cancelSubscription")}),n.jsx("span",{className:"text-sm",style:{color:f.textSecondary},children:""})]}),n.jsxs("button",{type:"button",onClick:async()=>{if(!l)return;if(window.confirm(h("settings.resetConfirm"))){N(!0);try{await jr.from("writing_test_results").delete().eq("user_id",l.id),await jr.from("speaking_test_results").delete().eq("user_id",l.id),await jr.from("reading_test_results").delete().eq("user_id",l.id),await jr.from("listening_test_results").delete().eq("user_id",l.id);const{error:t}=await jr.from("test_results").delete().eq("user_id",l.id);if(t)throw t;ia.success(h("settings.resetSuccess")),j(!1),null==e||e()}catch(t){console.error("Failed to reset results",t),ia.error(h("settings.resetError"))}finally{N(!1)}}},className:"flex items-center justify-between p-4 rounded-lg border text-left transition",style:{borderColor:f.border,backgroundColor:f.cardBackground,color:f.textPrimary},disabled:_,children:[n.jsx("span",{className:"font-medium",children:h("settings.reset")}),n.jsx("span",{className:"text-sm",style:{color:f.textSecondary},children:""})]}),n.jsxs("button",{type:"button",onClick:async()=>{if(!window.confirm("Are you absolutely sure you want to delete your account? This action cannot be undone."))return;if("DELETE"===window.prompt('Type "DELETE" to confirm account deletion:')){N(!0);try{const{error:e}=await jr.functions.invoke("delete-account");if(e)throw e;ia.success("Account deleted successfully"),await c(),m("/"),j(!1)}catch(e){console.error("Error deleting account:",e),ia.error("Failed to delete account automatically. Please contact support.")}finally{N(!1)}}},className:"flex items-center justify-between p-4 rounded-lg border text-left transition",style:{borderColor:f.border,backgroundColor:f.cardBackground,color:f.textPrimary},disabled:_,children:[n.jsx("span",{className:"font-medium",style:{color:"crimson"},children:h("settings.delete")}),n.jsx("span",{className:"text-sm",style:{color:f.textSecondary},children:""})]})]})]})]})})]})]})]}),n.jsx(_n,{open:G,onOpenChange:e=>{Y(e),e||(J(""),Q(null))},children:n.jsxs(Tn,{className:"sm:max-w-lg",style:{backgroundColor:f.cardBackground,borderColor:f.border,color:f.textPrimary},children:[n.jsxs(Cn,{children:[n.jsx(An,{style:{color:f.textPrimary},children:"Cancel Subscription"}),n.jsx(Pn,{style:{color:f.textSecondary},children:"We're sorry to see you go. Please let us know why you're leaving."})]}),n.jsxs("div",{className:"p-4 rounded-lg border mb-2",style:{borderColor:f.border,backgroundColor:f.hoverBg},children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium",style:{color:f.textSecondary},children:"Your Current Plan"}),n.jsx(xo,{className:"px-2 py-0.5 text-xs text-white border-0",style:{background:"ultra"===q?"linear-gradient(to right, #f59e0b, #fbbf24)":"linear-gradient(to right, #d97757, #e8956f)"},children:"ultra"===q?"Ultra":"pro"===q||"premium"===q?"Pro":"Free"})]}),n.jsx("p",{className:"text-sm",style:{color:f.textSecondary},children:"Your subscription will remain active until the end of your current billing period. After that, you'll be moved to the Free plan."})]}),("pro"===q||"premium"===q||"ultra"===q)&&n.jsxs("div",{className:"mb-2",children:[n.jsx("p",{className:"text-sm font-medium mb-2",style:{color:f.textPrimary},children:"Features you'll lose:"}),n.jsx("ul",{className:"space-y-1.5",children:(pe=q,"ultra"===pe?["Unlimited AI feedback","Priority support","Advanced analytics","All practice tests","Personalized study plans","Speaking practice with AI"]:"pro"===pe||"premium"===pe?["Extended AI feedback","More practice tests","Basic analytics","Email support"]:[]).map((e,t)=>n.jsxs("li",{className:"flex items-center gap-2 text-sm",style:{color:f.textSecondary},children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),e]},t))})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Mn,{style:{color:f.textPrimary},children:"Why are you cancelling?"}),n.jsx("div",{className:"grid gap-2",children:K.map(e=>n.jsxs("button",{type:"button",onClick:()=>Q(e.id),className:"flex items-center gap-3 p-3 rounded-lg border text-left transition-colors",style:{borderColor:X===e.id?f.buttonPrimary:f.border,backgroundColor:X===e.id?f.hoverBg:"transparent",color:f.textPrimary},children:[n.jsx("div",{className:"w-4 h-4 rounded-full border-2 flex items-center justify-center",style:{borderColor:X===e.id?f.buttonPrimary:f.border},children:X===e.id&&n.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:f.buttonPrimary}})}),n.jsx("span",{className:"text-sm",children:e.label})]},e.id))})]}),"other"===X&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Mn,{htmlFor:"cancel-reason",style:{color:f.textPrimary},children:"Tell us more (optional)"}),n.jsx(fo,{id:"cancel-reason",placeholder:"Let us know how we can improve...",value:H,onChange:e=>J(e.target.value),className:"min-h-[80px]",style:{backgroundColor:f.cardBackground,borderColor:f.border,color:f.textPrimary}})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[n.jsx(qr,{variant:"outline",onClick:()=>{Y(!1),J(""),Q(null)},style:{borderColor:f.border,color:f.textPrimary,backgroundColor:"transparent"},children:"Keep My Plan"}),n.jsx(qr,{variant:"destructive",disabled:_||!X,onClick:async()=>{var e;const t="other"===X?H:(null==(e=K.find(e=>e.id===X))?void 0:e.label)||"";await he(t),Y(!1),J(""),Q(null)},children:_?"Cancelling...":"Cancel Subscription"})]})]})})]});var pe},yo=({selectedSkill:e,selectedTestType:t})=>{var s,a;const{user:i}=Pr(),{t:o}=w(),l=en(),[c,d]=r.useState("week"),[u,m]=r.useState([]),[h,g]=r.useState(!0),[p,x]=r.useState(null);r.useEffect(()=>{i&&(b(),f())},[i,c,e,t]);const f=async()=>{var e,t,s,a,r,n;if(i)try{const{data:a,error:r}=await jr.from("user_preferences").select("target_score, target_deadline, target_scores").eq("user_id",i.id).maybeSingle();if(r){return void("PGRST204"===r.code||"42703"===r.code||"42P01"===r.code||"PGRST116"===r.code||(null==(e=r.message)?void 0:e.toLowerCase().includes("column"))||(null==(t=r.message)?void 0:t.toLowerCase().includes("does not exist"))||(null==(s=r.message)?void 0:s.toLowerCase().includes("bad request"))||console.error("Error loading user preferences:",r))}x(a)}catch(o){"PGRST204"===(null==o?void 0:o.code)||"42703"===(null==o?void 0:o.code)||"42P01"===(null==o?void 0:o.code)||"PGRST116"===(null==o?void 0:o.code)||(null==(a=null==o?void 0:o.message)?void 0:a.toLowerCase().includes("column"))||(null==(r=null==o?void 0:o.message)?void 0:r.toLowerCase().includes("does not exist"))||(null==(n=null==o?void 0:o.message)?void 0:n.toLowerCase().includes("bad request"))||console.error("Error loading user preferences:",o)}},b=async()=>{if(i){g(!0);try{let t=jr.from("test_results").select("id, score_percentage, test_type, created_at").eq("user_id",i.id);if("full"!==c){let e;switch(c){case"week":default:e=Vt(new Date,7);break;case"month":e=ys(new Date,1)}t=t.gte("created_at",e.toISOString())}"overall"!==e&&(t=t.ilike("test_type",`%${e}%`));const{data:s,error:a}=await t.order("created_at",{ascending:!0});if(a)throw a;m(s||[])}catch(t){console.error("Error loading test results:",t)}finally{g(!1)}}},y=e=>e>=95?9:e>=90?8.5:e>=85?8:e>=80?7.5:e>=75?7:e>=70?6.5:e>=65?6:e>=60?5.5:e>=55?5:e>=50?4.5:e>=45?4:e>=40?3.5:e>=35?3:e>=30?2.5:e>=25?2:e>=20?1.5:e>=15?1:e>=10?.5:0,v=u.map((e,t)=>({test:xs(new Date(e.created_at),"MMM dd"),score:y(e.score_percentage||0),date:xs(new Date(e.created_at),"MMM dd"),type:e.test_type})),j=u.length>0?y(u.reduce((e,t)=>e+(t.score_percentage||0),0)/u.length):0,_=u.length>1?y((null==(s=u[u.length-1])?void 0:s.score_percentage)||0)-y((null==(a=u[0])?void 0:a.score_percentage)||0):0,N=(null==p?void 0:p.target_deadline)?Math.max(0,Math.ceil((new Date(p.target_deadline).getTime()-Date.now())/864e5)):null;return n.jsxs(Rr,{className:`${l.cardClassName} h-full flex flex-col shadow-md`,style:l.cardStyle,children:[n.jsx(Dr,{className:"pb-2 relative flex-shrink-0",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Fr,{style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:"overall"===e?o("testResults.overallResults",{defaultValue:"Overall Test Results"}):""}),n.jsxs(Wr,{value:c,onValueChange:d,children:[n.jsx(Gr,{className:"w-auto min-w-[70px] h-7 text-xs border",style:{fontFamily:"Poppins, sans-serif",backgroundColor:"glassmorphism"===l.theme.name||"dark"===l.theme.name?"rgba(255,255,255,0.1)":"minimalist"===l.theme.name?"#ffffff":"rgba(255,255,255,0.6)",borderColor:l.border,color:l.textPrimary},children:n.jsx(Ur,{})}),n.jsxs(Jr,{className:"backdrop-blur-xl border",style:{backgroundColor:l.cardBackground,borderColor:l.border},children:[n.jsx(Xr,{value:"week",className:"text-xs",style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:"Week"}),n.jsx(Xr,{value:"month",className:"text-xs",style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:"Month"}),n.jsx(Xr,{value:"full",className:"text-xs",style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:"Full"})]})]})]})}),n.jsxs(Br,{className:"px-0 lg:px-2 flex-1 flex flex-col min-h-0",children:[n.jsx("div",{className:"h-64 mb-4 w-full flex items-center justify-center flex-shrink-0",children:h?n.jsx("p",{style:{color:l.textSecondary},children:o("common.loading",{defaultValue:"Loading..."})}):0===u.length?n.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 px-4",children:[n.jsx("p",{className:"text-sm text-center",style:{fontFamily:"Inter, sans-serif",color:l.textSecondary},children:"No data available for graph"}),n.jsx("button",{onClick:()=>{if(!i)return;const t=[],s=new Date,a=[];for(let e=0;e<8;e++){const e=Math.floor(30*Math.random()),t=new Date(s);t.setDate(t.getDate()-e),a.push(t)}a.sort((e,t)=>e.getTime()-t.getTime());const r=[];for(let e=0;e<8;e++){let t=50+5*e+(10*Math.random()-5);e>0&&Math.random()<.3&&(t=r[e-1]),t=Math.max(45,Math.min(90,t)),r.push(Math.round(10*t)/10)}let n="IELTS";"overall"!==e&&("reading"===e?n="IELTS Reading":"listening"===e?n="IELTS Listening":"writing"===e?n="writing":"speaking"===e&&(n="speaking"));for(let e=0;e<8;e++)t.push({id:`mock-${e}-${Date.now()}`,score_percentage:r[e],test_type:n,created_at:a[e].toISOString(),test_data:null});m(t),g(!1)},className:"px-4 py-2 rounded-lg text-sm font-medium transition shadow-sm",style:{fontFamily:"Poppins, sans-serif",backgroundColor:l.buttonPrimary,color:"white"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=l.buttonPrimaryHover,onMouseLeave:e=>e.currentTarget.style.backgroundColor=l.buttonPrimary,children:"Generate Mock Data"})]}):n.jsx(Lt,{width:"100%",height:"100%",children:n.jsxs(Bt,{data:v,margin:{left:-10,right:10,top:5,bottom:5},children:[n.jsx(Ot,{strokeDasharray:"3 3",stroke:l.textSecondary+"40"}),n.jsx(Rt,{dataKey:"test",stroke:l.textSecondary,fontSize:12}),n.jsx(Dt,{stroke:l.textSecondary,fontSize:12,domain:[0,9],ticks:[0,1,2,3,4,5,6,7,8,9],tickFormatter:e=>`${e}`}),n.jsx(Ft,{contentStyle:{backgroundColor:l.cardBackground,border:`1px solid ${l.border}`,borderRadius:"8px",color:l.textPrimary},formatter:(e,t)=>[`${e}`,"IELTS Band"],labelFormatter:e=>`${e}`}),n.jsx($t,{type:"monotone",dataKey:"score",stroke:l.chartLine,strokeWidth:3,dot:{fill:l.chartLine,strokeWidth:2,r:4},activeDot:{r:6,stroke:l.chartLine,strokeWidth:2}}),(null==p?void 0:p.target_scores)&&"overall"!==e?n.jsx($t,{type:"monotone",dataKey:()=>{var t;return(null==(t=p.target_scores)?void 0:t[e])||p.target_score},stroke:l.chartTarget,strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1}):(null==p?void 0:p.target_score)&&n.jsx($t,{type:"monotone",dataKey:()=>p.target_score,stroke:l.chartTarget,strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1})]})})}),!h&&n.jsxs("div",{className:"grid grid-cols-3 gap-3 flex-shrink-0",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-normal",style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:null!==N?N:""}),n.jsx("p",{className:"text-[11px]",style:{fontFamily:"Poppins, sans-serif",color:l.textSecondary},children:o("dashboard.daysLeft",{defaultValue:"Days Left"})})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-xl font-normal",style:{fontFamily:"Poppins, sans-serif",color:l.textPrimary},children:j.toFixed(1)}),n.jsx("p",{className:"text-[11px]",style:{fontFamily:"Poppins, sans-serif",color:l.textSecondary},children:o("dashboard.averageScore",{defaultValue:"Average Score"})})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("p",{className:"text-xl font-normal",style:{fontFamily:"Poppins, sans-serif",color:_>=0?l.textSecondary:l.chartTarget},children:[_>0?"+":"",_.toFixed(1)]}),n.jsx("p",{className:"text-[11px]",style:{fontFamily:"Poppins, sans-serif",color:l.textSecondary},children:o("testResults.improvement",{defaultValue:"Improvement"})})]})]})]})]})};function vo(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function jo(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function wo(e,t){var s,a,r,n;if(!(null==(s=null==e?void 0:e.weekly)?void 0:s.length))return null;const i=(()=>{var t;if(null==(t=null==e?void 0:e.meta)?void 0:t.startDateISO){const t=new Date(e.meta.startDateISO);return new Date(t.getFullYear(),t.getMonth(),t.getDate())}const s=new Date;return new Date(s.getFullYear(),s.getMonth(),s.getDate())})(),o=jo(t),l=Math.max(0,Math.floor((o.getTime()-i.getTime())/864e5)),c=Math.floor(l/7),d=l%7;return(null==(n=null==(r=null==(a=null==e?void 0:e.weekly)?void 0:a[c])?void 0:r.days)?void 0:n[d])||null}const _o=()=>{const{user:e}=Pr(),{t:t}=w(),s=en(),[a,i]=r.useState(null),[o,l]=r.useState(!0),[c,d]=r.useState({title:"",minutes:15}),[u,m]=r.useState(null),[h,g]=r.useState(()=>jo(new Date)),[p,x]=r.useState(!1);r.useEffect(()=>{e?f():l(!1)},[e]);const f=async()=>{l(!0);try{let a=null;try{const e=JSON.parse(localStorage.getItem("latest_plan")||"null");if((null==e?void 0:e.plan)&&(null==e?void 0:e.ts)&&(a=e,e.fresh))return i(e.plan),void l(!1)}catch(t){console.warn("Error reading local cache:",t)}try{const{data:s,error:r}=await jr.from("profiles").select("current_plan_id").eq("id",e.id).maybeSingle();if(r&&console.warn("Error loading profile:",r),null==s?void 0:s.current_plan_id){const{data:e,error:r}=await jr.from("study_plans").select("plan, updated_at, created_at").eq("id",s.current_plan_id).maybeSingle();if(r)console.warn("Error loading study plan:",r),(null==a?void 0:a.plan)&&i(a.plan);else if(null==e?void 0:e.plan){const s=new Date(e.updated_at||e.created_at||Date.now()).getTime(),r=(null==a?void 0:a.ts)||0,n=Math.abs(s-r);if(!a||n>3e4){i(e.plan);try{localStorage.setItem("latest_plan",JSON.stringify({plan:e.plan,ts:Date.now()}))}catch(t){console.warn("Error saving to localStorage:",t)}}else i(a.plan)}else(null==a?void 0:a.plan)&&i(a.plan)}else(null==a?void 0:a.plan)&&i(a.plan)}catch(s){console.error("Database error:",s),(null==a?void 0:a.plan)&&i(a.plan)}}catch(a){console.error("Error loading study plan:",a),m(a instanceof Error?a.message:"Failed to load study plan")}finally{l(!1)}},b=r.useMemo(()=>jo(h),[h]),y=r.useMemo(()=>vo(b),[b]),v=r.useMemo(()=>{if(!a)return null;try{return wo(a,b)}catch(e){return console.error("Error calculating day:",e),null}},[a,b]),[j,_]=r.useState(()=>jo(new Date));r.useEffect(()=>{const e=setInterval(()=>{_(jo(new Date))},6e4);return()=>clearInterval(e)},[]);const N=j,k=r.useMemo(()=>{const e=new Date(N);return e.setDate(e.getDate()-1),jo(e)},[N]),E=r.useMemo(()=>{const e=new Date(N);return e.setDate(e.getDate()+1),jo(e)},[N]),S=r.useMemo(()=>b.getTime()===N.getTime(),[b,N]),T=r.useMemo(()=>b.getTime()===k.getTime(),[b,k]),C=r.useMemo(()=>b.getTime()===E.getTime(),[b,E]),I=r.useMemo(()=>b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),[b]),A=e=>{const t=new Date(b);"prev"===e?t.setDate(t.getDate()-1):"next"===e?t.setDate(t.getDate()+1):t.setTime(N.getTime()),g(jo(t)),x(!1)},[P,L]=r.useState({}),[M,O]=r.useState([]),[R,D]=r.useState(new Set);r.useEffect(()=>{const e=vo(b);try{const t=JSON.parse(localStorage.getItem(`quicktodo-${e}`)||"{}");L(t)}catch{L({})}try{const t=JSON.parse(localStorage.getItem(`quicktodo-custom-${e}`)||"[]");O(t)}catch{O([])}try{const t=JSON.parse(localStorage.getItem(`quicktodo-hidden-ai-${e}`)||"[]");D(new Set(t))}catch{D(new Set)}},[b]);const F=()=>y||vo(jo(new Date)),z=e=>{const t={...P,[e]:!P[e]};L(t);try{localStorage.setItem(`quicktodo-${F()}`,JSON.stringify(t))}catch(s){console.warn("Error saving task state:",s)}},B=e=>{const t=`c${e}`,s={...P,[t]:!P[t]};L(s);try{localStorage.setItem(`quicktodo-${F()}`,JSON.stringify(s))}catch(a){console.warn("Error saving custom task state:",a)}},$=()=>{if(!c.title.trim())return;const e=[...M,{title:c.title.trim(),minutes:Math.max(5,Math.min(180,Number(c.minutes)||15))}];O(e),d({title:"",minutes:15});try{localStorage.setItem(`quicktodo-custom-${F()}`,JSON.stringify(e))}catch(t){console.warn("Error saving custom tasks:",t)}},q=r.useMemo(()=>(null==v?void 0:v.tasks)&&Array.isArray(v.tasks)?v.tasks.slice(0,5).map((e,t)=>({task:e,originalIndex:t})).filter(({originalIndex:e})=>!R.has(String(e))).map(({task:e,originalIndex:t})=>({...e,originalIndex:t})):[],[v,R]),[V,W]=r.useState({totalTests:0,savedWords:0,dayStreak:7});return r.useEffect(()=>{if(!e)return;(async()=>{try{const{count:t}=await jr.from("test_results").select("id",{count:"exact",head:!0}).eq("user_id",e.id),{count:s}=await jr.from("user_vocabulary").select("id",{count:"exact",head:!0}).eq("user_id",e.id);W({totalTests:t||0,savedWords:s||0,dayStreak:7})}catch(t){console.error("Error fetching stats:",t)}})()},[e]),o?n.jsx("div",{className:`${s.cardClassName} rounded-xl p-4`,style:s.cardStyle,children:n.jsx("p",{className:"text-sm",style:{color:s.textSecondary},children:t("common.loading",{defaultValue:"Loading..."})})}):u?n.jsx("div",{className:`${s.cardClassName} rounded-xl p-4`,style:s.cardStyle,children:n.jsx("p",{className:"text-sm",style:{color:s.textSecondary},children:u})}):n.jsxs("div",{className:`${s.cardClassName} rounded-xl p-4 lg:p-5 shadow-md flex flex-col`,style:s.cardStyle,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("h3",{className:"text-sm lg:text-base font-normal",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:s.textPrimary},children:[I,S&&n.jsx("span",{className:"ml-2 text-xs font-medium",style:{color:s.textSecondary},children:"Today"}),T&&n.jsx("span",{className:"ml-2 text-xs font-medium",style:{color:s.textSecondary},children:"Yesterday"}),C&&n.jsx("span",{className:"ml-2 text-xs font-medium",style:{color:s.textSecondary},children:"Tomorrow"})]})}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>A("prev"),className:"p-1 rounded transition",style:{color:s.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=s.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Yesterday",children:n.jsx(Me,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>A("next"),className:"p-1 rounded transition",style:{color:s.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=s.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Tomorrow",children:n.jsx(Oe,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>x(!p),className:"p-1 rounded transition ml-1",style:{color:s.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=s.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Calendar",children:n.jsx(fe,{className:"w-4 h-4"})})]})]}),p&&n.jsx("div",{className:"mb-4 flex-shrink-0",children:n.jsx(No,{plan:a||null,selectedDate:b,onSelectDate:e=>{g(e),x(!1)}})}),n.jsx("div",{className:"flex-1 overflow-y-auto mb-4 min-h-0",style:{maxHeight:"400px"},children:n.jsxs("div",{className:"space-y-2",children:[a&&q.length>0&&q.map((e,t)=>{if(!e||!e.title)return null;const a=e.originalIndex??t,r=!0===P[a];return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all "+(r?"line-through opacity-60":"hover:shadow-sm"),style:{backgroundColor:r?"note"===s.theme.name?"rgba(245, 230, 211, 0.5)":"dark"===s.theme.name?"rgba(255,255,255,0.05)":"minimalist"===s.theme.name?"#f9fafb":"rgba(255,255,255,0.1)":"glassmorphism"===s.theme.name?"rgba(255,255,255,0.1)":"dark"===s.theme.name?"rgba(255,255,255,0.05)":"minimalist"===s.theme.name?"#ffffff":"rgba(255,255,255,0.4)",borderColor:s.border,boxShadow:r?"none":"0 1px 2px rgba(0,0,0,0.05)"},onClick:()=>z(a),children:[n.jsx("button",{className:"flex-shrink-0",onClick:e=>{e.stopPropagation(),z(a)},children:r?n.jsx(et,{className:"w-5 h-5",style:{color:s.textSecondary}}):n.jsx(tt,{className:"w-5 h-5",style:{color:s.textAccent}})}),n.jsx("span",{className:"flex-1 text-sm",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',color:r?s.textSecondary:s.textPrimary},children:e.title||"Untitled task"}),n.jsx("button",{className:"text-xs font-bold flex-shrink-0 z-10",style:{color:s.chartTarget,opacity:r?.8:1},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity=r?"0.8":"1",onClick:e=>{e.stopPropagation(),e.preventDefault(),(t=>{const s=new Set(R);s.add(String(t)),D(s);try{localStorage.setItem(`quicktodo-hidden-ai-${F()}`,JSON.stringify(Array.from(s)))}catch(e){console.warn("Error hiding AI task:",e)}})(a)},title:"Remove",children:""})]},`ai-${a}`)}),M.length>0&&M.map((e,t)=>{if(!e||!e.title)return null;const a=!0===P[`c${t}`];return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all "+(a?"line-through opacity-60":"hover:shadow-sm"),style:{backgroundColor:a?"note"===s.theme.name?"rgba(245, 230, 211, 0.5)":"dark"===s.theme.name?"rgba(255,255,255,0.05)":"minimalist"===s.theme.name?"#f9fafb":"rgba(255,255,255,0.1)":"glassmorphism"===s.theme.name?"rgba(255,255,255,0.1)":"dark"===s.theme.name?"rgba(255,255,255,0.05)":"minimalist"===s.theme.name?"#ffffff":"rgba(255,255,255,0.4)",borderColor:s.border,boxShadow:a?"none":"0 1px 2px rgba(0,0,0,0.05)"},onClick:()=>B(t),children:[n.jsx("button",{className:"flex-shrink-0",onClick:e=>{e.stopPropagation(),B(t)},children:a?n.jsx(et,{className:"w-5 h-5",style:{color:s.textSecondary}}):n.jsx(tt,{className:"w-5 h-5",style:{color:s.textAccent}})}),n.jsx("span",{className:"flex-1 text-sm",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',color:a?s.textSecondary:s.textPrimary},children:e.title||"Untitled task"}),n.jsx("button",{className:"text-xs font-bold flex-shrink-0 z-10",style:{color:s.chartTarget,opacity:a?.8:1},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity=a?"0.8":"1",onClick:e=>{e.stopPropagation(),e.preventDefault(),(t=>{const s=M.slice();s.splice(t,1),O(s);try{localStorage.setItem(`quicktodo-custom-${F()}`,JSON.stringify(s))}catch(e){console.warn("Error removing custom task:",e)}})(t)},title:"Remove",children:""})]},`custom-${t}`)}),n.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t flex-shrink-0",style:{borderColor:s.border},children:[n.jsx("input",{type:"text",value:c.title,onChange:e=>d({...c,title:e.target.value}),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),$())},placeholder:t("studyPlan.addTask",{defaultValue:"Add a task..."}),className:"flex-1 rounded-lg border px-3 py-2 text-sm focus:outline-none focus:ring-0 focus:ring-offset-0",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',borderColor:s.border,backgroundColor:"glassmorphism"===s.theme.name||"dark"===s.theme.name?"rgba(255,255,255,0.1)":"minimalist"===s.theme.name?"#ffffff":"rgba(255,255,255,0.6)",color:s.textPrimary}}),n.jsx("button",{onClick:$,className:"rounded-lg px-3 py-2 transition flex items-center justify-center shadow-sm focus:outline-none focus:ring-0 focus:ring-offset-0",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',backgroundColor:s.buttonPrimary,color:"white",minWidth:"44px",minHeight:"38px",boxSizing:"border-box"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=s.buttonPrimaryHover,onMouseLeave:e=>e.currentTarget.style.backgroundColor=s.buttonPrimary,children:n.jsx(st,{className:"w-4 h-4"})})]})]})})]})},No=({plan:e,selectedDate:t,onSelectDate:s})=>{var a;const i=en(),o=new Date,[l,c]=r.useState(()=>{const e=jo(t);return 12*(e.getFullYear()-o.getFullYear())+(e.getMonth()-o.getMonth())});r.useEffect(()=>{const e=jo(t),s=12*(e.getFullYear()-o.getFullYear())+(e.getMonth()-o.getMonth());c(s)},[t]),(null==(a=null==e?void 0:e.meta)?void 0:a.startDateISO)||(new Date).toISOString();const d=new Date(o.getFullYear(),o.getMonth()+l,1),u=new Date(d.getFullYear(),d.getMonth()+1,0).getDate(),m=d.toLocaleString(void 0,{month:"long",year:"numeric"}),h=d.getDay(),g=Array.from({length:h}).map((e,t)=>t),p=[];for(let r=1;r<=u;r++){const t=new Date(d.getFullYear(),d.getMonth(),r);let s=!1,a=!1;try{if(e){const r=wo(e,t),n=null==r?void 0:r.tasks;if(Array.isArray(n)&&n.length>0){const e=vo(jo(t)),r=new Set(JSON.parse(localStorage.getItem(`quicktodo-hidden-ai-${e}`)||"[]")),i=n.filter((e,t)=>!r.has(String(t)));if(s=i.length>0,s){const t=JSON.parse(localStorage.getItem(`quicktodo-${e}`)||"{}"),s=JSON.parse(localStorage.getItem(`quicktodo-custom-${e}`)||"[]"),r=i.every((e,s)=>!0===t[s]),n=s.every((e,s)=>!0===t[`c${s}`]);a=r&&n}}}else{const e=vo(jo(t)),r=JSON.parse(localStorage.getItem(`quicktodo-custom-${e}`)||"[]");if(r.length>0){s=!0;const t=JSON.parse(localStorage.getItem(`quicktodo-${e}`)||"{}");a=r.every((e,s)=>!0===t[`c${s}`])}}}catch{s=!1,a=!1}p.push({date:t,hasTasks:s,allCompleted:a})}return n.jsxs("div",{className:`rounded-xl border p-4 shadow-sm ${i.cardClassName}`,style:i.cardStyle,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"text-base font-medium",style:{color:i.textPrimary},children:m}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{"aria-label":"Previous",className:"rounded-md border px-3 py-1.5 text-sm transition",style:{borderColor:i.border,color:i.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=i.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",onClick:()=>c(e=>e-1),children:""}),n.jsx("button",{"aria-label":"Next",className:"rounded-md border px-3 py-1.5 text-sm transition",style:{borderColor:i.border,color:i.textSecondary,backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=i.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",onClick:()=>c(e=>e+1),children:""})]})]}),n.jsx("div",{className:"grid grid-cols-7 gap-2 text-sm mb-3 font-medium",style:{color:i.textSecondary},children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>n.jsx("div",{className:"text-center",children:e},e))}),n.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[g.map(e=>n.jsx("div",{className:"h-10"},`b${e}`)),p.map((e,a)=>{const r=jo(e.date),l=(c=e.date,t.getTime()===jo(c).getTime());var c;const d=(e=>o.getFullYear()===e.getFullYear()&&o.getMonth()===e.getMonth()&&o.getDate()===e.getDate())(e.date);return n.jsxs("button",{onClick:()=>s(r),className:"relative h-10 rounded-lg border text-sm transition",style:{backgroundColor:l?i.buttonPrimary:d&&!l?"glassmorphism"===i.theme.name?"rgba(255,255,255,0.2)":"dark"===i.theme.name?"rgba(255,255,255,0.1)":"minimalist"===i.theme.name?"#f9fafb":"rgba(255,255,255,0.6)":"glassmorphism"===i.theme.name||"dark"===i.theme.name?"rgba(255,255,255,0.05)":"minimalist"===i.theme.name?"#ffffff":"rgba(255,255,255,0.3)",borderColor:l?i.buttonPrimary:e.allCompleted?"#D4AF37":i.border,borderWidth:e.allCompleted?"2px":"1px",color:l?"white":e.hasTasks?i.textPrimary:i.textSecondary},onMouseEnter:e=>{l||(e.currentTarget.style.backgroundColor=i.hoverBg)},onMouseLeave:e=>{l||(e.currentTarget.style.backgroundColor=d&&!l?"glassmorphism"===i.theme.name?"rgba(255,255,255,0.2)":"dark"===i.theme.name?"rgba(255,255,255,0.1)":"minimalist"===i.theme.name?"#f9fafb":"rgba(255,255,255,0.6)":"glassmorphism"===i.theme.name||"dark"===i.theme.name?"rgba(255,255,255,0.05)":"minimalist"===i.theme.name?"#ffffff":"rgba(255,255,255,0.3)")},children:[n.jsx("span",{className:"relative z-10",children:e.date.getDate()}),e.allCompleted&&n.jsx("div",{className:"absolute top-0.5 right-0.5 text-[10px] z-10",children:""}),!e.allCompleted&&e.hasTasks&&n.jsx("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 h-1.5 w-1.5 rounded-full bg-current"})]},a)})]})]})},ko=()=>{const e=o(),[t,s]=c(),{t:a}=w(),{user:i,profile:l,refreshProfile:u,loading:m}=Pr(),{toast:h}=Ts(),g=en(),[p,x]=r.useState("IELTS"),[f,b]=r.useState("reading"),[y,v]=r.useState(null),[j,_]=r.useState([]),[N,k]=r.useState(!0),[E,S]=r.useState(0);r.useState("overview");const[T,C]=r.useState(null),[I,A]=r.useState(0),[P,L]=r.useState(!1),[M,O]=r.useState(!1),[R,D]=r.useState(!1),[F,z]=r.useState({}),B=e=>{if(null==i?void 0:i.id)try{e?localStorage.setItem(`nickname_${i.id}`,JSON.stringify({nickname:e,timestamp:Date.now()})):localStorage.removeItem(`nickname_${i.id}`)}catch(t){}},$=[{id:"reading",label:"R",fullLabel:a("skills.reading"),icon:Je},{id:"listening",label:"L",fullLabel:a("skills.listening"),icon:at},{id:"writing",label:"W",fullLabel:a("skills.writing"),icon:rt},{id:"speaking",label:"S",fullLabel:a("skills.speaking"),icon:Ze}],q=async(e=0)=>{var t,s,a,r,n,o,l,c,d,u,m,h;if(!i)return;try{const{data:l,error:c}=await jr.from("user_preferences").select("*").eq("user_id",i.id).maybeSingle();if(c){const i=(null==(t=c.message)?void 0:t.includes("ERR_CONNECTION_CLOSED"))||(null==(s=c.message)?void 0:s.includes("Failed to fetch"))||(null==(a=c.message)?void 0:a.includes("NetworkError"));"PGRST204"===c.code||"42703"===c.code||"42P01"===c.code||(null==(r=c.message)?void 0:r.toLowerCase().includes("column"))||(null==(n=c.message)?void 0:n.toLowerCase().includes("does not exist"))||(null==(o=c.message)||o.toLowerCase().includes("bad request"));if(i&&e<1)return await new Promise(e=>setTimeout(e,2e3)),q(e+1);0,C(null)}else l?(C(l),x(l.target_test_type||"IELTS"),A(e=>e+1),l.preferred_name&&B(l.preferred_name)):(C(null),B(null))}catch(g){const t=(null==(l=null==g?void 0:g.message)?void 0:l.includes("ERR_CONNECTION_CLOSED"))||(null==(c=null==g?void 0:g.message)?void 0:c.includes("Failed to fetch"))||(null==(d=null==g?void 0:g.message)?void 0:d.includes("NetworkError"));"PGRST204"===(null==g?void 0:g.code)||"42703"===(null==g?void 0:g.code)||"42P01"===(null==g?void 0:g.code)||(null==(u=null==g?void 0:g.message)?void 0:u.toLowerCase().includes("column"))||(null==(m=null==g?void 0:g.message)?void 0:m.toLowerCase().includes("does not exist"))||(null==(h=null==g?void 0:g.message)||h.toLowerCase().includes("bad request"));if(t&&e<1)return await new Promise(e=>setTimeout(e,2e3)),q(e+1);0,C(null)}};r.useEffect(()=>{if(!i||m||N)return;"required"===t.get("setup")&&(console.log(" Settings setup explicitly required, opening settings modal"),O(!0),s({},{replace:!0}),h({title:"Welcome! Complete your profile",description:"Please set up your preferences to get started.",duration:5e3}))},[i,m,N,t,s,h]),r.useEffect(()=>{if(!i||m||N||R)return;const e=`settings_seen_${i.id}`,t="true"===localStorage.getItem(e);t?D(!0):T||t||(O(!0),localStorage.setItem(e,"true"),D(!0))},[i,m,N,T,R]),r.useEffect(()=>{let e=!0,t=0;const s=new Image;s.onload=()=>L(!0),s.src="/lovable-uploads/5d9b151b-eb54-41c3-a578-e70139faa878.png";const a=async()=>{var s,r;if(i)try{await q();const{data:e,error:t}=await jr.from("test_results").select("id, test_type, score_percentage, created_at, user_id").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(10);t&&console.warn("Error fetching test results:",t);const{data:a,error:n}=await jr.from("reading_test_results").select("id, comprehension_score, created_at, reading_time_seconds, user_id").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(10);n&&console.warn("Error fetching reading results:",n);const{data:o}=await jr.from("writing_test_results").select("id, created_at, task_number, band_scores, user_id, test_result_id").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(10),l=[...e||[]];if(a&&a.forEach(e=>{l.push({id:e.id,user_id:e.user_id,test_type:"reading",score_percentage:Math.round(100*e.comprehension_score),created_at:e.created_at,test_data:{readingResult:e},section_number:null,total_questions:40,correct_answers:Math.floor(40*(e.comprehension_score||0)),time_taken:e.reading_time_seconds,completed_at:e.created_at,audio_retention_expires_at:null,detailed_feedback:null,question_analysis:null,performance_metrics:null,skill_breakdown:null})}),o){const e={};o.forEach(t=>{var s;const a=t.test_result_id||(null==(s=t.created_at)?void 0:s.split("T")[0])||"standalone";e[a]||(e[a]=[]),e[a].push(t)}),Object.entries(e).forEach(([e,t])=>{if("standalone"!==e&&l.some(t=>t.id===e))return;const s=t.find(e=>1===e.task_number),a=t.find(e=>2===e.task_number);let r=70;if(s&&a){const e=e=>{if(e.band_scores&&"object"==typeof e.band_scores){const t=Object.values(e.band_scores).filter(e=>"number"==typeof e);if(t.length>0)return t.reduce((e,t)=>e+t,0)/t.length}return 7},t=(1*e(s)+2*e(a))/3;r=Math.round(10*t)}l.push({id:"standalone"===e?`writing-${Date.now()}`:e,user_id:i.id,test_type:"writing",score_percentage:r,created_at:t[0].created_at,test_data:{writingResults:t},section_number:null,total_questions:t.length,correct_answers:null,time_taken:null,completed_at:t[0].created_at,audio_retention_expires_at:null,detailed_feedback:null,question_analysis:null,performance_metrics:null,skill_breakdown:null})})}l.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),_(l);const c=l.length,d=l.length>0?l.reduce((e,t)=>e+(t.score_percentage||0),0)/l.length:0;v({totalTests:c,avgScore:Math.round(d),recentImprovement:c>1?Math.round(((null==(s=l[0])?void 0:s.score_percentage)||0)-((null==(r=l[1])?void 0:r.score_percentage)||0)):0,weeklyProgress:15})}catch(n){if(console.error("Error fetching user data:",n),e&&t<2&&(t++,console.log(` Retrying dashboard data fetch (attempt ${t}/2)...`),await new Promise(e=>setTimeout(e,1e3*Math.pow(2,t))),e))return a()}finally{e&&k(!1)}else k(!1)};return a(),V(),()=>{e=!1}},[i]);const V=async()=>{if(i)try{const{count:e,error:t}=await jr.from("user_vocabulary").select("id",{count:"exact",head:!0}).eq("user_id",i.id);if(t)return void console.warn("Error loading vocabulary count:",t);S(e||0)}catch(e){console.error("Error loading vocabulary count:",e)}},W=e=>e>=95?"9.0":e>=90?"8.5":e>=85?"8.0":e>=80?"7.5":e>=75?"7.0":e>=70?"6.5":e>=65?"6.0":e>=60?"5.5":e>=55?"5.0":e>=50?"4.5":e>=45?"4.0":e>=40?"3.5":e>=35?"3.0":e>=30?"2.5":e>=25?"2.0":e>=20?"1.5":"1.0";if(m)return n.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:n.jsx(wn,{})});if(!i)return n.jsx(d,{to:"/auth",replace:!0});if(N)return n.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:n.jsx(wn,{})});const U="dark"===g.theme.name?g.theme.colors.background:"transparent";return n.jsxs("div",{className:"h-screen relative overflow-hidden",style:{backgroundColor:U},children:[n.jsx("div",{className:"absolute inset-0 bg-contain bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"note"===g.theme.name||"minimalist"===g.theme.name||"dark"===g.theme.name?"none":"url('/lovable-uploads/5d9b151b-eb54-41c3-a578-e70139faa878.png')",backgroundColor:g.backgroundImageColor}}),n.jsx("div",{className:"relative z-10 h-full w-full flex flex-col",children:n.jsxs("div",{className:"relative w-full h-full overflow-y-auto border backdrop-blur-xl",style:{backgroundColor:g.backgroundOverlay,borderColor:"glassmorphism"===g.theme.name?"rgba(255, 255, 255, 0.3)":g.border+"40",backdropFilter:"glassmorphism"===g.theme.name?"blur(12px)":"dark"===g.theme.name?"blur(8px)":"none"},children:[n.jsxs("header",{className:"flex flex-col lg:flex-row sm:px-6 lg:px-12 lg:py-5 pt-4 pr-4 pb-4 pl-4 items-center justify-between border-b gap-4 lg:gap-0",style:{borderColor:"glassmorphism"===g.theme.name?"rgba(255, 255, 255, 0.2)":g.border+"60"},children:[n.jsx("div",{className:"flex items-center gap-3 order-3 lg:order-1"}),n.jsxs("nav",{className:"flex items-center gap-4 lg:gap-6 text-sm font-medium order-1 lg:order-2 flex-wrap justify-center",children:[n.jsx("button",{onClick:()=>e("/dashboard/my-word-book"),className:"transition whitespace-nowrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=g.buttonPrimary,onMouseLeave:e=>e.currentTarget.style.color=g.textSecondary,children:a("dashboard.myWordBook")}),n.jsx("button",{onClick:()=>{e({IELTS:"/ielts-portal",PTE:"/pte-portal",TOEFL:"/toefl-portal",TOEIC:"/toeic-portal",Business:"/business-portal",NCLEX:"/nclex-portal",GENERAL:"/general-portal"}[p]||"/ielts-portal")},className:"transition whitespace-nowrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=g.buttonPrimary,onMouseLeave:e=>e.currentTarget.style.color=g.textSecondary,children:a("dashboard.tests")}),n.jsx("button",{onClick:()=>e("/hero"),className:"transition whitespace-nowrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=g.buttonPrimary,onMouseLeave:e=>e.currentTarget.style.color=g.textSecondary,children:a("dashboard.home")}),n.jsx("button",{onClick:()=>e("/community"),className:"transition whitespace-nowrap",style:{fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=g.buttonPrimary,onMouseLeave:e=>e.currentTarget.style.color=g.textSecondary,children:a("navigation.community")})]}),n.jsx("div",{className:"flex items-center gap-2 lg:gap-3 order-2 lg:order-3 relative z-50",children:n.jsx(bo,{open:M,onOpenChange:O,onSettingsChange:()=>{q(),u(),A(e=>e+1),O(!1)},children:n.jsxs("button",{className:"group w-8 h-8 lg:w-9 lg:h-9 rounded-full bg-slate-800/80 backdrop-blur-sm flex items-center justify-center border border-white/20 overflow-hidden hover:border-blue-400/50 transition-all duration-200 hover:scale-105",title:a("dashboard.clickToOpenSettings"),children:[(null==l?void 0:l.avatar_url)?n.jsx("img",{src:l.avatar_url,alt:"Profile",className:"w-full h-full object-cover group-hover:opacity-80 transition-opacity"}):n.jsx(oe,{className:"w-4 h-4 text-white group-hover:text-blue-300 transition-colors"}),n.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-full flex items-center justify-center",children:n.jsx(Be,{className:"w-3 h-3 text-white"})})]})})})]}),n.jsx("main",{className:"relative flex-1 overflow-y-auto sm:px-6 lg:px-12 pr-4 pb-4 pl-4",children:n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 lg:gap-8 pt-3 lg:pt-4",children:[n.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[n.jsx("div",{className:"space-y-3",children:n.jsx("h1",{className:"text-3xl sm:text-4xl lg:text-5xl tracking-tight font-semibold flex-shrink-0",style:{fontFamily:'Comfortaa, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, cursive, sans-serif',color:g.textPrimary},children:a("dashboard.helloUser",{name:(()=>{const e=(()=>{if(!(null==i?void 0:i.id))return null;try{const e=localStorage.getItem(`nickname_${i.id}`);if(e){const{nickname:t,timestamp:s}=JSON.parse(e);if(Date.now()-s<864e5)return t}}catch(e){}return null})();return e||((null==T?void 0:T.preferred_name)?T.preferred_name:(null==l?void 0:l.full_name)?l.full_name.split(" ")[0]:"Learner")})()})})}),n.jsx("div",{className:"grid grid-cols-4 gap-2 lg:gap-3 flex-shrink-0",children:$.map(e=>{const t=f===e.id;return n.jsx("button",{onClick:()=>b(e.id),className:"flex flex-col items-center justify-center gap-2 p-2 lg:p-3 rounded-xl border transition-all min-h-[60px] "+(t?g.cardClassName+" shadow-md":"bg-white/40 border-gray-200 hover:bg-gray-50"),style:{...t?g.cardStyle:{},borderColor:g.border},children:n.jsx("span",{className:"text-xs lg:text-sm font-medium text-center leading-tight px-1",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',color:t?g.textPrimary:g.textSecondary},children:e.fullLabel})},e.id)})}),n.jsx("div",{className:"flex-shrink-0",style:{height:"400px"},children:n.jsx(yo,{selectedSkill:f,selectedTestType:p},I)}),n.jsx("div",{className:"flex-shrink-0 mt-4",children:n.jsx(_o,{})})]}),n.jsx("div",{className:"flex flex-col h-full",children:n.jsxs("div",{className:"grid xl:grid-cols-1 h-full pt-12 sm:pt-16 lg:pt-20",children:[n.jsx("div",{className:"flex flex-col flex-1 justify-start gap-4",children:$.map(t=>{const s=j.filter(e=>"writing"===t.id?"writing"===e.test_type:e.test_type&&e.test_type.toLowerCase().includes(t.id.toLowerCase())).slice(0,3),r=s.length>0?Math.round(s.reduce((e,t)=>e+(t.score_percentage||0),0)/s.length):0;"writing"===t.id||t.id;const i=((e,t,s)=>{var a;if(t.length>0)return{testsTaken:t.length,avgDisplay:W(s),latestDisplay:W((null==(a=t[0])?void 0:a.score_percentage)||0)};const r=F[e];return{testsTaken:(null==r?void 0:r.tests)??0,avgDisplay:W((null==r?void 0:r.avg)??0),latestDisplay:W((null==r?void 0:r.latest)??0)}})(t.id,s,r);return n.jsxs("div",{className:`relative lg:p-6 ${g.cardClassName} rounded-xl pt-4 pr-4 pb-4 pl-4 min-h-[190px] flex flex-col transition-all hover:shadow-md`,style:g.cardStyle,children:[n.jsxs("div",{className:"relative flex items-center justify-center mb-3",children:[n.jsx("h3",{className:"text-sm lg:text-base tracking-tight font-normal text-center",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textPrimary},children:t.fullLabel}),n.jsx(nt,{onClick:s=>{var a;s.stopPropagation(),a=t.id,e({reading:"/reading-results",writing:"/ielts-writing-results",speaking:"/ielts-speaking-results",listening:"/listening-results"}[a]||"/personal")},className:"absolute right-0 top-1/2 -translate-y-1/2 w-4 h-4 cursor-pointer transition-colors",style:{color:g.textSecondary},onMouseEnter:e=>e.currentTarget.style.color=g.textPrimary,onMouseLeave:e=>e.currentTarget.style.color=g.textSecondary,"aria-label":a("dashboard.viewHistory")})]}),n.jsx("div",{className:"flex-1 flex flex-col justify-center",children:n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-sm font-normal mb-1",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},children:a("dashboard.testsTaken")}),n.jsx("p",{className:"text-lg lg:text-xl font-medium mt-2",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textPrimary},children:i.testsTaken})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-sm font-normal mb-1",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},children:a("dashboard.averageScore")}),n.jsx("p",{className:"text-lg lg:text-xl font-medium mt-2",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textPrimary},children:i.avgDisplay})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-sm font-normal mb-1",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textSecondary},children:a("dashboard.latestScore")}),n.jsx("p",{className:"text-lg lg:text-xl font-medium mt-2",style:{fontFamily:'Poppins, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:g.textPrimary},children:i.latestDisplay})]})]})})]},t.id)})}),n.jsx("div",{className:"flex justify-end mt-4",children:n.jsx("button",{className:"text-xs font-medium underline",style:{color:g.buttonPrimary},onClick:()=>{const e={};$.forEach(t=>{e[t.id]={tests:Math.floor(5*Math.random())+1,avg:Math.floor(50*Math.random())+50,latest:Math.floor(50*Math.random())+50}}),z(t=>({...t,...e}))},children:a("dashboard.generateMockNumbers")})})]})})]})})]})})]})},Eo=Object.freeze(Object.defineProperty({__proto__:null,default:ko},Symbol.toStringTag,{value:"Module"})),So=()=>{const{user:e,loading:t}=Pr();return t?n.jsx("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center",children:n.jsx(Qr,{size:"lg"})}):e?n.jsx(ko,{}):n.jsx(yn,{})},To=()=>{const e=o(),{toast:t}=Ts(),[s,a]=r.useState(3600),[i,l]=r.useState(null),[c,d]=r.useState([]),[u,m]=r.useState({}),[h,g]=r.useState(!0);r.useEffect(()=>{p()},[]),r.useEffect(()=>{const e=setInterval(()=>{a(e=>e<=1?(f(),0):e-1)},1e3);return()=>clearInterval(e)},[]);const p=async()=>{try{g(!1);l({id:"placeholder",title:"Reading Test Coming Soon",content:"Reading tests are being updated to the new system. Please check back soon!",passage_type:"placeholder"}),d([])}catch(e){t({title:"Error",description:"Failed to load reading test: "+e.message,variant:"destructive"})}finally{g(!1)}},x=(e,t)=>{m(s=>({...s,[e]:t}))},f=()=>{const s=b();t({title:"Test Submitted!",description:`You answered ${s}/${c.length} questions correctly.`}),e("/")},b=()=>c.reduce((e,t)=>u[t.id]===t.correct_answer?e+1:e,0),y={title:"IELTS Reading Practice Test Online | Timed Passages & Answers",description:"Train for IELTS Reading with realistic passages, question types, and countdown timers. Track accuracy and build scanning strategies in one dashboard.",keywords:"IELTS reading practice, IELTS reading mock test, reading passage PDF, IELTS skimming scanning tips, IELTS multiple choice practice",type:"article",schemaType:"faq",url:"https://englishaidol.com/reading",faqs:[{question:"What IELTS reading question types can I practice here?",answer:"You can work through matching headings, True/False/Not Given, multiple choice, and summary completion question sets, mirroring the official exam format."},{question:"Do I get a timer like the real IELTS Reading section?",answer:"Yes. A built-in one-hour timer keeps you on pace, then we calculate accuracy so you can see if you are meeting your target band score."}]};return h?n.jsxs(n.Fragment,{children:[n.jsx(bn,{...y}),n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),n.jsx("p",{children:"Loading reading test..."})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(bn,{...y}),n.jsx("div",{className:"bg-white border-b-2 border-gray-200 p-4",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2",children:[n.jsx(it,{className:"h-4 w-4"}),"Back to Dashboard"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Je,{className:"h-5 w-5 text-blue-600"}),n.jsx("span",{className:"font-semibold text-lg",children:"IELTS Reading Test"})]})]}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-orange-100 px-3 py-1 rounded-lg",children:[n.jsx(ot,{className:"h-4 w-4 text-orange-600"}),n.jsx("span",{className:"font-mono text-orange-600 font-medium",children:(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`})(s)})]}),n.jsx(qr,{onClick:f,className:"bg-blue-600 hover:bg-blue-700",children:"Submit Test"})]})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsx("div",{children:n.jsxs(Rr,{children:[n.jsxs(Dr,{children:[n.jsxs(Fr,{className:"flex items-center gap-2",children:[n.jsx(Je,{className:"h-5 w-5"}),null==i?void 0:i.title]}),n.jsxs(zr,{children:["Type: ",null==i?void 0:i.passage_type]})]}),n.jsx(Br,{children:n.jsx("div",{className:"prose max-w-none text-sm leading-relaxed",children:null==i?void 0:i.content.split("\n\n").map((e,t)=>n.jsx("p",{className:"mb-4",children:e},t))})})]})}),n.jsx("div",{children:n.jsxs(Rr,{children:[n.jsxs(Dr,{children:[n.jsxs(Fr,{children:["Questions (",c.length,")"]}),n.jsx(zr,{children:"Read the passage and answer all questions"})]}),n.jsx(Br,{className:"space-y-6",children:c.map(e=>n.jsxs("div",{className:"border-b pb-4 last:border-b-0",children:[n.jsxs("p",{className:"font-medium mb-3",children:[e.question_number,". ",e.question_text]}),"multiple_choice"===e.question_type&&e.options?n.jsx("div",{className:"space-y-2",children:e.options.map((t,s)=>n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"radio",name:`question_${e.id}`,value:t,checked:u[e.id]===t,onChange:t=>x(e.id,t.target.value),className:"text-blue-600"}),n.jsx("span",{className:"text-sm",children:t})]},s))}):n.jsx("input",{type:"text",placeholder:"Type your answer here",value:u[e.id]||"",onChange:t=>x(e.id,t.target.value),className:"w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})]},e.id))})]})})]})})]})},Co=r.forwardRef(({className:e,...t},s)=>n.jsx(lt,{className:Cs("grid gap-2",e),...t,ref:s}));Co.displayName=lt.displayName;const Io=r.forwardRef(({className:e,...t},s)=>n.jsx(ct,{ref:s,className:Cs("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(dt,{className:"flex items-center justify-center",children:n.jsx(tt,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Io.displayName=ct.displayName;const Ao=({children:e,title:t,showBackButton:s=!1,backPath:a,transparentBackground:r=!1,fullWidth:i=!1,noPadding:l=!1})=>(o(),n.jsx("div",{className:"min-h-screen "+(r?"bg-transparent":"bg-gradient-to-br from-slate-100 via-blue-50/30 to-indigo-100/50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 dark:opacity-95"),style:r?{}:{backgroundImage:"radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.08) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(59, 130, 246, 0.03) 0%, transparent 50%)"},children:n.jsx("main",{className:`${i?"w-full":"container mx-auto px-6"} ${l?"":"py-8"}`,children:e})})),Po=e=>e>=39?9:e>=37?8.5:e>=35?8:e>=33?7.5:e>=30?7:e>=27?6.5:e>=23?6:e>=19?5.5:e>=15?5:e>=13?4.5:e>=10?4:e>=8?3.5:e>=6?3:e>=4?2.5:e>=2?2:e>=1?1:0,Lo=(e,t="academic-reading")=>{switch(t){case"listening":return(e=>e>=39?9:e>=37?8.5:e>=35?8:e>=32?7.5:e>=30?7:e>=26?6.5:e>=23?6:e>=18?5.5:e>=16?5:e>=13?4.5:e>=10?4:e>=8?3.5:e>=6?3:e>=4?2.5:e>=2?2:e>=1?1:0)(e);case"academic-reading":default:return Po(e);case"general-reading":return(e=>e>=40?9:e>=39?8.5:e>=37?8:e>=36?7.5:e>=34?7:e>=32?6.5:e>=30?6:e>=27?5.5:e>=23?5:e>=19?4.5:e>=15?4:e>=12?3.5:e>=9?3:e>=6?2.5:e>=4?2:e>=2?1.5:e>=1?1:0)(e)}},Mo=r.forwardRef(({className:e,value:t,...s},a)=>n.jsx(ut,{ref:a,className:Cs("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:n.jsx(mt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));function Oo(e){let t=e[0],s=e[1],a=e[2];return Math.sqrt(t*t+s*s+a*a)}function Ro(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Do(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e}function Fo(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e}function zo(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function Bo(e){let t=e[0],s=e[1],a=e[2];return t*t+s*s+a*a}function $o(e,t){let s=t[0],a=t[1],r=t[2],n=s*s+a*a+r*r;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function qo(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Vo(e,t,s){let a=t[0],r=t[1],n=t[2],i=s[0],o=s[1],l=s[2];return e[0]=r*l-n*o,e[1]=n*i-a*l,e[2]=a*o-r*i,e}Mo.displayName=ut.displayName;const Wo=function(){const e=[0,0,0],t=[0,0,0];return function(s,a){Ro(e,s),Ro(t,a),$o(e,e),$o(t,t);let r=qo(e,t);return r>1?0:r<-1?Math.PI:Math.acos(r)}}();class Uo extends Array{constructor(e=0,t=e,s=e){return super(e,t,s),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,t=e,s=e){return e.length?this.copy(e):(function(e,t,s,a){e[0]=t,e[1]=s,e[2]=a}(this,e,t,s),this)}copy(e){return Ro(this,e),this}add(e,t){return t?Do(this,e,t):Do(this,this,e),this}sub(e,t){return t?Fo(this,e,t):Fo(this,this,e),this}multiply(e){var t,s,a;return e.length?(s=this,a=e,(t=this)[0]=s[0]*a[0],t[1]=s[1]*a[1],t[2]=s[2]*a[2]):zo(this,this,e),this}divide(e){var t,s,a;return e.length?(s=this,a=e,(t=this)[0]=s[0]/a[0],t[1]=s[1]/a[1],t[2]=s[2]/a[2]):zo(this,this,1/e),this}inverse(e=this){var t,s;return s=e,(t=this)[0]=1/s[0],t[1]=1/s[1],t[2]=1/s[2],this}len(){return Oo(this)}distance(e){return e?function(e,t){let s=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(s*s+a*a+r*r)}(this,e):Oo(this)}squaredLen(){return Bo(this)}squaredDistance(e){return e?function(e,t){let s=t[0]-e[0],a=t[1]-e[1],r=t[2]-e[2];return s*s+a*a+r*r}(this,e):Bo(this)}negate(e=this){var t,s;return s=e,(t=this)[0]=-s[0],t[1]=-s[1],t[2]=-s[2],this}cross(e,t){return t?Vo(this,e,t):Vo(this,this,e),this}scale(e){return zo(this,this,e),this}normalize(){return $o(this,this),this}dot(e){return qo(this,e)}equals(e){return s=e,(t=this)[0]===s[0]&&t[1]===s[1]&&t[2]===s[2];var t,s}applyMatrix3(e){return function(e,t,s){let a=t[0],r=t[1],n=t[2];e[0]=a*s[0]+r*s[3]+n*s[6],e[1]=a*s[1]+r*s[4]+n*s[7],e[2]=a*s[2]+r*s[5]+n*s[8]}(this,this,e),this}applyMatrix4(e){return function(e,t,s){let a=t[0],r=t[1],n=t[2],i=s[3]*a+s[7]*r+s[11]*n+s[15];i=i||1,e[0]=(s[0]*a+s[4]*r+s[8]*n+s[12])/i,e[1]=(s[1]*a+s[5]*r+s[9]*n+s[13])/i,e[2]=(s[2]*a+s[6]*r+s[10]*n+s[14])/i}(this,this,e),this}scaleRotateMatrix4(e){return function(e,t,s){let a=t[0],r=t[1],n=t[2],i=s[3]*a+s[7]*r+s[11]*n+s[15];i=i||1,e[0]=(s[0]*a+s[4]*r+s[8]*n)/i,e[1]=(s[1]*a+s[5]*r+s[9]*n)/i,e[2]=(s[2]*a+s[6]*r+s[10]*n)/i}(this,this,e),this}applyQuaternion(e){return function(e,t,s){let a=t[0],r=t[1],n=t[2],i=s[0],o=s[1],l=s[2],c=o*n-l*r,d=l*a-i*n,u=i*r-o*a,m=o*u-l*d,h=l*c-i*u,g=i*d-o*c,p=2*s[3];c*=p,d*=p,u*=p,m*=2,h*=2,g*=2,e[0]=a+c+m,e[1]=r+d+h,e[2]=n+u+g}(this,this,e),this}angle(e){return Wo(this,e)}lerp(e,t){return function(e,t,s,a){let r=t[0],n=t[1],i=t[2];e[0]=r+a*(s[0]-r),e[1]=n+a*(s[1]-n),e[2]=i+a*(s[2]-i)}(this,this,e,t),this}smoothLerp(e,t,s){return function(e,t,s,a,r){const n=Math.exp(-a*r);let i=t[0],o=t[1],l=t[2];e[0]=s[0]+(i-s[0])*n,e[1]=s[1]+(o-s[1])*n,e[2]=s[2]+(l-s[2])*n}(this,this,e,t,s),this}clone(){return new Uo(this[0],this[1],this[2])}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}transformDirection(e){const t=this[0],s=this[1],a=this[2];return this[0]=e[0]*t+e[4]*s+e[8]*a,this[1]=e[1]*t+e[5]*s+e[9]*a,this[2]=e[2]*t+e[6]*s+e[10]*a,this.normalize()}}const Go=new Uo;let Yo=1,Ho=1,Jo=!1;class Xo{constructor(e,t={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=t,this.id=Yo++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let s in t)this.addAttribute(s,t[s])}addAttribute(e,t){if(this.attributes[e]=t,t.id=Ho++,t.size=t.size||1,t.type=t.type||(t.data.constructor===Float32Array?this.gl.FLOAT:t.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),t.target="index"===e?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,t.normalized=t.normalized||!1,t.stride=t.stride||0,t.offset=t.offset||0,t.count=t.count||(t.stride?t.data.byteLength/t.stride:t.data.length/t.size),t.divisor=t.instanced||0,t.needsUpdate=!1,t.usage=t.usage||this.gl.STATIC_DRAW,t.buffer||this.updateAttribute(t),t.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==t.count*t.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,t.count*t.divisor);this.instancedCount=t.count*t.divisor}else"index"===e?this.drawRange.count=t.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,t.count))}updateAttribute(e){const t=!e.buffer;t&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),t?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((e,{name:t,type:s})=>{if(!this.attributes[t])return void console.warn(`active attribute ${t} not being supplied`);const a=this.attributes[t];this.gl.bindBuffer(a.target,a.buffer),this.glState.boundBuffer=a.buffer;let r=1;35674===s&&(r=2),35675===s&&(r=3),35676===s&&(r=4);const n=a.size/r,i=1===r?0:r*r*4,o=1===r?0:4*r;for(let l=0;l<r;l++)this.gl.vertexAttribPointer(e+l,n,a.type,a.normalized,a.stride+i,a.offset+l*o),this.gl.enableVertexAttribArray(e+l),this.gl.renderer.vertexAttribDivisor(e+l,a.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:t=this.gl.TRIANGLES}){var s;this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((e,{name:t})=>{const s=this.attributes[t];s.needsUpdate&&this.updateAttribute(s)});let a=2;(null==(s=this.attributes.index)?void 0:s.type)===this.gl.UNSIGNED_INT&&(a=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a,this.instancedCount):this.gl.renderer.drawArraysInstanced(t,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(t,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a):this.gl.drawArrays(t,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;return e.data?e:Jo?void 0:(console.warn("No position buffer data found to compute bounds"),Jo=!0)}computeBoundingBox(e){e||(e=this.getPosition());const t=e.data,s=e.size;this.bounds||(this.bounds={min:new Uo,max:new Uo,center:new Uo,scale:new Uo,radius:1/0});const a=this.bounds.min,r=this.bounds.max,n=this.bounds.center,i=this.bounds.scale;a.set(1/0),r.set(-1/0);for(let o=0,l=t.length;o<l;o+=s){const e=t[o],s=t[o+1],n=t[o+2];a.x=Math.min(e,a.x),a.y=Math.min(s,a.y),a.z=Math.min(n,a.z),r.x=Math.max(e,r.x),r.y=Math.max(s,r.y),r.z=Math.max(n,r.z)}i.sub(r,a),n.add(a,r).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const t=e.data,s=e.size;this.bounds||this.computeBoundingBox(e);let a=0;for(let r=0,n=t.length;r<n;r+=s)Go.fromArray(t,r),a=Math.max(a,this.bounds.center.squaredDistance(Go));this.bounds.radius=Math.sqrt(a)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let Qo=1;const Ko={};class Zo{constructor(e,{vertex:t,fragment:s,uniforms:a={},transparent:r=!1,cullFace:n=e.BACK,frontFace:i=e.CCW,depthTest:o=!0,depthWrite:l=!0,depthFunc:c=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=a,this.id=Qo++,t||console.warn("vertex shader not supplied"),s||console.warn("fragment shader not supplied"),this.transparent=r,this.cullFace=n,this.frontFace=i,this.depthTest=o,this.depthWrite=l,this.depthFunc=c,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:t,fragment:s})}setShaders({vertex:e,fragment:t}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),""!==this.gl.getShaderInfoLog(this.vertexShader)&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}\nVertex Shader\n${tl(e)}`)),t&&(this.gl.shaderSource(this.fragmentShader,t),this.gl.compileShader(this.fragmentShader),""!==this.gl.getShaderInfoLog(this.fragmentShader)&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}\nFragment Shader\n${tl(t)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let n=0;n<s;n++){let e=this.gl.getActiveUniform(this.program,n);this.uniformLocations.set(e,this.gl.getUniformLocation(this.program,e.name));const t=e.name.match(/(\w+)/g);e.uniformName=t[0],e.nameComponents=t.slice(1)}this.attributeLocations=new Map;const a=[],r=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){const e=this.gl.getActiveAttrib(this.program,n),t=this.gl.getAttribLocation(this.program,e.name);-1!==t&&(a[t]=e.name,this.attributeLocations.set(e,t))}this.attributeOrder=a.join("")}setBlendFunc(e,t,s,a){this.blendFunc.src=e,this.blendFunc.dst=t,this.blendFunc.srcAlpha=s,this.blendFunc.dstAlpha=a,e&&(this.transparent=!0)}setBlendEquation(e,t){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=t}setStencilFunc(e,t,s){this.stencilRef=t,this.stencilFunc.func=e,this.stencilFunc.ref=t,this.stencilFunc.mask=s}setStencilOp(e,t,s){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=t,this.stencilOp.depthPass=s}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let t=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((e,s)=>{let a=this.uniforms[s.uniformName];for(const t of s.nameComponents){if(!a)break;if(!(t in a)){if(Array.isArray(a.value))break;a=void 0;break}a=a[t]}if(!a)return al(`Active uniform ${s.name} has not been supplied`);if(a&&void 0===a.value)return al(`${s.name} uniform is missing a value parameter`);if(a.value.texture)return t+=1,a.value.update(t),el(this.gl,s.type,e,t);if(a.value.length&&a.value[0].texture){const r=[];return a.value.forEach(e=>{t+=1,e.update(t),r.push(t)}),el(this.gl,s.type,e,r)}el(this.gl,s.type,e,a.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function el(e,t,s,a){a=a.length?function(e){const t=e.length,s=e[0].length;if(void 0===s)return e;const a=t*s;let r=Ko[a];r||(Ko[a]=r=new Float32Array(a));for(let n=0;n<t;n++)r.set(e[n],n*s);return r}(a):a;const r=e.renderer.state.uniformLocations.get(s);if(a.length)if(void 0===r||r.length!==a.length)e.renderer.state.uniformLocations.set(s,a.slice(0));else{if(function(e,t){if(e.length!==t.length)return!1;for(let s=0,a=e.length;s<a;s++)if(e[s]!==t[s])return!1;return!0}(r,a))return;r.set?r.set(a):function(e,t){for(let s=0,a=e.length;s<a;s++)e[s]=t[s]}(r,a),e.renderer.state.uniformLocations.set(s,r)}else{if(r===a)return;e.renderer.state.uniformLocations.set(s,a)}switch(t){case 5126:return a.length?e.uniform1fv(s,a):e.uniform1f(s,a);case 35664:return e.uniform2fv(s,a);case 35665:return e.uniform3fv(s,a);case 35666:return e.uniform4fv(s,a);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return a.length?e.uniform1iv(s,a):e.uniform1i(s,a);case 35671:case 35667:return e.uniform2iv(s,a);case 35672:case 35668:return e.uniform3iv(s,a);case 35673:case 35669:return e.uniform4iv(s,a);case 35674:return e.uniformMatrix2fv(s,!1,a);case 35675:return e.uniformMatrix3fv(s,!1,a);case 35676:return e.uniformMatrix4fv(s,!1,a)}}function tl(e){let t=e.split("\n");for(let s=0;s<t.length;s++)t[s]=s+1+": "+t[s];return t.join("\n")}let sl=0;function al(e){sl>100||(console.warn(e),sl++,sl>100&&console.warn("More than 100 program warnings - stopping logs."))}const rl=new Uo;let nl=1;class il{constructor({canvas:e=document.createElement("canvas"),width:t=300,height:s=150,dpr:a=1,alpha:r=!1,depth:n=!0,stencil:i=!1,antialias:o=!1,premultipliedAlpha:l=!1,preserveDrawingBuffer:c=!1,powerPreference:d="default",autoClear:u=!0,webgl:m=2}={}){const h={alpha:r,depth:n,stencil:i,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d};this.dpr=a,this.alpha=r,this.color=!0,this.depth=n,this.stencil=i,this.premultipliedAlpha=l,this.autoClear=u,this.id=nl++,2===m&&(this.gl=e.getContext("webgl2",h)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",h)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(t,s),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,t){this.width=e,this.height=t,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=t*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:t+"px"})}setViewport(e,t,s=0,a=0){this.state.viewport.width===e&&this.state.viewport.height===t||(this.state.viewport.width=e,this.state.viewport.height=t,this.state.viewport.x=s,this.state.viewport.y=a,this.gl.viewport(s,a,e,t))}setScissor(e,t,s=0,a=0){this.gl.scissor(s,a,e,t)}enable(e){!0!==this.state[e]&&(this.gl.enable(e),this.state[e]=!0)}disable(e){!1!==this.state[e]&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,t,s,a){this.state.blendFunc.src===e&&this.state.blendFunc.dst===t&&this.state.blendFunc.srcAlpha===s&&this.state.blendFunc.dstAlpha===a||(this.state.blendFunc.src=e,this.state.blendFunc.dst=t,this.state.blendFunc.srcAlpha=s,this.state.blendFunc.dstAlpha=a,void 0!==s?this.gl.blendFuncSeparate(e,t,s,a):this.gl.blendFunc(e,t))}setBlendEquation(e,t){e=e||this.gl.FUNC_ADD,this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===t||(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=t,void 0!==t?this.gl.blendEquationSeparate(e,t):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,t,s){this.state.stencilFunc===e&&this.state.stencilRef===t&&this.state.stencilFuncMask===s||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=t||0,this.state.stencilFuncMask=s||0,this.gl.stencilFunc(e||this.gl.ALWAYS,t||0,s||0))}setStencilOp(e,t,s){this.state.stencilFail===e&&this.state.stencilDepthFail===t&&this.state.stencilDepthPass===s||(this.state.stencilFail=e,this.state.stencilDepthFail=t,this.state.stencilDepthPass=s,this.gl.stencilOp(e,t,s))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:t=null}={}){this.state.framebuffer!==t&&(this.state.framebuffer=t,this.gl.bindFramebuffer(e,t))}getExtension(e,t,s){return t&&this.gl[t]?this.gl[t].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),t?this.extensions[e]?this.extensions[e][s].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:e.zDepth!==t.zDepth?e.zDepth-t.zDepth:t.id-e.id}sortTransparent(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.zDepth!==t.zDepth?t.zDepth-e.zDepth:t.id-e.id}sortUI(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program.id!==t.program.id?e.program.id-t.program.id:t.id-e.id}getRenderList({scene:e,camera:t,frustumCull:s,sort:a}){let r=[];if(t&&s&&t.updateFrustum(),e.traverse(e=>{if(!e.visible)return!0;e.draw&&(s&&e.frustumCulled&&t&&!t.frustumIntersectsMesh(e)||r.push(e))}),a){const e=[],s=[],a=[];r.forEach(r=>{r.program.transparent?r.program.depthTest?s.push(r):a.push(r):e.push(r),r.zDepth=0,0===r.renderOrder&&r.program.depthTest&&t&&(r.worldMatrix.getTranslation(rl),rl.applyMatrix4(t.projectionViewMatrix),r.zDepth=rl.z)}),e.sort(this.sortOpaque),s.sort(this.sortTransparent),a.sort(this.sortUI),r=e.concat(s,a)}return r}render({scene:e,camera:t,target:s=null,update:a=!0,sort:r=!0,frustumCull:n=!0,clear:i}){null===s?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(s),this.setViewport(s.width,s.height)),(i||this.autoClear&&!1!==i)&&(!this.depth||s&&!s.depth||(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!s||s.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),a&&e.updateMatrixWorld(),t&&t.updateMatrixWorld();this.getRenderList({scene:e,camera:t,frustumCull:n,sort:r}).forEach(e=>{e.draw({camera:t})})}}function ol(e,t,s){let a=t[0],r=t[1],n=t[2],i=t[3],o=s[0],l=s[1],c=s[2],d=s[3];return e[0]=a*d+i*o+r*c-n*l,e[1]=r*d+i*l+n*o-a*c,e[2]=n*d+i*c+a*l-r*o,e[3]=i*d-a*o-r*l-n*c,e}const ll=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},cl=function(e,t,s,a,r){return e[0]=t,e[1]=s,e[2]=a,e[3]=r,e},dl=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},ul=function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=s*s+a*a+r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=s*i,e[1]=a*i,e[2]=r*i,e[3]=n*i,e};class ml extends Array{constructor(e=0,t=0,s=0,a=1){super(e,t,s,a),this.onChange=()=>{},this._target=this;const r=["0","1","2","3"];return new Proxy(this,{set(e,t){const s=Reflect.set(...arguments);return s&&r.includes(t)&&e.onChange(),s}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){var e;return(e=this._target)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.onChange(),this}set(e,t,s,a){return e.length?this.copy(e):(cl(this._target,e,t,s,a),this.onChange(),this)}rotateX(e){return function(e,t,s){s*=.5;let a=t[0],r=t[1],n=t[2],i=t[3],o=Math.sin(s),l=Math.cos(s);e[0]=a*l+i*o,e[1]=r*l+n*o,e[2]=n*l-r*o,e[3]=i*l-a*o}(this._target,this._target,e),this.onChange(),this}rotateY(e){return function(e,t,s){s*=.5;let a=t[0],r=t[1],n=t[2],i=t[3],o=Math.sin(s),l=Math.cos(s);e[0]=a*l-n*o,e[1]=r*l+i*o,e[2]=n*l+a*o,e[3]=i*l-r*o}(this._target,this._target,e),this.onChange(),this}rotateZ(e){return function(e,t,s){s*=.5;let a=t[0],r=t[1],n=t[2],i=t[3],o=Math.sin(s),l=Math.cos(s);e[0]=a*l+r*o,e[1]=r*l-a*o,e[2]=n*l+i*o,e[3]=i*l-n*o}(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=s*s+a*a+r*r+n*n,o=i?1/i:0;e[0]=-s*o,e[1]=-a*o,e[2]=-r*o,e[3]=n*o}(this._target,e),this.onChange(),this}conjugate(e=this._target){var t,s;return t=this._target,s=e,t[0]=-s[0],t[1]=-s[1],t[2]=-s[2],t[3]=s[3],this.onChange(),this}copy(e){return ll(this._target,e),this.onChange(),this}normalize(e=this._target){return ul(this._target,e),this.onChange(),this}multiply(e,t){return t?ol(this._target,e,t):ol(this._target,this._target,e),this.onChange(),this}dot(e){return dl(this._target,e)}fromMatrix3(e){return function(e,t){let s,a=t[0]+t[4]+t[8];if(a>0)s=Math.sqrt(a+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);let r=(a+1)%3,n=(a+2)%3;s=Math.sqrt(t[3*a+a]-t[3*r+r]-t[3*n+n]+1),e[a]=.5*s,s=.5/s,e[3]=(t[3*r+n]-t[3*n+r])*s,e[r]=(t[3*r+a]+t[3*a+r])*s,e[n]=(t[3*n+a]+t[3*a+n])*s}}(this._target,e),this.onChange(),this}fromEuler(e,t){return function(e,t,s="YXZ"){let a=Math.sin(.5*t[0]),r=Math.cos(.5*t[0]),n=Math.sin(.5*t[1]),i=Math.cos(.5*t[1]),o=Math.sin(.5*t[2]),l=Math.cos(.5*t[2]);"XYZ"===s?(e[0]=a*i*l+r*n*o,e[1]=r*n*l-a*i*o,e[2]=r*i*o+a*n*l,e[3]=r*i*l-a*n*o):"YXZ"===s?(e[0]=a*i*l+r*n*o,e[1]=r*n*l-a*i*o,e[2]=r*i*o-a*n*l,e[3]=r*i*l+a*n*o):"ZXY"===s?(e[0]=a*i*l-r*n*o,e[1]=r*n*l+a*i*o,e[2]=r*i*o+a*n*l,e[3]=r*i*l-a*n*o):"ZYX"===s?(e[0]=a*i*l-r*n*o,e[1]=r*n*l+a*i*o,e[2]=r*i*o-a*n*l,e[3]=r*i*l+a*n*o):"YZX"===s?(e[0]=a*i*l+r*n*o,e[1]=r*n*l+a*i*o,e[2]=r*i*o-a*n*l,e[3]=r*i*l-a*n*o):"XZY"===s&&(e[0]=a*i*l-r*n*o,e[1]=r*n*l-a*i*o,e[2]=r*i*o+a*n*l,e[3]=r*i*l+a*n*o)}(this._target,e,e.order),t||this.onChange(),this}fromAxisAngle(e,t){return function(e,t,s){s*=.5;let a=Math.sin(s);e[0]=a*t[0],e[1]=a*t[1],e[2]=a*t[2],e[3]=Math.cos(s)}(this._target,e,t),this.onChange(),this}slerp(e,t){return function(e,t,s,a){let r,n,i,o,l,c=t[0],d=t[1],u=t[2],m=t[3],h=s[0],g=s[1],p=s[2],x=s[3];n=c*h+d*g+u*p+m*x,n<0&&(n=-n,h=-h,g=-g,p=-p,x=-x),1-n>1e-6?(r=Math.acos(n),i=Math.sin(r),o=Math.sin((1-a)*r)/i,l=Math.sin(a*r)/i):(o=1-a,l=a),e[0]=o*c+l*h,e[1]=o*d+l*g,e[2]=o*u+l*p,e[3]=o*m+l*x}(this._target,this._target,e,t),this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this._target[3]=e[t+3],this.onChange(),this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}}function hl(e){let t=e[0],s=e[1],a=e[2],r=e[3],n=e[4],i=e[5],o=e[6],l=e[7],c=e[8],d=e[9],u=e[10],m=e[11],h=e[12],g=e[13],p=e[14],x=e[15];return(t*i-s*n)*(u*x-m*p)-(t*o-a*n)*(d*x-m*g)+(t*l-r*n)*(d*p-u*g)+(s*o-a*i)*(c*x-m*h)-(s*l-r*i)*(c*p-u*h)+(a*l-r*o)*(c*g-d*h)}function gl(e,t,s){let a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=t[9],h=t[10],g=t[11],p=t[12],x=t[13],f=t[14],b=t[15],y=s[0],v=s[1],j=s[2],w=s[3];return e[0]=y*a+v*o+j*u+w*p,e[1]=y*r+v*l+j*m+w*x,e[2]=y*n+v*c+j*h+w*f,e[3]=y*i+v*d+j*g+w*b,y=s[4],v=s[5],j=s[6],w=s[7],e[4]=y*a+v*o+j*u+w*p,e[5]=y*r+v*l+j*m+w*x,e[6]=y*n+v*c+j*h+w*f,e[7]=y*i+v*d+j*g+w*b,y=s[8],v=s[9],j=s[10],w=s[11],e[8]=y*a+v*o+j*u+w*p,e[9]=y*r+v*l+j*m+w*x,e[10]=y*n+v*c+j*h+w*f,e[11]=y*i+v*d+j*g+w*b,y=s[12],v=s[13],j=s[14],w=s[15],e[12]=y*a+v*o+j*u+w*p,e[13]=y*r+v*l+j*m+w*x,e[14]=y*n+v*c+j*h+w*f,e[15]=y*i+v*d+j*g+w*b,e}function pl(e,t){let s=t[0],a=t[1],r=t[2],n=t[4],i=t[5],o=t[6],l=t[8],c=t[9],d=t[10];return e[0]=Math.hypot(s,a,r),e[1]=Math.hypot(n,i,o),e[2]=Math.hypot(l,c,d),e}const xl=function(){const e=[1,1,1];return function(t,s){let a=e;pl(a,s);let r=1/a[0],n=1/a[1],i=1/a[2],o=s[0]*r,l=s[1]*n,c=s[2]*i,d=s[4]*r,u=s[5]*n,m=s[6]*i,h=s[8]*r,g=s[9]*n,p=s[10]*i,x=o+u+p,f=0;return x>0?(f=2*Math.sqrt(x+1),t[3]=.25*f,t[0]=(m-g)/f,t[1]=(h-c)/f,t[2]=(l-d)/f):o>u&&o>p?(f=2*Math.sqrt(1+o-u-p),t[3]=(m-g)/f,t[0]=.25*f,t[1]=(l+d)/f,t[2]=(h+c)/f):u>p?(f=2*Math.sqrt(1+u-o-p),t[3]=(h-c)/f,t[0]=(l+d)/f,t[1]=.25*f,t[2]=(m+g)/f):(f=2*Math.sqrt(1+p-o-u),t[3]=(l-d)/f,t[0]=(h+c)/f,t[1]=(m+g)/f,t[2]=.25*f),t}}();function fl(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e[8]=t[8]+s[8],e[9]=t[9]+s[9],e[10]=t[10]+s[10],e[11]=t[11]+s[11],e[12]=t[12]+s[12],e[13]=t[13]+s[13],e[14]=t[14]+s[14],e[15]=t[15]+s[15],e}function bl(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e[6]=t[6]-s[6],e[7]=t[7]-s[7],e[8]=t[8]-s[8],e[9]=t[9]-s[9],e[10]=t[10]-s[10],e[11]=t[11]-s[11],e[12]=t[12]-s[12],e[13]=t[13]-s[13],e[14]=t[14]-s[14],e[15]=t[15]-s[15],e}class yl extends Array{constructor(e=1,t=0,s=0,a=0,r=0,n=1,i=0,o=0,l=0,c=0,d=1,u=0,m=0,h=0,g=0,p=1){return super(e,t,s,a,r,n,i,o,l,c,d,u,m,h,g,p),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,t,s,a,r,n,i,o,l,c,d,u,m,h,g,p){return e.length?this.copy(e):(function(e,t,s,a,r,n,i,o,l,c,d,u,m,h,g,p,x){e[0]=t,e[1]=s,e[2]=a,e[3]=r,e[4]=n,e[5]=i,e[6]=o,e[7]=l,e[8]=c,e[9]=d,e[10]=u,e[11]=m,e[12]=h,e[13]=g,e[14]=p,e[15]=x}(this,e,t,s,a,r,n,i,o,l,c,d,u,m,h,g,p),this)}translate(e,t=this){return function(e,t,s){let a,r,n,i,o,l,c,d,u,m,h,g,p=s[0],x=s[1],f=s[2];t===e?(e[12]=t[0]*p+t[4]*x+t[8]*f+t[12],e[13]=t[1]*p+t[5]*x+t[9]*f+t[13],e[14]=t[2]*p+t[6]*x+t[10]*f+t[14],e[15]=t[3]*p+t[7]*x+t[11]*f+t[15]):(a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=t[9],h=t[10],g=t[11],e[0]=a,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=l,e[6]=c,e[7]=d,e[8]=u,e[9]=m,e[10]=h,e[11]=g,e[12]=a*p+o*x+u*f+t[12],e[13]=r*p+l*x+m*f+t[13],e[14]=n*p+c*x+h*f+t[14],e[15]=i*p+d*x+g*f+t[15])}(this,t,e),this}rotate(e,t,s=this){return function(e,t,s,a){let r,n,i,o,l,c,d,u,m,h,g,p,x,f,b,y,v,j,w,_,N,k,E,S,T=a[0],C=a[1],I=a[2],A=Math.hypot(T,C,I);Math.abs(A)<1e-6||(A=1/A,T*=A,C*=A,I*=A,r=Math.sin(s),n=Math.cos(s),i=1-n,o=t[0],l=t[1],c=t[2],d=t[3],u=t[4],m=t[5],h=t[6],g=t[7],p=t[8],x=t[9],f=t[10],b=t[11],y=T*T*i+n,v=C*T*i+I*r,j=I*T*i-C*r,w=T*C*i-I*r,_=C*C*i+n,N=I*C*i+T*r,k=T*I*i+C*r,E=C*I*i-T*r,S=I*I*i+n,e[0]=o*y+u*v+p*j,e[1]=l*y+m*v+x*j,e[2]=c*y+h*v+f*j,e[3]=d*y+g*v+b*j,e[4]=o*w+u*_+p*N,e[5]=l*w+m*_+x*N,e[6]=c*w+h*_+f*N,e[7]=d*w+g*_+b*N,e[8]=o*k+u*E+p*S,e[9]=l*k+m*E+x*S,e[10]=c*k+h*E+f*S,e[11]=d*k+g*E+b*S,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,s,e,t),this}scale(e,t=this){return function(e,t,s){let a=s[0],r=s[1],n=s[2];e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}(this,t,"number"==typeof e?[e,e,e]:e),this}add(e,t){return t?fl(this,e,t):fl(this,this,e),this}sub(e,t){return t?bl(this,e,t):bl(this,this,e),this}multiply(e,t){var s,a,r;return e.length?t?gl(this,e,t):gl(this,this,e):(a=this,r=e,(s=this)[0]=a[0]*r,s[1]=a[1]*r,s[2]=a[2]*r,s[3]=a[3]*r,s[4]=a[4]*r,s[5]=a[5]*r,s[6]=a[6]*r,s[7]=a[7]*r,s[8]=a[8]*r,s[9]=a[9]*r,s[10]=a[10]*r,s[11]=a[11]*r,s[12]=a[12]*r,s[13]=a[13]*r,s[14]=a[14]*r,s[15]=a[15]*r),this}identity(){var e;return(e=this)[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}copy(e){var t,s;return s=e,(t=this)[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],this}fromPerspective({fov:e,aspect:t,near:s,far:a}={}){return function(e,t,s,a,r){let n=1/Math.tan(t/2),i=1/(a-r);e[0]=n/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*i,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*i,e[15]=0}(this,e,t,s,a),this}fromOrthogonal({left:e,right:t,bottom:s,top:a,near:r,far:n}){return function(e,t,s,a,r,n,i){let o=1/(t-s),l=1/(a-r),c=1/(n-i);e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+s)*o,e[13]=(r+a)*l,e[14]=(i+n)*c,e[15]=1}(this,e,t,s,a,r,n),this}fromQuaternion(e){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=s+s,o=a+a,l=r+r,c=s*i,d=a*i,u=a*o,m=r*i,h=r*o,g=r*l,p=n*i,x=n*o,f=n*l;e[0]=1-u-g,e[1]=d+f,e[2]=m-x,e[3]=0,e[4]=d-f,e[5]=1-c-g,e[6]=h+p,e[7]=0,e[8]=m+x,e[9]=h-p,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=t[4],o=t[5],l=t[6],c=t[7],d=t[8],u=t[9],m=t[10],h=t[11],g=t[12],p=t[13],x=t[14],f=t[15],b=s*o-a*i,y=s*l-r*i,v=s*c-n*i,j=a*l-r*o,w=a*c-n*o,_=r*c-n*l,N=d*p-u*g,k=d*x-m*g,E=d*f-h*g,S=u*x-m*p,T=u*f-h*p,C=m*f-h*x,I=b*C-y*T+v*S+j*E-w*k+_*N;I&&(I=1/I,e[0]=(o*C-l*T+c*S)*I,e[1]=(r*T-a*C-n*S)*I,e[2]=(p*_-x*w+f*j)*I,e[3]=(m*w-u*_-h*j)*I,e[4]=(l*E-i*C-c*k)*I,e[5]=(s*C-r*E+n*k)*I,e[6]=(x*v-g*_-f*y)*I,e[7]=(d*_-m*v+h*y)*I,e[8]=(i*T-o*E+c*N)*I,e[9]=(a*E-s*T-n*N)*I,e[10]=(g*w-p*v+f*b)*I,e[11]=(u*v-d*w-h*b)*I,e[12]=(o*k-i*S-l*N)*I,e[13]=(s*S-a*k+r*N)*I,e[14]=(p*y-g*j-x*b)*I,e[15]=(d*j-u*y+m*b)*I)}(this,e),this}compose(e,t,s){return function(e,t,s,a){const r=e,n=t[0],i=t[1],o=t[2],l=t[3],c=n+n,d=i+i,u=o+o,m=n*c,h=n*d,g=n*u,p=i*d,x=i*u,f=o*u,b=l*c,y=l*d,v=l*u,j=a[0],w=a[1],_=a[2];r[0]=(1-(p+f))*j,r[1]=(h+v)*j,r[2]=(g-y)*j,r[3]=0,r[4]=(h-v)*w,r[5]=(1-(m+f))*w,r[6]=(x+b)*w,r[7]=0,r[8]=(g+y)*_,r[9]=(x-b)*_,r[10]=(1-(m+p))*_,r[11]=0,r[12]=s[0],r[13]=s[1],r[14]=s[2],r[15]=1}(this,e,t,s),this}decompose(e,t,s){return function(e,t,s,a){let r=Oo([e[0],e[1],e[2]]);const n=Oo([e[4],e[5],e[6]]),i=Oo([e[8],e[9],e[10]]);hl(e)<0&&(r=-r),s[0]=e[12],s[1]=e[13],s[2]=e[14];const o=e.slice(),l=1/r,c=1/n,d=1/i;o[0]*=l,o[1]*=l,o[2]*=l,o[4]*=c,o[5]*=c,o[6]*=c,o[8]*=d,o[9]*=d,o[10]*=d,xl(t,o),a[0]=r,a[1]=n,a[2]=i}(this,e,t,s),this}getRotation(e){return xl(e,this),this}getTranslation(e){var t,s;return s=this,(t=e)[0]=s[12],t[1]=s[13],t[2]=s[14],this}getScaling(e){return pl(e,this),this}getMaxScaleOnAxis(){return function(e){let t=e[0],s=e[1],a=e[2],r=e[4],n=e[5],i=e[6],o=e[8],l=e[9],c=e[10];const d=t*t+s*s+a*a,u=r*r+n*n+i*i,m=o*o+l*l+c*c;return Math.sqrt(Math.max(d,u,m))}(this)}lookAt(e,t,s){return function(e,t,s,a){let r=t[0],n=t[1],i=t[2],o=a[0],l=a[1],c=a[2],d=r-s[0],u=n-s[1],m=i-s[2],h=d*d+u*u+m*m;0===h?m=1:(h=1/Math.sqrt(h),d*=h,u*=h,m*=h);let g=l*m-c*u,p=c*d-o*m,x=o*u-l*d;h=g*g+p*p+x*x,0===h&&(c?o+=1e-6:l?c+=1e-6:l+=1e-6,g=l*m-c*u,p=c*d-o*m,x=o*u-l*d,h=g*g+p*p+x*x),h=1/Math.sqrt(h),g*=h,p*=h,x*=h,e[0]=g,e[1]=p,e[2]=x,e[3]=0,e[4]=u*x-m*p,e[5]=m*g-d*x,e[6]=d*p-u*g,e[7]=0,e[8]=d,e[9]=u,e[10]=m,e[11]=0,e[12]=r,e[13]=n,e[14]=i,e[15]=1}(this,e,t,s),this}determinant(){return hl(this)}fromArray(e,t=0){return this[0]=e[t],this[1]=e[t+1],this[2]=e[t+2],this[3]=e[t+3],this[4]=e[t+4],this[5]=e[t+5],this[6]=e[t+6],this[7]=e[t+7],this[8]=e[t+8],this[9]=e[t+9],this[10]=e[t+10],this[11]=e[t+11],this[12]=e[t+12],this[13]=e[t+13],this[14]=e[t+14],this[15]=e[t+15],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e[t+4]=this[4],e[t+5]=this[5],e[t+6]=this[6],e[t+7]=this[7],e[t+8]=this[8],e[t+9]=this[9],e[t+10]=this[10],e[t+11]=this[11],e[t+12]=this[12],e[t+13]=this[13],e[t+14]=this[14],e[t+15]=this[15],e}}const vl=new yl;class jl extends Array{constructor(e=0,t=e,s=e,a="YXZ"){super(e,t,s),this.order=a,this.onChange=()=>{},this._target=this;const r=["0","1","2"];return new Proxy(this,{set(e,t){const s=Reflect.set(...arguments);return s&&r.includes(t)&&e.onChange(),s}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,t=e,s=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=t,this._target[2]=s,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,t=this.order){return function(e,t,s="YXZ"){"XYZ"===s?(e[1]=Math.asin(Math.min(Math.max(t[8],-1),1)),Math.abs(t[8])<.99999?(e[0]=Math.atan2(-t[9],t[10]),e[2]=Math.atan2(-t[4],t[0])):(e[0]=Math.atan2(t[6],t[5]),e[2]=0)):"YXZ"===s?(e[0]=Math.asin(-Math.min(Math.max(t[9],-1),1)),Math.abs(t[9])<.99999?(e[1]=Math.atan2(t[8],t[10]),e[2]=Math.atan2(t[1],t[5])):(e[1]=Math.atan2(-t[2],t[0]),e[2]=0)):"ZXY"===s?(e[0]=Math.asin(Math.min(Math.max(t[6],-1),1)),Math.abs(t[6])<.99999?(e[1]=Math.atan2(-t[2],t[10]),e[2]=Math.atan2(-t[4],t[5])):(e[1]=0,e[2]=Math.atan2(t[1],t[0]))):"ZYX"===s?(e[1]=Math.asin(-Math.min(Math.max(t[2],-1),1)),Math.abs(t[2])<.99999?(e[0]=Math.atan2(t[6],t[10]),e[2]=Math.atan2(t[1],t[0])):(e[0]=0,e[2]=Math.atan2(-t[4],t[5]))):"YZX"===s?(e[2]=Math.asin(Math.min(Math.max(t[1],-1),1)),Math.abs(t[1])<.99999?(e[0]=Math.atan2(-t[9],t[5]),e[1]=Math.atan2(-t[2],t[0])):(e[0]=0,e[1]=Math.atan2(t[8],t[10]))):"XZY"===s&&(e[2]=Math.asin(-Math.min(Math.max(t[4],-1),1)),Math.abs(t[4])<.99999?(e[0]=Math.atan2(t[6],t[5]),e[1]=Math.atan2(t[8],t[0])):(e[0]=Math.atan2(-t[9],t[10]),e[1]=0))}(this._target,e,t),this.onChange(),this}fromQuaternion(e,t=this.order,s){return vl.fromQuaternion(e),this._target.fromRotationMatrix(vl,t),s||this.onChange(),this}fromArray(e,t=0){return this._target[0]=e[t],this._target[1]=e[t+1],this._target[2]=e[t+2],this}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}}class wl{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new yl,this.worldMatrix=new yl,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Uo,this.quaternion=new ml,this.scale=new Uo(1),this.rotation=new jl,this.up=new Uo(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,t=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,t&&e&&e.addChild(this,!1)}addChild(e,t=!0){~this.children.indexOf(e)||this.children.push(e),t&&e.setParent(this,!1)}removeChild(e,t=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),t&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(null===this.parent?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let t=0,s=this.children.length;t<s;t++)this.children[t].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let t=0,s=this.children.length;t<s;t++)this.children[t].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,t=!1){t?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function _l(e,t,s){let a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=s[0],h=s[1],g=s[2],p=s[3],x=s[4],f=s[5],b=s[6],y=s[7],v=s[8];return e[0]=m*a+h*i+g*c,e[1]=m*r+h*o+g*d,e[2]=m*n+h*l+g*u,e[3]=p*a+x*i+f*c,e[4]=p*r+x*o+f*d,e[5]=p*n+x*l+f*u,e[6]=b*a+y*i+v*c,e[7]=b*r+y*o+v*d,e[8]=b*n+y*l+v*u,e}class Nl extends Array{constructor(e=1,t=0,s=0,a=0,r=1,n=0,i=0,o=0,l=1){return super(e,t,s,a,r,n,i,o,l),this}set(e,t,s,a,r,n,i,o,l){return e.length?this.copy(e):(function(e,t,s,a,r,n,i,o,l,c){e[0]=t,e[1]=s,e[2]=a,e[3]=r,e[4]=n,e[5]=i,e[6]=o,e[7]=l,e[8]=c}(this,e,t,s,a,r,n,i,o,l),this)}translate(e,t=this){return function(e,t,s){let a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=s[0],h=s[1];e[0]=a,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=l,e[6]=m*a+h*i+c,e[7]=m*r+h*o+d,e[8]=m*n+h*l+u}(this,t,e),this}rotate(e,t=this){return function(e,t,s){let a=t[0],r=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],u=t[8],m=Math.sin(s),h=Math.cos(s);e[0]=h*a+m*i,e[1]=h*r+m*o,e[2]=h*n+m*l,e[3]=h*i-m*a,e[4]=h*o-m*r,e[5]=h*l-m*n,e[6]=c,e[7]=d,e[8]=u}(this,t,e),this}scale(e,t=this){return function(e,t,s){let a=s[0],r=s[1];e[0]=a*t[0],e[1]=a*t[1],e[2]=a*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]}(this,t,e),this}multiply(e,t){return t?_l(this,e,t):_l(this,this,e),this}identity(){var e;return(e=this)[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,this}copy(e){var t,s;return s=e,(t=this)[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],this}fromMatrix4(e){var t,s;return s=e,(t=this)[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[4],t[4]=s[5],t[5]=s[6],t[6]=s[8],t[7]=s[9],t[8]=s[10],this}fromQuaternion(e){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=s+s,o=a+a,l=r+r,c=s*i,d=a*i,u=a*o,m=r*i,h=r*o,g=r*l,p=n*i,x=n*o,f=n*l;e[0]=1-u-g,e[3]=d-f,e[6]=m+x,e[1]=d+f,e[4]=1-c-g,e[7]=h-p,e[2]=m-x,e[5]=h+p,e[8]=1-c-u}(this,e),this}fromBasis(e,t,s){return this.set(e[0],e[1],e[2],t[0],t[1],t[2],s[0],s[1],s[2]),this}inverse(e=this){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=t[4],o=t[5],l=t[6],c=t[7],d=t[8],u=d*i-o*c,m=-d*n+o*l,h=c*n-i*l,g=s*u+a*m+r*h;g&&(g=1/g,e[0]=u*g,e[1]=(-d*a+r*c)*g,e[2]=(o*a-r*i)*g,e[3]=m*g,e[4]=(d*s-r*l)*g,e[5]=(-o*s+r*n)*g,e[6]=h*g,e[7]=(-c*s+a*l)*g,e[8]=(i*s-a*n)*g)}(this,e),this}getNormalMatrix(e){return function(e,t){let s=t[0],a=t[1],r=t[2],n=t[3],i=t[4],o=t[5],l=t[6],c=t[7],d=t[8],u=t[9],m=t[10],h=t[11],g=t[12],p=t[13],x=t[14],f=t[15],b=s*o-a*i,y=s*l-r*i,v=s*c-n*i,j=a*l-r*o,w=a*c-n*o,_=r*c-n*l,N=d*p-u*g,k=d*x-m*g,E=d*f-h*g,S=u*x-m*p,T=u*f-h*p,C=m*f-h*x,I=b*C-y*T+v*S+j*E-w*k+_*N;I&&(I=1/I,e[0]=(o*C-l*T+c*S)*I,e[1]=(l*E-i*C-c*k)*I,e[2]=(i*T-o*E+c*N)*I,e[3]=(r*T-a*C-n*S)*I,e[4]=(s*C-r*E+n*k)*I,e[5]=(a*E-s*T-n*N)*I,e[6]=(p*_-x*w+f*j)*I,e[7]=(x*v-g*_-f*y)*I,e[8]=(g*w-p*v+f*b)*I)}(this,e),this}}let kl=0;class El extends wl{constructor(e,{geometry:t,program:s,mode:a=e.TRIANGLES,frustumCulled:r=!0,renderOrder:n=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=kl++,this.geometry=t,this.program=s,this.mode=a,this.frustumCulled=r,this.renderOrder=n,this.modelViewMatrix=new yl,this.normalMatrix=new Nl,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(t=>t&&t({mesh:this,camera:e}));let t=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:t}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(t=>t&&t({mesh:this,camera:e}))}}class Sl extends Xo{constructor(e,{attributes:t={}}={}){Object.assign(t,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,t)}}const Tl=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]:[1,1,1]},Cl=(e,t,s)=>{switch(e){case"top-left":return{anchor:[0,-.2*s],dir:[0,1]};case"top-right":return{anchor:[t,-.2*s],dir:[0,1]};case"left":return{anchor:[-.2*t,.5*s],dir:[1,0]};case"right":return{anchor:[1.2*t,.5*s],dir:[-1,0]};case"bottom-left":return{anchor:[0,1.2*s],dir:[0,-1]};case"bottom-center":return{anchor:[.5*t,1.2*s],dir:[0,-1]};case"bottom-right":return{anchor:[t,1.2*s],dir:[0,-1]};default:return{anchor:[.5*t,-.2*s],dir:[0,1]}}},Il=({raysOrigin:e="top-center",raysColor:t="#ffffff",raysSpeed:s=1,lightSpread:a=1,rayLength:i=2,pulsating:o=!1,fadeDistance:l=1,saturation:c=1,followMouse:d=!0,mouseInfluence:u=.1,noiseAmount:m=0,distortion:h=0,className:g=""})=>{const p=r.useRef(null),x=r.useRef(null),f=r.useRef(null),b=r.useRef({x:.5,y:.5}),y=r.useRef({x:.5,y:.5}),v=r.useRef(null),j=r.useRef(null),w=r.useRef(null),[_,N]=r.useState(!1),k=r.useRef(null);return r.useEffect(()=>{if(p.current)return k.current=new IntersectionObserver(e=>{const t=e[0];N(t.isIntersecting)},{threshold:.1}),k.current.observe(p.current),()=>{k.current&&(k.current.disconnect(),k.current=null)}},[]),r.useEffect(()=>{if(!_||!p.current)return;w.current&&(w.current(),w.current=null);return(async()=>{if(!p.current)return;if(await new Promise(e=>setTimeout(e,10)),!p.current)return;const r=new il({dpr:Math.min(window.devicePixelRatio,2),alpha:!0});f.current=r;const n=r.gl;for(n.canvas.style.width="100%",n.canvas.style.height="100%";p.current.firstChild;)p.current.removeChild(p.current.firstChild);p.current.appendChild(n.canvas);const g={iTime:{value:0},iResolution:{value:[1,1]},rayPos:{value:[0,0]},rayDir:{value:[0,1]},raysColor:{value:Tl(t)},raysSpeed:{value:s},lightSpread:{value:a},rayLength:{value:i},pulsating:{value:o?1:0},fadeDistance:{value:l},saturation:{value:c},mousePos:{value:[.5,.5]},mouseInfluence:{value:u},noiseAmount:{value:m},distortion:{value:h}};x.current=g;const _=new Sl(n),N=new Zo(n,{vertex:"\nattribute vec2 position;\nvarying vec2 vUv;\nvoid main() {\n  vUv = position * 0.5 + 0.5;\n  gl_Position = vec4(position, 0.0, 1.0);\n}",fragment:"precision highp float;\n\nuniform float iTime;\nuniform vec2  iResolution;\n\nuniform vec2  rayPos;\nuniform vec2  rayDir;\nuniform vec3  raysColor;\nuniform float raysSpeed;\nuniform float lightSpread;\nuniform float rayLength;\nuniform float pulsating;\nuniform float fadeDistance;\nuniform float saturation;\nuniform vec2  mousePos;\nuniform float mouseInfluence;\nuniform float noiseAmount;\nuniform float distortion;\n\nvarying vec2 vUv;\n\nfloat noise(vec2 st) {\n  return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);\n}\n\nfloat rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord,\n                  float seedA, float seedB, float speed) {\n  vec2 sourceToCoord = coord - raySource;\n  vec2 dirNorm = normalize(sourceToCoord);\n  float cosAngle = dot(dirNorm, rayRefDirection);\n\n  float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2;\n  \n  float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001));\n\n  float distance = length(sourceToCoord);\n  float maxDistance = iResolution.x * rayLength;\n  float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);\n  \n  float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);\n  float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;\n\n  float baseStrength = clamp(\n    (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +\n    (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),\n    0.0, 1.0\n  );\n\n  return baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);\n  \n  vec2 finalRayDir = rayDir;\n  if (mouseInfluence > 0.0) {\n    vec2 mouseScreenPos = mousePos * iResolution.xy;\n    vec2 mouseDirection = normalize(mouseScreenPos - rayPos);\n    finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));\n  }\n\n  vec4 rays1 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349,\n                           1.5 * raysSpeed);\n  vec4 rays2 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234,\n                           1.1 * raysSpeed);\n\n  fragColor = rays1 * 0.5 + rays2 * 0.4;\n\n  if (noiseAmount > 0.0) {\n    float n = noise(coord * 0.01 + iTime * 0.1);\n    fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);\n  }\n\n  float brightness = 1.0 - (coord.y / iResolution.y);\n  fragColor.x *= 0.1 + brightness * 0.8;\n  fragColor.y *= 0.3 + brightness * 0.6;\n  fragColor.z *= 0.5 + brightness * 0.5;\n\n  if (saturation != 1.0) {\n    float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));\n    fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);\n  }\n\n  fragColor.rgb *= raysColor;\n}\n\nvoid main() {\n  vec4 color;\n  mainImage(color, gl_FragCoord.xy);\n  gl_FragColor  = color;\n}",uniforms:g}),k=new El(n,{geometry:_,program:N});j.current=k;const E=()=>{if(!p.current||!r)return;r.dpr=Math.min(window.devicePixelRatio,2);const{clientWidth:t,clientHeight:s}=p.current;r.setSize(t,s);const a=r.dpr,n=t*a,i=s*a;g.iResolution.value=[n,i];const{anchor:o,dir:l}=Cl(e,n,i);g.rayPos.value=o,g.rayDir.value=l},S=e=>{if(f.current&&x.current&&j.current){if(g.iTime.value=.001*e,d&&u>0){const e=.92;y.current.x=y.current.x*e+b.current.x*(1-e),y.current.y=y.current.y*e+b.current.y*(1-e),g.mousePos.value=[y.current.x,y.current.y]}try{r.render({scene:k}),v.current=requestAnimationFrame(S)}catch(t){return void console.warn("WebGL rendering error:",t)}}};window.addEventListener("resize",E),E(),v.current=requestAnimationFrame(S),w.current=()=>{if(v.current&&(cancelAnimationFrame(v.current),v.current=null),window.removeEventListener("resize",E),r)try{const e=r.gl.canvas,t=r.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),e&&e.parentNode&&e.parentNode.removeChild(e)}catch(e){console.warn("Error during WebGL cleanup:",e)}f.current=null,x.current=null,j.current=null}})(),()=>{w.current&&(w.current(),w.current=null)}},[_,e,t,s,a,i,o,l,c,d,u,m,h]),r.useEffect(()=>{if(!x.current||!p.current||!f.current)return;const r=x.current,n=f.current;r.raysColor.value=Tl(t),r.raysSpeed.value=s,r.lightSpread.value=a,r.rayLength.value=i,r.pulsating.value=o?1:0,r.fadeDistance.value=l,r.saturation.value=c,r.mouseInfluence.value=u,r.noiseAmount.value=m,r.distortion.value=h;const{clientWidth:d,clientHeight:g}=p.current,b=n.dpr,{anchor:y,dir:v}=Cl(e,d*b,g*b);r.rayPos.value=y,r.rayDir.value=v},[t,s,a,e,i,o,l,c,u,m,h]),r.useEffect(()=>{const e=e=>{if(!p.current||!f.current)return;const t=p.current.getBoundingClientRect(),s=(e.clientX-t.left)/t.width,a=(e.clientY-t.top)/t.height;b.current={x:s,y:a}};if(d)return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[d]),n.jsx("div",{ref:p,className:`light-rays-container ${g}`.trim()})},Al=({score:e,totalQuestions:t,timeTaken:s,answers:a,questions:r,onRetake:i,onContinue:l,testTitle:c})=>{const d=o(),{t:u}=w(),m=Math.round(e/t*100),h=Lo(e,"academic-reading"),g=r.filter(e=>{var t,s;return(null==(t=a[e.id])?void 0:t.toLowerCase().trim())===(null==(s=e.correct_answer)?void 0:s.toLowerCase().trim())}),p=r.filter(e=>{var t,s;return a[e.id]&&(null==(t=a[e.id])?void 0:t.toLowerCase().trim())!==(null==(s=e.correct_answer)?void 0:s.toLowerCase().trim())}),x=r.filter(e=>!a[e.id]);return n.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6 relative",children:[n.jsx(Il,{raysOrigin:"top-right",raysColor:"#F59E0B",raysSpeed:.6,lightSpread:1.2,rayLength:1.5,pulsating:!0,fadeDistance:1,saturation:.8,followMouse:!0,mouseInfluence:.1,noiseAmount:.12,distortion:.25}),n.jsxs(Rr,{className:"rounded-2xl border-light-border shadow-soft",style:{background:"var(--gradient-card)"},children:[n.jsxs(Dr,{className:"text-center pb-4",children:[n.jsx(Fr,{className:"text-3xl font-georgia text-foreground mb-2",children:u("testResults.viewResults",{defaultValue:"View Results"})}),c&&n.jsx("p",{className:"text-warm-gray",children:c})]}),n.jsxs(Br,{className:"text-center",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"text-4xl font-bold text-foreground",children:[e,"/",t]}),n.jsx("p",{className:"text-sm text-warm-gray",children:u("testResults.correctAnswers",{defaultValue:"Correct Answers"})}),n.jsxs(xo,{variant:"outline",className:"text-lg px-3 py-1",children:[m,"%"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-4xl font-bold text-primary",children:h}),n.jsx("p",{className:"text-sm text-warm-gray",children:u("testResults.band",{defaultValue:"Band"})}),n.jsx(Mo,{value:m,className:"w-full h-2"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(ge,{className:"w-8 h-8 text-primary mx-auto"}),n.jsx("p",{className:"text-sm text-warm-gray",children:u("testResults.performance",{defaultValue:"Performance"})}),n.jsx(xo,{variant:m>=70?"default":m>=50?"secondary":"destructive",className:"text-sm px-3 py-1",children:m>=70?u("testResults.excellent",{defaultValue:"Excellent"}):m>=50?u("testResults.good",{defaultValue:"Good"}):u("testResults.needsWork",{defaultValue:"Needs Work"})})]})]}),n.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[n.jsxs(qr,{variant:"outline",onClick:()=>d("/dashboard"),className:"rounded-xl px-6",children:[n.jsx(ht,{className:"w-4 h-4 mr-2"}),u("header.dashboard",{defaultValue:"Dashboard"})]}),n.jsxs(qr,{variant:"outline",onClick:i,className:"rounded-xl px-6",children:[n.jsx(gt,{className:"w-4 h-4 mr-2"}),u("testResults.retakeTest",{defaultValue:"Retake Test"})]}),n.jsxs(qr,{onClick:l,className:"rounded-xl px-6",style:{background:"var(--gradient-button)"},children:[u("testResults.continuePractice",{defaultValue:"Continue Practice"}),n.jsx(je,{className:"w-4 h-4 ml-2"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(Rr,{className:"rounded-2xl border-light-border shadow-soft",children:[n.jsx(Dr,{children:n.jsx(Fr,{className:"text-xl font-georgia text-foreground",children:u("testResults.summary",{defaultValue:"Summary"})})}),n.jsxs(Br,{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(et,{className:"w-5 h-5 text-green-500"}),n.jsx("span",{className:"text-foreground",children:u("testResults.correct",{defaultValue:"Correct"})})]}),n.jsx(xo,{variant:"outline",className:"bg-green-50 text-green-700",children:g.length})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(pt,{className:"w-5 h-5 text-red-500"}),n.jsx("span",{className:"text-foreground",children:u("testResults.incorrect",{defaultValue:"Incorrect"})})]}),n.jsx(xo,{variant:"outline",className:"bg-red-50 text-red-700",children:p.length})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-400"}),n.jsx("span",{className:"text-foreground",children:u("testResults.skipped",{defaultValue:"Skipped"})})]}),n.jsx(xo,{variant:"outline",className:"bg-gray-50 text-gray-700",children:x.length})]})]})]}),n.jsxs(Rr,{className:"rounded-2xl border-light-border shadow-soft",children:[n.jsx(Dr,{children:n.jsx(Fr,{className:"text-xl font-georgia text-foreground",children:u("testResults.questionTypes",{defaultValue:"Question Types"})})}),n.jsx(Br,{children:(()=>{const e=r.reduce((e,t)=>{var s,r;const n=t.question_type||"Unknown";return e[n]||(e[n]={correct:0,total:0}),e[n].total++,(null==(s=a[t.id])?void 0:s.toLowerCase().trim())===(null==(r=t.correct_answer)?void 0:r.toLowerCase().trim())&&e[n].correct++,e},{});return Object.entries(e).map(([e,t])=>n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("span",{className:"text-sm font-medium text-foreground",children:e}),n.jsxs("span",{className:"text-xs text-warm-gray",children:[t.correct,"/",t.total]})]}),n.jsx(Mo,{value:t.correct/t.total*100,className:"h-2"})]},e))})()})]})]}),n.jsxs(Rr,{className:"rounded-2xl border-light-border shadow-soft",children:[n.jsx(Dr,{children:n.jsx(Fr,{className:"text-xl font-georgia text-foreground",children:u("testResults.answerReview",{defaultValue:"Answer Review"})})}),n.jsx(Br,{className:"space-y-4",children:r.map(e=>{var t;const s=a[e.id],r=(null==s?void 0:s.toLowerCase().trim())===(null==(t=e.correct_answer)?void 0:t.toLowerCase().trim()),i=!s;return n.jsx("div",{className:"p-4 rounded-xl border-2 "+(r?"border-green-200 bg-green-50":i?"border-gray-200 bg-gray-50":"border-red-200 bg-red-50"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0",children:r?n.jsx(et,{className:"w-5 h-5 text-green-500 mt-0.5"}):i?n.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-400 mt-0.5"}):n.jsx(pt,{className:"w-5 h-5 text-red-500 mt-0.5"})}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(xo,{variant:"outline",className:"text-xs",children:["Q",e.question_number]}),n.jsx(xo,{variant:"outline",className:"text-xs",children:e.question_type})]}),n.jsx("p",{className:"font-medium text-foreground",children:e.question_text}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"text-warm-gray",children:u("testResults.yourAnswer",{defaultValue:"Your answer:"})}),n.jsx("span",{className:"font-medium "+(r?"text-green-700":i?"text-gray-500":"text-red-700"),children:s||u("testResults.notAnswered",{defaultValue:"Not answered"})})]}),!r&&n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"text-warm-gray",children:u("testResults.correctAnswer",{defaultValue:"Correct answer:"})}),n.jsx("span",{className:"font-medium text-green-700",children:e.correct_answer})]})]}),e.explanation&&n.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:u("testResults.explanation",{defaultValue:"Explanation:"})})," ",e.explanation]})})]})]})},e.id)})})]})]})},Pl=({children:e,className:t="",spotlightColor:s="rgba(255, 255, 255, 0.25)",onClick:a,...i})=>{const o=r.useRef(null);return n.jsx("div",{ref:o,onMouseMove:e=>{if(!o.current)return;const t=o.current.getBoundingClientRect(),a=e.clientX-t.left,r=e.clientY-t.top;o.current.style.setProperty("--mouse-x",`${a}px`),o.current.style.setProperty("--mouse-y",`${r}px`),o.current.style.setProperty("--spotlight-color",s)},onClick:a,className:`card-spotlight ${t}`,...i,children:e})},Ll=()=>{var e,t;const s=o(),{toast:a}=Ts(),{testId:i}=u(),l=en(),[c,d]=r.useState(3600),[m,h]=r.useState(1),[g,p]=r.useState({}),[x,f]=r.useState({}),[b,y]=r.useState(!0),[v,j]=r.useState(!1),[w,_]=r.useState(!1),[N,k]=r.useState([]),[E,S]=r.useState([]),[T,C]=r.useState(null);r.useEffect(()=>{i?I(i):A()},[i]),r.useEffect(()=>{if(c>0&&!v){const e=setTimeout(()=>d(c-1),1e3);return()=>clearTimeout(e)}0!==c||v||M()},[c,v]);const I=async e=>{try{if(y(!0),!e||"random"===e){return p({1:{passage:{id:"placeholder",title:"Reading Test Coming Soon",content:"Reading tests are being updated to the new universal system. Please check back soon!",part_number:1},questions:[]}}),void k([])}const{data:t,error:r}=await jr.from("tests").select("*").eq("id",e).maybeSingle();if(r)throw r;if(!t)return a({title:"Test Not Found",description:"This test doesn't exist. Please check the test ID.",variant:"destructive"}),void s(-1);C(t);const{data:n,error:i}=await jr.from("questions").select("*").eq("test_id",e).order("part_number",{ascending:!0}).order("question_number_in_part",{ascending:!0});if(i)throw i;if(!n||0===n.length)return a({title:"No Questions Available",description:"This test doesn't have questions yet. Please contact your instructor.",variant:"destructive"}),void s(-1);const o={},l=[],c={},d={};n.forEach(e=>{0!==e.question_number_in_part?(c[e.part_number]||(c[e.part_number]=[]),c[e.part_number].push(e)):d[e.part_number]=e.question_text}),Object.entries(c).forEach(([e,s])=>{const a=parseInt(e),r=s[0],n=d[a]||`Reading Passage ${a}`;o[a]={passage:{id:`passage-${a}`,title:n,content:(null==r?void 0:r.passage_text)||"Passage content not available",part_number:a,test_number:t.test_number||1},questions:s.map((e,t)=>({id:e.id,question_number:e.question_number_in_part||t+1,question_text:e.question_text,question_type:e.question_type,options:e.choices?"string"==typeof e.choices?e.choices.includes(";")?e.choices.split(";"):[e.choices]:Array.isArray(e.choices)?e.choices.map(e=>String(e)):[]:[],correct_answer:e.correct_answer,explanation:e.explanation||"",passage_id:`passage-${a}`,part_number:e.part_number,structure_data:e.structure_data}))},l.push(...o[a].questions)}),p(o),k(l),console.log(` Loaded ${Object.keys(o).length} parts with ${l.length} total questions`)}catch(t){console.error("Error fetching test:",t),a({title:"Error",description:"Failed to load reading test",variant:"destructive"}),s(-1)}finally{y(!1)}},A=async()=>{y(!0);try{console.log(" Loading available reading tests...");const{data:e,error:t}=await jr.from("tests").select("*").eq("test_type","IELTS").eq("module","Reading").order("created_at",{ascending:!1});if(t)throw console.error(" Error loading tests:",t),t;let s=e||[];if(s.length>0){const e=s.map(e=>e.id),{data:t,error:a}=await jr.from("questions").select("test_id").in("test_id",e);if(!a&&t){const e=new Set(t.map(e=>e.test_id)),a=s.length;s=s.filter(t=>e.has(t.id)),console.log(` Filtered from ${a} to ${s.length} tests (only showing tests with questions)`)}}console.log(` Found ${s.length} available reading tests:`,s.map(e=>({id:e.id,name:e.test_name,module:e.module,skill_category:e.skill_category}))),S(s)}catch(e){console.error("Error fetching available tests:",e),a({title:"Error",description:"Failed to load available reading tests.",variant:"destructive"}),S([])}finally{y(!1)}},P=(e,t)=>{f(s=>({...s,[e]:t}))},L=()=>{let e=0;return N.forEach(t=>{var s;(null==(s=x[t.id])?void 0:s.toLowerCase().trim())===t.correct_answer.toLowerCase().trim()&&e++}),e},M=async()=>{var e;const t=L(),s=N.length;j(!0),_(!0);try{const{data:{user:a}}=await jr.auth.getUser();if(a&&(null==(e=g[1])?void 0:e.passage)){const e={user_id:a.id,test_type:"reading",section_number:1,total_questions:s,correct_answers:t,score_percentage:t/s*100,time_taken:3600-c,test_data:{answers:x,all_questions:N.map(e=>({id:e.id,question_number:e.question_number,question_type:e.question_type,question_text:e.question_text,correct_answer:e.correct_answer,explanation:e.explanation})),completed_parts:Object.keys(g).map(e=>parseInt(e))}},{error:r}=await jr.from("test_results").insert(e);r?console.error("Error saving test result:",r):console.log(" Test result saved successfully")}}catch(a){console.error("Error saving test result:",a)}};if(b)return n.jsx(Ao,{title:"Loading Reading Test",children:n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),n.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading Reading Test..."})]})})});if(w)return n.jsx(Ao,{title:"Reading Test Results",children:n.jsx(Al,{score:L(),totalQuestions:N.length,timeTaken:3600-c,answers:x,questions:N,onRetake:()=>window.location.reload(),onContinue:()=>s("/ielts-portal"),testTitle:`Reading Test ${(null==T?void 0:T.test_name)||i}`})});if(!i)return n.jsxs("div",{className:"min-h-screen relative",style:{backgroundColor:"dark"===l.theme.name?l.theme.colors.background:"transparent"},children:[n.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"note"===l.theme.name||"minimalist"===l.theme.name||"dark"===l.theme.name?"none":"url('/1000031207.png')",backgroundColor:l.backgroundImageColor}}),n.jsx("div",{className:"relative z-10",children:n.jsx(Ao,{title:"Available Reading Tests",children:n.jsx("div",{className:"min-h-screen py-12",children:n.jsx("div",{className:"container mx-auto px-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsx("div",{className:"mb-8 text-center",children:n.jsx("h1",{className:"text-4xl font-bold mb-2",style:{color:l.textPrimary},children:"IELTS Reading Tests"})}),E.length>0?n.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:E.map(e=>n.jsx(Pl,{className:"cursor-pointer h-[140px] hover:scale-105 transition-all duration-300 hover:shadow-lg flex items-center justify-center",onClick:()=>s(`/reading/${e.id}`),style:{backgroundColor:"glassmorphism"===l.theme.name?"rgba(255,255,255,0.8)":"dark"===l.theme.name?"rgba(255,255,255,0.1)":"minimalist"===l.theme.name?"#ffffff":l.theme.colors.cardBackground,borderColor:l.border,...l.cardStyle},children:n.jsx(Br,{className:"p-3 md:p-4 text-center flex items-center justify-center h-full",children:n.jsx("h3",{className:"font-semibold text-sm",style:{color:l.textPrimary},children:e.test_name||`Reading Test ${e.test_number||""}`})})},e.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("p",{className:"text-lg mb-4",style:{color:l.textSecondary},children:"No reading tests available yet"}),n.jsx(qr,{onClick:()=>s("/ielts-portal"),variant:"outline",style:{borderColor:l.border,color:l.textPrimary,backgroundColor:"glassmorphism"===l.theme.name||"dark"===l.theme.name?"rgba(255,255,255,0.1)":"minimalist"===l.theme.name?"#ffffff":l.theme.colors.cardBackground},onMouseEnter:e=>e.currentTarget.style.backgroundColor=l.hoverBg,onMouseLeave:e=>e.currentTarget.style.backgroundColor="glassmorphism"===l.theme.name||"dark"===l.theme.name?"rgba(255,255,255,0.1)":"minimalist"===l.theme.name?"#ffffff":l.theme.colors.cardBackground,children:"Back to Portal"})]})]})})})})})]});const O=g[m];return O?n.jsx(Ao,{title:`Reading Test - Part ${m}`,transparentBackground:!0,fullWidth:!0,noPadding:!0,children:n.jsxs("div",{className:"h-screen flex flex-col bg-[#FEF9E7] overflow-hidden",children:[n.jsx("div",{className:"flex-shrink-0 bg-[#FEF9E7] border-b border-[#E8D5A3]",children:n.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[n.jsxs(qr,{variant:"ghost",onClick:()=>s("/ielts-portal"),className:"text-[#5c4b37] hover:bg-[#E8D5A3]/50",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Back"]}),n.jsx("div",{className:"flex items-center gap-3 bg-white/50 p-1 rounded-full border border-[#E8D5A3]",children:Object.keys(g).map(e=>{const t=parseInt(e),s=m===t;return n.jsx("button",{onClick:()=>(e=>{g[e]&&h(e)})(t),className:"w-8 h-8 rounded-full font-serif font-bold text-sm transition-all duration-300 "+(s?"bg-[#8B4513] text-white shadow-sm scale-110":"text-[#5c4b37] hover:bg-[#8B4513]/10"),children:t},t)})}),n.jsx("div",{className:"flex items-center gap-2 text-[#8B4513]",children:n.jsx("span",{className:"font-serif text-lg font-medium tabular-nums tracking-wider",children:(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`})(c)})})]})}),n.jsxs("div",{className:"flex-1 grid lg:grid-cols-2 min-h-0",children:[n.jsxs("div",{className:"flex flex-col min-h-0 bg-[#FEF9E7] border-r border-[#E8D5A3]",children:[n.jsx("div",{className:"flex-shrink-0 border-b border-[#E8D5A3] px-6 py-4",children:n.jsx("h2",{className:"font-serif text-[#5c4b37] text-xl font-semibold",children:O.passage.title})}),n.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-5 ielts-scrollbar",children:n.jsx("div",{className:"prose prose-lg max-w-none font-serif text-[#2f241f]",children:n.jsx("div",{className:"whitespace-pre-wrap leading-loose text-justify",children:O.passage.content})})})]}),n.jsxs("div",{className:"flex flex-col min-h-0 bg-[#FEF9E7]",children:[n.jsx("div",{className:"flex-shrink-0 border-b border-[#E8D5A3] px-6 py-4",children:n.jsxs("h2",{className:"text-xl text-[#5c4b37] font-serif font-semibold",children:["Questions ",null==(e=O.questions[0])?void 0:e.question_number," - ",null==(t=O.questions[O.questions.length-1])?void 0:t.question_number]})}),n.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-5 ielts-scrollbar",children:(()=>{const e=[];let t=null;return O.questions.forEach(s=>{const a=s.question_type||"Short Answer",r=(s.options||[]).join("|"),n=t?t.options.join("|"):"";if(t&&t.type===a&&r===n)t.questions.push(s);else{const r=s.structure_data;t={type:a,questions:[s],options:s.options||[],taskInstruction:(null==r?void 0:r.taskInstruction)||"",instructions:(null==r?void 0:r.instructions)||""},e.push(t)}}),e.map((e,t)=>{var s,a;const r=e.type.toLowerCase().includes("yes")&&e.type.toLowerCase().includes("no"),i=e.type.toLowerCase().includes("true")&&e.type.toLowerCase().includes("false"),o=e.options.length>=5&&e.options.every(e=>/^[A-G]\s{1,2}[A-Z]/.test(e)),l=e.type.toLowerCase().includes("matching")||e.type.toLowerCase().includes("paragraph")||o,c="multiple choice"===e.type.toLowerCase()&&4===e.options.length&&!o,d=e.type.toLowerCase().includes("summary")||e.type.toLowerCase().includes("completion")&&!l,u=null==(s=e.questions[0])?void 0:s.question_number,m=null==(a=e.questions[e.questions.length-1])?void 0:a.question_number,h=u===m?`${u}`:`${u}-${m}`;return n.jsxs("div",{className:"py-6 border-b border-[#E8D5A3]/40 last:border-b-0",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("h5",{className:"font-bold text-lg text-[#2f241f] font-serif",children:["Questions ",h]}),e.taskInstruction&&!r&&!i&&n.jsx("p",{className:"text-sm text-[#2f241f] mt-2 leading-relaxed",children:e.taskInstruction}),!e.taskInstruction&&e.instructions&&!r&&!i&&n.jsx("p",{className:"text-sm text-[#5a4a3f] mt-2 italic leading-relaxed",children:e.instructions})]}),(r||i)&&n.jsxs("div",{className:"mb-4 p-3 bg-[#fdfaf3] rounded-lg border border-[#e0d6c7]",children:[e.taskInstruction&&n.jsx("p",{className:"text-sm text-[#2f241f] mb-3 leading-relaxed",children:e.taskInstruction}),r?n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"YES"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if the statement agrees with the claims of the writer"})]}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"NO"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if the statement contradicts the claims of the writer"})]}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"NOT GIVEN"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if it is impossible to say what the writer thinks about this"})]})]}):n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"TRUE"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if the statement agrees with the information"})]}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"FALSE"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if the statement contradicts the information"})]}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsx("span",{className:"font-bold text-[#2f241f] w-24",children:"NOT GIVEN"}),n.jsx("span",{className:"text-[#5a4a3f]",children:"if there is no information on this"})]})]})]}),l&&e.options.length>0&&n.jsx("div",{className:"mb-4 p-3 bg-[#fdfaf3] rounded-lg border border-[#e0d6c7]",children:n.jsx("div",{className:"space-y-1",children:e.options.map((e,t)=>n.jsx("div",{className:"text-sm text-[#2f241f]",children:e},t))})}),n.jsx("div",{className:"space-y-4",children:e.questions.map(t=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0 text-base font-bold text-black font-serif w-6 text-right pt-0.5",children:t.question_number}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-serif text-base text-black leading-relaxed",children:t.question_text}),(()=>{if(r)return n.jsx(Co,{value:x[t.id]||"",onValueChange:e=>P(t.id,e),className:"flex flex-wrap gap-2 mt-2",children:["YES","NO","NOT GIVEN"].map(e=>{const s=x[t.id]===e;return n.jsxs("div",{className:"relative",children:[n.jsx(Io,{value:e,id:`${t.id}-${e}`,className:"peer sr-only"}),n.jsx(Mn,{htmlFor:`${t.id}-${e}`,className:"flex items-center justify-center px-4 py-1.5 min-w-[80px] rounded-md border transition-all duration-200 cursor-pointer text-sm font-bold tracking-wide "+(s?"bg-[#8B4513] text-white border-[#8B4513] shadow-md":"bg-white border-[#E8D5A3] text-[#5c4b37] hover:bg-[#FEF9E7] hover:border-[#8B4513]"),children:e})]},e)})});if(i)return n.jsx(Co,{value:x[t.id]||"",onValueChange:e=>P(t.id,e),className:"flex flex-wrap gap-2 mt-2",children:["TRUE","FALSE","NOT GIVEN"].map(e=>{const s=x[t.id]===e;return n.jsxs("div",{className:"relative",children:[n.jsx(Io,{value:e,id:`${t.id}-${e}`,className:"peer sr-only"}),n.jsx(Mn,{htmlFor:`${t.id}-${e}`,className:"flex items-center justify-center px-4 py-1.5 min-w-[80px] rounded-md border transition-all duration-200 cursor-pointer text-sm font-bold tracking-wide "+(s?"bg-[#8B4513] text-white border-[#8B4513] shadow-md":"bg-white border-[#E8D5A3] text-[#5c4b37] hover:bg-[#FEF9E7] hover:border-[#8B4513]"),children:e})]},e)})});if(l){const s=`A-${e.options.length>0?String.fromCharCode(64+e.options.length):e.type.toLowerCase().includes("paragraph")?"I":"G"}`;return n.jsx(Vr,{value:x[t.id]||"",onChange:e=>P(t.id,e.target.value.toUpperCase()),placeholder:s,maxLength:1,className:"w-16 h-10 text-center bg-white border border-[#E8D5A3] rounded-lg focus:ring-1 focus:ring-[#8B4513] focus:border-[#8B4513] shadow-sm font-serif text-lg font-bold text-black uppercase mt-2"})}return d?t.options&&t.options.length>0?n.jsxs("select",{value:x[t.id]||"",onChange:e=>P(t.id,e.target.value),className:"w-64 h-10 bg-white border border-[#E8D5A3] rounded-lg px-3 focus:ring-1 focus:ring-[#8B4513] focus:border-[#8B4513] shadow-sm font-serif text-base text-black mt-2",children:[n.jsx("option",{value:"",children:"Select answer..."}),t.options.map((e,t)=>{var s;const a=(null==(s=e.match(/^([A-E])\s/))?void 0:s[1])||String.fromCharCode(65+t);return n.jsx("option",{value:a,children:e},t)})]}):n.jsx(Vr,{value:x[t.id]||"",onChange:e=>P(t.id,e.target.value),placeholder:"Type your answer",className:"w-48 h-10 bg-white border border-[#E8D5A3] rounded-lg px-3 focus:ring-1 focus:ring-[#8B4513] focus:border-[#8B4513] shadow-sm font-serif text-base text-black mt-2"}):c&&t.options&&t.options.length>0?n.jsx(Co,{value:x[t.id]||"",onValueChange:e=>P(t.id,e),className:"grid gap-2 mt-3",children:t.options.map((e,s)=>{const a=String.fromCharCode(65+s),r=x[t.id]===a;return n.jsxs("div",{className:"relative",children:[n.jsx(Io,{value:a,id:`${t.id}-${a}`,className:"peer sr-only"}),n.jsxs(Mn,{htmlFor:`${t.id}-${a}`,className:"flex items-start p-3 rounded-lg border transition-all duration-200 cursor-pointer "+(r?"border-[#8B4513] bg-[#FEF9E7] shadow-sm":"border-[#E8D5A3] bg-white hover:bg-[#FEF9E7] hover:border-[#8B4513]/50"),children:[n.jsx("span",{className:"flex-shrink-0 font-bold text-base mr-3 "+(r?"text-[#8B4513]":"text-[#8B4513]/70"),children:a}),n.jsx("span",{className:"text-sm leading-relaxed text-black",children:e.replace(/^[A-D]\s+/,"")})]})]},s)})}):n.jsx(Vr,{value:x[t.id]||"",onChange:e=>P(t.id,e.target.value),className:"max-w-md bg-white border border-[#E8D5A3] rounded-lg px-4 py-2 focus:ring-1 focus:ring-[#8B4513] focus:border-[#8B4513] shadow-sm font-serif h-10 text-base text-black mt-2"})})()]})]},t.id))})]},`section-${t}`)})})()})]})]})]})}):n.jsx(Ao,{title:"Reading Test - Part Not Available",children:n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("p",{className:"text-lg text-muted-foreground",children:["Part ",m," not available"]}),n.jsx(qr,{onClick:()=>h(1),className:"mt-4",children:"Go to Part 1"})]})})})},Ml=()=>{const e=o(),{toast:t}=Ts(),[s,a]=r.useState(1800),[i,l]=r.useState(null),[c,d]=r.useState([]),[u,m]=r.useState({}),[h,g]=r.useState(!0),[p,x]=r.useState(!1),[f,b]=r.useState(null);r.useEffect(()=>{y()},[]),r.useEffect(()=>{const e=setInterval(()=>{a(e=>e<=1?(j(),0):e-1)},1e3);return()=>clearInterval(e)},[]);const y=async()=>{try{g(!1);l({id:"placeholder",title:"Listening Test Coming Soon",section_number:1,instructions:"Listening tests are being updated to the new system. Please check back soon!",audio_url:null,transcript:""}),d([])}catch(e){t({title:"Error",description:"Failed to load listening test: "+e.message,variant:"destructive"})}finally{g(!1)}},v=(e,t)=>{m(s=>({...s,[e]:t}))},j=()=>{f&&f.pause();const s=w();t({title:"Test Submitted!",description:`You answered ${s}/${c.length} questions correctly.`}),e("/")},w=()=>c.reduce((e,t)=>u[t.id]===t.correct_answer?e+1:e,0),_={title:"IELTS Listening Practice | Audio Mock Test & Instant Feedback",description:"Simulate the IELTS Listening exam with authentic audio tracks, transcripts, timers, and auto-scoring so you can sharpen note-taking skills.",keywords:"IELTS listening practice, IELTS audio mock test, IELTS listening questions, band score listening, IELTS listening timer",type:"article",schemaType:"faq",url:"https://englishaidol.com/listening",faqs:[{question:"Can I replay IELTS listening audio tracks?",answer:"You control playback to mimic exam pacing, but we recommend listening once to build real test stamina. Transcripts are available for review afterward."},{question:"What feedback do I get after finishing a section?",answer:"We tally your correct answers, highlight weak question types, and suggest listening strategies so you know exactly how to improve."}]};return h?n.jsxs(n.Fragment,{children:[n.jsx(bn,{..._}),n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),n.jsx("p",{children:"Loading listening test..."})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(bn,{..._}),n.jsx("div",{className:"bg-white border-b-2 border-gray-200 p-4",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2",children:[n.jsx(it,{className:"h-4 w-4"}),"Back to Dashboard"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xt,{className:"h-5 w-5 text-green-600"}),n.jsx("span",{className:"font-semibold text-lg",children:"IELTS Listening Test"})]})]}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"flex items-center gap-2 bg-orange-100 px-3 py-1 rounded-lg",children:[n.jsx(ot,{className:"h-4 w-4 text-orange-600"}),n.jsx("span",{className:"font-mono text-orange-600 font-medium",children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(s)})]}),n.jsx(qr,{onClick:j,className:"bg-green-600 hover:bg-green-700",children:"Submit Test"})]})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[n.jsxs("div",{children:[n.jsxs(Rr,{className:"mb-6",children:[n.jsxs(Dr,{children:[n.jsxs(Fr,{className:"flex items-center gap-2",children:[n.jsx(xt,{className:"h-5 w-5"}),null==i?void 0:i.title]}),n.jsxs(zr,{children:["Section ",null==i?void 0:i.section_number]})]}),n.jsx(Br,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm",children:null==i?void 0:i.instructions}),(null==i?void 0:i.audio_url)?n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>{f&&(p?f.pause():f.play(),x(!p))},className:"flex items-center gap-2",children:[p?n.jsx(ft,{className:"h-4 w-4"}):n.jsx(bt,{className:"h-4 w-4"}),p?"Pause":"Play"," Audio"]}),n.jsx("span",{className:"text-sm text-gray-600",children:"Click play to start the listening section"})]}):n.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:n.jsx("p",{className:"text-sm text-yellow-800",children:"Audio file not available. Please check the transcript below for content."})})]})})]}),(null==i?void 0:i.transcript)&&n.jsxs(Rr,{children:[n.jsx(Dr,{children:n.jsx(Fr,{children:"Transcript (for reference)"})}),n.jsx(Br,{children:n.jsx("div",{className:"text-sm leading-relaxed text-gray-600",children:i.transcript.split("\n\n").map((e,t)=>n.jsx("p",{className:"mb-3",children:e},t))})})]})]}),n.jsx("div",{children:n.jsxs(Rr,{children:[n.jsxs(Dr,{children:[n.jsxs(Fr,{children:["Questions (",c.length,")"]}),n.jsx(zr,{children:"Listen to the audio and answer all questions"})]}),n.jsx(Br,{className:"space-y-6",children:c.map(e=>n.jsxs("div",{className:"border-b pb-4 last:border-b-0",children:[n.jsxs("p",{className:"font-medium mb-3",children:[e.question_number,". ",e.question_text]}),"multiple_choice"===e.question_type&&e.options?n.jsx("div",{className:"space-y-2",children:e.options.map((t,s)=>n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"radio",name:`question_${e.id}`,value:t,checked:u[e.id]===t,onChange:t=>v(e.id,t.target.value),className:"text-green-600"}),n.jsx("span",{className:"text-sm",children:t})]},s))}):n.jsx("input",{type:"text",placeholder:"Type your answer here",value:u[e.id]||"",onChange:t=>v(e.id,t.target.value),className:"w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-green-500"})]},e.id))})]})})]})})]})},Ol=r.createContext(null);function Rl(){const e=r.useContext(Ol);if(!e)throw new Error("useTranscriptViewer must be used within a TranscriptViewerContainer");return e}function Dl({children:e,audioSrc:t,audioType:s="audio/mpeg",alignment:a,className:i,...o}){const l=r.useRef(null),[c,d]=r.useState(0),[u,m]=r.useState(0),[h,g]=r.useState(!1);r.useEffect(()=>{const e=l.current;if(!e)return;const t=()=>d(e.currentTime),s=()=>m(e.duration),a=()=>g(!0),r=()=>g(!1),n=()=>g(!1);return e.addEventListener("timeupdate",t),e.addEventListener("durationchange",s),e.addEventListener("play",a),e.addEventListener("pause",r),e.addEventListener("ended",n),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("durationchange",s),e.removeEventListener("play",a),e.removeEventListener("pause",r),e.removeEventListener("ended",n)}},[]);const p=r.useCallback(()=>{l.current&&(h?l.current.pause():l.current.play())},[h]),x=r.useCallback(e=>{l.current&&(l.current.currentTime=e)},[]),f=r.useMemo(()=>({audioRef:l,currentTime:c,duration:u,isPlaying:h,alignment:a,togglePlay:p,seek:x}),[c,u,h,a,p,x]);return n.jsx(Ol.Provider,{value:f,children:n.jsxs("div",{className:Cs("relative",i),...o,children:[n.jsxs("audio",{ref:l,src:t,children:[n.jsx("source",{src:t,type:s}),"Your browser does not support the audio element."]}),e]})})}function Fl({className:e,...t}){return n.jsx("div",{className:Cs("",e),...t})}function zl({className:e,...t}){const{alignment:s,currentTime:a,seek:i}=Rl(),o=r.useMemo(()=>{const e=[];let t="",r=-1,n=-1;return s.characters.forEach((i,o)=>{const l=s.characterStartTimesSeconds[o],c=s.characterEndTimesSeconds[o];if(-1===r&&(r=l),n=c,t+=i," "===i||o===s.characters.length-1){const s=a>=r&&a<=n;e.push({text:t,startTime:r,endTime:n,isActive:s}),t="",r=-1,n=-1}}),e},[s,a]);return n.jsx("div",{className:Cs("flex flex-wrap gap-x-0.5",e),...t,children:o.map((e,t)=>n.jsx("span",{className:Cs("cursor-pointer transition-colors duration-150 rounded px-0.5",e.isActive?"bg-primary/20 text-primary font-medium":"hover:bg-muted text-foreground/80"),onClick:()=>i(e.startTime),children:e.text},t))})}function Bl({className:e,...t}){const{currentTime:s,duration:a,seek:i}=Rl(),o=r.useRef(null),l=a>0?s/a*100:0,c=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return n.jsxs("div",{className:Cs("w-full space-y-2",e),...t,children:[n.jsx("div",{ref:o,className:"relative h-2 w-full bg-secondary rounded-full cursor-pointer overflow-hidden",onClick:e=>{if(!o.current)return;const t=o.current.getBoundingClientRect(),s=(e.clientX-t.left)/t.width;i(s*a)},children:n.jsx("div",{className:"absolute top-0 left-0 h-full bg-primary transition-all duration-100 ease-linear",style:{width:`${l}%`}})}),n.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[n.jsx("span",{children:c(s)}),n.jsx("span",{children:c(a)})]})]})}function $l({children:e,className:t,onClick:s,...a}){const{isPlaying:r,togglePlay:i}=Rl();return n.jsx("button",{className:Cs("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",t),onClick:e=>{i(),null==s||s(e)},...a,children:e({isPlaying:r})})}function ql({className:e,...t}){return n.jsx("div",{className:Cs("animate-pulse rounded-md bg-muted",e),...t})}const Vl=({audioUrl:e,transcriptData:t})=>t?n.jsxs(Dl,{className:"bg-card w-full rounded-xl border p-6 shadow-sm",audioSrc:e,audioType:"audio/mpeg",alignment:t,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Live Transcript"}),n.jsx("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded",children:"Click words to jump"})]}),n.jsx(Fl,{className:"sr-only"}),n.jsx("div",{className:"max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:n.jsx(zl,{className:"text-base leading-relaxed"})}),n.jsxs("div",{className:"flex flex-col gap-4 mt-6 pt-4 border-t",children:[n.jsx("div",{className:"w-full",children:n.jsx(Bl,{})}),n.jsx($l,{className:"w-full flex items-center justify-center gap-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 rounded-md transition-colors",children:({isPlaying:e})=>n.jsx(n.Fragment,{children:e?n.jsxs(n.Fragment,{children:[n.jsx(ft,{className:"w-4 h-4"})," Pause Audio"]}):n.jsxs(n.Fragment,{children:[n.jsx(bt,{className:"w-4 h-4"})," Play Audio"]})})})]})]}):n.jsxs("div",{className:"flex w-full flex-col gap-3 p-6 border rounded-xl bg-card",children:[n.jsx(ql,{className:"h-6 w-1/3 mb-4"}),n.jsx(ql,{className:"h-4 w-full"}),n.jsx(ql,{className:"h-4 w-full"}),n.jsx(ql,{className:"h-4 w-3/4"}),n.jsx("div",{className:"flex items-center gap-3 mt-4",children:n.jsx(ql,{className:"h-10 w-full"})})]}),Wl=()=>{const e=o(),{toast:t}=Ts(),{testId:s}=u(),a=en(),[i,l]=r.useState(1800),[c,d]=r.useState(null),[m,h]=r.useState([]),[g,p]=r.useState({}),[x,f]=r.useState(!0),[b,y]=r.useState(!1),[v,j]=r.useState(!1);r.useState(!1);const[w,_]=r.useState(0),[N,k]=r.useState(!1),[E,S]=r.useState(null),[T,C]=r.useState(0),[I,A]=r.useState(0),[P,L]=r.useState({}),[M,O]=r.useState(1),[R,D]=r.useState([]),[F,z]=r.useState({}),[B,$]=r.useState([]),[q,V]=r.useState(null);r.useEffect(()=>{if(s){const e=(()=>{const e=s.match(/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/);return e?e[0]:s})();W(e)}else U()},[s]),r.useEffect(()=>{if(!b){const e=setInterval(()=>{l(e=>e<=1?(Y(),0):e-1)},1e3);return()=>clearInterval(e)}},[b]),r.useEffect(()=>{console.log(" Fresh Start: Clearing any saved test data for fresh test experience"),localStorage.removeItem(`listening_test_${s}_answers`)},[s]),r.useEffect(()=>{if(!(null==c?void 0:c.audio_url))return E&&E.pause(),S(null),A(0),C(0),void k(!1);const e=new Audio(c.audio_url),t=()=>{A(e.duration||0)},s=()=>{C(e.currentTime||0)},a=()=>{k(!1)};return e.addEventListener("loadedmetadata",t),e.addEventListener("timeupdate",s),e.addEventListener("ended",a),S(e),()=>{e.pause(),e.currentTime=0,e.removeEventListener("loadedmetadata",t),e.removeEventListener("timeupdate",s),e.removeEventListener("ended",a)}},[null==c?void 0:c.audio_url]);const W=async s=>{try{f(!0),console.log(` Loading listening test for test ID: ${s}`);const{data:a,error:r}=await jr.from("tests").select("*").eq("id",s).maybeSingle();if(r)throw r;if(!a)return t({title:"Test Not Found",description:"This listening test doesn't exist. Please check the test ID.",variant:"destructive"}),void e(-1);const{data:n,error:i}=await jr.from("questions").select("*").eq("test_id",s).order("part_number",{ascending:!0}).order("question_number_in_part",{ascending:!0});if(i)throw i;if(!n||0===n.length)return t({title:"No Questions Available",description:"This test doesn't have questions yet. Please contact your instructor.",variant:"destructive"}),void e(-1);const o={};n.forEach(e=>{const t=e.part_number||1;o[t]||(o[t]=[]),o[t].push(e)});const l=1,c=o[l]||[];if(0===c.length)return t({title:"No Questions Available",description:"This test doesn't have questions for Part 1.",variant:"destructive"}),void e(-1);const u=c[0],m=u.audio_url||null,g={id:`part-${l}`,title:`Part ${l}`,section_number:l,instructions:u.passage_text||`Part ${l} - Listen to the audio and answer the questions.`,audio_url:m,transcript:u.transcription||"",transcript_json:u.transcript_json||null,photo_url:u.answer_image_url||null,part_number:l,test_number:a.test_number||1};d(g);const p=c.map((e,t)=>({id:e.id,question_text:e.question_text,question_number:e.question_number_in_part||t+1,question_type:e.question_type||"multiple_choice",options:e.choices?"string"==typeof e.choices?e.choices.includes(";")?e.choices.split(";"):[e.choices]:Array.isArray(e.choices)?e.choices.map(e=>String(e)):[]:[],correct_answer:e.correct_answer,explanation:e.explanation||"",section_id:g.id}));h(p);const x={};Object.keys(o).forEach(e=>{const t=parseInt(e),s=o[t],r=s[0],n={id:`part-${t}`,title:`Part ${t}`,section_number:t,instructions:r.passage_text||`Part ${t} - Listen to the audio and answer the questions.`,audio_url:r.audio_url||null,transcript:r.transcription||"",transcript_json:r.transcript_json||null,photo_url:r.answer_image_url||null,part_number:t,test_number:a.test_number||1},i=s.map((e,t)=>({id:e.id,question_text:e.question_text,question_number:e.question_number_in_part||t+1,question_type:e.question_type||"multiple_choice",options:e.choices?"string"==typeof e.choices?e.choices.includes(";")?e.choices.split(";"):[e.choices]:Array.isArray(e.choices)?e.choices.map(e=>String(e)):[]:[],correct_answer:e.correct_answer,explanation:e.explanation||"",section_id:n.id}));x[t]={section:n,questions:i}}),z(x),O(l),V(a),console.log(` Listening test loaded: ${a.test_name}, ${Object.keys(o).length} parts`)}catch(a){console.error("Error loading listening test:",a),t({title:"Error",description:"Failed to load listening test: "+a.message,variant:"destructive"})}finally{f(!1)}},U=async()=>{f(!0);try{console.log(" Loading available listening tests...");const{data:e,error:t}=await jr.from("tests").select("*").eq("test_type","IELTS").eq("module","Listening").order("created_at",{ascending:!1});if(t)throw console.error(" Error loading tests:",t),t;let s=e||[];if(s.length>0){const e=s.map(e=>e.id),{data:t,error:a}=await jr.from("questions").select("test_id").in("test_id",e);if(!a&&t){const e=new Set(t.map(e=>e.test_id)),a=s.length;s=s.filter(t=>e.has(t.id)),console.log(` Filtered from ${a} to ${s.length} tests (only showing tests with questions)`)}}console.log(` Found ${s.length} available listening tests:`,s.map(e=>({id:e.id,name:e.test_name,module:e.module,skill_category:e.skill_category}))),$(s),f(!1)}catch(e){console.error("Error fetching available tests:",e),t({title:"Error",description:"Failed to fetch available listening tests: "+e.message,variant:"destructive"}),$([]),f(!1)}},G=(e,t)=>{p(s=>({...s,[e]:t}))},Y=async()=>{var e,a;if(!b){E&&E.pause();let n=0,o=0;const l=[...R,M];l.forEach(e=>{if(F[e]){const t=F[e].questions;o+=t.length,t.forEach(e=>{g[e.id]===e.correct_answer&&n++})}}),F[M]||(o+=m.length,m.forEach(e=>{g[e.id]===e.correct_answer&&n++})),_(n),y(!0),j(!1),localStorage.removeItem(`listening_test_${s}_answers`);try{const{data:{user:t}}=await jr.auth.getUser();if(t){const{data:s,error:r}=await jr.from("test_results").insert({user_id:t.id,test_type:"listening",total_questions:o,correct_answers:n,score_percentage:n/o*100,time_taken:1800-i,test_data:{answers:g,total_score:n,completed_parts:l}}).select().single();if(r)throw r;for(const n of l){const r=F[n]||{section:c,questions:m},i=r.questions,o=i.filter(e=>g[e.id]===e.correct_answer).length,l=i.map(e=>({id:e.id,question_text:e.question_text,user_answer:g[e.id]||"",correct_answer:e.correct_answer,is_correct:g[e.id]===e.correct_answer}));await jr.from("listening_test_results").insert({user_id:t.id,test_result_id:s.id,section_number:n,section_title:(null==(e=r.section)?void 0:e.title)||`Section ${n}`,audio_url:null==(a=r.section)?void 0:a.audio_url,questions_data:l,section_score:o,section_total:i.length,detailed_feedback:`Section ${n}: ${o}/${i.length} correct`})}console.log(" Listening test results saved successfully")}}catch(r){console.error("Error saving test results:",r)}console.log(" Sequential Flow: Listening test completed with all parts. Final score:",n,"out of",o,"questions"),t({title:"Test Submitted!",description:`You scored ${n}/${o} (${Math.round(n/o*100)}%)`})}},H=async e=>{if(console.log(` Sequential Flow: Loading data for Part ${e}`),F[e])return d(F[e].section),h(F[e].questions),O(e),void console.log(` Part ${e} loaded from cache`);t({title:"Part Not Found",description:`Part ${e} is not available for this test.`,variant:"destructive"})},J=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return x?n.jsx(Ao,{title:"Loading Test...",children:n.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),n.jsx("p",{className:"text-warm-gray",children:"Loading listening test..."})]})})}):s?n.jsxs("div",{className:"min-h-screen relative "+("note"===a.theme.name?"font-serif":""),style:{backgroundColor:"dark"===a.theme.name?a.theme.colors.background:"transparent"},children:[n.jsx(Ao,{title:`IELTS Listening - ${(null==c?void 0:c.title)||"Test"}`,showBackButton:!0,backPath:"/tests",children:n.jsx("div",{className:"flex-1 flex justify-center py-6 sm:py-8 pb-20",children:n.jsxs("div",{className:"w-full max-w-4xl mx-auto space-y-6 px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex gap-2",children:[(null==c?void 0:c.cambridge_book)&&n.jsx(xo,{variant:"outline",className:"bg-background/50 backdrop-blur",children:c.cambridge_book}),(null==c?void 0:c.section_number)&&n.jsxs(xo,{variant:"outline",className:"bg-background/50 backdrop-blur",children:["Section ",c.section_number]})]}),n.jsx("div",{className:"flex items-center gap-4",children:b?n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-xl font-bold text-primary",children:[w,"/",m.length]}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Band ",(X=w,Lo(X,"listening").toString())]})]}):n.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 rounded-full bg-orange-100/80 backdrop-blur border border-orange-200 text-orange-700 shadow-sm",children:[n.jsx(ot,{className:"w-4 h-4"}),n.jsx("span",{className:"font-mono font-medium",children:(e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(i)})]})})]}),n.jsx(Rr,{className:"rounded-2xl border shadow-sm sticky top-4 z-30 transition-all duration-300",style:{backgroundColor:"dark"===a.theme.name?"rgba(30, 41, 59, 0.95)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderColor:a.border},children:n.jsxs(Br,{className:"p-4 flex items-center gap-4",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary flex-shrink-0",children:n.jsx(xt,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"font-medium text-sm truncate pr-4",children:(null==c?void 0:c.instructions)||"Listen to the audio"}),n.jsxs("span",{className:"text-xs text-muted-foreground font-mono whitespace-nowrap",children:[J(T)," / ",J(I)]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(qr,{size:"icon",variant:"ghost",className:"h-8 w-8 rounded-full hover:bg-primary/10 hover:text-primary shrink-0",onClick:()=>{E&&(N?E.pause():E.play().catch(e=>{console.error("Error playing audio:",e),k(!1)}),k(!N))},disabled:b||!(null==c?void 0:c.audio_url),children:N?n.jsx(ft,{className:"h-4 w-4"}):n.jsx(bt,{className:"h-4 w-4"})}),n.jsx("div",{className:"flex-1 h-1.5 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary transition-all duration-100 ease-linear",style:{width:I?T/I*100+"%":"0%"}})})]})]})]})}),n.jsxs("div",{className:"space-y-6",children:[(null==c?void 0:c.photo_url)&&n.jsx(Rr,{className:"overflow-hidden border-none shadow-none bg-transparent",children:n.jsx("img",{src:c.photo_url,alt:"Visual Reference",className:"w-full max-w-xl mx-auto rounded-xl shadow-md border border-border/50"})}),n.jsx(Rr,{className:"border shadow-sm rounded-3xl overflow-hidden",style:{backgroundColor:"dark"===a.theme.name?a.theme.colors.cardBackground:"rgba(255, 255, 255, 0.8)",borderColor:a.border},children:n.jsx(Br,{className:"p-6 sm:p-8 space-y-8",children:m.map(e=>n.jsxs("div",{className:"relative pl-0 sm:pl-2",children:[n.jsxs("div",{className:"flex items-baseline gap-3 mb-3",children:[n.jsx("span",{className:"flex-shrink-0 flex items-center justify-center w-7 h-7 rounded-full bg-primary/10 text-primary text-sm font-bold",children:e.question_number}),n.jsx("div",{className:"flex-1 pt-1",children:n.jsx("div",{className:"text-base sm:text-lg font-medium leading-relaxed text-foreground/90 whitespace-pre-line",children:e.question_text})}),b&&n.jsx("div",{className:"flex-shrink-0 ml-2",children:g[e.id]===e.correct_answer?n.jsx(et,{className:"w-5 h-5 text-green-500"}):n.jsx(pt,{className:"w-5 h-5 text-red-500"})})]}),n.jsxs("div",{className:"pl-10",children:["multiple_choice"===e.question_type&&e.options&&e.options.length>0?n.jsx("div",{className:"space-y-2.5",children:e.options.map((t,s)=>n.jsxs("label",{className:`\n                                      flex items-center gap-3 p-3 rounded-xl border transition-all cursor-pointer hover:bg-muted/50\n                                      ${g[e.id]===t?"border-primary bg-primary/5 shadow-sm ring-1 ring-primary/20":"border-transparent bg-muted/30 hover:border-border"}\n                                      ${b&&t===e.correct_answer?"!border-green-500 !bg-green-50/50":""}\n                                      ${b&&g[e.id]===t&&t!==e.correct_answer?"!border-red-500 !bg-red-50/50":""}\n                                    `,children:[n.jsx("div",{className:`\n                                      w-4 h-4 rounded-full border flex items-center justify-center\n                                      ${g[e.id]===t?"border-primary":"border-muted-foreground"}\n                                    `,children:g[e.id]===t&&n.jsx("div",{className:"w-2 h-2 rounded-full bg-primary"})}),n.jsx("input",{type:"radio",name:`question_${e.id}`,value:t,checked:g[e.id]===t,onChange:t=>G(e.id,t.target.value),disabled:b,className:"sr-only"}),n.jsx("span",{className:"text-sm sm:text-base",children:t})]},s))}):n.jsxs("div",{className:"relative max-w-md",children:[n.jsx("input",{type:"text",placeholder:"Type your answer...",value:g[e.id]||"",onChange:t=>G(e.id,t.target.value),disabled:b,className:`\n                                    w-full px-4 py-3 rounded-xl bg-muted/30 border transition-all focus:bg-background\n                                    focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary\n                                    ${b?g[e.id]===e.correct_answer?"border-green-500 bg-green-50/50 text-green-900":"border-red-500 bg-red-50/50 text-red-900":"border-transparent hover:border-border"}\n                                  `}),b&&g[e.id]!==e.correct_answer&&n.jsxs("div",{className:"mt-2 text-sm text-green-600 flex items-center gap-1.5 font-medium",children:[n.jsx(et,{className:"w-3.5 h-3.5"}),"Answer: ",e.correct_answer]})]}),b&&e.explanation&&n.jsxs("div",{className:"mt-4",children:[n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>{return t=e.id,void L(e=>({...e,[t]:!e[t]}));var t},className:"h-auto p-0 text-purple-600 hover:text-purple-700 hover:bg-transparent font-medium flex items-center gap-1.5",children:[P[e.id]?n.jsx(yt,{className:"w-3.5 h-3.5"}):n.jsx(vt,{className:"w-3.5 h-3.5"}),P[e.id]?"Hide":"Show"," Explanation"]}),P[e.id]&&n.jsx("div",{className:"mt-3 p-4 rounded-xl bg-purple-50/50 border border-purple-100 dark:bg-purple-900/10 dark:border-purple-800/30",children:n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"mt-0.5 shrink-0",children:n.jsx(Ue,{className:"w-4 h-4 text-purple-600"})}),n.jsx("div",{className:"text-sm text-purple-900 dark:text-purple-100 leading-relaxed",children:e.explanation})]})})]})]})]},e.id))})})]}),b&&((null==c?void 0:c.transcript)||(null==c?void 0:c.transcript_json))&&n.jsxs(Rr,{className:"border shadow-sm rounded-3xl overflow-hidden bg-background/80 backdrop-blur",children:[n.jsx(Dr,{children:n.jsxs(Fr,{className:"flex items-center gap-2 text-lg",children:[n.jsx(Xe,{className:"w-5 h-5 text-muted-foreground"}),"Audio Transcript"]})}),n.jsx(Br,{children:(null==c?void 0:c.transcript_json)?n.jsx(Vl,{audioUrl:c.audio_url,transcriptData:c.transcript_json}):n.jsx("div",{className:"prose dark:prose-invert max-w-none text-sm text-muted-foreground leading-relaxed whitespace-pre-wrap font-serif",children:null==c?void 0:c.transcript})})]}),n.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-background/80 backdrop-blur-lg border-t z-40 sm:relative sm:bg-transparent sm:border-0 sm:p-0 sm:backdrop-blur-none",children:n.jsxs("div",{className:"max-w-4xl mx-auto flex gap-3",children:[n.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm text-muted-foreground mr-auto",children:[n.jsxs("span",{children:["Part ",M," of 4"]}),n.jsx("div",{className:"flex gap-1",children:[1,2,3,4].map(e=>n.jsx("div",{className:"w-2 h-2 rounded-full "+(e===M?"bg-primary":R.includes(e)?"bg-green-500":"bg-muted")},e))})]}),b?n.jsx(qr,{onClick:()=>e("/tests"),variant:"outline",className:"w-full sm:w-auto rounded-xl",children:"Back to Tests"}):M<4?n.jsxs(qr,{onClick:()=>{if(D(e=>[...e,M]),M>=4)return void Y();const e=M+1;O(e),F[e]?(d(F[e].section),h(F[e].questions)):H(e),console.log(` Sequential Flow: Moving from Part ${M} to Part ${e}`)},className:"w-full sm:w-auto rounded-xl min-w-[140px] shadow-lg hover:shadow-xl transition-all",children:["Next Part ",n.jsx(it,{className:"w-4 h-4 ml-2 rotate-180"})]}):n.jsxs(qr,{onClick:()=>j(!0),className:"w-full sm:w-auto rounded-xl min-w-[140px] bg-primary text-primary-foreground shadow-lg hover:shadow-xl transition-all",children:["Submit Test ",n.jsx(et,{className:"w-4 h-4 ml-2"})]})]})})]})})}),n.jsx(_n,{open:v,onOpenChange:j,children:n.jsxs(Tn,{className:"rounded-2xl border-light-border sm:max-w-md",children:[n.jsxs(Cn,{children:[n.jsx(An,{className:"font-georgia text-xl",children:"Ready to submit?"}),n.jsxs(Pn,{className:"pt-2",children:["You have answered ",n.jsx("span",{className:"font-medium text-foreground",children:Object.keys(g).filter(e=>g[e]).length})," out of ",n.jsx("span",{className:"font-medium text-foreground",children:m.length})," questions in this part.",n.jsx("br",{}),"Proceeding will finalize your score for the whole test."]})]}),n.jsxs(In,{className:"gap-2 sm:gap-0",children:[n.jsx(qr,{variant:"outline",onClick:()=>j(!1),className:"rounded-xl border-light-border",children:"Keep Reviewing"}),n.jsx(qr,{onClick:Y,className:"rounded-xl shadow-md",children:"Yes, Submit"})]})]})})]}):n.jsxs("div",{className:"min-h-screen relative",children:[n.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"note"===a.theme.name||"minimalist"===a.theme.name||"dark"===a.theme.name?"none":"url('/1000031207.png')",backgroundColor:a.backgroundImageColor}}),n.jsx("div",{className:"relative z-10",children:n.jsx(Ao,{title:"Available Listening Tests",children:n.jsx("div",{className:"min-h-screen py-12",children:n.jsx("div",{className:"container mx-auto px-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"IELTS Listening Tests"}),n.jsx("p",{className:"text-lg text-muted-foreground",children:"Choose a test to begin your listening practice"})]}),B.length>0?n.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:B.map(t=>n.jsx(Pl,{className:"cursor-pointer h-[140px] hover:scale-105 transition-all duration-300 hover:shadow-lg bg-white/80 flex items-center justify-center",onClick:()=>e(`/listening/${t.id}`),children:n.jsx(Br,{className:"p-3 md:p-4 text-center flex items-center justify-center h-full",children:n.jsx("h3",{className:"font-semibold text-sm",children:t.test_name||`Listening Test ${t.test_number||""}`})})},t.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"No listening tests available yet"}),n.jsx(qr,{onClick:()=>e("/ielts-portal"),variant:"outline",children:"Back to Portal"})]})]})})})})})]});var X},Ul=()=>{const e=o(),t=m(),{toast:s}=Ts(),a=t.pathname.includes("/reading")?"reading":"listening",i=a,[l,c]=r.useState([]),[d,u]=r.useState(!0),[h,g]=r.useState({}),[p,x]=r.useState(null),f=en();r.useEffect(()=>{let e=!0,t=0;const s=async()=>{try{await b()}catch(a){if(console.error("Error loading content:",a),e&&t<2&&(t++,console.log(` Retrying content fetch (attempt ${t}/2)...`),await new Promise(e=>setTimeout(e,1e3*Math.pow(2,t))),e))return s()}};return s(),()=>{e=!1}},[a,p]);const b=async()=>{try{u(!0),console.log(" DEBUG: Fetching content from universal tables...");const e="reading"===i?"Reading":"Listening",{data:t,error:s}=await jr.from("tests").select("*").eq("test_type","IELTS").eq("module",e).order("created_at",{ascending:!1});if(s)throw s;console.log(` DEBUG: Found ${(null==t?void 0:t.length)||0} ${e} tests`);let a=t||[];if(0===a.length)return console.log(" No tests found for module:",i),c([]),void g({});const r=a.map(e=>e.id),{data:n,error:o}=await jr.from("questions").select("test_id, part_number, id").in("test_id",r);if(o)throw o;const l=[];a.forEach(e=>{const t=(null==n?void 0:n.filter(t=>t.test_id===e.id))||[];if(t.length>0){const s=Math.max(...t.map(e=>e.part_number||1),0);l.push({id:e.id,title:e.test_name||`Test ${e.test_number}`,cambridge_book:e.test_name||`Test ${e.test_number}`,test_number:e.test_number,section_number:1,part_number:s,question_count:t.length})}}),console.log(" DEBUG: Found tests with questions:",l.length),c(l),y(l)}catch(e){console.error("Error fetching content:",e),s({title:"Error",description:"Failed to load content",variant:"destructive"})}finally{u(!1)}},y=e=>{const t={};t["Available Tests"]=e,g(t)};return d?n.jsx("div",{className:"flex items-center justify-center min-h-screen",style:{backgroundColor:f.cardBackground},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),n.jsxs("p",{className:"text-muted-foreground",children:["Loading ",a," content..."]})]})}):n.jsx("div",{className:"min-h-screen relative "+("note"===f.theme.name?"font-serif":""),style:{backgroundColor:"dark"===f.theme.name?f.theme.colors.background:"transparent"},children:n.jsx(Ao,{title:`${i.charAt(0).toUpperCase()}${i.slice(1)} Tests`,showBackButton:!0,backPath:"/tests",transparentBackground:!0,children:n.jsx("div",{className:"flex-1 flex justify-center py-8",children:n.jsxs("div",{className:"w-full max-w-5xl mx-auto space-y-8 px-4",children:[n.jsx(Rr,{className:"border shadow-lg",style:{backgroundColor:"dark"===f.theme.name?"rgba(30, 41, 59, 0.5)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(12px)",borderColor:f.border},children:n.jsxs(Dr,{className:"pb-6",children:[n.jsxs("div",{className:"text-center space-y-3",children:[n.jsx("div",{className:"w-16 h-16 mx-auto rounded-3xl bg-primary/10 flex items-center justify-center mb-2",children:"reading"===i?n.jsx(Je,{className:"w-8 h-8 text-primary"}):n.jsx(xt,{className:"w-8 h-8 text-primary"})}),n.jsxs(Fr,{className:"text-3xl font-medium bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:["reading"===i?"IELTS Reading":"IELTS Listening"," Practice"]}),n.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Practice with official Cambridge IELTS materials. Select a test below or start a random session."})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-8",children:[n.jsxs("div",{className:"flex items-center gap-3 bg-background/50 border rounded-xl px-4 py-2 shadow-sm w-full sm:w-auto justify-between sm:justify-start",style:{borderColor:f.border},children:[n.jsx("label",{className:"text-sm font-medium text-muted-foreground whitespace-nowrap",children:"Filter Part:"}),n.jsxs(Wr,{value:(null==p?void 0:p.toString())||"all",onValueChange:e=>x("all"===e?null:parseInt(e)),children:[n.jsx(Gr,{className:"w-32 border-none bg-transparent shadow-none h-8 px-0 focus:ring-0 text-right sm:text-left",children:n.jsx(Ur,{})}),n.jsxs(Jr,{className:"rounded-xl border shadow-lg",children:[n.jsx(Xr,{value:"all",children:"All Parts"}),("reading"===i?[1,2,3]:[1,2,3,4]).map(e=>n.jsxs(Xr,{value:e.toString(),children:["Part ",e]},e))]})]})]}),n.jsxs(qr,{onClick:()=>{l.length>0?e(`/${i}/random`):s({title:"No Content Available",description:`No ${a} content is available yet.`,variant:"destructive"})},size:"default",className:"rounded-xl bg-primary text-primary-foreground shadow-md hover:shadow-lg transition-all w-full sm:w-auto h-11",children:[n.jsx(bt,{className:"w-4 h-4 mr-2"}),"Start Random Test"]})]})]})}),n.jsx("div",{className:"space-y-6",children:Object.values(h).sort((e,t)=>{var s,a,r,n;return parseInt((null==(a=null==(s=t[0])?void 0:s.cambridge_book)?void 0:a.replace(/\D/g,""))||"0")-parseInt((null==(n=null==(r=e[0])?void 0:r.cambridge_book)?void 0:n.replace(/\D/g,""))||"0")}).map(t=>{var s;const a=(null==(s=t[0])?void 0:s.cambridge_book)||"Unknown Book",r=t.reduce((e,t)=>e+(t.question_count||0),0);return n.jsxs(Rr,{className:"overflow-hidden border shadow-sm rounded-3xl transition-all hover:shadow-md",style:{backgroundColor:f.cardBackground,borderColor:f.border},children:[n.jsx(Dr,{className:"pb-4 border-b bg-muted/20",style:{borderColor:f.border},children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(xo,{variant:"outline",className:"bg-background/50 backdrop-blur",children:"reading"===i?"Reading":"Listening"}),n.jsx(Fr,{className:"text-lg font-bold font-georgia",style:{color:f.textPrimary},children:a})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground font-mono bg-background/50 px-2 py-1 rounded-md border",style:{borderColor:f.border},children:[n.jsx(xe,{className:"w-3 h-3"}),r," Questions"]})]})}),n.jsx(Br,{className:"p-6",children:n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.map(t=>n.jsxs(qr,{variant:"outline",onClick:()=>(t=>{e(`/${i}/${t.id}`)})(t),className:"h-auto py-4 flex flex-col gap-2 rounded-2xl hover:bg-primary/5 hover:border-primary/30 transition-all group",style:{borderColor:f.border,backgroundColor:"dark"===f.theme.name?"rgba(255,255,255,0.03)":"white"},children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-muted group-hover:bg-primary/10 flex items-center justify-center transition-colors",children:n.jsx("span",{className:"font-bold text-sm group-hover:text-primary",style:{color:f.textPrimary},children:t.test_number||"?"})}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-sm font-medium group-hover:text-primary transition-colors",style:{color:f.textPrimary},children:["Test ",t.test_number]}),n.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5",children:[t.question_count," Qs"]})]})]},t.id))})})]},a)})}),0===l.length&&!d&&n.jsx("div",{className:"text-center py-20 bg-muted/20 rounded-3xl border border-dashed",style:{borderColor:f.border},children:n.jsxs("div",{className:"max-w-md mx-auto",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mx-auto mb-4",children:"reading"===i?n.jsx(Je,{className:"w-8 h-8 text-muted-foreground"}):n.jsx(xt,{className:"w-8 h-8 text-muted-foreground"})}),n.jsx("h3",{className:"text-lg font-medium mb-2",style:{color:f.textPrimary},children:"No Content Available"}),n.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:["No ",a," tests have been uploaded yet. Please check back soon."]}),n.jsxs(qr,{variant:"outline",onClick:()=>e("/tests"),className:"rounded-xl",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Back to Tests"]})]})})]})})})})},Gl=()=>{const e=o(),{toast:t}=Ts(),[s,a]=r.useState(1),[i,l]=r.useState(""),[c,d]=r.useState(!1),[u,m]=r.useState(null),[h,g]=r.useState(0),p={1:"The chart below shows the percentage of households in owned and rented accommodation in England and Wales between 1918 and 2011. Summarise the information by selecting and reporting the main features, and make comparisons where relevant. Write at least 150 words.",2:"Some people think that all university students should study whatever they like. Others believe that they should only be allowed to study subjects that will be useful in the future, such as those related to science and technology. Discuss both these views and give your own opinion. Write at least 250 words."};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(bn,{title:"IELTS Writing Practice Test | AI Band Score Feedback",description:"Write IELTS Task 1 and Task 2 responses, then receive instant examiner-style feedback, band score predictions, and action steps from our AI tutors.",keywords:"IELTS writing practice, IELTS task 2 feedback, AI writing evaluation, IELTS essay checker, IELTS band score predictor",type:"article",schemaType:"faq",url:"https://englishaidol.com/writing",faqs:[{question:"How accurate is the IELTS writing band score prediction?",answer:"Our AI rubric mirrors the official IELTS Writing descriptors that former examiners encoded, so the predicted band aligns within 0.5 of real test results."},{question:"Can I practice both Task 1 and Task 2 essays?",answer:"Yes. Switch between Task 1 visuals and Task 2 opinion prompts, then submit writing to get tailored feedback on Task Achievement, Coherence, Lexical Resource, and Grammar."}]}),n.jsx("header",{className:"border-b border-border bg-background shadow-soft",children:n.jsx("div",{className:"container mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>e("/"),children:[n.jsx(it,{className:"w-4 h-4"}),"Back to Dashboard"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(rt,{className:"w-5 h-5 text-blue-deep"}),n.jsx("span",{className:"font-semibold",children:"Writing Test"})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(ot,{className:"w-4 h-4"}),n.jsx("span",{children:"60:00"})]}),n.jsx(qr,{variant:"hero",size:"sm",children:"Submit Test"})]})]})})}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsx(Rr,{children:n.jsxs(Dr,{children:[n.jsx(Fr,{className:"text-center text-2xl",children:"Writing Practice"}),n.jsx("div",{className:"flex justify-center gap-2 mt-4",children:[1,2].map(e=>n.jsxs(qr,{variant:s===e?"default":"outline",onClick:()=>{a(e),l(""),m(null),g(0)},disabled:c,children:["Task ",e]},e))})]})}),n.jsxs(Rr,{children:[n.jsxs(Dr,{children:[n.jsxs(Fr,{children:["Writing Task ",s]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:1===s?"Minimum 150 words | 20 minutes":"Minimum 250 words | 40 minutes"})]}),n.jsxs(Br,{children:[n.jsxs("div",{className:"bg-blue-light/30 p-6 rounded-lg mb-6",children:[n.jsx("h3",{className:"font-semibold mb-3",children:"Task Instructions:"}),n.jsx("p",{className:"text-sm leading-relaxed",children:p[s]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"text-sm font-medium",children:"Your Response:"}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Word count: ",n.jsx("span",{className:h<(1===s?150:250)?"text-red-500":"text-green-600",children:h})]})]}),n.jsx(fo,{value:i,onChange:e=>(e=>{l(e);const t=e.trim().split(/\s+/).filter(e=>e.length>0);g(t.length)})(e.target.value),placeholder:`Start writing your response for Task ${s}...`,className:"min-h-[300px] text-sm leading-relaxed",disabled:c}),n.jsx(qr,{onClick:async()=>{if(i.trim().length<50)t({title:"Text too short",description:"Please write more content before requesting feedback.",variant:"destructive"});else{d(!0);try{const{data:e,error:a}=await jr.functions.invoke("writing-feedback",{body:{writing:i,prompt:p[s],taskType:`Task ${s}`}});if(a)throw a;if(!e.success)throw new Error(e.error||"Analysis failed");m(e.feedback),t({title:"Feedback Complete",description:"Your writing has been analyzed successfully!"})}catch(e){console.error("Feedback error:",e),t({title:"Analysis Failed",description:e.message||"Could not analyze your writing. Please try again.",variant:"destructive"})}finally{d(!1)}}},disabled:c||i.trim().length<50,className:"w-full",children:c?n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(Qr,{size:"sm",message:"Analyzing Writing..."})}):"Get AI Feedback"})]})]})]}),u&&n.jsxs(Rr,{children:[n.jsx(Dr,{children:n.jsx(Fr,{children:"Detailed Writing Analysis"})}),n.jsx(Br,{children:n.jsx("div",{className:"prose max-w-none",children:n.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:u})})})]})]})})]})};function Yl(){const[e,t]=r.useState(!1),[s,a]=r.useState(null);return{loading:e,error:s,createNewTest:async(e,s)=>{t(!0),a(null);try{console.log("Creating new test:",{testType:e,module:s});const{count:a,error:r}=await jr.from("tests").select("*",{count:"exact",head:!0}).eq("test_type",e);if(r)throw console.error("Error counting tests:",r),r;const n=(a||0)+1,i=`${e.toUpperCase()} Test ${n}`;console.log("Inserting new test:",{testName:i,testType:e,module:s});const{data:o,error:l}=await jr.from("tests").insert({test_name:i,test_type:e,module:s}).select().single();if(l)throw console.error("Error inserting test:",l),l;return console.log("Test created successfully:",o),t(!1),o}catch(r){return console.error("Error creating new test:",r),a(r.message),t(!1),null}},createContent:async(e,s)=>{t(!0);try{if(console.log("Creating content:",e,s),"tests"===e){const{data:e,error:t}=await jr.from("tests").insert(s).select().single();if(t)throw console.error("Supabase insert error:",t),new Error(`Database Error: ${t.message}`);return console.log("Content created successfully:",e),{data:e}}if("csv_upload"===e){const{data:e,error:t}=await jr.functions.invoke("admin-content",{body:{questions:s.questions,adminKeypass:"myye65402086"}});if(t)throw console.error("CSV upload error:",t),t;return{success:!0,data:e}}const{data:t,error:a}=await jr.functions.invoke("admin-content",{body:{action:"create",type:e,data:s,adminKeypass:"myye65402086"}});if(a)throw console.error("Edge function error:",a),a;return t}catch(a){throw console.error("Create content error:",a),a}finally{t(!1)}},updateContent:async(e,s)=>{t(!0);try{console.log("Updating content:",e,s);const{data:t,error:a}=await jr.functions.invoke("admin-content",{body:{action:"update",type:e,data:s,adminKeypass:"myye65402086"}});if(a)throw console.error("Update error:",a),a;return t}catch(a){throw console.error("Update content error:",a),a}finally{t(!1)}},deleteContent:async(e,s)=>{t(!0);try{console.log("Deleting content:",e,s);const{data:t,error:a}=await jr.functions.invoke("admin-content",{body:{action:"delete",type:e,data:{id:s},adminKeypass:"myye65402086"}});if(a)throw console.error("Delete error:",a),a;return t}catch(a){throw console.error("Delete content error:",a),a}finally{t(!1)}},listContent:async e=>{t(!0);try{if(console.log("Listing content for type:",e),"tests"===e){const{data:t,error:s}=await jr.from("tests").select("*").order("created_at",{ascending:!1});if(s)throw console.error("Supabase select error:",s),new Error(`Database Error: ${s.message}`);return console.log(`Found ${(null==t?void 0:t.length)||0} ${e} records`),{data:t}}if("questions"===e){const{data:t,error:s}=await jr.from("questions").select("*").order("created_at",{ascending:!1});if(s)throw console.error("Supabase select error:",s),new Error(`Database Error: ${s.message}`);return console.log(`Found ${(null==t?void 0:t.length)||0} ${e} records`),{data:t}}const{data:t,error:s}=await jr.functions.invoke("admin-content",{body:{action:"list",type:e,adminKeypass:"myye65402086"}});if(s)throw console.error("List content error:",s),s;return t}catch(s){throw console.error("List content error:",s),s}finally{t(!1)}},uploadAudio:async e=>{t(!0);try{const t=e.name||"audio.wav",s=t.includes(".")?t.split(".").pop().toLowerCase():"wav",a=t.replace(/\.[^/.]+$/,"").normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase(),r=`${Date.now()}-${a}.${s}`,n=`admin/listening/${r}`;console.log(" Requesting presigned URL for R2 upload:",{originalName:t,fileName:r,size:e.size,type:e.type});const i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN1dW14bWZ6aHdsanlsYmRsZmxqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1MTkxMjEsImV4cCI6MjA2OTA5NTEyMX0.8jqO_ciOttSxSLZnKY0i5oJmEn79ROF53TjUMYhNemI",o="https://cuumxmfzhwljylbdlflj.supabase.co/functions/v1/r2-upload",l=await fetch(o,{method:"POST",headers:{apikey:i,Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({operation:"presign",path:n,contentType:e.type||"audio/mpeg"})});if(!l.ok){const e=await l.text();throw console.error(" Presign request failed:",l.status,e),new Error(`Presign failed ${l.status}: ${e}`)}const c=await l.json();if(!c||!c.success||!c.uploadUrl)throw new Error((null==c?void 0:c.error)||"Failed to get upload URL");console.log(" Got presigned URL, uploading directly to R2...");const d=await fetch(c.uploadUrl,{method:"PUT",headers:{"Content-Type":e.type||"audio/mpeg"},body:e});if(!d.ok)throw console.error(" Direct upload to R2 failed:",d.status,d.statusText),new Error(`Direct upload failed: ${d.status} ${d.statusText}`);return console.log(" Audio uploaded successfully:",c.publicUrl),{success:!0,url:c.publicUrl}}catch(s){throw console.error("Upload error:",s),new Error(s.message||"Upload failed")}finally{t(!1)}}}}const Hl=()=>{const e=o(),[t]=c(),s=u(),{listContent:a}=Yl(),{toast:i}=Ts(),[l,d]=r.useState([]),[m,h]=r.useState(null),[g,p]=r.useState(""),[x,f]=r.useState(!1),[b,y]=r.useState(null),[v,j]=r.useState(0),[w,_]=r.useState(1),[N,k]=r.useState(!0),[E,S]=r.useState("gemini"),[T,C]=r.useState("en"),I=s.book||t.get("book")||"C19",A=s.test||t.get("test")||"1";r.useEffect(()=>{P()},[I,A]);const P=async()=>{try{k(!0),console.log(` Loading writing prompts for ${I}, Test ${A}`);const e=(await a("writing_prompts")).data||[];console.log(" All prompts:",e.map(e=>({id:e.id,title:e.title,cambridge_book:e.cambridge_book,test_number:e.test_number})));const t=e.filter(e=>{const t=e.cambridge_book===I&&e.test_number===parseInt(A);return t&&console.log(" Match found:",{title:e.title,cambridge_book:e.cambridge_book,test_number:e.test_number}),t});if(console.log(` Found ${t.length} writing prompts for ${I}, Test ${A}`),0===t.length){console.log(" No exact matches found. Checking for similar patterns...");const t=e.filter(e=>{var t,s;return(null==(t=e.cambridge_book)?void 0:t.includes("19"))||(null==(s=e.cambridge_book)?void 0:s.includes("C19"))||e.test_number===parseInt(A)});console.log(" Similar prompts found:",t.map(e=>({title:e.title,cambridge_book:e.cambridge_book,test_number:e.test_number})))}0===t.length&&i({title:"No Writing Prompts Found",description:`No writing prompts available for ${I}, Test ${A}. Please check the admin panel.`,variant:"destructive"}),d(t);const s=t.find(e=>"task1"===e.task_type);h(s||t[0]||null)}catch(e){console.error(" Error loading writing prompts:",e),i({title:"Error Loading Prompts",description:"Failed to load writing prompts. Please try again.",variant:"destructive"})}finally{k(!1)}};if(N)return n.jsx("div",{className:"min-h-screen glass-card flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue mx-auto"}),n.jsx("p",{className:"mt-2 text-sm text-text-primary",children:"Loading Writing Test..."})]})});if(!m)return n.jsx("div",{className:"min-h-screen glass-card",children:n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsx("div",{className:"max-w-2xl mx-auto text-center",children:n.jsx(Rr,{className:"glass-effect",children:n.jsxs(Br,{className:"pt-8",children:[n.jsx(Je,{className:"w-16 h-16 text-text-secondary mx-auto mb-4"}),n.jsx("h2",{className:"text-2xl font-bold mb-4 text-text-primary",children:"No Writing Prompts Available"}),n.jsxs("p",{className:"text-text-secondary mb-6",children:["No writing prompts found for ",I,", Test ",A,". Please contact your admin to upload writing content."]}),n.jsxs(qr,{onClick:()=>e("/tests"),className:"glass-button",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Back to Tests"]})]})})})})});const L=l.map(e=>({type:e.task_type,number:parseInt(e.task_type.replace("task",""))})).sort((e,t)=>e.number-t.number);return n.jsxs("div",{className:"min-h-screen glass-card",children:[n.jsx("header",{className:"border-b border-border/30 glass-effect shadow-lg",children:n.jsx("div",{className:"container mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>e("/tests"),className:"glass-button",children:[n.jsx(it,{className:"w-4 h-4"}),"Back to Tests"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(rt,{className:"w-5 h-5 text-brand-blue"}),n.jsx("span",{className:"font-semibold text-text-primary",children:"IELTS Writing Test"}),n.jsxs(xo,{variant:"secondary",className:"glass-effect",children:[I," - Test ",A]})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-primary",children:[n.jsx(ot,{className:"w-4 h-4"}),n.jsxs("span",{children:[(null==m?void 0:m.time_limit)||60," minutes"]})]}),n.jsx(qr,{className:"btn-primary",size:"sm",children:"Submit Test"})]})]})})}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[L.length>1&&n.jsx(Rr,{className:"card-modern",children:n.jsxs(Dr,{children:[n.jsx(Fr,{className:"text-center text-2xl",children:"Select Writing Task"}),n.jsx("div",{className:"flex justify-center gap-2 mt-4",children:L.map(e=>n.jsxs(qr,{variant:(null==m?void 0:m.task_type)===e.type?"default":"outline",onClick:()=>(e=>{const t=l.find(t=>t.task_type===e);t&&(h(t),_(parseInt(e.replace("task",""))),p(""),y(null),j(0))})(e.type),disabled:x,className:"min-w-24",children:["Task ",e.number]},e.type))})]})}),n.jsxs(Rr,{className:"card-modern",children:[n.jsx(Dr,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Fr,{className:"text-xl",children:["Writing ",m.task_type.charAt(0).toUpperCase()+m.task_type.slice(1),m.task_number&&` - ${m.task_number}`]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(xo,{variant:"outline",children:[m.word_limit," words minimum"]}),n.jsxs(xo,{variant:"outline",children:[m.time_limit," minutes"]})]})]})}),n.jsxs(Br,{children:[n.jsxs("div",{className:"bg-brand-blue/5 border border-brand-blue/20 p-6 rounded-xl mb-6",children:[n.jsx("h3",{className:"font-semibold mb-3 text-brand-blue",children:"Task Instructions:"}),n.jsx("div",{className:"text-sm leading-relaxed text-text-primary",children:m.prompt_text}),m.image_url&&n.jsx("div",{className:"mt-4",children:n.jsx("img",{src:m.image_url,alt:"Task 1 Chart/Graph",className:"max-w-full max-h-80 object-contain border border-border rounded-lg shadow-sm mx-auto"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"text-sm font-medium",children:"Your Response:"}),n.jsxs("div",{className:"text-sm text-text-secondary",children:["Word count: ",n.jsx("span",{className:v<m.word_limit?"text-brand-red":"text-brand-green font-semibold",children:v})," / ",m.word_limit," minimum"]})]}),n.jsx(fo,{value:g,onChange:e=>(e=>{p(e);const t=e.trim().split(/\s+/).filter(e=>e.length>0);j(t.length)})(e.target.value),placeholder:`Start writing your response for ${m.task_type}...`,className:"min-h-[350px] text-sm leading-relaxed input-modern",disabled:x}),n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-surface-2 rounded-xl border border-border",children:[n.jsx(ne,{className:"w-5 h-5 text-brand-blue"}),n.jsxs("div",{className:"flex-1",children:[n.jsx(Mn,{htmlFor:"feedback-language-writing",className:"text-sm font-medium mb-1 block",children:"Feedback Language"}),n.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Choose your preferred language for explanations. Your writing and key terms will remain in English."}),n.jsxs(Wr,{value:T,onValueChange:C,children:[n.jsx(Gr,{id:"feedback-language-writing",className:"w-full max-w-xs",children:n.jsx(Ur,{placeholder:"Select language"})}),n.jsxs(Jr,{children:[n.jsx(Xr,{value:"en",children:"English"}),n.jsx(Xr,{value:"zh",children:" (Chinese)"}),n.jsx(Xr,{value:"es",children:"Espaol (Spanish)"}),n.jsx(Xr,{value:"fr",children:"Franais (French)"}),n.jsx(Xr,{value:"de",children:"Deutsch (German)"}),n.jsx(Xr,{value:"ja",children:" (Japanese)"}),n.jsx(Xr,{value:"ko",children:" (Korean)"}),n.jsx(Xr,{value:"ar",children:" (Arabic)"}),n.jsx(Xr,{value:"pt",children:"Portugus (Portuguese)"}),n.jsx(Xr,{value:"ru",children:" (Russian)"}),n.jsx(Xr,{value:"hi",children:" (Hindi)"}),n.jsx(Xr,{value:"vi",children:"Ting Vit (Vietnamese)"})]})]})]})]}),n.jsxs("div",{className:"space-y-3 p-4 border border-border/50 rounded-lg bg-surface-2",children:[n.jsx(Mn,{className:"text-sm font-medium",children:"Choose AI Provider:"}),n.jsxs(Co,{value:E,onValueChange:e=>S(e),className:"flex gap-6",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Io,{value:"gemini",id:"gemini"}),n.jsx(Mn,{htmlFor:"gemini",className:"cursor-pointer",children:"Google Gemini"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Io,{value:"openai",id:"openai"}),n.jsx(Mn,{htmlFor:"openai",className:"cursor-pointer",children:"OpenAI GPT"})]})]})]}),n.jsx(qr,{onClick:async()=>{var e;if(g.trim().length<50)i({title:"Text too short",description:"Please write more content before requesting feedback.",variant:"destructive"});else{f(!0);try{console.log(" Requesting AI feedback for writing...");const{data:s,error:a}=await jr.functions.invoke("ielts-writing-examiner",{body:{task1Answer:"task1"===(null==m?void 0:m.task_type)?g:"Not completed",task2Answer:"task2"===(null==m?void 0:m.task_type)?g:"Not completed",task1Data:"task1"===(null==m?void 0:m.task_type)?{title:(null==m?void 0:m.title)||"Task 1",instructions:(null==m?void 0:m.prompt_text)||"",imageUrl:null==m?void 0:m.image_url}:{},task2Data:"task2"===(null==m?void 0:m.task_type)?{title:(null==m?void 0:m.title)||"Task 2",instructions:(null==m?void 0:m.prompt_text)||""}:{},apiProvider:E,targetLanguage:"en"!==T?T:void 0}});if(a)throw a;if(!s.success)throw new Error(s.error||"Analysis failed");y(s.feedback);try{const{data:{user:t}}=await jr.auth.getUser();if(t){console.log(" Saving writing test results for user:",t.id);const{data:a,error:r}=await jr.from("test_results").insert({user_id:t.id,test_type:"writing",total_questions:1,correct_answers:1,score_percentage:85,time_taken:60*((null==m?void 0:m.time_limit)||60),test_data:{prompt:m,response:g,word_count:v,feedback:s.feedback}}).select().single();if(r)throw console.error(" Error saving test result:",r),r;console.log(" Test result saved:",a);const{error:n}=await jr.from("writing_test_results").insert({user_id:t.id,test_result_id:a.id,task_number:(null==m?void 0:m.task_number)||1,prompt_text:(null==m?void 0:m.prompt_text)||"",user_response:g,word_count:v,band_scores:(null==(e=s.structured)?void 0:e.criteria)||null,detailed_feedback:s.feedback,structured:s.structured||null,improvement_suggestions:[],time_taken_seconds:60*((null==m?void 0:m.time_limit)||60)});if(n)throw console.error(" Error saving writing result:",n),n;console.log(" Writing test results saved successfully"),i({title:"Results Saved",description:"Your writing test results have been saved to your dashboard!"})}}catch(t){console.error(" Error saving writing results:",t),i({title:"Save Failed",description:"Your feedback was generated but results couldn't be saved. Please contact support.",variant:"destructive"})}console.log(" AI feedback received successfully"),i({title:"Writing Analysis Complete",description:"Your writing has been analyzed with detailed IELTS band scores!"})}catch(s){console.error(" Feedback error:",s),i({title:"Analysis Failed",description:s.message||"Could not analyze your writing. Please try again.",variant:"destructive"})}finally{f(!1)}}},disabled:x||g.trim().length<50,className:"w-full btn-primary",children:x?n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(Qr,{size:"sm",message:`Analyzing with ${"gemini"===E?"Gemini":"OpenAI"}...`})}):`Get AI Feedback & IELTS Band Score (${"gemini"===E?"Gemini":"OpenAI"})`})]})]})]}),b&&n.jsxs(Rr,{className:"card-modern",children:[n.jsx(Dr,{children:n.jsxs(Fr,{className:"flex items-center gap-2",children:[n.jsx(rt,{className:"w-5 h-5 text-brand-blue"}),"IELTS Writing Analysis & Band Score"]})}),n.jsx(Br,{children:n.jsx("div",{className:"prose max-w-none",children:n.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed bg-surface-3 p-4 rounded-xl",children:b})})})]})]})})]})},Jl=({onRecordingComplete:e,disabled:t=!1,autoFocus:s=!1})=>{const[a,i]=r.useState(!1),[o,l]=r.useState(!1),[c,d]=r.useState(null),[u,m]=r.useState(0),h=r.useRef(null),g=r.useRef(null),p=r.useRef(null),x=r.useRef([]),f=r.useRef(null),[b,y]=r.useState(null),[v,j]=r.useState(!1),{toast:w}=Ts();r.useEffect(()=>{var e;!s||a||c||null==(e=f.current)||e.focus()},[s,a,c]),r.useCallback(()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),s=e.createGain();t.type="sine",t.frequency.value=880,t.connect(s),s.connect(e.destination),s.gain.setValueAtTime(1e-4,e.currentTime),s.gain.exponentialRampToValueAtTime(.15,e.currentTime+.01),t.start(),setTimeout(()=>{s.gain.exponentialRampToValueAtTime(1e-5,e.currentTime+.12),setTimeout(()=>{t.stop(),e.close()},150)},100)}catch(e){}},[]);const _=r.useCallback(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:44100,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),s=new MediaRecorder(t,{mimeType:"audio/webm;codecs=opus"});h.current=s,x.current=[],s.ondataavailable=e=>{e.data.size>0&&x.current.push(e.data)},s.onstop=()=>{const s=new Blob(x.current,{type:"audio/webm"});d(s),e(s),t.getTracks().forEach(e=>e.stop())},s.start(1e3),i(!0),m(0),p.current=setInterval(()=>{m(e=>e+1)},1e3)}catch(t){console.error("Error starting recording:",t),w({title:"Recording Error",description:"Could not access microphone. Please check permissions.",variant:"destructive"})}},[e,w]),N=r.useCallback(()=>{h.current&&a&&(h.current.stop(),i(!1),p.current&&(clearInterval(p.current),p.current=null))},[a]),k=r.useCallback(()=>{if(c&&!o){const e=URL.createObjectURL(c),t=new Audio(e);g.current=t,t.onended=()=>{l(!1),URL.revokeObjectURL(e)},t.play(),l(!0)}},[c,o]),E=r.useCallback(()=>{g.current&&o&&(g.current.pause(),l(!1))},[o]),S=r.useCallback(()=>{d(null),m(0),l(!1),g.current&&(g.current.pause(),g.current=null)},[]);return n.jsx("div",{className:"w-full",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-mono text-primary",children:(T=u,`${Math.floor(T/60)}:${(T%60).toString().padStart(2,"0")}`)}),a&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mt-2",children:[n.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse"}),n.jsx("span",{className:"text-sm",children:"Recording..."})]})]}),v&&n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center text-3xl font-semibold text-primary",children:b})}),n.jsxs("div",{className:"flex justify-center gap-4",children:[!a&&!c&&n.jsxs(qr,{ref:f,onClick:_,disabled:t,size:"lg",children:[n.jsx(jt,{className:"w-5 h-5 mr-2"}),"Start recording"]}),a&&n.jsxs(qr,{onClick:N,size:"lg",variant:"secondary",children:[n.jsx(wt,{className:"w-5 h-5 mr-2"}),"Stop Recording"]}),c&&!a&&n.jsxs(n.Fragment,{children:[n.jsx(qr,{onClick:o?E:k,size:"lg",variant:"outline",children:o?n.jsxs(n.Fragment,{children:[n.jsx(ft,{className:"w-5 h-5 mr-2"}),"Pause"]}):n.jsxs(n.Fragment,{children:[n.jsx(bt,{className:"w-5 h-5 mr-2"}),"Play"]})}),n.jsxs(qr,{onClick:S,size:"lg",variant:"outline",children:[n.jsx(gt,{className:"w-5 h-5 mr-2"}),"Record Again"]})]})]}),c&&n.jsx("div",{className:"text-center text-sm text-muted-foreground",children:'Recording complete! Click "Get Analysis" to receive detailed feedback.'})]})});var T};function Xl({defaultValue:e=50,onVolumeChange:t,className:s="",showValueIndicator:a=!0}){const[i,o]=r.useState(!1);return n.jsx("div",{className:`slider-container ${s}`,style:{width:i?void 0:"auto"},children:n.jsx(Ql,{defaultValue:e,startingValue:0,maxValue:100,onVolumeChange:e=>{document.querySelectorAll("audio").forEach(t=>{t.volume=e/100});try{window.localStorage.setItem("appAudioVolume",String(e)),window.dispatchEvent(new CustomEvent("app:volume-change",{detail:{volume:e/100}}))}catch{}null==t||t(e)},rightIcon:n.jsx(at,{size:20}),showValueIndicator:a&&i,expanded:i,onToggleExpanded:()=>o(e=>!e)})})}function Ql({defaultValue:e,startingValue:t,maxValue:s,onVolumeChange:a,rightIcon:i,showValueIndicator:o=!0,expanded:l,onToggleExpanded:c}){const[d,u]=r.useState(e),m=r.useRef(null),[h,g]=r.useState("middle"),p=Ct(0),x=Ct(0);r.useEffect(()=>{u(e)},[e]),r.useEffect(()=>{null==a||a(d)},[d,a]),It(p,"change",e=>{if(m.current){const{left:t,right:s}=m.current.getBoundingClientRect();let a;e<t?(g("left"),a=t-e):e>s?(g("right"),a=e-s):(g("middle"),a=0),x.jump(function(e,t){const s=e/t;return 2*(1/(1+Math.exp(-s))-.5)*t}(a,50))}});const f=e=>{if(e.buttons>0&&m.current){const{left:a,width:r}=m.current.getBoundingClientRect();let n=t+(e.clientX-a)/r*(s-t);n=Math.min(Math.max(n,t),s),u(n),p.jump(e.clientX)}};return n.jsxs(n.Fragment,{children:[n.jsxs(Et.div,{className:"slider-wrapper",children:[n.jsx("div",{ref:m,className:"slider-root",onPointerMove:l?f:void 0,onPointerDown:l?e=>{f(e),e.currentTarget.setPointerCapture(e.pointerId)}:void 0,onPointerUp:l?()=>{At(x,0,{type:"spring",bounce:.5})}:void 0,children:l&&n.jsx("div",{className:"slider-track-wrapper",children:n.jsx("div",{className:"slider-track",children:n.jsx("div",{className:"slider-range",style:{width:`${(()=>{const e=s-t;return 0===e?0:(d-t)/e*100})()}%`}})})})}),n.jsx("div",{onClick:c,className:"cursor-pointer",children:i})]}),o&&n.jsx("p",{className:"value-indicator",children:Math.round(d)})]})}const Kl=({partNumber:e,onComplete:t})=>{const{toast:s}=Ts(),[a,i]=r.useState([]),[o,l]=r.useState(0),[c,d]=r.useState([]),[u,m]=r.useState(!0),[h,g]=r.useState(!1),[p,x]=r.useState({});r.useEffect(()=>{f()},[e]);const f=async()=>{try{m(!0);const{data:t,error:a}=await jr.from("speaking_prompts").select("*").eq("part_number",e).order("id");if(a)throw a;if(t&&t.length>0){const e=t.map(e=>({...e,follow_up_questions:Array.isArray(e.follow_up_questions)?e.follow_up_questions:[]}));i(e)}else s({title:"No questions available",description:`No speaking questions found for Part ${e}`,variant:"destructive"})}catch(t){console.error("Error loading questions:",t),s({title:"Error loading questions",description:t.message,variant:"destructive"})}finally{m(!1)}};if(u)return n.jsx("div",{className:"text-center py-8",children:n.jsx(Qr,{size:"md",message:"Loading questions..."})});if(0===a.length)return n.jsx("div",{className:"text-center py-8",children:n.jsxs("p",{className:"text-muted-foreground",children:["No questions available for Part ",e]})});const b=a[o],y=o===a.length-1,v=c[o];return n.jsxs(Rr,{children:[n.jsx(Dr,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(Fr,{className:"font-georgia",children:[" Part ",e," - Question ",o+1," of ",a.length]}),n.jsxs(xo,{variant:"outline",children:[b.time_limit," minutes"]})]}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx(Xl,{defaultValue:50,className:"w-64 md:w-80"}),n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>(async(e,t)=>{if(e){g(!0);try{if(p[t]){console.log(" Efficient Voice: Reusing saved audio for question",t);const e=new Audio(p[t]);return e.onended=()=>g(!1),e.onerror=()=>{g(!1),s({title:"Audio playback failed",description:"Could not play the saved question audio",variant:"destructive"})},void(await e.play())}console.log(" Efficient Voice: Using audio cache for question",t);const{data:a,error:r}=await jr.functions.invoke("audio-cache",{body:{text:e,voice:"alloy",questionId:t}});if(r)throw r;if(a.success){const e=a.cached?a.audioContent:`data:audio/mp3;base64,${a.audioContent}`;x(s=>({...s,[t]:e})),console.log(` Efficient Voice: Audio ${a.cached?"reused from cache":"generated and cached"} - cost efficient!`);const r=new Audio(e);r.onended=()=>g(!1),r.onerror=()=>{g(!1),s({title:"Audio playback failed",description:"Could not play the question audio",variant:"destructive"})},await r.play()}}catch(a){console.error("TTS error:",a),g(!1),s({title:"Voice generation failed",description:"Could not generate question audio",variant:"destructive"})}}})(b.prompt_text,b.id),disabled:h,children:[n.jsx(at,{className:"w-4 h-4 mr-2"}),h?"Playing...":"Hear Question"]})]})]})}),n.jsx(Br,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gentle-blue/10 border border-gentle-blue/20 p-6 rounded-lg",children:[n.jsx("h3",{className:"font-semibold mb-3 text-gentle-blue",children:" Question:"}),n.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:b.prompt_text}),b.follow_up_questions&&Array.isArray(b.follow_up_questions)&&b.follow_up_questions.length>0&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-gentle-blue/20",children:[n.jsx("h4",{className:"font-medium mb-2 text-gentle-blue",children:"Follow-up questions:"}),n.jsx("ul",{className:"text-sm space-y-1",children:b.follow_up_questions.map((e,t)=>n.jsxs("li",{className:"text-muted-foreground",children:[" ",e]},t))})]})]}),n.jsxs("div",{className:"border rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium mb-3",children:" Record your answer:"}),n.jsx(Jl,{onRecordingComplete:async e=>{const t=a[o],s={questionId:t.id,questionText:t.prompt_text,audioBlob:e,timestamp:(new Date).toISOString()},r=[...c];r[o]=s,d(r)},disabled:!1})]}),n.jsxs("div",{className:"flex justify-between items-center pt-4",children:[n.jsxs(qr,{variant:"outline",onClick:()=>{o>0&&l(o-1)},disabled:0===o,children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Previous"]}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Question ",o+1," of ",a.length]}),n.jsx(qr,{onClick:()=>{o<a.length-1?l(o+1):t(c)},disabled:!v,variant:y?"default":"outline",children:y?n.jsxs(n.Fragment,{children:["Complete Part ",e]}):n.jsxs(n.Fragment,{children:["Next",n.jsx(je,{className:"w-4 h-4 ml-2"})]})})]})]})})]})},Zl=()=>{const e=o(),{toast:t}=Ts(),[s,a]=r.useState(!1),[i,l]=r.useState(null),[c,d]=r.useState(null),[u,m]=r.useState(!1),{currentPrompt:h,currentPart:g,timeRemaining:p,isTimerActive:x,isLoading:f,isPlayingPrompt:b,playPromptAudio:y,startTimer:v,stopTimer:j,resetTimer:w,changePart:_,formatTime:N,loadRandomPrompt:k}=(()=>{const[e,t]=r.useState(null),[s,a]=r.useState(1),[n,i]=r.useState(0),[o,l]=r.useState(!1),[c,d]=r.useState(!1),[u,m]=r.useState(!1),{toast:h}=Ts(),g=r.useCallback(async e=>{d(!0);try{const{data:s,error:a}=await jr.from("speaking_prompts").select("*").eq("part_number",e);if(a)throw a;if(s&&s.length>0){const e=s[Math.floor(Math.random()*s.length)];t(e),i(60*e.time_limit),await p(e.prompt_text)}else h({title:"No questions available",description:`No speaking questions found for Part ${e}`,variant:"destructive"})}catch(s){console.error("Error loading prompt:",s),h({title:"Error loading question",description:s.message,variant:"destructive"})}finally{d(!1)}},[h]),p=async e=>{if(e){m(!0);try{const{data:t,error:s}=await jr.functions.invoke("audio-cache",{body:{text:e,voice_id:"9BWtsMINqrJLrRacOk9x"}});if(s)throw s;if(null==t?void 0:t.audioContent){const e=new Audio(t.audioContent);e.onended=()=>{m(!1)},e.onerror=()=>{m(!1),h({title:"Audio playback failed",description:"Could not play the question audio",variant:"destructive"})},await e.play()}}catch(t){console.error("OpenAI TTS error:",t),m(!1),h({title:"Voice generation failed",description:"Could not generate question audio",variant:"destructive"})}}};return r.useEffect(()=>{let e;return o&&n>0&&(e=setInterval(()=>{i(e=>e<=1?(l(!1),h({title:"Time's up!",description:"The time limit for this part has been reached."}),0):e-1)},1e3)),()=>clearInterval(e)},[o,n,h]),r.useEffect(()=>{g(1)},[g]),{currentPrompt:e,currentPart:s,timeRemaining:n,isTimerActive:o,isLoading:c,isPlayingPrompt:u,loadRandomPrompt:g,playPromptAudio:p,startTimer:()=>{l(!0)},stopTimer:()=>{l(!1)},resetTimer:()=>{l(!1),e&&i(60*e.time_limit)},changePart:async e=>{a(e),l(!1),await g(e)},formatTime:e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}}})(),E=e=>{switch(e){case 1:return"Introduction & Interview (4-5 minutes)";case 2:return"Long Turn (3-4 minutes, including 1 minute preparation)";case 3:return"Discussion (4-5 minutes)";default:return""}},S={title:"IELTS Speaking Practice | AI Examiner Feedback & Transcripts",description:"Record IELTS Speaking responses, get instant transcripts, fluency analytics, pronunciation tips, and follow-up questions built by real examiners.",keywords:"IELTS speaking practice, AI speaking examiner, IELTS speaking feedback, pronunciation analysis, IELTS speaking timer",type:"article",schemaType:"faq",url:"https://englishaidol.com/speaking",faqs:[{question:"How does the AI evaluate my IELTS Speaking performance?",answer:"It listens to your recording, transcribes it, then scores Fluency, Lexical Resource, Grammar, and Pronunciation based on examiner rubrics, delivering actionable tips."},{question:"Can I practice Part 1, Part 2, and Part 3 questions?",answer:"Yes. Switch between all three parts, hear follow-up questions, and use the built-in timer to mimic the real interview experience."}]};return f?n.jsxs(n.Fragment,{children:[n.jsx(bn,{...S}),n.jsx("div",{className:"min-h-screen glass-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ce,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-brand-blue"}),n.jsx("p",{className:"text-text-secondary",children:"Loading speaking test..."})]})})]}):h?n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-surface-1/30 to-primary/5",children:[n.jsx(bn,{...S}),n.jsx("header",{className:"border-b border-border/60 bg-background/80 backdrop-blur-xl shadow-sm",children:n.jsx("div",{className:"container mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>e("/"),className:"hover:bg-primary/10",children:[n.jsx(it,{className:"w-4 h-4"}),"Back to Dashboard"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-2xl bg-primary/10 flex items-center justify-center",children:n.jsx(jt,{className:"w-5 h-5 text-primary"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"font-semibold text-text-primary",children:"IELTS Speaking Practice"}),n.jsx("p",{className:"text-xs text-text-secondary",children:"AI-Powered Speech Analysis"})]})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(Xl,{defaultValue:50,className:"w-32"}),n.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-surface-1 rounded-xl",children:[n.jsx(ot,{className:"w-4 h-4 text-primary"}),n.jsx("span",{className:"font-mono text-sm "+(p<60?"text-destructive":"text-text-primary"),children:N(p)})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(qr,{variant:"outline",size:"sm",onClick:x?j:v,className:"hover:bg-primary/10 border-primary/20",children:[x?n.jsx(ft,{className:"w-4 h-4"}):n.jsx(bt,{className:"w-4 h-4"}),x?"Pause":"Start"]}),n.jsxs(qr,{variant:"outline",size:"sm",onClick:w,className:"hover:bg-secondary/10 border-secondary/20",children:[n.jsx(gt,{className:"w-4 h-4"}),"Reset"]})]})]})]})})}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsx(Rr,{className:"bg-gradient-to-r from-background via-surface-1/50 to-background border border-border/60 shadow-lg",children:n.jsxs(Dr,{className:"pb-6",children:[n.jsxs("div",{className:"text-center space-y-3",children:[n.jsx("div",{className:"w-16 h-16 mx-auto rounded-3xl bg-primary/10 flex items-center justify-center mb-4",children:n.jsx(jt,{className:"w-8 h-8 text-primary"})}),n.jsx(Fr,{className:"text-3xl font-medium bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"IELTS Speaking Practice"}),n.jsx("p",{className:"text-text-secondary max-w-2xl mx-auto",children:"Experience an authentic IELTS speaking test with advanced AI analysis and instant feedback"})]}),n.jsx("div",{className:"flex justify-center gap-3 mt-8",children:[1,2,3].map(e=>{var t;return n.jsxs(qr,{variant:g===e?"default":"outline",onClick:()=>_(e),disabled:s||b,className:"flex flex-col h-auto p-6 min-w-[140px] transition-all duration-300 "+(g===e?"bg-primary text-primary-foreground shadow-lg scale-105":"hover:bg-primary/5 hover:border-primary/30 hover:scale-102"),children:[n.jsxs("span",{className:"font-semibold text-lg",children:["Part ",e]}),n.jsx("span",{className:"text-xs opacity-75 mt-1 text-center leading-tight",children:E(e).split("(")[0].trim()}),n.jsx("span",{className:"text-xs opacity-60 mt-1",children:(null==(t=E(e).match(/\((.*?)\)/))?void 0:t[1])||""})]},e)})}),(1===g||3===g)&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsx(qr,{variant:"outline",onClick:()=>m(!u),className:"text-sm px-6 py-2 transition-all duration-300 "+(u?"bg-secondary/10 border-secondary/30 text-secondary":"hover:bg-primary/5 hover:border-primary/30"),children:u?" Switch to Free Practice":" One Question at a Time"})})]})}),(1===g||3===g)&&u&&n.jsx(Kl,{partNumber:g,onComplete:e=>{console.log(" Sequential Questions: Completed all questions with responses:",e.length),t({title:"Part Complete!",description:`All questions answered for Part ${g}`}),m(!1)}}),h&&!u&&n.jsxs(Rr,{className:"bg-gradient-to-br from-background to-surface-1/30 border border-border/60 shadow-lg",children:[n.jsxs(Dr,{className:"pb-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Fr,{className:"text-xl font-medium text-text-primary flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-xl bg-primary/10 flex items-center justify-center",children:n.jsx("span",{className:"text-lg",children:""})}),h.title," - Part ",g]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>y(h.prompt_text),disabled:b,className:"hover:bg-primary/10 border-primary/20",children:[n.jsx(at,{className:"w-4 h-4 mr-2"}),b?"Playing...":"Hear Question"]}),n.jsxs(qr,{variant:"outline",size:"sm",onClick:()=>k(g),disabled:s||b,className:"hover:bg-secondary/10 border-secondary/20",children:[n.jsx(gt,{className:"w-4 h-4 mr-2"}),"New Question"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[n.jsx(ot,{className:"w-4 h-4"}),n.jsx("span",{children:E(g)})]})]}),n.jsxs(Br,{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-r from-primary/5 to-secondary/5 border border-primary/20 p-6 rounded-2xl",children:[n.jsxs("h3",{className:"font-semibold mb-4 text-primary flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 rounded-lg bg-primary/10 flex items-center justify-center text-sm",children:""}),"Task Instructions"]}),n.jsx("p",{className:"leading-relaxed whitespace-pre-wrap text-text-primary",children:h.prompt_text}),h.follow_up_questions&&Array.isArray(h.follow_up_questions)&&h.follow_up_questions.length>0&&n.jsxs("div",{className:"mt-6 pt-4 border-t border-primary/20",children:[n.jsxs("h4",{className:"font-medium mb-3 text-primary flex items-center gap-2",children:[n.jsx("span",{className:"w-5 h-5 rounded-lg bg-primary/10 flex items-center justify-center text-xs",children:""}),"Follow-up Questions"]}),n.jsx("ul",{className:"space-y-2",children:h.follow_up_questions.map((e,t)=>n.jsxs("li",{className:"text-text-secondary flex items-start gap-2",children:[n.jsx("span",{className:"text-primary mt-1",children:""}),n.jsx("span",{children:e})]},t))})]})]}),n.jsx("div",{className:"text-center py-4 bg-surface-1/50 rounded-xl",children:n.jsx("p",{className:"text-text-secondary font-medium",children:2===g?" You have 1 minute to prepare, then speak for up to 2 minutes":1===g?" Speak naturally for 4-5 minutes":" Engage in discussion for 4-5 minutes"})}),n.jsx(Jl,{onRecordingComplete:async e=>{a(!0);try{const a=await(s=e,new Promise((e,t)=>{const a=new FileReader;a.onloadend=()=>{const t=a.result.split(",")[1];e(t)},a.onerror=t,a.readAsDataURL(s)})),{data:r,error:n}=await jr.functions.invoke("speech-analysis",{body:{audio:a,prompt:(null==h?void 0:h.prompt_text)||"",speakingPart:`Part ${g}`}});if(n)throw n;if(!r.success)throw new Error(r.error||"Analysis failed");d(r.transcription),l(r.analysis),t({title:"Analysis Complete ",description:"Your speech has been analyzed successfully!"})}catch(r){console.error("Analysis error:",r),t({title:"Analysis Failed",description:r.message||"Could not analyze your speech. Please try again.",variant:"destructive"})}finally{a(!1)}var s},disabled:s}),s&&n.jsxs("div",{className:"text-center py-12 bg-gradient-to-r from-primary/5 to-secondary/5 rounded-2xl",children:[n.jsx(ce,{className:"w-12 h-12 animate-spin mx-auto mb-6 text-primary"}),n.jsx("h3",{className:"font-semibold text-lg text-text-primary mb-2",children:"Analyzing Your Speech"}),n.jsx("p",{className:"text-text-secondary max-w-md mx-auto",children:" AI is evaluating pronunciation, fluency, intonation, and accent patterns to provide detailed feedback"})]})]})]}),c&&!u&&n.jsxs(Rr,{className:"bg-gradient-to-br from-secondary/5 to-background border border-secondary/20 shadow-lg",children:[n.jsx(Dr,{children:n.jsxs(Fr,{className:"text-xl font-medium text-text-primary flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-xl bg-secondary/10 flex items-center justify-center",children:n.jsx("span",{className:"text-lg",children:""})}),"Speech Transcription"]})}),n.jsx(Br,{children:n.jsx("div",{className:"bg-gradient-to-r from-surface-1 to-surface-1/50 p-6 rounded-2xl border border-border/60",children:n.jsxs("p",{className:"text-text-primary leading-relaxed text-lg italic",children:['"',c,'"']})})})]}),i&&!u&&n.jsxs(Rr,{className:"bg-gradient-to-br from-primary/5 to-background border border-primary/20 shadow-lg",children:[n.jsx(Dr,{children:n.jsxs(Fr,{className:"text-xl font-medium text-text-primary flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-xl bg-primary/10 flex items-center justify-center",children:n.jsx("span",{className:"text-lg",children:""})}),"AI Speech Analysis & Feedback"]})}),n.jsx(Br,{children:n.jsx("div",{className:"bg-gradient-to-r from-surface-1 to-surface-1/50 p-6 rounded-2xl border border-border/60",children:n.jsx("div",{className:"prose max-w-none",children:n.jsx("div",{className:"whitespace-pre-wrap leading-relaxed text-text-primary",children:i})})})})]})]})})]}):n.jsxs(n.Fragment,{children:[n.jsx(bn,{...S}),n.jsx("div",{className:"min-h-screen glass-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center glass-card p-8 rounded-2xl max-w-md",children:[n.jsx(jt,{className:"h-12 w-12 mx-auto mb-4 text-text-secondary"}),n.jsx("h2",{className:"text-heading-2 mb-2 text-text-primary",children:"No Speaking Test Available"}),n.jsx("p",{className:"text-text-secondary mb-6",children:"No speaking prompts found for this test. Please check with your instructor to upload content."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(qr,{onClick:()=>e(-1),variant:"outline",className:"w-full",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Go Back"]}),n.jsx(qr,{onClick:()=>e("/tests"),className:"w-full btn-primary",children:"Browse Other Tests"})]})]})})]})},ec="admin_session";function tc(){const[e,t]=r.useState(null),[s,a]=r.useState(!0);r.useEffect(()=>{console.log(" Checking admin session...");"true"===localStorage.getItem(ec)?(console.log(" Valid admin session found"),t({id:"admin",email:"admin@system.local",name:"Admin"})):(console.log(" No valid admin session"),t(null)),a(!1)},[]);return{admin:e,loading:s,login:async e=>{console.log(" Attempting admin login...");try{return"myye65402086"!==e?(console.log(" Invalid password"),{error:"Invalid password"}):(console.log(" Password validated"),localStorage.setItem(ec,"true"),t({id:"admin",email:"admin@system.local",name:"Admin"}),{success:!0})}catch(s){return console.error(" Error during admin login:",s),{error:"Failed to login"}}},logout:()=>{console.log(" Logging out admin..."),localStorage.removeItem(ec),t(null)},validateSession:()=>"true"===localStorage.getItem(ec)}}const sc=()=>{const e=o(),{toast:t}=Ts(),{login:s}=tc(),[a,i]=r.useState(""),[l,c]=r.useState(!1),[d,u]=r.useState(null),[m,h]=r.useState(!1),g=async()=>{if(a){c(!0);try{const r=await s(a);r.success?(console.log(" Login successful, localStorage admin_session set"),u(null),h(!1),t({title:"Access granted",description:"Welcome to the admin panel"}),e("/admin")):(console.log(" Login failed:",r.error),r.blocked?(h(!0),u(0)):(h(!1),u(r.remaining??null)),t({title:r.blocked?"Access Blocked":"Access denied",description:r.error||"Failed to login",variant:"destructive"}),r.blocked||i(""))}catch(r){console.error(" Login error:",r),t({title:"Error",description:"An unexpected error occurred",variant:"destructive"})}finally{c(!1)}}else t({title:"Password required",description:"Please enter the admin password",variant:"destructive"})};return n.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[n.jsx("div",{className:"fixed inset-0 w-full h-full",children:n.jsx("img",{src:"/lovable-uploads/c25cc620-ab6d-47a4-9dc6-32d1f6264773.png",alt:"Background",className:"absolute inset-0 w-full h-full object-cover"})}),n.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-screen p-4",children:n.jsxs("div",{className:"w-full max-w-md space-y-6",children:[n.jsxs("div",{className:"text-center space-y-2",children:[n.jsxs(qr,{variant:"ghost",size:"sm",onClick:()=>e("/"),className:"mb-4 bg-zinc-950/60 text-white hover:bg-zinc-800/80",children:[n.jsx(it,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"w-16 h-16 bg-white/10 border border-white/20 backdrop-blur-xl rounded-full flex items-center justify-center",children:n.jsx(Be,{className:"w-8 h-8 text-white"})})}),n.jsx("h1",{className:"text-2xl font-light text-zinc-950",children:"Admin Panel"}),n.jsx("p",{className:"text-zinc-700",children:"Enter password to access"})]}),n.jsxs(Rr,{className:"bg-white/10 border border-white/20 backdrop-blur-xl",children:[n.jsx(Dr,{children:n.jsx(Fr,{className:"text-zinc-950 font-normal",children:"Admin Access"})}),n.jsxs(Br,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium text-zinc-950",children:"Password"}),n.jsx(Vr,{type:"password",placeholder:"Enter admin password",value:a,onChange:e=>{i(e.target.value),(null!==d||m)&&(u(null),h(!1))},onKeyPress:e=>{"Enter"===e.key&&g()},disabled:l||m,className:"bg-white/20 border-white/30 text-zinc-950 placeholder:text-zinc-600"}),null!==d&&d>0&&!m&&n.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:[d," attempt",1!==d?"s":""," remaining"]}),m&&n.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"Too many failed attempts. Please try again in 30 minutes."})]}),n.jsx(qr,{onClick:g,className:"w-full",disabled:l||!a||m,children:l?"Accessing...":m?"Blocked - Try Again Later":"Access Admin Panel"})]})]})]})})]})},ac=r.lazy(()=>_(()=>import("./AdminDashboard-BlYBvKdz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),rc=r.lazy(()=>_(()=>import("./AdminReading-DVVZKHJE.js"),__vite__mapDeps([11,1,2,3,12,13,5,4,14,15,6,7,8,9,10]))),nc=r.lazy(()=>_(()=>import("./AdminListening-RM1NW6mv.js"),__vite__mapDeps([16,1,2,3,13,5,14,15,4,6,7,8,9,10]))),ic=r.lazy(()=>_(()=>import("./AdminWriting-DeEdhadV.js"),__vite__mapDeps([17,1,2,3,13,5,4,6,7,8,9,10]))),oc=r.lazy(()=>_(()=>import("./AdminSpeaking-Cfaw5nFZ.js"),__vite__mapDeps([18,1,2,3,13,5,4,6,7,8,9,10]))),lc=r.lazy(()=>_(()=>import("./AdminIELTS-DajXv7Xw.js"),__vite__mapDeps([19,1,2,3,20,5,21,22,4,14,15,23,6,7,8,9,10]))),cc=r.lazy(()=>_(()=>import("./AdminPTE-DxlsWTNO.js"),__vite__mapDeps([24,1,2,3,20,5,21,4,6,7,8,9,10]))),dc=r.lazy(()=>_(()=>import("./AdminTOEFL-BqLV7H6-.js"),__vite__mapDeps([25,1,2,3,20,5,21,4,14,15,26,6,7,8,9,10]))),uc=r.lazy(()=>_(()=>import("./AdminTOEIC-Dg0VDV-2.js"),__vite__mapDeps([27,1,2,3,20,5,21,22,4,6,7,8,9,10]))),mc=r.lazy(()=>_(()=>import("./AdminTOEICListening-DbZn3VX1.js"),__vite__mapDeps([28,1,2,3,20,5,4,29,6,7,8,9,10]))),hc=r.lazy(()=>_(()=>import("./AdminTOEICReading-DdMh45Og.js"),__vite__mapDeps([30,1,2,3,20,5,4,29,6,7,8,9,10]))),gc=r.lazy(()=>_(()=>import("./TOEICListeningTest-Cc7CWJNO.js"),__vite__mapDeps([31,1,2,3,32,33,5,6,7,8,9,10]))),pc=r.lazy(()=>_(()=>import("./TOEICReadingTest-D3Vyaz9u.js"),__vite__mapDeps([34,1,2,3,35,5,6,7,8,9,10]))),xc=r.lazy(()=>_(()=>import("./TOEICReadingResult-nomw-Rlq.js"),__vite__mapDeps([36,1,2,3,35,5,13,6,7,8,9,10]))),fc=r.lazy(()=>_(()=>import("./TOEICPortal-h17OhRcr.js"),__vite__mapDeps([37,1,2,3,5,6,7,8,9,10]))),bc=r.lazy(()=>_(()=>import("./AdminPTESpeakingWriting-K4gNoZqa.js"),__vite__mapDeps([38,1,2,3,22,5,4,6,7,8,9,10]))),yc=r.lazy(()=>_(()=>import("./AdminPTEReading-C0vNwzX7.js"),__vite__mapDeps([39,1,2,3,20,5,22,4,29,6,7,8,9,10]))),vc=r.lazy(()=>_(()=>import("./AdminPTEListening-DrEytk62.js"),__vite__mapDeps([40,1,2,3,20,5,22,4,29,6,7,8,9,10]))),jc=r.lazy(()=>_(()=>import("./PTESpeakingWritingTest-BEm5eibL.js"),__vite__mapDeps([41,1,2,3,42,5,6,7,8,9,10]))),wc=r.lazy(()=>_(()=>import("./PTEReadingTest-DvE6Fclm.js"),__vite__mapDeps([43,1,2,3,44,5,6,7,8,9,10]))),_c=r.lazy(()=>_(()=>import("./PTEListeningTest-BVA66RVx.js"),__vite__mapDeps([45,1,2,3,44,5,20,6,7,8,9,10]))),Nc=r.lazy(()=>_(()=>import("./AdminGeneral-OBov-yx4.js"),__vite__mapDeps([46,1,2,3,20,5,21,4,14,15,26,6,7,8,9,10]))),kc=r.lazy(()=>_(()=>import("./PersonalPage-GZR1CAfA.js"),__vite__mapDeps([47,1,2,3,20,5,32,33,6,7,8,9,10]))),Ec=r.lazy(()=>_(()=>Promise.resolve().then(()=>Eo),void 0)),Sc=r.lazy(()=>_(()=>import("./TestSelection-7JEO0pyc.js"),__vite__mapDeps([48,1,2,3,5,6,7,8,9,10]))),Tc=r.lazy(()=>_(()=>import("./Auth-Ch8JR-85.js"),__vite__mapDeps([49,1,2,3,5,6,7,8,9,10]))),Cc=r.lazy(()=>_(()=>import("./NotFound-Czk44B-Y.js"),__vite__mapDeps([50,1,2,3]))),Ic=r.lazy(()=>_(()=>import("./CommunityPage-CZ8A7Cf4.js"),__vite__mapDeps([51,1,2,3,6,5,7,8,9,10]))),Ac=r.lazy(()=>_(()=>import("./SettingsPage-CcaEBvUt.js"),__vite__mapDeps([52,1,2,3,53,5,21,22,6,7,8,9,10]))),Pc=r.lazy(()=>_(()=>import("./PTEPortal-DTE2JB1X.js"),__vite__mapDeps([54,1,2,3,20,5,6,7,8,9,10]))),Lc=r.lazy(()=>_(()=>import("./TOEFLPortal-lK1UJTM_.js"),__vite__mapDeps([55,1,2,3,5,6,7,8,9,10]))),Mc=r.lazy(()=>_(()=>import("./GeneralPortal-DWymOHfc.js"),__vite__mapDeps([56,1,2,3,5,6,7,8,9,10]))),Oc=r.lazy(()=>_(()=>import("./EnhancedGeneralPortal-Dvt28ArJ.js"),__vite__mapDeps([57,1,2,3,5,6,7,8,9,10]))),Rc=r.lazy(()=>_(()=>import("./IELTSPortal-BqZ4uBmw.js"),__vite__mapDeps([58,1,2,3,23,5,6,7,8,9,10]))),Dc=r.lazy(()=>_(()=>import("./IELTSSkillHub-GQ4cGBC-.js"),__vite__mapDeps([59,1,2,3,5,6,7,8,9,10]))),Fc=r.lazy(()=>_(()=>import("./IELTSSkillTests-G5P5wtqU.js"),__vite__mapDeps([60,1,2,3,6,5,7,8,9,10]))),zc=r.lazy(()=>_(()=>import("./AdminIELTSSkillManagement-CTENchny.js"),__vite__mapDeps([61,1,2,3,22,5,4,6,7,8,9,10]))),Bc=r.lazy(()=>_(()=>import("./IELTSTestModules-Cn0-1Ffu.js"),__vite__mapDeps([62,1,2,3,6,5,7,8,9,10]))),$c=r.lazy(()=>_(()=>import("./QwenTTSTest-BZ3ev3s3.js"),__vite__mapDeps([63,1,2,3,6,5,7,8,9,10]))),qc=r.lazy(()=>_(()=>import("./AdminTestManagement-Pc_BVGzw.js"),__vite__mapDeps([64,1,2,3,4,5,6,7,8,9,10]))),Vc=r.lazy(()=>_(()=>import("./AdminTestDetails-cXv_nqid.js"),__vite__mapDeps([65,1,2,3,20,5,4,14,15,6,7,8,9,10]))),Wc=r.lazy(()=>_(()=>import("./AdminSectionManagement-Hc9KYB58.js"),__vite__mapDeps([66,1,2,3,12,14,15,5,4,6,7,8,9,10]))),Uc=r.lazy(()=>_(()=>import("./AdminReadingManagement-DK21Vme7.js"),__vite__mapDeps([67,1,2,3,4,5,6,7,8,9,10]))),Gc=r.lazy(()=>_(()=>import("./AdminIELTSReadingDashboard-BnJyhP-0.js"),__vite__mapDeps([68,1,2,3,22,5,4,6,7,8,9,10]))),Yc=r.lazy(()=>_(()=>import("./AdminIELTSListening-0ue_dRHK.js"),__vite__mapDeps([69,6,1,2,3,4,5,29,7,8,9,10])));r.lazy(()=>_(()=>import("./AdminIELTSWriting-5bL1pBAh.js"),__vite__mapDeps([70,1,2,3,22,5,4,6,7,8,9,10])));const Hc=r.lazy(()=>_(()=>import("./AdminIELTSWritingTest-D066eo3Z.js"),__vite__mapDeps([71,1,2,3,21,5,4,72,6,7,8,9,10]))),Jc=r.lazy(()=>_(()=>import("./AdminIELTSReadingTest-CVCoAxAB.js"),__vite__mapDeps([73,1,2,3,20,5,4,29,6,7,8,9,10]))),Xc=r.lazy(()=>_(()=>import("./AdminIELTSSpeaking-Dkm6W-MR.js"),__vite__mapDeps([74,1,2,3,21,5,4,6,7,8,9,10]))),Qc=r.lazy(()=>_(()=>import("./IELTSWritingTest-D1kVLacz.js"),__vite__mapDeps([75,1,2,3,76,42,5,6,7,8,9,10]))),Kc=r.lazy(()=>_(()=>import("./IELTSWritingProResults-BfOAMYBg.js"),__vite__mapDeps([77,1,2,3,78,9,5,6,7,8,10]))),Zc=r.lazy(()=>_(()=>import("./IELTSWritingResults-DIWZr47U.js"),__vite__mapDeps([79,1,2,3,80,20,5,6,7,8,9,10]))),ed=r.lazy(()=>_(()=>import("./ReadingResults-DnLDmyUw.js"),__vite__mapDeps([81,1,2,3,13,5,32,33,6,7,8,9,10]))),td=r.lazy(()=>_(()=>import("./ListeningResults-DyP1R9N9.js"),__vite__mapDeps([82,1,2,3,32,33,5,6,7,8,9,10]))),sd=r.lazy(()=>_(()=>import("./IELTSSpeakingResults-CqcASzA2.js"),__vite__mapDeps([83,1,2,3,21,5,84,6,7,8,9,10]))),ad=r.lazy(()=>_(()=>import("./IELTSSpeakingTest-Bs8GJyw_.js"),__vite__mapDeps([85,1,2,3,21,5,35,84,9,72,86,33,42,76,6,7,8,10]))),rd=r.lazy(()=>_(()=>import("./EnhancedReadingTest-Dq746lm1.js"),__vite__mapDeps([87,1,2,3,78,5,6,7,8,9,10]))),nd=r.lazy(()=>_(()=>import("./Pricing-XLndgLk_.js"),__vite__mapDeps([88,1,2,3,5,6,7,8,9,10]))),id=r.lazy(()=>_(()=>import("./AdminSkillsPractice-BEKky-Jh.js"),__vite__mapDeps([89,1,2,3,4,5,23,6,7,8,9,10]))),od=r.lazy(()=>_(()=>import("./AdminSkillManager-ORYBkg2t.js"),__vite__mapDeps([90,1,2,3,4,5,21,23,6,7,8,9,10]))),ld=r.lazy(()=>_(()=>import("./SkillPractice-C6kBFoeB.js"),__vite__mapDeps([91,6,1,2,3,23,5,78,92,22,7,8,9,10]))),cd=r.lazy(()=>_(()=>import("./AISpeakingCall-D48zUMOK.js"),__vite__mapDeps([93,1,2,3,5,6,7,8,9,10]))),dd=r.lazy(()=>_(()=>import("./AISpeakingTutor-C0c99l_f.js"),__vite__mapDeps([94,1,2,3,5,6,7,8,9,10]))),ud=r.lazy(()=>_(()=>import("./AdminVocabularyTests-D8ERYCiE.js"),__vite__mapDeps([95,1,2,3,4,5,21,6,7,8,9,10]))),md=r.lazy(()=>_(()=>import("./AdminVocabBook-D_SDxoFs.js"),__vite__mapDeps([96,1,2,3,4,5,15,6,7,8,9,10]))),hd=r.lazy(()=>_(()=>import("./AdminVocabManager-BOHiqRWu.js"),__vite__mapDeps([97,1,2,3,5,6,7,8,9,10]))),gd=r.lazy(()=>_(()=>import("./AdminVocabularyTestDetail-BQBwDdbj.js"),__vite__mapDeps([98,1,2,3,4,5,21,15,99,6,7,8,9,10]))),pd=r.lazy(()=>_(()=>import("./AdminGrammarTests-D6P6iRnF.js"),__vite__mapDeps([100,1,2,3,4,5,21,6,7,8,9,10]))),xd=r.lazy(()=>_(()=>import("./AdminGrammarTestDetail-DM2ZVVGF.js"),__vite__mapDeps([101,1,2,3,4,5,21,15,99,6,7,8,9,10]))),fd=r.lazy(()=>_(()=>import("./AdminParaphrasingTests-sb3hjF2Q.js"),__vite__mapDeps([102,1,2,3,4,5,21,6,7,8,9,10]))),bd=r.lazy(()=>_(()=>import("./AdminParaphrasingTestDetail-BybOa-vb.js"),__vite__mapDeps([103,1,2,3,4,5,21,15,6,7,8,9,10]))),yd=r.lazy(()=>_(()=>import("./AdminPronunciationTests-yj87DG28.js"),__vite__mapDeps([104,1,2,3,4,5,21,6,7,8,9,10]))),vd=r.lazy(()=>_(()=>import("./AdminPronunciationTestDetail-BLPhW-Xe.js"),__vite__mapDeps([105,1,2,3,4,5,21,6,7,8,9,10]))),jd=r.lazy(()=>_(()=>import("./AdminSentenceScrambleTests-Xgd2A2db.js"),__vite__mapDeps([106,1,2,3,4,5,21,6,7,8,9,10]))),wd=r.lazy(()=>_(()=>import("./AdminSentenceScrambleTestDetail-BvHefOJr.js"),__vite__mapDeps([107,1,2,3,4,5,21,15,6,7,8,9,10]))),_d=r.lazy(()=>_(()=>import("./AdminListeningForDetailsTests-BoM9ArbT.js"),__vite__mapDeps([108,1,2,3,4,5,21,6,7,8,9,10]))),Nd=r.lazy(()=>_(()=>import("./AdminListeningForDetailsTestDetail-BXpVY_EW.js"),__vite__mapDeps([109,1,2,3,4,5,21,15,6,7,8,9,10]))),kd=r.lazy(()=>_(()=>import("./VocabularyQuiz-pDTWFX5G.js"),__vite__mapDeps([110,1,2,3,111,78,6,5,7,8,9,10])));r.lazy(()=>_(()=>import("./GrammarQuiz-CbrvS50L.js"),__vite__mapDeps([112,1,2,3,111,78,5,6,7,8,9,10])));const Ed=r.lazy(()=>_(()=>import("./ParaphraseQuiz-DcgsII6K.js"),__vite__mapDeps([113,1,2,3,111,78,6,5,7,8,9,10]))),Sd=r.lazy(()=>_(()=>import("./SentenceScrambleQuiz-CHpea66y.js"),__vite__mapDeps([114,1,2,3,6,5,7,8,9,10]))),Td=r.lazy(()=>_(()=>import("./ListeningQuiz-CQF9Veoh.js"),__vite__mapDeps([115,1,2,3,111,78,6,5,7,8,9,10]))),Cd=r.lazy(()=>_(()=>import("./VocabularyMap-DgpLx2CZ.js"),__vite__mapDeps([116,1,2,3,5,6,7,8,9,10]))),Id=r.lazy(()=>_(()=>import("./VocabularyBook-CdpNnBKu.js"),__vite__mapDeps([117,1,2,3,118,5,6,7,8,9,10])));r.lazy(()=>_(()=>import("./VocabHome-B0qE_mVv.js"),__vite__mapDeps([119,1,2,3,20,5,6,7,8,9,10])));const Ad=r.lazy(()=>_(()=>import("./VocabDeck-A9KxnDy0.js"),__vite__mapDeps([120,1,2,3,44,5,6,7,8,9,10]))),Pd=r.lazy(()=>_(()=>import("./VocabReview-B6BtXWm5.js"),__vite__mapDeps([121,1,2,3,6,5,7,8,9,10]))),Ld=r.lazy(()=>_(()=>import("./VocabLevels-DME58U_L.js"),__vite__mapDeps([122,1,2,3,118,5,6,7,8,9,10]))),Md=r.lazy(()=>_(()=>import("./VocabTest-C1Uk0NWx.js"),__vite__mapDeps([123,1,2,3,118,5,6,7,8,9,10,124]))),Od=r.lazy(()=>_(()=>import("./Signup-mUHpyKC6.js"),__vite__mapDeps([125,1,2,3,5,6,7,8,9,10]))),Rd=r.lazy(()=>_(()=>import("./AuthCallback-D4IpqJL9.js"),__vite__mapDeps([126,1,2,3,5,6,7,8,9,10]))),Dd=r.lazy(()=>_(()=>import("./VocabularyMapView-DwJe3eyJ.js"),__vite__mapDeps([92,1,2,3,22,5,6,7,8,9,10]))),Fd=r.lazy(()=>_(()=>import("./WritingHistory-BnWAbDXG.js"),__vite__mapDeps([127,1,2,3,5,6,7,8,9,10]))),zd=r.lazy(()=>_(()=>import("./WritingResultsDetail-CCrG3Zgf.js"),__vite__mapDeps([128,1,2,3,80,20,5,6,7,8,9,10]))),Bd=r.lazy(()=>_(()=>import("./Pay-abLPjvHr.js"),__vite__mapDeps([129,1,2,3,9,5,6,7,8,10]))),$d=r.lazy(()=>_(()=>import("./ResetPassword-37TfJbW1.js"),__vite__mapDeps([130,1,2,3,5,6,7,8,9,10]))),qd=r.lazy(()=>_(()=>import("./MyWordBook-BF3HBoNK.js"),__vite__mapDeps([131,1,2,3,44,5,6,7,8,9,10]))),Vd=r.lazy(()=>_(()=>import("./AdminAnalytics-CIxGjmBz.js"),__vite__mapDeps([132,1,2,3,4,5,6,7,8,9,10]))),Wd=r.lazy(()=>_(()=>import("./OnboardingAssessment-CoZ4e-6g.js"),__vite__mapDeps([133,1,2,3,134,6,5,7,8,9,10]))),Ud=r.lazy(()=>_(()=>import("./Plan-DMf8Wi4v.js"),__vite__mapDeps([135,1,2,3,134,6,5,7,8,9,10]))),Gd=r.lazy(()=>_(()=>import("./BlogListing-D4l7yp8I.js"),__vite__mapDeps([136,1,2,3,137,6,5,7,8,9,10]))),Yd=r.lazy(()=>_(()=>import("./BlogDetail-2_lR0XuC.js"),__vite__mapDeps([138,1,2,3,137,6,5,7,8,9,10]))),Hd=r.lazy(()=>_(()=>import("./AdminBlogManagement-626MnREE.js"),__vite__mapDeps([139,1,2,3,20,5,22,4,137,6,7,8,9,10]))),Jd=r.lazy(()=>_(()=>import("./AdminBookCreation-zxLCmRx2.js"),__vite__mapDeps([140,1,2,3,21,5,22,33,4,141,6,7,8,9,10]))),Xd=r.lazy(()=>_(()=>import("./AdminTemplates-CGQ7op9r.js"),__vite__mapDeps([142,1,2,3,53,5,22,4,6,7,8,9,10]))),Qd=r.lazy(()=>_(()=>import("./AdminAffiliates-DQ5MgS97.js"),__vite__mapDeps([143,1,2,3,20,5,22,12,4,6,7,8,9,10]))),Kd=r.lazy(()=>_(()=>import("./AdminAffiliateDetail-AydqUscM.js"),__vite__mapDeps([144,1,2,3,20,5,12,4,6,7,8,9,10]))),Zd=r.lazy(()=>_(()=>import("./GrammarPortal-DOwlaF70.js"),__vite__mapDeps([145,1,2,3,20,5,6,7,8,9,10]))),eu=r.lazy(()=>_(()=>import("./GrammarLesson-nWYHJstc.js"),__vite__mapDeps([146,1,2,3,20,5,6,7,8,9,10]))),tu=r.lazy(()=>_(()=>import("./AdminGrammarDashboard-DlqQXAuM.js"),__vite__mapDeps([147,1,2,3,4,5,20,53,33,6,7,8,9,10]))),su=r.lazy(()=>_(()=>import("./AdminGrammarLessonEditor-ClaVjqLe.js"),__vite__mapDeps([148,1,2,3,4,5,20,21,6,7,8,9,10]))),au=r.lazy(()=>_(()=>import("./BusinessPortal-DfMW0zEt.js"),__vite__mapDeps([149,1,2,3,5,6,7,8,9,10]))),ru=r.lazy(()=>_(()=>import("./ResumeBuilder-DbeBbfU2.js"),__vite__mapDeps([150,1,2,3,20,5,151,141,6,7,8,9,10]))),nu=r.lazy(()=>_(()=>import("./EmailPractice-DcqMwFiI.js"),__vite__mapDeps([152,1,2,3,5,6,7,8,9,10]))),iu=r.lazy(()=>_(()=>import("./InterviewPractice-C2cu4wp4.js"),__vite__mapDeps([153,1,2,3,5,6,7,8,9,10]))),ou=r.lazy(()=>_(()=>import("./NCLEXPortal-BGEnzBXe.js"),__vite__mapDeps([154,1,2,3,5,6,7,8,9,10]))),lu=r.lazy(()=>_(()=>import("./NCLEXTest-BJfRvev9.js"),__vite__mapDeps([155,1,2,3,44,5,15,35,6,7,8,9,10]))),cu=r.lazy(()=>_(()=>import("./AdminNCLEX-O5f-hZ2d.js"),__vite__mapDeps([156,1,2,3,22,5,4,6,7,8,9,10]))),du=r.lazy(()=>_(()=>import("./AdminNCLEXTestDetail-Dtq7FJy2.js"),__vite__mapDeps([157,1,2,3,20,5,22,4,15,21,35,44,6,7,8,9,10]))),uu=r.lazy(()=>_(()=>import("./BooksLibrary-B_xO7EfQ.js"),__vite__mapDeps([158,1,2,3,5,6,7,8,9,10]))),mu=r.lazy(()=>_(()=>import("./BookReader-DShol5QV.js"),__vite__mapDeps([159,1,2,3,35,5,21,6,7,8,9,10]))),hu=r.lazy(()=>_(()=>import("./TemplatesGallery-CUywm3oq.js"),__vite__mapDeps([160,1,2,3,5,6,7,8,9,10]))),gu=r.lazy(()=>_(()=>import("./PrivacyPolicy-DdrVtsLo.js"),__vite__mapDeps([161,1,2,3]))),pu=r.lazy(()=>_(()=>import("./RefundPolicy-D2ds0mEq.js"),__vite__mapDeps([162,1,2,3]))),xu=r.lazy(()=>_(()=>import("./TermsOfService-zxqmexsE.js"),__vite__mapDeps([163,1,2,3]))),fu=r.lazy(()=>_(()=>import("./Support-D7WxcyO9.js"),__vite__mapDeps([164,1,2,3,5]))),bu=r.lazy(()=>_(()=>import("./PodcastListing-CWbSMfKu.js"),__vite__mapDeps([165,1,2,3,86,5,32,33,6,7,8,9,10]))),yu=r.lazy(()=>_(()=>import("./AdminPodcast-B628bFxf.js"),__vite__mapDeps([166,1,2,3,53,5,22,4,72,6,7,8,9,10]))),vu=new _t({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:2,retryDelay:e=>Math.min(1e3*2**e,5e3),refetchOnWindowFocus:!1,networkMode:"online"}}});function ju({children:e}){const{admin:t,loading:s}=tc(),a="undefined"!=typeof window&&"true"===localStorage.getItem("admin_session");return a||t||a?n.jsx(n.Fragment,{children:e}):n.jsx(d,{to:"/admin/login",replace:!0})}const wu=()=>n.jsxs(Vs,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:[n.jsx(lr,{children:n.jsx(N,{i18n:b,children:n.jsx(Nt,{client:vu,children:n.jsx(Mr,{children:n.jsx(h,{children:n.jsx(pa,{children:n.jsxs(an,{children:[n.jsx(rn,{}),n.jsx(Ds,{}),n.jsx(ga,{}),n.jsx(un,{}),n.jsx(r.Suspense,{fallback:n.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-primary/30 border-t-primary rounded-full animate-spin"}),n.jsx("p",{className:"mt-4 text-sm text-muted-foreground animate-pulse",children:"Loading..."})]}),children:n.jsxs(g,{children:[n.jsx(p,{path:"/",element:n.jsx(So,{})}),n.jsx(p,{path:"/hero",element:n.jsx(yn,{})}),n.jsx(p,{path:"/hero/",element:n.jsx(yn,{})}),n.jsx(p,{path:"/reading",element:n.jsx(Ll,{})}),n.jsx(p,{path:"/reading/:testId",element:n.jsx(Ll,{})}),n.jsx(p,{path:"/listening",element:n.jsx(Ul,{})}),n.jsx(p,{path:"/listening/:testId",element:n.jsx(Wl,{})}),n.jsx(p,{path:"/writing",element:n.jsx(Gl,{})}),n.jsx(p,{path:"/writing/random",element:n.jsx(Gl,{})}),n.jsx(p,{path:"/writing-test",element:n.jsx(Hl,{})}),n.jsx(p,{path:"/writing/:book/:test",element:n.jsx(Hl,{})}),n.jsx(p,{path:"/speaking",element:n.jsx(Zl,{})}),n.jsx(p,{path:"/speaking/random",element:n.jsx(Zl,{})}),n.jsx(p,{path:"/speaking/:book/:test",element:n.jsx(Zl,{})}),n.jsx(p,{path:"/qwen-tts-test",element:n.jsx($c,{})}),n.jsx(p,{path:"/pte/writing",element:n.jsx(Gl,{})}),n.jsx(p,{path:"/pte/speaking",element:n.jsx(Zl,{})}),n.jsx(p,{path:"/pte/reading",element:n.jsx(To,{})}),n.jsx(p,{path:"/pte/listening",element:n.jsx(Ml,{})}),n.jsx(p,{path:"/toefl/writing",element:n.jsx(Gl,{})}),n.jsx(p,{path:"/toefl/speaking",element:n.jsx(Zl,{})}),n.jsx(p,{path:"/toefl/reading",element:n.jsx(To,{})}),n.jsx(p,{path:"/toefl/listening",element:n.jsx(Ml,{})}),n.jsx(p,{path:"/general/grammar",element:n.jsx(Oc,{})}),n.jsx(p,{path:"/general/vocabulary",element:n.jsx(Oc,{})}),n.jsx(p,{path:"/general/conversation",element:n.jsx(Oc,{})}),n.jsx(p,{path:"/general/listening",element:n.jsx(Oc,{})}),n.jsx(p,{path:"/general/speaking",element:n.jsx(Oc,{})}),n.jsx(p,{path:"/ielts-portal",element:n.jsx(Rc,{})}),n.jsx(p,{path:"/ielts",element:n.jsx(Dc,{})}),n.jsx(p,{path:"/ielts/:skill",element:n.jsx(Fc,{})}),n.jsx(p,{path:"/books",element:n.jsx(uu,{})}),n.jsx(p,{path:"/books/:bookId",element:n.jsx(mu,{})}),n.jsx(p,{path:"/templates",element:n.jsx(hu,{})}),n.jsx(p,{path:"/grammar",element:n.jsx(Zd,{})}),n.jsx(p,{path:"/grammar/:topicSlug",element:n.jsx(eu,{})}),n.jsx(p,{path:"/business-portal",element:n.jsx(au,{})}),n.jsx(p,{path:"/business/resume",element:n.jsx(ru,{})}),n.jsx(p,{path:"/business/email",element:n.jsx(nu,{})}),n.jsx(p,{path:"/business/interview",element:n.jsx(iu,{})}),n.jsx(p,{path:"/nclex",element:n.jsx(ou,{})}),n.jsx(p,{path:"/nclex/test/:testId",element:n.jsx(lu,{})}),n.jsx(p,{path:"/admin/login",element:n.jsx(sc,{})}),n.jsx(p,{path:"/admin",element:n.jsx(ju,{children:n.jsx(ac,{})})}),n.jsx(p,{path:"/admin/analytics",element:n.jsx(ju,{children:n.jsx(Vd,{})})}),n.jsx(p,{path:"/admin/reading",element:n.jsx(ju,{children:n.jsx(rc,{})})}),n.jsx(p,{path:"/admin/listening",element:n.jsx(ju,{children:n.jsx(nc,{})})}),n.jsx(p,{path:"/admin/writing",element:n.jsx(ju,{children:n.jsx(ic,{})})}),n.jsx(p,{path:"/admin/speaking",element:n.jsx(ju,{children:n.jsx(oc,{})})}),n.jsx(p,{path:"/admin/ielts",element:n.jsx(ju,{children:n.jsx(lc,{})})}),n.jsx(p,{path:"/admin/ielts/:skill",element:n.jsx(ju,{children:n.jsx(zc,{})})}),n.jsx(p,{path:"/admin/pte",element:n.jsx(ju,{children:n.jsx(cc,{})})}),n.jsx(p,{path:"/admin/toefl",element:n.jsx(ju,{children:n.jsx(dc,{})})}),n.jsx(p,{path:"/admin/general",element:n.jsx(ju,{children:n.jsx(Nc,{})})}),n.jsx(p,{path:"/admin/blog",element:n.jsx(ju,{children:n.jsx(Hd,{})})}),n.jsx(p,{path:"/admin/books",element:n.jsx(ju,{children:n.jsx(Jd,{})})}),n.jsx(p,{path:"/admin/templates",element:n.jsx(ju,{children:n.jsx(Xd,{})})}),n.jsx(p,{path:"/admin/affiliates",element:n.jsx(ju,{children:n.jsx(Qd,{})})}),n.jsx(p,{path:"/admin/affiliates/:affiliateId",element:n.jsx(ju,{children:n.jsx(Kd,{})})}),n.jsx(p,{path:"/admin/grammar",element:n.jsx(ju,{children:n.jsx(tu,{})})}),n.jsx(p,{path:"/admin/grammar/:topicId",element:n.jsx(ju,{children:n.jsx(su,{})})}),n.jsx(p,{path:"/admin/nclex",element:n.jsx(ju,{children:n.jsx(cu,{})})}),n.jsx(p,{path:"/admin/nclex/test/:testId",element:n.jsx(ju,{children:n.jsx(du,{})})}),n.jsx(p,{path:"/admin/:testType/tests",element:n.jsx(ju,{children:n.jsx(qc,{})})}),n.jsx(p,{path:"/admin/:testType/test/:testId",element:n.jsx(ju,{children:n.jsx(Vc,{})})}),n.jsx(p,{path:"/admin/:testType/test/:testId/:sectionId",element:n.jsx(ju,{children:n.jsx(Wc,{})})}),n.jsx(p,{path:"/admin/ielts/reading",element:n.jsx(ju,{children:n.jsx(Gc,{})})}),n.jsx(p,{path:"/admin/:testType/test/:testId/reading",element:n.jsx(ju,{children:n.jsx(Uc,{})})}),n.jsx(p,{path:"/admin/:testType/test/:testId/listening",element:n.jsx(ju,{children:n.jsx(Yc,{})})}),n.jsx(p,{path:"/admin/ielts/test/:testId/writing",element:n.jsx(ju,{children:n.jsx(Hc,{})})}),n.jsx(p,{path:"/admin/ielts/test/:testId/speaking",element:n.jsx(ju,{children:n.jsx(Xc,{})})}),n.jsx(p,{path:"/admin/ielts/test/:testId/reading",element:n.jsx(ju,{children:n.jsx(Jc,{})})}),n.jsx(p,{path:"/admin/ielts/test/:testId/listening",element:n.jsx(ju,{children:n.jsx(Yc,{})})}),n.jsx(p,{path:"/admin/skills",element:n.jsx(ju,{children:n.jsx(id,{})})}),n.jsx(p,{path:"/admin/vocab",element:n.jsx(ju,{children:n.jsx(hd,{})})}),n.jsx(p,{path:"/admin/vocab/",element:n.jsx(ju,{children:n.jsx(hd,{})})}),n.jsx(p,{path:"/admin/skills/vocabulary/tests",element:n.jsx(ju,{children:n.jsx(ud,{})})}),n.jsx(p,{path:"/admin/vocab-book",element:n.jsx(ju,{children:n.jsx(md,{})})}),n.jsx(p,{path:"/admin/skills/vocabulary/tests/:id",element:n.jsx(ju,{children:n.jsx(gd,{})})}),n.jsx(p,{path:"/admin/skills/vocabulary-builder",element:n.jsx(ju,{children:n.jsx(ud,{})})}),n.jsx(p,{path:"/admin/skills/vocabulary-builder/tests/:id",element:n.jsx(ju,{children:n.jsx(gd,{})})}),n.jsx(p,{path:"/admin/skills/grammar/tests",element:n.jsx(ju,{children:n.jsx(pd,{})})}),n.jsx(p,{path:"/admin/skills/grammar/tests/:id",element:n.jsx(ju,{children:n.jsx(xd,{})})}),n.jsx(p,{path:"/admin/skills/grammar-fix-it",element:n.jsx(ju,{children:n.jsx(pd,{})})}),n.jsx(p,{path:"/admin/skills/grammar-fix-it/tests/:id",element:n.jsx(ju,{children:n.jsx(xd,{})})}),n.jsx(p,{path:"/admin/skills/paraphrasing-challenge",element:n.jsx(ju,{children:n.jsx(fd,{})})}),n.jsx(p,{path:"/admin/skills/paraphrasing-challenge/:id",element:n.jsx(ju,{children:n.jsx(bd,{})})}),n.jsx(p,{path:"/admin/skills/sentence-scramble",element:n.jsx(ju,{children:n.jsx(jd,{})})}),n.jsx(p,{path:"/admin/skills/sentence-scramble/:id",element:n.jsx(ju,{children:n.jsx(wd,{})})}),n.jsx(p,{path:"/admin/skills/sentence-structure-scramble",element:n.jsx(ju,{children:n.jsx(jd,{})})}),n.jsx(p,{path:"/admin/skills/sentence-structure-scramble/:id",element:n.jsx(ju,{children:n.jsx(wd,{})})}),n.jsx(p,{path:"/admin/skills/listening-for-details",element:n.jsx(ju,{children:n.jsx(_d,{})})}),n.jsx(p,{path:"/admin/skills/listening-for-details/:id",element:n.jsx(ju,{children:n.jsx(Nd,{})})}),n.jsx(p,{path:"/admin/skills/pronunciation-repeat-after-me",element:n.jsx(ju,{children:n.jsx(yd,{})})}),n.jsx(p,{path:"/admin/skills/pronunciation-repeat-after-me/:id",element:n.jsx(ju,{children:n.jsx(vd,{})})}),n.jsx(p,{path:"/admin/skills/:slug",element:n.jsx(ju,{children:n.jsx(od,{})})}),n.jsx(p,{path:"/ielts-writing-test/:testId",element:n.jsx(Qc,{})}),n.jsx(p,{path:"/ielts-writing-test",element:n.jsx(Qc,{})}),n.jsx(p,{path:"/ielts-writing-results",element:n.jsx(Zc,{})}),n.jsx(p,{path:"/ielts-writing-results-pro",element:n.jsx(Kc,{})}),n.jsx(p,{path:"/ielts-speaking-test",element:n.jsx(ad,{})}),n.jsx(p,{path:"/ielts-speaking-test/:testId",element:n.jsx(ad,{})}),n.jsx(p,{path:"/ielts-speaking-test/:testName",element:n.jsx(ad,{})}),n.jsx(p,{path:"/ielts-speaking-results",element:n.jsx(sd,{})}),n.jsx(p,{path:"/enhanced-reading-test/:testId",element:n.jsx(rd,{})}),n.jsx(p,{path:"/admin/pte/speaking_writing/:type",element:n.jsx(ju,{children:n.jsx(bc,{})})}),n.jsx(p,{path:"/admin/pte/reading/:type",element:n.jsx(ju,{children:n.jsx(yc,{})})}),n.jsx(p,{path:"/admin/pte/listening/:testId",element:n.jsx(ju,{children:n.jsx(vc,{})})}),n.jsx(p,{path:"/admin/pte/listening",element:n.jsx(ju,{children:n.jsx(cc,{})})}),n.jsx(p,{path:"/admin/pte/reading",element:n.jsx(ju,{children:n.jsx(cc,{})})}),n.jsx(p,{path:"/admin/pte/writing",element:n.jsx(ju,{children:n.jsx(cc,{})})}),n.jsx(p,{path:"/admin/pte/speaking",element:n.jsx(ju,{children:n.jsx(cc,{})})}),n.jsx(p,{path:"/admin/toefl/listening",element:n.jsx(ju,{children:n.jsx(nc,{})})}),n.jsx(p,{path:"/admin/toefl/reading",element:n.jsx(ju,{children:n.jsx(rc,{})})}),n.jsx(p,{path:"/admin/toefl/writing",element:n.jsx(ju,{children:n.jsx(ic,{})})}),n.jsx(p,{path:"/admin/toefl/speaking",element:n.jsx(ju,{children:n.jsx(oc,{})})}),n.jsx(p,{path:"/admin/toefl/integrated-writing",element:n.jsx(ju,{children:n.jsx(ic,{})})}),n.jsx(p,{path:"/admin/toefl/independent-writing",element:n.jsx(ju,{children:n.jsx(ic,{})})}),n.jsx(p,{path:"/admin/toeic",element:n.jsx(ju,{children:n.jsx(uc,{})})}),n.jsx(p,{path:"/admin/toeic/listening/:testId",element:n.jsx(ju,{children:n.jsx(mc,{})})}),n.jsx(p,{path:"/admin/toeic/reading/:testId",element:n.jsx(ju,{children:n.jsx(hc,{})})}),n.jsx(p,{path:"/toeic",element:n.jsx(fc,{})}),n.jsx(p,{path:"/toeic-portal",element:n.jsx(fc,{})}),n.jsx(p,{path:"/toeic/listening/:testId",element:n.jsx(gc,{})}),n.jsx(p,{path:"/toeic/reading/:testId",element:n.jsx(pc,{})}),n.jsx(p,{path:"/toeic/reading/result",element:n.jsx(xc,{})}),n.jsx(p,{path:"/admin/general/grammar",element:n.jsx(ju,{children:n.jsx(Nc,{})})}),n.jsx(p,{path:"/admin/general/vocabulary",element:n.jsx(ju,{children:n.jsx(Nc,{})})}),n.jsx(p,{path:"/admin/general/pronunciation",element:n.jsx(ju,{children:n.jsx(Nc,{})})}),n.jsx(p,{path:"/reading-results",element:n.jsx(ed,{})}),n.jsx(p,{path:"/listening-results",element:n.jsx(td,{})}),n.jsx(p,{path:"/ielts-speaking-results",element:n.jsx(sd,{})}),n.jsx(p,{path:"/ielts-writing-pro-results",element:n.jsx(Kc,{})}),n.jsx(p,{path:"/pay",element:n.jsx(Bd,{})}),n.jsx(p,{path:"/reset-password",element:n.jsx($d,{})}),n.jsx(p,{path:"/onboarding/assessment",element:n.jsx(Wd,{})}),n.jsx(p,{path:"/plan",element:n.jsx(Ud,{})}),n.jsx(p,{path:"/ielts-portal",element:n.jsx(Rc,{})}),n.jsx(p,{path:"/ielts-test-modules/:testId",element:n.jsx(Bc,{})}),n.jsx(p,{path:"/pte-portal",element:n.jsx(Pc,{})}),n.jsx(p,{path:"/pte-speaking/:type",element:n.jsx(jc,{})}),n.jsx(p,{path:"/pte-reading/:type",element:n.jsx(wc,{})}),n.jsx(p,{path:"/pte-listening/:testId",element:n.jsx(_c,{})}),n.jsx(p,{path:"/toefl-portal",element:n.jsx(Lc,{})}),n.jsx(p,{path:"/general-portal",element:n.jsx(Mc,{})}),n.jsx(p,{path:"/dashboard",element:n.jsx(Ec,{})}),n.jsx(p,{path:"/dashboard/writing-history",element:n.jsx(Fd,{})}),n.jsx(p,{path:"/dashboard/my-word-book",element:n.jsx(qd,{})}),n.jsx(p,{path:"/results/writing/:submissionId",element:n.jsx(zd,{})}),n.jsx(p,{path:"/user-dashboard",element:n.jsx(kc,{})}),n.jsx(p,{path:"/practice",element:n.jsx(Sc,{})}),n.jsx(p,{path:"/personal-page",element:n.jsx(kc,{})}),n.jsx(p,{path:"/auth",element:n.jsx(Tc,{})}),n.jsx(p,{path:"/auth/callback",element:n.jsx(Rd,{})}),n.jsx(p,{path:"/tests",element:n.jsx(Sc,{})}),n.jsx(p,{path:"/community",element:n.jsx(Ic,{})}),n.jsx(p,{path:"/settings",element:n.jsx(Ac,{})}),n.jsx(p,{path:"/ai-speaking",element:n.jsx(cd,{})}),n.jsx(p,{path:"/earthworm",element:n.jsx(dd,{})}),n.jsx(p,{path:"/skills/:slug",element:n.jsx(ld,{})}),n.jsx(p,{path:"/skills/vocabulary-builder/map",element:n.jsx(Cd,{})}),n.jsx(p,{path:"/skills/vocabulary-builder",element:n.jsx(Dd,{})}),n.jsx(p,{path:"/vocabulary",element:n.jsx(Ld,{})}),n.jsx(p,{path:"/vocabulary/levels",element:n.jsx(Ld,{})}),n.jsx(p,{path:"/vocabulary/book",element:n.jsx(Id,{})}),n.jsx(p,{path:"/vocabulary/deck/:deckId",element:n.jsx(Ad,{})}),n.jsx(p,{path:"/vocabulary/test/:deckId",element:n.jsx(Md,{})}),n.jsx(p,{path:"/vocabulary/review/:deckId",element:n.jsx(Pd,{})}),n.jsx(p,{path:"/signup",element:n.jsx(Od,{})}),n.jsx(p,{path:"/skills/vocabulary-builder/test/:testId",element:n.jsx(kd,{})}),n.jsx(p,{path:"/skills/paraphrasing-challenge/test/:testId",element:n.jsx(Ed,{})}),n.jsx(p,{path:"/skills/sentence-structure-scramble/test/:testId",element:n.jsx(Sd,{})}),n.jsx(p,{path:"/skills/listening-for-details/test/:testId",element:n.jsx(Td,{})}),n.jsx(p,{path:"/pricing",element:n.jsx(nd,{})}),n.jsx(p,{path:"/privacy-policy",element:n.jsx(gu,{})}),n.jsx(p,{path:"/refund-policy",element:n.jsx(pu,{})}),n.jsx(p,{path:"/terms-of-service",element:n.jsx(xu,{})}),n.jsx(p,{path:"/support",element:n.jsx(fu,{})}),n.jsx(p,{path:"/podcasts",element:n.jsx(bu,{})}),n.jsx(p,{path:"/admin/podcasts",element:n.jsx(ju,{children:n.jsx(yu,{})})}),n.jsx(p,{path:"/blog",element:n.jsx(d,{to:"/en/blog",replace:!0})}),n.jsx(p,{path:"/:lang/blog",element:n.jsx(Gd,{})}),n.jsx(p,{path:"/:lang/blog/:slug",element:n.jsx(Yd,{})}),n.jsx(p,{path:"*",element:n.jsx(Cc,{})})]})}),n.jsx(Kr,{})]})})})})})})}),void 0]});"undefined"!=typeof window&&(window.React=i),window.onerror=(e,t,s,a,r)=>{console.error("Global Error:",{message:e,source:t,lineno:s,colno:a,error:r})},window.addEventListener("error",e=>{console.error("Window Error Event:",e.error)}),window.addEventListener("unhandledrejection",e=>{console.error("Unhandled Promise Rejection:",e.reason)});try{const e=document.getElementById("root");if(!e)throw new Error("Root element not found!");console.log("Root element found, mounting React app..."),f(e).render(n.jsx(wu,{})),console.log("React app mounted successfully!")}catch(_u){console.error("Failed to mount React app:",_u);const e=document.getElementById("root");e&&(e.innerHTML=`<div style="color: red; padding: 20px; font-size: 16px;">\n      <h1>Error Loading App</h1>\n      <p>${String(_u)}</p>\n      <pre>${_u instanceof Error?_u.stack:""}</pre>\n    </div>`)}export{ba as $,Pl as A,qr as B,Rr as C,_n as D,Pr as E,Er as F,Nr as G,Lo as H,Vr as I,ia as J,Tr as K,Mn as L,Il as M,Cs as N,pa as O,Mo as P,$r as Q,Co as R,Wr as S,fo as T,bn as U,wr as V,Pn as W,In as X,Zr as Y,xa as Z,fa as _,Br as a,Qr as a0,an as a1,Jl as a2,gn as a3,Ar as a4,io as a5,jo as a6,vo as a7,hn as a8,ql as a9,_r as aa,Dr as b,Fr as c,Ts as d,xo as e,Tn as f,Cn as g,An as h,Gr as i,Ur as j,Jr as k,Xr as l,Nn as m,tc as n,zr as o,Io as p,en as q,oo as r,jr as s,lo as t,Yl as u,co as v,Or as w,wn as x,Ao as y,br as z};
